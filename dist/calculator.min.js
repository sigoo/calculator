var requirejs,require,define;!function(p){function d(e,t){return r.call(e,t)}function a(e,t){var r,n,i,o,a,s,l,c,u,p,d=t&&t.split("/"),h=x.map,f=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=(d=d.slice(0,d.length-1)).concat(e.split("/")),c=0;c<e.length;c+=1)if("."===(p=e[c]))e.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===e[2]||".."===e[0]))break;0<c&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||f)&&h){for(c=(r=e.split("/")).length;0<c;c-=1){if(n=r.slice(0,c).join("/"),d)for(u=d.length;0<u;u-=1)if((i=h[d.slice(0,u).join("/")])&&(i=i[n])){o=i,a=c;break}if(o)break;!s&&f&&f[n]&&(s=f[n],l=c)}!o&&s&&(o=s,a=l),o&&(r.splice(0,a,o),e=r.join("/"))}return e}function h(e,t){return function(){return l.apply(p,n.call(arguments,0).concat([e,t]))}}function f(t){return function(e){v[t]=e}}function g(e){if(d(b,e)){var t=b[e];delete b[e],w[e]=!0,o.apply(p,t)}if(!d(v,e)&&!d(w,e))throw new Error("No "+e);return v[e]}function s(e){var t,r=e?e.indexOf("!"):-1;return-1<r&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}var o,l,m,y,v={},b={},x={},w={},r=Object.prototype.hasOwnProperty,n=[].slice;m=function(e,t){var r,n,i=s(e),o=i[0];return e=i[1],o&&(r=g(o=a(o,t))),o?e=r&&r.normalize?r.normalize(e,(n=t,function(e){return a(e,n)})):a(e,t):(o=(i=s(e=a(e,t)))[0],e=i[1],o&&(r=g(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},y={require:function(e){return h(e)},exports:function(e){var t=v[e];return void 0!==t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:(t=e,function(){return x&&x.config&&x.config[t]||{}})};var t}},o=function(e,t,r,n){var i,o,a,s,l,c,u=[];if(n=n||e,"function"==typeof r){for(t=!t.length&&r.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if("require"===(o=(s=m(t[l],n)).f))u[l]=y.require(e);else if("exports"===o)u[l]=y.exports(e),c=!0;else if("module"===o)i=u[l]=y.module(e);else if(d(v,o)||d(b,o)||d(w,o))u[l]=g(o);else{if(!s.p)throw new Error(e+" missing "+o);s.p.load(s.n,h(n,!0),f(o),{}),u[l]=v[o]}a=r.apply(v[e],u),e&&(i&&i.exports!==p&&i.exports!==v[e]?v[e]=i.exports:a===p&&c||(v[e]=a))}else e&&(v[e]=r)},requirejs=require=l=function(e,t,r,n,i){return"string"==typeof e?y[e]?y[e](t):g(m(e,t).f):(e.splice||(x=e,t.splice?(e=t,t=r,r=null):e=p),t=t||function(){},"function"==typeof r&&(r=n,n=i),n?o(p,e,t,r):setTimeout(function(){o(p,e,t,r)},4),l)},l.config=function(e){return(x=e).deps&&l(x.deps,x.callback),l},(define=function(e,t,r){t.splice||(r=t,t=[]),d(v,e)||d(b,e)||(b[e]=[e,t,r])}).amd={jQuery:!0}}(),"undefined"!=typeof ALMOND_OVERRIDES&&ALMOND_OVERRIDES&&(define=ALMOND_OVERRIDES.define||define,require=ALMOND_OVERRIDES.require||require,requirejs=ALMOND_OVERRIDES.requirejs||requirejs),define("vendor/almond",function(){}),define("testbridge",["require"],function(e){var t={ready:function(){try{window.TestBridge=t,parent.USING_SELENIUM&&function(){window.consoleOverride=!0;var r=window.console.log;window.console.log=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(window.console,[].concat([e.join(" ")],e))}}()}catch(e){}}};return t}),define("ipad.ghostevents",["require"],function(e){function t(e){n&&o.evtInScope(e)&&(e.stopPropagation(),e.stopImmediatePropagation())}function r(e){n&&o.evtInScope(e)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())}var n=!1,i=null,o={isGhostEvent:function(e){return!1},evtInScope:function(e){return!1}};return document.addEventListener("mousedown",function(e){o.evtInScope(e)&&(i=document.activeElement,n=o.isGhostEvent(e),t(e))},!0),document.addEventListener("mouseup",t,!0),document.addEventListener("click",function(e){r(e),n&&document.activeElement!==i&&(document.activeElement&&document.activeElement.blur(),i&&i.focus()),n=!1},!0),document.addEventListener("focus",r,!0),document.addEventListener("blur",r,!0),o}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(S,e){function s(e){var t=!!e&&"length"in e&&e.length,r=Z.type(e);return"function"!==r&&!Z.isWindow(e)&&("array"===r||0===t||"number"==typeof t&&0<t&&t-1 in e)}function t(e,r,n){if(Z.isFunction(r))return Z.grep(e,function(e,t){return!!r.call(e,t,e)!==n});if(r.nodeType)return Z.grep(e,function(e){return e===r!==n});if("string"==typeof r){if(le.test(r))return Z.filter(r,e,n);r=Z.filter(r,e)}return Z.grep(e,function(e){return-1<K.call(r,e)!==n})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function n(){z.removeEventListener("DOMContentLoaded",n),S.removeEventListener("load",n),Z.ready()}function i(){this.expando=Z.expando+i.uid++}function l(e,t,r){var n;if(void 0===r&&1===e.nodeType)if(n="data-"+t.replace(xe,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(n))){try{r="true"===r||"false"!==r&&("null"===r?null:+r+""===r?+r:be.test(r)?Z.parseJSON(r):r)}catch(e){}ve.set(e,t,r)}else r=void 0;return r}function c(e,t,r,n){var i,o=1,a=20,s=n?function(){return n.cur()}:function(){return Z.css(e,t,"")},l=s(),c=r&&r[3]||(Z.cssNumber[t]?"":"px"),u=(Z.cssNumber[t]||"px"!==c&&+l)&&_e.exec(Z.css(e,t));if(u&&u[3]!==c)for(c=c||u[3],r=r||[],u=+l||1;u/=o=o||".5",Z.style(e,t,u+c),o!==(o=s()/l)&&1!==o&&--a;);return r&&(u=+u||+l||0,i=r[1]?u+(r[1]+1)*r[2]:+r[2],n&&(n.unit=c,n.start=u,n.end=i)),i}function g(e,t){var r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],r):r}function m(e,t){for(var r=0,n=e.length;r<n;r++)ye.set(e[r],"globalEval",!t||ye.get(t[r],"globalEval"))}function y(e,t,r,n,i){for(var o,a,s,l,c,u,p=t.createDocumentFragment(),d=[],h=0,f=e.length;h<f;h++)if((o=e[h])||0===o)if("object"===Z.type(o))Z.merge(d,o.nodeType?[o]:o);else if(De.test(o)){for(a=a||p.appendChild(t.createElement("div")),s=(Ie.exec(o)||["",""])[1].toLowerCase(),l=Ce[s]||Ce._default,a.innerHTML=l[1]+Z.htmlPrefilter(o)+l[2],u=l[0];u--;)a=a.lastChild;Z.merge(d,a.childNodes),(a=p.firstChild).textContent=""}else d.push(t.createTextNode(o));for(p.textContent="",h=0;o=d[h++];)if(n&&-1<Z.inArray(o,n))i&&i.push(o);else if(c=Z.contains(o.ownerDocument,o),a=g(p.appendChild(o),"script"),c&&m(a),r)for(u=0;o=a[u++];)Te.test(o.type||"")&&r.push(o);return p}function o(){return!0}function u(){return!1}function a(){try{return z.activeElement}catch(e){}}function p(e,t,r,n,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof r&&(n=n||r,r=void 0),t)p(e,s,r,n,t[s],o);return e}if(null==n&&null==i?(i=r,n=r=void 0):null==i&&("string"==typeof r?(i=n,n=void 0):(i=n,n=r,r=void 0)),!1===i)i=u;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return Z().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=Z.guid++)),e.each(function(){Z.event.add(this,t,i,n,r)})}function d(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function v(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function b(e){var t=Re.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function h(e,t){var r,n,i,o,a,s,l,c;if(1===t.nodeType){if(ye.hasData(e)&&(o=ye.access(e),a=ye.set(t,o),c=o.events))for(i in delete a.handle,a.events={},c)for(r=0,n=c[i].length;r<n;r++)Z.event.add(t,i,c[i][r]);ve.hasData(e)&&(s=ve.access(e),l=Z.extend({},s),ve.set(t,l))}}function x(r,n,i,o){n=H.apply([],n);var e,t,a,s,l,c,u=0,p=r.length,d=p-1,h=n[0],f=Z.isFunction(h);if(f||1<p&&"string"==typeof h&&!Q.checkClone&&Ne.test(h))return r.each(function(e){var t=r.eq(e);f&&(n[0]=h.call(this,e,t.html())),x(t,n,i,o)});if(p&&(t=(e=y(n,r[0].ownerDocument,!1,r,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=Z.map(g(e,"script"),v)).length;u<p;u++)l=e,u!==d&&(l=Z.clone(l,!0,!0),s&&Z.merge(a,g(l,"script"))),i.call(r[u],l,u);if(s)for(c=a[a.length-1].ownerDocument,Z.map(a,b),u=0;u<s;u++)l=a[u],Te.test(l.type||"")&&!ye.access(l,"globalEval")&&Z.contains(c,l)&&(l.src?Z._evalUrl&&Z._evalUrl(l.src):Z.globalEval(l.textContent.replace(Be,"")))}return r}function f(e,t,r){for(var n,i=t?Z.filter(t,e):e,o=0;null!=(n=i[o]);o++)r||1!==n.nodeType||Z.cleanData(g(n)),n.parentNode&&(r&&Z.contains(n.ownerDocument,n)&&m(g(n,"script")),n.parentNode.removeChild(n));return e}function w(e,t){var r=Z(t.createElement(e)).appendTo(t.body),n=Z.css(r[0],"display");return r.detach(),n}function _(e){var t=z,r=Ve[e];return r||("none"!==(r=w(e,t))&&r||((t=(je=(je||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),r=w(e,t),je.detach()),Ve[e]=r),r}function E(e,t,r){var n,i,o,a,s=e.style;return""!==(a=(r=r||Ge(e))?r.getPropertyValue(t)||r[t]:void 0)&&void 0!==a||Z.contains(e.ownerDocument,e)||(a=Z.style(e,t)),r&&!Q.pixelMarginRight()&&ze.test(a)&&Ue.test(t)&&(n=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=i,s.maxWidth=o),void 0!==a?a+"":a}function M(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function I(e){if(e in Qe)return e;for(var t=e[0].toUpperCase()+e.slice(1),r=$e.length;r--;)if((e=$e[r]+t)in Qe)return e}function T(e,t,r){var n=_e.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function C(e,t,r,n,i){for(var o=r===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===r&&(a+=Z.css(e,r+Se[o],!0,i)),n?("content"===r&&(a-=Z.css(e,"padding"+Se[o],!0,i)),"margin"!==r&&(a-=Z.css(e,"border"+Se[o]+"Width",!0,i))):(a+=Z.css(e,"padding"+Se[o],!0,i),"padding"!==r&&(a+=Z.css(e,"border"+Se[o]+"Width",!0,i)));return a}function k(e,t,r){var n=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Ge(e),a="border-box"===Z.css(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=E(e,t,o))<0||null==i)&&(i=e.style[t]),ze.test(i))return i;n=a&&(Q.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+C(e,t,r||(a?"border":"content"),n,o)+"px"}function P(e,t){for(var r,n,i,o=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(o[a]=ye.get(n,"olddisplay"),r=n.style.display,t?(o[a]||"none"!==r||(n.style.display=""),""===n.style.display&&Ee(n)&&(o[a]=ye.access(n,"olddisplay",_(n.nodeName)))):(i=Ee(n),"none"===r&&i||ye.set(n,"olddisplay",i?r:Z.css(n,"display"))));for(a=0;a<s;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function D(e,t,r,n,i){return new D.prototype.init(e,t,r,n,i)}function A(){return S.setTimeout(function(){Ze=void 0}),Ze=Z.now()}function L(e,t){var r,n=0,i={height:e};for(t=t?1:0;n<4;n+=2-t)i["margin"+(r=Se[n])]=i["padding"+r]=e;return t&&(i.opacity=i.width=e),i}function O(e,t,r){for(var n,i=(q.tweeners[t]||[]).concat(q.tweeners["*"]),o=0,a=i.length;o<a;o++)if(n=i[o].call(r,t,e))return n}function q(o,e,t){var r,a,n=0,i=q.prefilters.length,s=Z.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var e=Ze||A(),t=Math.max(0,c.startTime+c.duration-e),r=1-(t/c.duration||0),n=0,i=c.tweens.length;n<i;n++)c.tweens[n].run(r);return s.notifyWith(o,[c,r,t]),r<1&&i?t:(s.resolveWith(o,[c]),!1)},c=s.promise({elem:o,props:Z.extend({},e),opts:Z.extend(!0,{specialEasing:{},easing:Z.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||A(),duration:t.duration,tweens:[],createTween:function(e,t){var r=Z.Tween(o,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){var t=0,r=e?c.tweens.length:0;if(a)return this;for(a=!0;t<r;t++)c.tweens[t].run(1);return e?(s.notifyWith(o,[c,1,0]),s.resolveWith(o,[c,e])):s.rejectWith(o,[c,e]),this}}),u=c.props;for(function(e,t){var r,n,i,o,a;for(r in e)if(i=t[n=Z.camelCase(r)],o=e[r],Z.isArray(o)&&(i=o[1],o=e[r]=o[0]),r!==n&&(e[n]=o,delete e[r]),(a=Z.cssHooks[n])&&"expand"in a)for(r in o=a.expand(o),delete e[n],o)r in e||(e[r]=o[r],t[r]=i);else t[n]=i}(u,c.opts.specialEasing);n<i;n++)if(r=q.prefilters[n].call(c,o,u,c.opts))return Z.isFunction(r.stop)&&(Z._queueHooks(c.elem,c.opts.queue).stop=Z.proxy(r.stop,r)),r;return Z.map(u,O,c),Z.isFunction(c.opts.start)&&c.opts.start.call(o,c),Z.fx.timer(Z.extend(l,{elem:o,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function F(e){return e.getAttribute&&e.getAttribute("class")||""}function N(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var r,n=0,i=e.toLowerCase().match(fe)||[];if(Z.isFunction(t))for(;r=i[n++];)"+"===r[0]?(r=r.slice(1)||"*",(o[r]=o[r]||[]).unshift(t)):(o[r]=o[r]||[]).push(t)}}function R(t,i,o,a){function s(e){var n;return l[e]=!0,Z.each(t[e]||[],function(e,t){var r=t(i,o,a);return"string"!=typeof r||c||l[r]?c?!(n=r):void 0:(i.dataTypes.unshift(r),s(r),!1)}),n}var l={},c=t===_t;return s(i.dataTypes[0])||!l["*"]&&s("*")}function B(e,t){var r,n,i=Z.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&Z.extend(!0,e,n),e}function j(r,e,n,i){var t;if(Z.isArray(e))Z.each(e,function(e,t){n||It.test(r)?i(r,t):j(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,n,i)});else if(n||"object"!==Z.type(e))i(r,e);else for(t in e)j(r+"["+t+"]",e[t],n,i)}function V(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var U=[],z=S.document,G=U.slice,H=U.concat,W=U.push,K=U.indexOf,Y={},X=Y.toString,$=Y.hasOwnProperty,Q={},Z=function(e,t){return new Z.fn.init(e,t)},J=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ee=/^-ms-/,te=/-([\da-z])/gi,re=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:"2.2.4",constructor:Z,selector:"",length:0,toArray:function(){return G.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:G.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return Z.each(this,e)},map:function(r){return this.pushStack(Z.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(G.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(0<=r&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:W,sort:U.sort,splice:U.splice},Z.extend=Z.fn.extend=function(){var e,t,r,n,i,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||Z.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)r=a[t],a!==(n=e[t])&&(c&&n&&(Z.isPlainObject(n)||(i=Z.isArray(n)))?(o=i?(i=!1,r&&Z.isArray(r)?r:[]):r&&Z.isPlainObject(r)?r:{},a[t]=Z.extend(c,o,n)):void 0!==n&&(a[t]=n));return a},Z.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!Z.isArray(e)&&0<=t-parseFloat(t)+1},isPlainObject:function(e){var t;if("object"!==Z.type(e)||e.nodeType||Z.isWindow(e))return!1;if(e.constructor&&!$.call(e,"constructor")&&!$.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||$.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Y[X.call(e)]||"object":typeof e},globalEval:function(e){var t,r=eval;(e=Z.trim(e))&&(1===e.indexOf("use strict")?((t=z.createElement("script")).text=e,z.head.appendChild(t).parentNode.removeChild(t)):r(e))},camelCase:function(e){return e.replace(ee,"ms-").replace(te,re)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var r,n=0;if(s(e))for(r=e.length;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(J,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(s(Object(e))?Z.merge(r,"string"==typeof e?[e]:e):W.call(r,e)),r},inArray:function(e,t,r){return null==t?-1:K.call(t,e,r)},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;n++)e[i++]=t[n];return e.length=i,e},grep:function(e,t,r){for(var n=[],i=0,o=e.length,a=!r;i<o;i++)!t(e[i],i)!==a&&n.push(e[i]);return n},map:function(e,t,r){var n,i,o=0,a=[];if(s(e))for(n=e.length;o<n;o++)null!=(i=t(e[o],o,r))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,r))&&a.push(i);return H.apply([],a)},guid:1,proxy:function(e,t){var r,n,i;if("string"==typeof t&&(r=e[t],t=e,e=r),Z.isFunction(e))return n=G.call(arguments,2),(i=function(){return e.apply(t||this,n.concat(G.call(arguments)))}).guid=e.guid=e.guid||Z.guid++,i},now:Date.now,support:Q}),"function"==typeof Symbol&&(Z.fn[Symbol.iterator]=U[Symbol.iterator]),Z.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){Y["[object "+t+"]"]=t.toLowerCase()});var ne=function(r){function x(e,t,r,n){var i,o,a,s,l,c,u,p,d=t&&t.ownerDocument,h=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return r;if(!n&&((t?t.ownerDocument||t:R)!==P&&k(t),t=t||P,A)){if(11!==h&&(c=fe.exec(e)))if(i=c[1]){if(9===h){if(!(a=t.getElementById(i)))return r;if(a.id===i)return r.push(a),r}else if(d&&(a=d.getElementById(i))&&F(t,a)&&a.id===i)return r.push(a),r}else{if(c[2])return X.apply(r,t.getElementsByTagName(e)),r;if((i=c[3])&&m.getElementsByClassName&&t.getElementsByClassName)return X.apply(r,t.getElementsByClassName(i)),r}if(m.qsa&&!z[e+" "]&&(!L||!L.test(e))){if(1!==h)d=t,p=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(me,"\\$&"):t.setAttribute("id",s=N),o=(u=S(e)).length,l=ce.test(s)?"#"+s:"[id='"+s+"']";o--;)u[o]=l+" "+g(u[o]);p=u.join(","),d=ge.test(e)&&f(t.parentNode)||t}if(p)try{return X.apply(r,d.querySelectorAll(p)),r}catch(e){}finally{s===N&&t.removeAttribute("id")}}}return M(e.replace(ie,"$1"),t,r,n)}function e(){var n=[];return function e(t,r){return n.push(t+" ")>_.cacheLength&&delete e[n.shift()],e[t+" "]=r}}function l(e){return e[N]=!0,e}function i(e){var t=P.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function t(e,t){for(var r=e.split("|"),n=r.length;n--;)_.attrHandle[r[n]]=t}function c(e,t){var r=t&&e,n=r&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(n)return n;if(r)for(;r=r.nextSibling;)if(r===t)return-1;return e?1:-1}function n(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function o(r){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===r}}function a(a){return l(function(o){return o=+o,l(function(e,t){for(var r,n=a([],e.length,o),i=n.length;i--;)e[r=n[i]]&&(e[r]=!(t[r]=e[r]))})})}function f(e){return e&&void 0!==e.getElementsByTagName&&e}function s(){}function g(e){for(var t=0,r=e.length,n="";t<r;t++)n+=e[t].value;return n}function p(s,e,t){var l=e.dir,c=t&&"parentNode"===l,u=j++;return e.first?function(e,t,r){for(;e=e[l];)if(1===e.nodeType||c)return s(e,t,r)}:function(e,t,r){var n,i,o,a=[B,u];if(r){for(;e=e[l];)if((1===e.nodeType||c)&&s(e,t,r))return!0}else for(;e=e[l];)if(1===e.nodeType||c){if((n=(i=(o=e[N]||(e[N]={}))[e.uniqueID]||(o[e.uniqueID]={}))[l])&&n[0]===B&&n[1]===u)return a[2]=n[2];if((i[l]=a)[2]=s(e,t,r))return!0}}}function d(i){return 1<i.length?function(e,t,r){for(var n=i.length;n--;)if(!i[n](e,t,r))return!1;return!0}:i[0]}function w(e,t,r,n,i){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(r&&!r(o,n,i)||(a.push(o),c&&t.push(s)));return a}function v(h,f,g,m,y,e){return m&&!m[N]&&(m=v(m)),y&&!y[N]&&(y=v(y,e)),l(function(e,t,r,n){var i,o,a,s=[],l=[],c=t.length,u=e||function(e,t,r){for(var n=0,i=t.length;n<i;n++)x(e,t[n],r);return r}(f||"*",r.nodeType?[r]:r,[]),p=!h||!e&&f?u:w(u,s,h,r,n),d=g?y||(e?h:c||m)?[]:t:p;if(g&&g(p,d,r,n),m)for(i=w(d,l),m(i,[],r,n),o=i.length;o--;)(a=i[o])&&(d[l[o]]=!(p[l[o]]=a));if(e){if(y||h){if(y){for(i=[],o=d.length;o--;)(a=d[o])&&i.push(p[o]=a);y(null,d=[],i,n)}for(o=d.length;o--;)(a=d[o])&&-1<(i=y?Q(e,a):s[o])&&(e[i]=!(t[i]=a))}}else d=w(d===t?d.splice(c,d.length):d),y?y(null,t,d,n):X.apply(t,d)})}function h(e){for(var i,t,r,n=e.length,o=_.relative[e[0].type],a=o||_.relative[" "],s=o?1:0,l=p(function(e){return e===i},a,!0),c=p(function(e){return-1<Q(i,e)},a,!0),u=[function(e,t,r){var n=!o&&(r||t!==I)||((i=t).nodeType?l(e,t,r):c(e,t,r));return i=null,n}];s<n;s++)if(t=_.relative[e[s].type])u=[p(d(u),t)];else{if((t=_.filter[e[s].type].apply(null,e[s].matches))[N]){for(r=++s;r<n&&!_.relative[e[r].type];r++);return v(1<s&&d(u),1<s&&g(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ie,"$1"),t,s<r&&h(e.slice(s,r)),r<n&&h(e=e.slice(r)),r<n&&g(e))}u.push(t)}return d(u)}var u,m,_,y,b,S,E,M,I,T,C,k,P,D,A,L,O,q,F,N="sizzle"+1*new Date,R=r.document,B=0,j=0,V=e(),U=e(),z=e(),G=function(e,t){return e===t&&(C=!0),0},H={}.hasOwnProperty,W=[],K=W.pop,Y=W.push,X=W.push,$=W.slice,Q=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",J="[\\x20\\t\\r\\n\\f]",ee="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",te="\\["+J+"*("+ee+")(?:"+J+"*([*^$|!~]?=)"+J+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ee+"))|)"+J+"*\\]",re=":("+ee+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+te+")*)|.*)\\)|)",ne=new RegExp(J+"+","g"),ie=new RegExp("^"+J+"+|((?:^|[^\\\\])(?:\\\\.)*)"+J+"+$","g"),oe=new RegExp("^"+J+"*,"+J+"*"),ae=new RegExp("^"+J+"*([>+~]|"+J+")"+J+"*"),se=new RegExp("="+J+"*([^\\]'\"]*?)"+J+"*\\]","g"),le=new RegExp(re),ce=new RegExp("^"+ee+"$"),ue={ID:new RegExp("^#("+ee+")"),CLASS:new RegExp("^\\.("+ee+")"),TAG:new RegExp("^("+ee+"|[*])"),ATTR:new RegExp("^"+te),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+J+"*(even|odd|(([+-]|)(\\d*)n|)"+J+"*(?:([+-]|)"+J+"*(\\d+)|))"+J+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+J+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+J+"*((?:-\\d)?\\d*)"+J+"*\\)|)(?=[^-]|$)","i")},pe=/^(?:input|select|textarea|button)$/i,de=/^h\d$/i,he=/^[^{]+\{\s*\[native \w/,fe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ge=/[+~]/,me=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+J+"?|("+J+")|.)","ig"),ve=function(e,t,r){var n="0x"+t-65536;return n!=n||r?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},be=function(){k()};try{X.apply(W=$.call(R.childNodes),R.childNodes),W[R.childNodes.length].nodeType}catch(r){X={apply:W.length?function(e,t){Y.apply(e,$.call(t))}:function(e,t){for(var r=e.length,n=0;e[r++]=t[n++];);e.length=r-1}}}for(u in m=x.support={},b=x.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},k=x.setDocument=function(e){var t,r,n=e?e.ownerDocument||e:R;return n!==P&&9===n.nodeType&&n.documentElement&&(D=(P=n).documentElement,A=!b(P),(r=P.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",be,!1):r.attachEvent&&r.attachEvent("onunload",be)),m.attributes=i(function(e){return e.className="i",!e.getAttribute("className")}),m.getElementsByTagName=i(function(e){return e.appendChild(P.createComment("")),!e.getElementsByTagName("*").length}),m.getElementsByClassName=he.test(P.getElementsByClassName),m.getById=i(function(e){return D.appendChild(e).id=N,!P.getElementsByName||!P.getElementsByName(N).length}),m.getById?(_.find.ID=function(e,t){if(void 0!==t.getElementById&&A){var r=t.getElementById(e);return r?[r]:[]}},_.filter.ID=function(e){var t=e.replace(ye,ve);return function(e){return e.getAttribute("id")===t}}):(delete _.find.ID,_.filter.ID=function(e){var r=e.replace(ye,ve);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===r}}),_.find.TAG=m.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):m.qsa?t.querySelectorAll(e):void 0}:function(e,t){var r,n=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;r=o[i++];)1===r.nodeType&&n.push(r);return n},_.find.CLASS=m.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&A)return t.getElementsByClassName(e)},O=[],L=[],(m.qsa=he.test(P.querySelectorAll))&&(i(function(e){D.appendChild(e).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&L.push("[*^$]="+J+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||L.push("\\["+J+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+N+"-]").length||L.push("~="),e.querySelectorAll(":checked").length||L.push(":checked"),e.querySelectorAll("a#"+N+"+*").length||L.push(".#.+[+~]")}),i(function(e){var t=P.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&L.push("name"+J+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||L.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),L.push(",.*:")})),(m.matchesSelector=he.test(q=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&i(function(e){m.disconnectedMatch=q.call(e,"div"),q.call(e,"[s!='']:x"),O.push("!=",re)}),L=L.length&&new RegExp(L.join("|")),O=O.length&&new RegExp(O.join("|")),t=he.test(D.compareDocumentPosition),F=t||he.test(D.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(r.contains?r.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=t?function(e,t){if(e===t)return C=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!m.sortDetached&&t.compareDocumentPosition(e)===r?e===P||e.ownerDocument===R&&F(R,e)?-1:t===P||t.ownerDocument===R&&F(R,t)?1:T?Q(T,e)-Q(T,t):0:4&r?-1:1)}:function(e,t){if(e===t)return C=!0,0;var r,n=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===P?-1:t===P?1:i?-1:o?1:T?Q(T,e)-Q(T,t):0;if(i===o)return c(e,t);for(r=e;r=r.parentNode;)a.unshift(r);for(r=t;r=r.parentNode;)s.unshift(r);for(;a[n]===s[n];)n++;return n?c(a[n],s[n]):a[n]===R?-1:s[n]===R?1:0}),P},x.matches=function(e,t){return x(e,null,null,t)},x.matchesSelector=function(e,t){if((e.ownerDocument||e)!==P&&k(e),t=t.replace(se,"='$1']"),m.matchesSelector&&A&&!z[t+" "]&&(!O||!O.test(t))&&(!L||!L.test(t)))try{var r=q.call(e,t);if(r||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return 0<x(t,P,null,[e]).length},x.contains=function(e,t){return(e.ownerDocument||e)!==P&&k(e),F(e,t)},x.attr=function(e,t){(e.ownerDocument||e)!==P&&k(e);var r=_.attrHandle[t.toLowerCase()],n=r&&H.call(_.attrHandle,t.toLowerCase())?r(e,t,!A):void 0;return void 0!==n?n:m.attributes||!A?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},x.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},x.uniqueSort=function(e){var t,r=[],n=0,i=0;if(C=!m.detectDuplicates,T=!m.sortStable&&e.slice(0),e.sort(G),C){for(;t=e[i++];)t===e[i]&&(n=r.push(i));for(;n--;)e.splice(r[n],1)}return T=null,e},y=x.getText=function(e){var t,r="",n=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=y(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[n++];)r+=y(t);return r},(_=x.selectors={cacheLength:50,createPseudo:l,match:ue,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,ve),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,ve),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||x.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&x.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return ue.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&le.test(r)&&(t=S(r,!0))&&(t=r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,ve).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=V[e+" "];return t||(t=new RegExp("(^|"+J+")"+e+"("+J+"|$)"))&&V(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(r,n,i){return function(e){var t=x.attr(e,r);return null==t?"!="===n:!n||(t+="","="===n?t===i:"!="===n?t!==i:"^="===n?i&&0===t.indexOf(i):"*="===n?i&&-1<t.indexOf(i):"$="===n?i&&t.slice(-i.length)===i:"~="===n?-1<(" "+t.replace(ne," ")+" ").indexOf(i):"|="===n&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(f,e,t,g,m){var y="nth"!==f.slice(0,3),v="last"!==f.slice(-4),b="of-type"===e;return 1===g&&0===m?function(e){return!!e.parentNode}:function(e,t,r){var n,i,o,a,s,l,c=y!==v?"nextSibling":"previousSibling",u=e.parentNode,p=b&&e.nodeName.toLowerCase(),d=!r&&!b,h=!1;if(u){if(y){for(;c;){for(a=e;a=a[c];)if(b?a.nodeName.toLowerCase()===p:1===a.nodeType)return!1;l=c="only"===f&&!l&&"nextSibling"}return!0}if(l=[v?u.firstChild:u.lastChild],v&&d){for(h=(s=(n=(i=(o=(a=u)[N]||(a[N]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]||[])[0]===B&&n[1])&&n[2],a=s&&u.childNodes[s];a=++s&&a&&a[c]||(h=s=0)||l.pop();)if(1===a.nodeType&&++h&&a===e){i[f]=[B,s,h];break}}else if(d&&(h=s=(n=(i=(o=(a=e)[N]||(a[N]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]||[])[0]===B&&n[1]),!1===h)for(;(a=++s&&a&&a[c]||(h=s=0)||l.pop())&&((b?a.nodeName.toLowerCase()!==p:1!==a.nodeType)||!++h||(d&&((i=(o=a[N]||(a[N]={}))[a.uniqueID]||(o[a.uniqueID]={}))[f]=[B,h]),a!==e)););return(h-=m)===g||h%g==0&&0<=h/g}}},PSEUDO:function(e,o){var t,a=_.pseudos[e]||_.setFilters[e.toLowerCase()]||x.error("unsupported pseudo: "+e);return a[N]?a(o):1<a.length?(t=[e,e,"",o],_.setFilters.hasOwnProperty(e.toLowerCase())?l(function(e,t){for(var r,n=a(e,o),i=n.length;i--;)e[r=Q(e,n[i])]=!(t[r]=n[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:l(function(e){var n=[],i=[],s=E(e.replace(ie,"$1"));return s[N]?l(function(e,t,r,n){for(var i,o=s(e,null,n,[]),a=e.length;a--;)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,r){return n[0]=e,s(n,null,r,i),n[0]=null,!i.pop()}}),has:l(function(t){return function(e){return 0<x(t,e).length}}),contains:l(function(t){return t=t.replace(ye,ve),function(e){return-1<(e.textContent||e.innerText||y(e)).indexOf(t)}}),lang:l(function(r){return ce.test(r||"")||x.error("unsupported lang: "+r),r=r.replace(ye,ve).toLowerCase(),function(e){var t;do{if(t=A?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===r||0===t.indexOf(r+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===D},focus:function(e){return e===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return de.test(e.nodeName)},input:function(e){return pe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:a(function(){return[0]}),last:a(function(e,t){return[t-1]}),eq:a(function(e,t,r){return[r<0?r+t:r]}),even:a(function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:a(function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:a(function(e,t,r){for(var n=r<0?r+t:r;0<=--n;)e.push(n);return e}),gt:a(function(e,t,r){for(var n=r<0?r+t:r;++n<t;)e.push(n);return e})}}).pseudos.nth=_.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[u]=n(u);for(u in{submit:!0,reset:!0})_.pseudos[u]=o(u);return s.prototype=_.filters=_.pseudos,_.setFilters=new s,S=x.tokenize=function(e,t){var r,n,i,o,a,s,l,c=U[e+" "];if(c)return t?0:c.slice(0);for(a=e,s=[],l=_.preFilter;a;){for(o in r&&!(n=oe.exec(a))||(n&&(a=a.slice(n[0].length)||a),s.push(i=[])),r=!1,(n=ae.exec(a))&&(r=n.shift(),i.push({value:r,type:n[0].replace(ie," ")}),a=a.slice(r.length)),_.filter)!(n=ue[o].exec(a))||l[o]&&!(n=l[o](n))||(r=n.shift(),i.push({value:r,type:o,matches:n}),a=a.slice(r.length));if(!r)break}return t?a.length:a?x.error(e):U(e,s).slice(0)},E=x.compile=function(e,t){var r,m,y,v,b,n,i=[],o=[],a=z[e+" "];if(!a){for(t||(t=S(e)),r=t.length;r--;)(a=h(t[r]))[N]?i.push(a):o.push(a);(a=z(e,(m=o,v=0<(y=i).length,b=0<m.length,n=function(e,t,r,n,i){var o,a,s,l=0,c="0",u=e&&[],p=[],d=I,h=e||b&&_.find.TAG("*",i),f=B+=null==d?1:Math.random()||.1,g=h.length;for(i&&(I=t===P||t||i);c!==g&&null!=(o=h[c]);c++){if(b&&o){for(a=0,t||o.ownerDocument===P||(k(o),r=!A);s=m[a++];)if(s(o,t||P,r)){n.push(o);break}i&&(B=f)}v&&((o=!s&&o)&&l--,e&&u.push(o))}if(l+=c,v&&c!==l){for(a=0;s=y[a++];)s(u,p,t,r);if(e){if(0<l)for(;c--;)u[c]||p[c]||(p[c]=K.call(n));p=w(p)}X.apply(n,p),i&&!e&&0<p.length&&1<l+y.length&&x.uniqueSort(n)}return i&&(B=f,I=d),u},v?l(n):n))).selector=e}return a},M=x.select=function(e,t,r,n){var i,o,a,s,l,c="function"==typeof e&&e,u=!n&&S(e=c.selector||e);if(r=r||[],1===u.length){if(2<(o=u[0]=u[0].slice(0)).length&&"ID"===(a=o[0]).type&&m.getById&&9===t.nodeType&&A&&_.relative[o[1].type]){if(!(t=(_.find.ID(a.matches[0].replace(ye,ve),t)||[])[0]))return r;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=ue.needsContext.test(e)?0:o.length;i--&&(a=o[i],!_.relative[s=a.type]);)if((l=_.find[s])&&(n=l(a.matches[0].replace(ye,ve),ge.test(o[0].type)&&f(t.parentNode)||t))){if(o.splice(i,1),!(e=n.length&&g(o)))return X.apply(r,n),r;break}}return(c||E(e,u))(n,t,!A,r,!t||ge.test(e)&&f(t.parentNode)||t),r},m.sortStable=N.split("").sort(G).join("")===N,m.detectDuplicates=!!C,k(),m.sortDetached=i(function(e){return 1&e.compareDocumentPosition(P.createElement("div"))}),i(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||t("type|href|height|width",function(e,t,r){if(!r)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),m.attributes&&i(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||t("value",function(e,t,r){if(!r&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),i(function(e){return null==e.getAttribute("disabled")})||t(Z,function(e,t,r){var n;if(!r)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),x}(S);Z.find=ne,Z.expr=ne.selectors,Z.expr[":"]=Z.expr.pseudos,Z.uniqueSort=Z.unique=ne.uniqueSort,Z.text=ne.getText,Z.isXMLDoc=ne.isXML,Z.contains=ne.contains;var ie=function(e,t,r){for(var n=[],i=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&Z(e).is(r))break;n.push(e)}return n},oe=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},ae=Z.expr.match.needsContext,se=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,le=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,r){var n=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Z.find.matchesSelector(n,e)?[n]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,r=this.length,n=[],i=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;t<r;t++)if(Z.contains(i[t],this))return!0}));for(t=0;t<r;t++)Z.find(e,i[t],n);return(n=this.pushStack(1<r?Z.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(t(this,e||[],!1))},not:function(e){return this.pushStack(t(this,e||[],!0))},is:function(e){return!!t(this,"string"==typeof e&&ae.test(e)?Z(e):e||[],!1).length}});var ce,ue=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(Z.fn.init=function(e,t,r){var n,i;if(!e)return this;if(r=r||ce,"string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?void 0!==r.ready?r.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this));if(!(n="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:ue.exec(e))||!n[1]&&t)return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:z,!0)),se.test(n[1])&&Z.isPlainObject(t))for(n in t)Z.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(i=z.getElementById(n[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=z,this.selector=e,this}).prototype=Z.fn,ce=Z(z);var pe=/^(?:parents|prev(?:Until|All))/,de={children:!0,contents:!0,next:!0,prev:!0};Z.fn.extend({has:function(e){var t=Z(e,this),r=t.length;return this.filter(function(){for(var e=0;e<r;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var r,n=0,i=this.length,o=[],a=ae.test(e)||"string"!=typeof e?Z(e,t||this.context):0;n<i;n++)for(r=this[n];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(a?-1<a.index(r):1===r.nodeType&&Z.find.matchesSelector(r,e))){o.push(r);break}return this.pushStack(1<o.length?Z.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?K.call(Z(e),this[0]):K.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.uniqueSort(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ie(e,"parentNode")},parentsUntil:function(e,t,r){return ie(e,"parentNode",r)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return ie(e,"nextSibling")},prevAll:function(e){return ie(e,"previousSibling")},nextUntil:function(e,t,r){return ie(e,"nextSibling",r)},prevUntil:function(e,t,r){return ie(e,"previousSibling",r)},siblings:function(e){return oe((e.parentNode||{}).firstChild,e)},children:function(e){return oe(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(n,i){Z.fn[n]=function(e,t){var r=Z.map(this,i,e);return"Until"!==n.slice(-5)&&(t=e),t&&"string"==typeof t&&(r=Z.filter(t,r)),1<this.length&&(de[n]||Z.uniqueSort(r),pe.test(n)&&r.reverse()),this.pushStack(r)}});var he,fe=/\S+/g;Z.Callbacks=function(n){var e,r;n="string"==typeof n?(e=n,r={},Z.each(e.match(fe)||[],function(e,t){r[t]=!0}),r):Z.extend({},n);var i,t,o,a,s=[],l=[],c=-1,u=function(){for(a=n.once,o=i=!0;l.length;c=-1)for(t=l.shift();++c<s.length;)!1===s[c].apply(t[0],t[1])&&n.stopOnFalse&&(c=s.length,t=!1);n.memory||(t=!1),i=!1,a&&(s=t?[]:"")},p={add:function(){return s&&(t&&!i&&(c=s.length-1,l.push(t)),function r(e){Z.each(e,function(e,t){Z.isFunction(t)?n.unique&&p.has(t)||s.push(t):t&&t.length&&"string"!==Z.type(t)&&r(t)})}(arguments),t&&!i&&u()),this},remove:function(){return Z.each(arguments,function(e,t){for(var r;-1<(r=Z.inArray(t,s,r));)s.splice(r,1),r<=c&&c--}),this},has:function(e){return e?-1<Z.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=l=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=l=[],t||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],l.push(t),i||u()),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!o}};return p},Z.extend({Deferred:function(e){var o=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var i=arguments;return Z.Deferred(function(n){Z.each(o,function(e,t){var r=Z.isFunction(i[e])&&i[e];s[t[1]](function(){var e=r&&r.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[t[0]+"With"](this===a?n.promise():this,r?[e]:arguments)})}),i=null}).promise()},promise:function(e){return null!=e?Z.extend(e,a):a}},s={};return a.pipe=a.then,Z.each(o,function(e,t){var r=t[2],n=t[3];a[t[1]]=r.add,n&&r.add(function(){i=n},o[1^e][2].disable,o[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=r.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var i,t,r,n=0,o=G.call(arguments),a=o.length,s=1!==a||e&&Z.isFunction(e.promise)?a:0,l=1===s?e:Z.Deferred(),c=function(t,r,n){return function(e){r[t]=this,n[t]=1<arguments.length?G.call(arguments):e,n===i?l.notifyWith(r,n):--s||l.resolveWith(r,n)}};if(1<a)for(i=new Array(a),t=new Array(a),r=new Array(a);n<a;n++)o[n]&&Z.isFunction(o[n].promise)?o[n].promise().progress(c(n,t,i)).done(c(n,r,o)).fail(l.reject):--s;return s||l.resolveWith(r,o),l.promise()}}),Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(!0===e?--Z.readyWait:Z.isReady)||((Z.isReady=!0)!==e&&0<--Z.readyWait||(he.resolveWith(z,[Z]),Z.fn.triggerHandler&&(Z(z).triggerHandler("ready"),Z(z).off("ready"))))}}),Z.ready.promise=function(e){return he||(he=Z.Deferred(),"complete"===z.readyState||"loading"!==z.readyState&&!z.documentElement.doScroll?S.setTimeout(Z.ready):(z.addEventListener("DOMContentLoaded",n),S.addEventListener("load",n))),he.promise(e)},Z.ready.promise();var ge=function(e,t,r,n,i,o,a){var s=0,l=e.length,c=null==r;if("object"===Z.type(r))for(s in i=!0,r)ge(e,t,s,r[s],!0,o,a);else if(void 0!==n&&(i=!0,Z.isFunction(n)||(a=!0),c&&(t=a?(t.call(e,n),null):(c=t,function(e,t,r){return c.call(Z(e),r)})),t))for(;s<l;s++)t(e[s],r,a?n:n.call(e[s],s,t(e[s],r)));return i?e:c?t.call(e):l?t(e[0],r):o},me=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};i.uid=1,i.prototype={register:function(e,t){var r=t||{};return e.nodeType?e[this.expando]=r:Object.defineProperty(e,this.expando,{value:r,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!me(e))return{};var t=e[this.expando];return t||(t={},me(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,i=this.cache(e);if("string"==typeof t)i[t]=r;else for(n in t)i[n]=t[n];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,r){var n;return void 0===t||t&&"string"==typeof t&&void 0===r?void 0!==(n=this.get(e,t))?n:this.get(e,Z.camelCase(t)):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,n,i,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{r=(n=Z.isArray(t)?t.concat(t.map(Z.camelCase)):(i=Z.camelCase(t),t in o?[t,i]:(n=i)in o?[n]:n.match(fe)||[])).length;for(;r--;)delete o[n[r]]}(void 0===t||Z.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!Z.isEmptyObject(t)}};var ye=new i,ve=new i,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xe=/[A-Z]/g;Z.extend({hasData:function(e){return ve.hasData(e)||ye.hasData(e)},data:function(e,t,r){return ve.access(e,t,r)},removeData:function(e,t){ve.remove(e,t)},_data:function(e,t,r){return ye.access(e,t,r)},_removeData:function(e,t){ye.remove(e,t)}}),Z.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){ve.set(this,n)}):ge(this,function(t){var e,r;if(o&&void 0===t){if(void 0!==(e=ve.get(o,n)||ve.get(o,n.replace(xe,"-$&").toLowerCase())))return e;if(r=Z.camelCase(n),void 0!==(e=ve.get(o,r)))return e;if(void 0!==(e=l(o,r,void 0)))return e}else r=Z.camelCase(n),this.each(function(){var e=ve.get(this,r);ve.set(this,r,t),-1<n.indexOf("-")&&void 0!==e&&ve.set(this,n,t)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=ve.get(o),1===o.nodeType&&!ye.get(o,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(0===(r=a[t].name).indexOf("data-")&&(r=Z.camelCase(r.slice(5)),l(o,r,i[r])));ye.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){ve.remove(this,e)})}}),Z.extend({queue:function(e,t,r){var n;if(e)return t=(t||"fx")+"queue",n=ye.get(e,t),r&&(!n||Z.isArray(r)?n=ye.access(e,t,Z.makeArray(r)):n.push(r)),n||[]},dequeue:function(e,t){t=t||"fx";var r=Z.queue(e,t),n=r.length,i=r.shift(),o=Z._queueHooks(e,t);"inprogress"===i&&(i=r.shift(),n--),i&&("fx"===t&&r.unshift("inprogress"),delete o.stop,i.call(e,function(){Z.dequeue(e,t)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return ye.get(e,r)||ye.access(e,r,{empty:Z.Callbacks("once memory").add(function(){ye.remove(e,[t+"queue",r])})})}}),Z.fn.extend({queue:function(t,r){var e=2;return"string"!=typeof t&&(r=t,t="fx",e--),arguments.length<e?Z.queue(this[0],t):void 0===r?this:this.each(function(){var e=Z.queue(this,t,r);Z._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&Z.dequeue(this,t)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,n=1,i=Z.Deferred(),o=this,a=this.length,s=function(){--n||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(r=ye.get(o[a],e+"queueHooks"))&&r.empty&&(n++,r.empty.add(s));return s(),i.promise(t)}});var we=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_e=new RegExp("^(?:([+-])=|)("+we+")([a-z%]*)$","i"),Se=["Top","Right","Bottom","Left"],Ee=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Me=/^(?:checkbox|radio)$/i,Ie=/<([\w:-]+)/,Te=/^$|\/(?:java|ecma)script/i,Ce={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ce.optgroup=Ce.option,Ce.tbody=Ce.tfoot=Ce.colgroup=Ce.caption=Ce.thead,Ce.th=Ce.td;var ke,Pe,De=/<|&#?\w+;/;ke=z.createDocumentFragment().appendChild(z.createElement("div")),(Pe=z.createElement("input")).setAttribute("type","radio"),Pe.setAttribute("checked","checked"),Pe.setAttribute("name","t"),ke.appendChild(Pe),Q.checkClone=ke.cloneNode(!0).cloneNode(!0).lastChild.checked,ke.innerHTML="<textarea>x</textarea>",Q.noCloneChecked=!!ke.cloneNode(!0).lastChild.defaultValue;var Ae=/^key/,Le=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oe=/^([^.]*)(?:\.(.+)|)/;Z.event={global:{},add:function(t,e,r,n,i){var o,a,s,l,c,u,p,d,h,f,g,m=ye.get(t);if(m)for(r.handler&&(r=(o=r).handler,i=o.selector),r.guid||(r.guid=Z.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(e){return void 0!==Z&&Z.event.triggered!==e.type?Z.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(fe)||[""]).length;c--;)h=g=(s=Oe.exec(e[c])||[])[1],f=(s[2]||"").split(".").sort(),h&&(p=Z.event.special[h]||{},h=(i?p.delegateType:p.bindType)||h,p=Z.event.special[h]||{},u=Z.extend({type:h,origType:g,data:n,handler:r,guid:r.guid,selector:i,needsContext:i&&Z.expr.match.needsContext.test(i),namespace:f.join(".")},o),(d=l[h])||((d=l[h]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(t,n,f,a)||t.addEventListener&&t.addEventListener(h,a)),p.add&&(p.add.call(t,u),u.handler.guid||(u.handler.guid=r.guid)),i?d.splice(d.delegateCount++,0,u):d.push(u),Z.event.global[h]=!0)},remove:function(e,t,r,n,i){var o,a,s,l,c,u,p,d,h,f,g,m=ye.hasData(e)&&ye.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(fe)||[""]).length;c--;)if(h=g=(s=Oe.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),h){for(p=Z.event.special[h]||{},d=l[h=(n?p.delegateType:p.bindType)||h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)u=d[o],!i&&g!==u.origType||r&&r.guid!==u.guid||s&&!s.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,p.remove&&p.remove.call(e,u));a&&!d.length&&(p.teardown&&!1!==p.teardown.call(e,f,m.handle)||Z.removeEvent(e,h,m.handle),delete l[h])}else for(h in l)Z.event.remove(e,h+t[c],r,n,!0);Z.isEmptyObject(l)&&ye.remove(e,"handle events")}},dispatch:function(e){e=Z.event.fix(e);var t,r,n,i,o,a=[],s=G.call(arguments),l=(ye.get(this,"events")||{})[e.type]||[],c=Z.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=Z.event.handlers.call(this,e,l),t=0;(i=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,r=0;(o=i.handlers[r++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(n=((Z.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var r,n,i,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(n=[],r=0;r<s;r++)void 0===n[i=(o=t[r]).selector+" "]&&(n[i]=o.needsContext?-1<Z(i,this).index(l):Z.find(i,this,null,[l]).length),n[i]&&n.push(o);n.length&&a.push({elem:l,handlers:n})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var r,n,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=(r=e.target.ownerDocument||z).documentElement,i=r.body,e.pageX=t.clientX+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,r,n,i=e.type,o=e,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=Le.test(i)?this.mouseHooks:Ae.test(i)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new Z.Event(o),t=n.length;t--;)e[r=n[t]]=o[r];return e.target||(e.target=z),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==a()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===a()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&Z.nodeName(this,"input"))return this.click(),!1},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},Z.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?o:u):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={constructor:Z.Event,isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=o,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=o,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=o,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){Z.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,r=e.relatedTarget,n=e.handleObj;return r&&(r===this||Z.contains(this,r))||(e.type=n.origType,t=n.handler.apply(this,arguments),e.type=i),t}}}),Z.fn.extend({on:function(e,t,r,n){return p(this,e,t,r,n)},one:function(e,t,r,n){return p(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Z(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=u),this.each(function(){Z.event.remove(this,e,r,t)});for(i in e)this.off(i,t,e[i]);return this}});var qe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Fe=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Re=/^true\/(.*)/,Be=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Z.extend({htmlPrefilter:function(e){return e.replace(qe,"<$1></$2>")},clone:function(e,t,r){var n,i,o,a,s,l,c,u=e.cloneNode(!0),p=Z.contains(e.ownerDocument,e);if(!(Q.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(a=g(u),n=0,i=(o=g(e)).length;n<i;n++)s=o[n],l=a[n],void 0,"input"===(c=l.nodeName.toLowerCase())&&Me.test(s.type)?l.checked=s.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=s.defaultValue);if(t)if(r)for(o=o||g(e),a=a||g(u),n=0,i=o.length;n<i;n++)h(o[n],a[n]);else h(e,u);return 0<(a=g(u,"script")).length&&m(a,!p&&g(e,"script")),u},cleanData:function(e){for(var t,r,n,i=Z.event.special,o=0;void 0!==(r=e[o]);o++)if(me(r)){if(t=r[ye.expando]){if(t.events)for(n in t.events)i[n]?Z.event.remove(r,n):Z.removeEvent(r,n,t.handle);r[ye.expando]=void 0}r[ve.expando]&&(r[ve.expando]=void 0)}}}),Z.fn.extend({domManip:x,detach:function(e){return f(this,e,!0)},remove:function(e){return f(this,e)},text:function(e){return ge(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return x(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||d(this,e).appendChild(e)})},prepend:function(){return x(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return ge(this,function(e){var t=this[0]||{},r=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Fe.test(e)&&!Ce[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=Z.htmlPrefilter(e);try{for(;r<n;r++)1===(t=this[r]||{}).nodeType&&(Z.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var r=[];return x(this,arguments,function(e){var t=this.parentNode;Z.inArray(this,r)<0&&(Z.cleanData(g(this)),t&&t.replaceChild(e,this))},r)}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){Z.fn[e]=function(e){for(var t,r=[],n=Z(e),i=n.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),Z(n[o])[a](t),W.apply(r,t.get());return this.pushStack(r)}});var je,Ve={HTML:"block",BODY:"block"},Ue=/^margin/,ze=new RegExp("^("+we+")(?!px)[a-z%]+$","i"),Ge=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=S),t.getComputedStyle(e)},He=function(e,t,r,n){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in i=r.apply(e,n||[]),t)e.style[o]=a[o];return i},We=z.documentElement;!function(){function e(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",We.appendChild(o);var e=S.getComputedStyle(a);t="1%"!==e.top,i="2px"===e.marginLeft,r="4px"===e.width,a.style.marginRight="50%",n="4px"===e.marginRight,We.removeChild(o)}var t,r,n,i,o=z.createElement("div"),a=z.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",o.appendChild(a),Z.extend(Q,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return null==r&&e(),r},pixelMarginRight:function(){return null==r&&e(),n},reliableMarginLeft:function(){return null==r&&e(),i},reliableMarginRight:function(){var e,t=a.appendChild(z.createElement("div"));return t.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",a.style.width="1px",We.appendChild(o),e=!parseFloat(S.getComputedStyle(t).marginRight),We.removeChild(o),a.removeChild(t),e}}))}();var Ke=/^(none|table(?!-c[ea]).+)/,Ye={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:"0",fontWeight:"400"},$e=["Webkit","O","Moz","ms"],Qe=z.createElement("div").style;Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=E(e,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=Z.camelCase(t),l=e.style;return t=Z.cssProps[s]||(Z.cssProps[s]=I(s)||s),a=Z.cssHooks[t]||Z.cssHooks[s],void 0===r?a&&"get"in a&&void 0!==(i=a.get(e,!1,n))?i:l[t]:("string"===(o=typeof r)&&(i=_e.exec(r))&&i[1]&&(r=c(e,t,i),o="number"),void(null!=r&&r==r&&("number"===o&&(r+=i&&i[3]||(Z.cssNumber[s]?"":"px")),Q.clearCloneStyle||""!==r||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(r=a.set(e,r,n))||(l[t]=r))))}},css:function(e,t,r,n){var i,o,a,s=Z.camelCase(t);return t=Z.cssProps[s]||(Z.cssProps[s]=I(s)||s),(a=Z.cssHooks[t]||Z.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,r)),void 0===i&&(i=E(e,t,n)),"normal"===i&&t in Xe&&(i=Xe[t]),""===r||r?(o=parseFloat(i),!0===r||isFinite(o)?o||0:i):i}}),Z.each(["height","width"],function(e,a){Z.cssHooks[a]={get:function(e,t,r){if(t)return Ke.test(Z.css(e,"display"))&&0===e.offsetWidth?He(e,Ye,function(){return k(e,a,r)}):k(e,a,r)},set:function(e,t,r){var n,i=r&&Ge(e),o=r&&C(e,a,r,"border-box"===Z.css(e,"boxSizing",!1,i),i);return o&&(n=_e.exec(t))&&"px"!==(n[3]||"px")&&(e.style[a]=t,t=Z.css(e,a)),T(0,t,o)}}}),Z.cssHooks.marginLeft=M(Q.reliableMarginLeft,function(e,t){if(t)return(parseFloat(E(e,"marginLeft"))||e.getBoundingClientRect().left-He(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),Z.cssHooks.marginRight=M(Q.reliableMarginRight,function(e,t){if(t)return He(e,{display:"inline-block"},E,[e,"marginRight"])}),Z.each({margin:"",padding:"",border:"Width"},function(i,o){Z.cssHooks[i+o]={expand:function(e){for(var t=0,r={},n="string"==typeof e?e.split(" "):[e];t<4;t++)r[i+Se[t]+o]=n[t]||n[t-2]||n[0];return r}},Ue.test(i)||(Z.cssHooks[i+o].set=T)}),Z.fn.extend({css:function(e,t){return ge(this,function(e,t,r){var n,i,o={},a=0;if(Z.isArray(t)){for(n=Ge(e),i=t.length;a<i;a++)o[t[a]]=Z.css(e,t[a],!1,n);return o}return void 0!==r?Z.style(e,t,r):Z.css(e,t)},e,t,1<arguments.length)},show:function(){return P(this,!0)},hide:function(){return P(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ee(this)?Z(this).show():Z(this).hide()})}}),((Z.Tween=D).prototype={constructor:D,init:function(e,t,r,n,i,o){this.elem=e,this.prop=r,this.easing=i||Z.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Z.cssNumber[r]?"":"px")},cur:function(){var e=D.propHooks[this.prop];return e&&e.get?e.get(this):D.propHooks._default.get(this)},run:function(e){var t,r=D.propHooks[this.prop];return this.options.duration?this.pos=t=Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):D.propHooks._default.set(this),this}}).init.prototype=D.prototype,(D.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=Z.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[Z.cssProps[e.prop]]&&!Z.cssHooks[e.prop]?e.elem[e.prop]=e.now:Z.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=D.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},Z.fx=D.prototype.init,Z.fx.step={};var Ze,Je,et,tt,rt,nt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;Z.Animation=Z.extend(q,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return c(r.elem,e,_e.exec(t),r),r}]},tweener:function(e,t){for(var r,n=0,i=(e=Z.isFunction(e)?(t=e,["*"]):e.match(fe)).length;n<i;n++)r=e[n],q.tweeners[r]=q.tweeners[r]||[],q.tweeners[r].unshift(t)},prefilters:[function(t,e,r){var n,i,o,a,s,l,c,u=this,p={},d=t.style,h=t.nodeType&&Ee(t),f=ye.get(t,"fxshow");for(n in r.queue||(null==(s=Z._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,Z.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(r.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(c=Z.css(t,"display"))?ye.get(t,"olddisplay")||_(t.nodeName):c)&&"none"===Z.css(t,"float")&&(d.display="inline-block")),r.overflow&&(d.overflow="hidden",u.always(function(){d.overflow=r.overflow[0],d.overflowX=r.overflow[1],d.overflowY=r.overflow[2]})),e)if(i=e[n],nt.exec(i)){if(delete e[n],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!f||void 0===f[n])continue;h=!0}p[n]=f&&f[n]||Z.style(t,n)}else c=void 0;if(Z.isEmptyObject(p))"inline"===("none"===c?_(t.nodeName):c)&&(d.display=c);else for(n in f?"hidden"in f&&(h=f.hidden):f=ye.access(t,"fxshow",{}),o&&(f.hidden=!h),h?Z(t).show():u.done(function(){Z(t).hide()}),u.done(function(){var e;for(e in ye.remove(t,"fxshow"),p)Z.style(t,e,p[e])}),p)a=O(h?f[n]:0,n,u),n in f||(f[n]=a.start,h&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}],prefilter:function(e,t){t?q.prefilters.unshift(e):q.prefilters.push(e)}}),Z.speed=function(e,t,r){var n=e&&"object"==typeof e?Z.extend({},e):{complete:r||!r&&t||Z.isFunction(e)&&e,duration:e,easing:r&&t||t&&!Z.isFunction(t)&&t};return n.duration=Z.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Z.fx.speeds?Z.fx.speeds[n.duration]:Z.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){Z.isFunction(n.old)&&n.old.call(this),n.queue&&Z.dequeue(this,n.queue)},n},Z.fn.extend({fadeTo:function(e,t,r,n){return this.filter(Ee).css("opacity",0).show().end().animate({opacity:t},e,r,n)},animate:function(t,e,r,n){var i=Z.isEmptyObject(t),o=Z.speed(e,r,n),a=function(){var e=q(this,Z.extend({},t),o);(i||ye.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",r=Z.timers,n=ye.get(this);if(t)n[t]&&n[t].stop&&a(n[t]);else for(t in n)n[t]&&n[t].stop&&it.test(t)&&a(n[t]);for(t=r.length;t--;)r[t].elem!==this||null!=i&&r[t].queue!==i||(r[t].anim.stop(o),e=!1,r.splice(t,1));!e&&o||Z.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=ye.get(this),r=t[a+"queue"],n=t[a+"queueHooks"],i=Z.timers,o=r?r.length:0;for(t.finish=!0,Z.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete t.finish})}}),Z.each(["toggle","show","hide"],function(e,n){var i=Z.fn[n];Z.fn[n]=function(e,t,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(L(n,!0),e,t,r)}}),Z.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){Z.fn[e]=function(e,t,r){return this.animate(n,e,t,r)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,r=Z.timers;for(Ze=Z.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||Z.fx.stop(),Ze=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Je||(Je=S.setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){S.clearInterval(Je),Je=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(n,e){return n=Z.fx&&Z.fx.speeds[n]||n,e=e||"fx",this.queue(e,function(e,t){var r=S.setTimeout(e,n);t.stop=function(){S.clearTimeout(r)}})},et=z.createElement("input"),tt=z.createElement("select"),rt=tt.appendChild(z.createElement("option")),et.type="checkbox",Q.checkOn=""!==et.value,Q.optSelected=rt.selected,tt.disabled=!0,Q.optDisabled=!rt.disabled,(et=z.createElement("input")).value="t",et.type="radio",Q.radioValue="t"===et.value;var ot,at=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return ge(this,Z.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,r){var n,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?Z.prop(e,t,r):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),i=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?ot:void 0)),void 0!==r?null===r?void Z.removeAttr(e,t):i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:(e.setAttribute(t,r+""),r):i&&"get"in i&&null!==(n=i.get(e,t))?n:null==(n=Z.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!Q.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var r=e.value;return e.setAttribute("type",t),r&&(e.value=r),t}}}},removeAttr:function(e,t){var r,n,i=0,o=t&&t.match(fe);if(o&&1===e.nodeType)for(;r=o[i++];)n=Z.propFix[r]||r,Z.expr.match.bool.test(r)&&(e[n]=!1),e.removeAttribute(r)}}),ot={set:function(e,t,r){return!1===t?Z.removeAttr(e,r):e.setAttribute(r,r),r}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var o=at[t]||Z.find.attr;at[t]=function(e,t,r){var n,i;return r||(i=at[t],at[t]=n,n=null!=o(e,t,r)?t.toLowerCase():null,at[t]=i),n}});var st=/^(?:input|select|textarea|button)$/i,lt=/^(?:a|area)$/i;Z.fn.extend({prop:function(e,t){return ge(this,Z.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({prop:function(e,t,r){var n,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Z.isXMLDoc(e)||(t=Z.propFix[t]||t,i=Z.propHooks[t]),void 0!==r?i&&"set"in i&&void 0!==(n=i.set(e,r,t))?n:e[t]=r:i&&"get"in i&&null!==(n=i.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=Z.find.attr(e,"tabindex");return t?parseInt(t,10):st.test(e.nodeName)||lt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),Q.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var ct=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(t){var e,r,n,i,o,a,s,l=0;if(Z.isFunction(t))return this.each(function(e){Z(this).addClass(t.call(this,e,F(this)))});if("string"==typeof t&&t)for(e=t.match(fe)||[];r=this[l++];)if(i=F(r),n=1===r.nodeType&&(" "+i+" ").replace(ct," ")){for(a=0;o=e[a++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");i!==(s=Z.trim(n))&&r.setAttribute("class",s)}return this},removeClass:function(t){var e,r,n,i,o,a,s,l=0;if(Z.isFunction(t))return this.each(function(e){Z(this).removeClass(t.call(this,e,F(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(fe)||[];r=this[l++];)if(i=F(r),n=1===r.nodeType&&(" "+i+" ").replace(ct," ")){for(a=0;o=e[a++];)for(;-1<n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");i!==(s=Z.trim(n))&&r.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i;return"boolean"==typeof t&&"string"===o?t?this.addClass(i):this.removeClass(i):Z.isFunction(i)?this.each(function(e){Z(this).toggleClass(i.call(this,e,F(this),t),t)}):this.each(function(){var e,t,r,n;if("string"===o)for(t=0,r=Z(this),n=i.match(fe)||[];e=n[t++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==i&&"boolean"!==o||((e=F(this))&&ye.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":ye.get(this,"__className__")||""))})},hasClass:function(e){var t,r,n=0;for(t=" "+e+" ";r=this[n++];)if(1===r.nodeType&&-1<(" "+F(r)+" ").replace(ct," ").indexOf(t))return!0;return!1}});var ut=/\r/g,pt=/[\x20\t\r\n\f]+/g;Z.fn.extend({val:function(r){var n,e,i,t=this[0];return arguments.length?(i=Z.isFunction(r),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?r.call(this,e,Z(this).val()):r)?t="":"number"==typeof t?t+="":Z.isArray(t)&&(t=Z.map(t,function(e){return null==e?"":e+""})),(n=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,t,"value")||(this.value=t))})):t?(n=Z.valHooks[t.type]||Z.valHooks[t.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(ut,""):null==e?"":e:void 0}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e)).replace(pt," ")}},select:{get:function(e){for(var t,r,n=e.options,i=e.selectedIndex,o="select-one"===e.type||i<0,a=o?null:[],s=o?i+1:n.length,l=i<0?s:o?i:0;l<s;l++)if(((r=n[l]).selected||l===i)&&(Q.optDisabled?!r.disabled:null===r.getAttribute("disabled"))&&(!r.parentNode.disabled||!Z.nodeName(r.parentNode,"optgroup"))){if(t=Z(r).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var r,n,i=e.options,o=Z.makeArray(t),a=i.length;a--;)((n=i[a]).selected=-1<Z.inArray(Z.valHooks.option.get(n),o))&&(r=!0);return r||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){if(Z.isArray(t))return e.checked=-1<Z.inArray(Z(e).val(),t)}},Q.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var dt=/^(?:focusinfocus|focusoutblur)$/;Z.extend(Z.event,{trigger:function(e,t,r,n){var i,o,a,s,l,c,u,p=[r||z],d=$.call(e,"type")?e.type:e,h=$.call(e,"namespace")?e.namespace.split("."):[];if(o=a=r=r||z,3!==r.nodeType&&8!==r.nodeType&&!dt.test(d+Z.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),l=d.indexOf(":")<0&&"on"+d,(e=e[Z.expando]?e:new Z.Event(d,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:Z.makeArray(t,[e]),u=Z.event.special[d]||{},n||!u.trigger||!1!==u.trigger.apply(r,t))){if(!n&&!u.noBubble&&!Z.isWindow(r)){for(s=u.delegateType||d,dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(r.ownerDocument||z)&&p.push(a.defaultView||a.parentWindow||S)}for(i=0;(o=p[i++])&&!e.isPropagationStopped();)e.type=1<i?s:u.bindType||d,(c=(ye.get(o,"events")||{})[e.type]&&ye.get(o,"handle"))&&c.apply(o,t),(c=l&&o[l])&&c.apply&&me(o)&&(e.result=c.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,n||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(p.pop(),t)||!me(r)||l&&Z.isFunction(r[d])&&!Z.isWindow(r)&&((a=r[l])&&(r[l]=null),r[Z.event.triggered=d](),Z.event.triggered=void 0,a&&(r[l]=a)),e.result}},simulate:function(e,t,r){var n=Z.extend(new Z.Event,r,{type:e,isSimulated:!0});Z.event.trigger(n,null,t)}}),Z.fn.extend({trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return Z.event.trigger(e,t,r,!0)}}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,r){Z.fn[r]=function(e,t){return 0<arguments.length?this.on(r,null,e,t):this.trigger(r)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Q.focusin="onfocusin"in S,Q.focusin||Z.each({focus:"focusin",blur:"focusout"},function(r,n){var i=function(e){Z.event.simulate(n,e.target,Z.event.fix(e))};Z.event.special[n]={setup:function(){var e=this.ownerDocument||this,t=ye.access(e,n);t||e.addEventListener(r,i,!0),ye.access(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=ye.access(e,n)-1;t?ye.access(e,n,t):(e.removeEventListener(r,i,!0),ye.remove(e,n))}}});var ht=S.location,ft=Z.now(),gt=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new S.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||Z.error("Invalid XML: "+e),t};var mt=/#.*$/,yt=/([?&])_=[^&]*/,vt=/^(.*?):[ \t]*([^\r\n]*)$/gm,bt=/^(?:GET|HEAD)$/,xt=/^\/\//,wt={},_t={},St="*/".concat("*"),Et=z.createElement("a");Et.href=ht.href,Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ht.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ht.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":St,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?B(B(e,Z.ajaxSettings),t):B(Z.ajaxSettings,e)},ajaxPrefilter:N(wt),ajaxTransport:N(_t),ajax:function(e,t){function r(e,t,r,n){var i,o,a,s,l,c=t;2!==w&&(w=2,h&&S.clearTimeout(h),u=void 0,d=n||"",_.readyState=0<e?4:0,i=200<=e&&e<300||304===e,r&&(s=function(e,t,r){for(var n,i,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(i in s)if(s[i]&&s[i].test(n)){l.unshift(i);break}if(l[0]in r)o=l[0];else{for(i in r){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),r[o]}(g,_,r)),s=function(e,t,r,n){var i,o,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(r[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(i in c)if((s=i.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[i]:!0!==c[i]&&(o=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(g,s,_,i),i?(g.ifModified&&((l=_.getResponseHeader("Last-Modified"))&&(Z.lastModified[p]=l),(l=_.getResponseHeader("etag"))&&(Z.etag[p]=l)),204===e||"HEAD"===g.type?c="nocontent":304===e?c="notmodified":(c=s.state,o=s.data,i=!(a=s.error))):(a=c,!e&&c||(c="error",e<0&&(e=0))),_.status=e,_.statusText=(t||c)+"",i?v.resolveWith(m,[o,c,_]):v.rejectWith(m,[_,c,a]),_.statusCode(x),x=void 0,f&&y.trigger(i?"ajaxSuccess":"ajaxError",[_,g,i?o:a]),b.fireWith(m,[_,c]),f&&(y.trigger("ajaxComplete",[_,g]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var u,p,d,n,h,i,f,o,g=Z.ajaxSetup({},t),m=g.context||g,y=g.context&&(m.nodeType||m.jquery)?Z(m):Z.event,v=Z.Deferred(),b=Z.Callbacks("once memory"),x=g.statusCode||{},a={},s={},w=0,l="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!n)for(n={};t=vt.exec(d);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?d:null},setRequestHeader:function(e,t){var r=e.toLowerCase();return w||(e=s[r]=s[r]||e,a[e]=t),this},overrideMimeType:function(e){return w||(g.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)x[t]=[x[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||l;return u&&u.abort(t),r(0,t),this}};if(v.promise(_).complete=b.add,_.success=_.done,_.error=_.fail,g.url=((e||g.url||ht.href)+"").replace(mt,"").replace(xt,ht.protocol+"//"),g.type=t.method||t.type||g.method||g.type,g.dataTypes=Z.trim(g.dataType||"*").toLowerCase().match(fe)||[""],null==g.crossDomain){i=z.createElement("a");try{i.href=g.url,i.href=i.href,g.crossDomain=Et.protocol+"//"+Et.host!=i.protocol+"//"+i.host}catch(e){g.crossDomain=!0}}if(g.data&&g.processData&&"string"!=typeof g.data&&(g.data=Z.param(g.data,g.traditional)),R(wt,g,t,_),2===w)return _;for(o in(f=Z.event&&g.global)&&0==Z.active++&&Z.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!bt.test(g.type),p=g.url,g.hasContent||(g.data&&(p=g.url+=(gt.test(p)?"&":"?")+g.data,delete g.data),!1===g.cache&&(g.url=yt.test(p)?p.replace(yt,"$1_="+ft++):p+(gt.test(p)?"&":"?")+"_="+ft++)),g.ifModified&&(Z.lastModified[p]&&_.setRequestHeader("If-Modified-Since",Z.lastModified[p]),Z.etag[p]&&_.setRequestHeader("If-None-Match",Z.etag[p])),(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&_.setRequestHeader("Content-Type",g.contentType),_.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+St+"; q=0.01":""):g.accepts["*"]),g.headers)_.setRequestHeader(o,g.headers[o]);if(g.beforeSend&&(!1===g.beforeSend.call(m,_,g)||2===w))return _.abort();for(o in l="abort",{success:1,error:1,complete:1})_[o](g[o]);if(u=R(_t,g,t,_)){if(_.readyState=1,f&&y.trigger("ajaxSend",[_,g]),2===w)return _;g.async&&0<g.timeout&&(h=S.setTimeout(function(){_.abort("timeout")},g.timeout));try{w=1,u.send(a,r)}catch(e){if(!(w<2))throw e;r(-1,e)}}else r(-1,"No Transport");return _},getJSON:function(e,t,r){return Z.get(e,t,r,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,i){Z[i]=function(e,t,r,n){return Z.isFunction(t)&&(n=n||r,r=t,t=void 0),Z.ajax(Z.extend({url:e,type:i,dataType:n,data:t,success:r},Z.isPlainObject(e)&&e))}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},Z.fn.extend({wrapAll:function(t){var e;return Z.isFunction(t)?this.each(function(e){Z(this).wrapAll(t.call(this,e))}):(this[0]&&(e=Z(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(r){return Z.isFunction(r)?this.each(function(e){Z(this).wrapInner(r.call(this,e))}):this.each(function(){var e=Z(this),t=e.contents();t.length?t.wrapAll(r):e.append(r)})},wrap:function(t){var r=Z.isFunction(t);return this.each(function(e){Z(this).wrapAll(r?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return!Z.expr.filters.visible(e)},Z.expr.filters.visible=function(e){return 0<e.offsetWidth||0<e.offsetHeight||0<e.getClientRects().length};var Mt=/%20/g,It=/\[\]$/,Tt=/\r?\n/g,Ct=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var r,n=[],i=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){i(this.name,this.value)});else for(r in e)j(r,e[r],t,i);return n.join("&").replace(Mt,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&kt.test(this.nodeName)&&!Ct.test(e)&&(this.checked||!Me.test(e))}).map(function(e,t){var r=Z(this).val();return null==r?null:Z.isArray(r)?Z.map(r,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:r.replace(Tt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new S.XMLHttpRequest}catch(e){}};var Pt={0:200,1223:204},Dt=Z.ajaxSettings.xhr();Q.cors=!!Dt&&"withCredentials"in Dt,Q.ajax=Dt=!!Dt,Z.ajaxTransport(function(i){var o,a;if(Q.cors||Dt&&!i.crossDomain)return{send:function(e,t){var r,n=i.xhr();if(n.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(r in i.xhrFields)n[r]=i.xhrFields[r];for(r in i.mimeType&&n.overrideMimeType&&n.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)n.setRequestHeader(r,e[r]);o=function(e){return function(){o&&(o=a=n.onload=n.onerror=n.onabort=n.onreadystatechange=null,"abort"===e?n.abort():"error"===e?"number"!=typeof n.status?t(0,"error"):t(n.status,n.statusText):t(Pt[n.status]||n.status,n.statusText,"text"!==(n.responseType||"text")||"string"!=typeof n.responseText?{binary:n.response}:{text:n.responseText},n.getAllResponseHeaders()))}},n.onload=o(),a=n.onerror=o("error"),void 0!==n.onabort?n.onabort=a:n.onreadystatechange=function(){4===n.readyState&&S.setTimeout(function(){o&&a()})},o=o("abort");try{n.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(r){var n,i;if(r.crossDomain)return{send:function(e,t){n=Z("<script>").prop({charset:r.scriptCharset,src:r.url}).on("load error",i=function(e){n.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),z.head.appendChild(n[0])},abort:function(){i&&i()}}});var At=[],Lt=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=At.pop()||Z.expando+"_"+ft++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(e,t,r){var n,i,o,a=!1!==e.jsonp&&(Lt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Lt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=Z.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Lt,"$1"+n):!1!==e.jsonp&&(e.url+=(gt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return o||Z.error(n+" was not called"),o[0]},e.dataTypes[0]="json",i=S[n],S[n]=function(){o=arguments},r.always(function(){void 0===i?Z(S).removeProp(n):S[n]=i,e[n]&&(e.jsonpCallback=t.jsonpCallback,At.push(n)),o&&Z.isFunction(i)&&i(o[0]),o=i=void 0}),"script"}),Z.parseHTML=function(e,t,r){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(r=t,t=!1),t=t||z;var n=se.exec(e),i=!r&&[];return n?[t.createElement(n[1])]:(n=y([e],t,i),i&&i.length&&Z(i).remove(),Z.merge([],n.childNodes))};var Ot=Z.fn.load;Z.fn.load=function(e,t,r){if("string"!=typeof e&&Ot)return Ot.apply(this,arguments);var n,i,o,a=this,s=e.indexOf(" ");return-1<s&&(n=Z.trim(e.slice(s)),e=e.slice(0,s)),Z.isFunction(t)?(r=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&Z.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(n?Z("<div>").append(Z.parseHTML(e)).find(n):e)}).always(r&&function(e,t){a.each(function(){r.apply(this,o||[e.responseText,t,e])})}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(t){return Z.grep(Z.timers,function(e){return t===e.elem}).length},Z.offset={setOffset:function(e,t,r){var n,i,o,a,s,l,c=Z.css(e,"position"),u=Z(e),p={};"static"===c&&(e.style.position="relative"),s=u.offset(),o=Z.css(e,"top"),l=Z.css(e,"left"),i=("absolute"===c||"fixed"===c)&&-1<(o+l).indexOf("auto")?(a=(n=u.position()).top,n.left):(a=parseFloat(o)||0,parseFloat(l)||0),Z.isFunction(t)&&(t=t.call(e,r,Z.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):u.css(p)}},Z.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Z.offset.setOffset(this,t,e)});var e,r,n=this[0],i={top:0,left:0},o=n&&n.ownerDocument;return o?(e=o.documentElement,Z.contains(e,n)?(i=n.getBoundingClientRect(),r=V(o),{top:i.top+r.pageYOffset-e.clientTop,left:i.left+r.pageXOffset-e.clientLeft}):i):void 0},position:function(){if(this[0]){var e,t,r=this[0],n={top:0,left:0};return"fixed"===Z.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(n=e.offset()),n.top+=Z.css(e[0],"borderTopWidth",!0),n.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-Z.css(r,"marginTop",!0),left:t.left-n.left-Z.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||We})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;Z.fn[t]=function(e){return ge(this,function(e,t,r){var n=V(e);return void 0===r?n?n[i]:e[t]:void(n?n.scrollTo(o?n.pageXOffset:r,o?r:n.pageYOffset):e[t]=r)},t,e,arguments.length)}}),Z.each(["top","left"],function(e,r){Z.cssHooks[r]=M(Q.pixelPosition,function(e,t){if(t)return t=E(e,r),ze.test(t)?Z(e).position()[r]+"px":t})}),Z.each({Height:"height",Width:"width"},function(o,a){Z.each({padding:"inner"+o,content:a,"":"outer"+o},function(n,e){Z.fn[e]=function(e,t){var r=arguments.length&&(n||"boolean"!=typeof e),i=n||(!0===e||!0===t?"margin":"border");return ge(this,function(e,t,r){var n;return Z.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+o],n["scroll"+o],e.body["offset"+o],n["offset"+o],n["client"+o])):void 0===r?Z.css(e,t,i):Z.style(e,t,r,i)},a,r?e:void 0,r,null)}})}),Z.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)},size:function(){return this.length}}),Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var qt=S.jQuery,Ft=S.$;return Z.noConflict=function(e){return S.$===Z&&(S.$=Ft),e&&S.jQuery===Z&&(S.jQuery=qt),Z},e||(S.jQuery=S.$=Z),Z}),define("keys",["require"],function(e){return new function(){var t={8:this.BACKSPACE="Backspace",9:this.TAB="Tab",13:this.ENTER="Enter",16:this.SHIFT="Shift",17:this.CONTROL="Control",18:this.ALT="Alt",20:this.CAPSLOCK="CapsLock",27:this.ESCAPE="Esc",32:this.SPACEBAR="Space",33:this.PAGEUP="PageUp",34:this.PAGEDOWN="PageDown",35:this.END="End",36:this.HOME="Home",37:this.LEFT="Left",38:this.UP="Up",39:this.RIGHT="Right",40:this.DOWN="Down",46:this.DELETE="Del"},r={UIKeyInputUpArrow:this.UP,UIKeyInputDownArrow:this.DOWN,UIKeyInputLeftArrow:this.LEFT,UIKeyInputRightArrow:this.RIGHT,UIKeyInputEscape:this.ESCAPE,UIKeyInputPageUp:this.PAGEUP,UIKeyInputPageDown:this.PAGEDOWN};this.isUndo=function(e){return!e.altKey&&(e.ctrlKey||e.metaKey)&&90==e.which&&!e.shiftKey},this.isRedo=function(e){return!e.altKey&&(e.ctrlKey||e.metaKey)&&(89==e.which||90==e.which&&e.shiftKey)},this.isSelectAll=function(e){return!e.altKey&&(e.ctrlKey||e.metaKey)&&65==e.which},this.isBacktick=function(e){return!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||192!=e.which)},this.isHelp=function(e){return!e.altKey&&(e.ctrlKey||e.metaKey)&&191==e.which},this.lookup=function(e){return t[e.which]||r[e.key]},this.lookupChar=function(e){return String.fromCharCode(e.which)}}}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),function(){function e(s){return function(e,t,r,n){t=b(t,n,4);var i=!I(e)&&v.keys(e),o=(i||e).length,a=0<s?0:o-1;return arguments.length<3&&(r=e[i?i[a]:a],a+=s),function(e,t,r,n,i,o){for(;0<=i&&i<o;i+=s){var a=n?n[i]:i;r=t(r,e[a],a,e)}return r}(e,t,r,i,a,o)}}function t(o){return function(e,t,r){t=x(t,r);for(var n=M(e),i=0<o?0:n-1;0<=i&&i<n;i+=o)if(t(e[i],i,e))return i;return-1}}function r(o,a,s){return function(e,t,r){var n=0,i=M(e);if("number"==typeof r)0<o?n=0<=r?r:Math.max(r+i,n):i=0<=r?Math.min(r+1,i):r+i+1;else if(s&&r&&i)return e[r=s(e,t)]===t?r:-1;if(t!=t)return 0<=(r=a(u.call(e,n,i),v.isNaN))?r+n:-1;for(r=0<o?n:i-1;0<=r&&r<i;r+=o)if(e[r]===t)return r;return-1}}function n(e,t){var r=D.length,n=e.constructor,i=v.isFunction(n)&&n.prototype||s,o="constructor";for(v.has(e,o)&&!v.contains(t,o)&&t.push(o);r--;)(o=D[r])in e&&e[o]!==i[o]&&!v.contains(t,o)&&t.push(o)}var i=this,o=i._,a=Array.prototype,s=Object.prototype,l=Function.prototype,c=a.push,u=a.slice,p=s.toString,d=s.hasOwnProperty,h=Array.isArray,f=Object.keys,g=l.bind,m=Object.create,y=function(){},v=function(e){return e instanceof v?e:this instanceof v?void(this._wrapped=e):new v(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=v),exports._=v):i._=v,v.VERSION="1.8.3";var b=function(i,o,e){if(void 0===o)return i;switch(null==e?3:e){case 1:return function(e){return i.call(o,e)};case 2:return function(e,t){return i.call(o,e,t)};case 3:return function(e,t,r){return i.call(o,e,t,r)};case 4:return function(e,t,r,n){return i.call(o,e,t,r,n)}}return function(){return i.apply(o,arguments)}},x=function(e,t,r){return null==e?v.identity:v.isFunction(e)?b(e,t,r):v.isObject(e)?v.matcher(e):v.property(e)};v.iteratee=function(e,t){return x(e,t,1/0)};var w=function(l,c){return function(e){var t=arguments.length;if(t<2||null==e)return e;for(var r=1;r<t;r++)for(var n=arguments[r],i=l(n),o=i.length,a=0;a<o;a++){var s=i[a];c&&void 0!==e[s]||(e[s]=n[s])}return e}},_=function(e){if(!v.isObject(e))return{};if(m)return m(e);y.prototype=e;var t=new y;return y.prototype=null,t},S=function(t){return function(e){return null==e?void 0:e[t]}},E=Math.pow(2,53)-1,M=S("length"),I=function(e){var t=M(e);return"number"==typeof t&&0<=t&&t<=E};v.each=v.forEach=function(e,t,r){var n,i;if(t=b(t,r),I(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var o=v.keys(e);for(n=0,i=o.length;n<i;n++)t(e[o[n]],o[n],e)}return e},v.map=v.collect=function(e,t,r){t=x(t,r);for(var n=!I(e)&&v.keys(e),i=(n||e).length,o=Array(i),a=0;a<i;a++){var s=n?n[a]:a;o[a]=t(e[s],s,e)}return o},v.reduce=v.foldl=v.inject=e(1),v.reduceRight=v.foldr=e(-1),v.find=v.detect=function(e,t,r){var n;if(void 0!==(n=I(e)?v.findIndex(e,t,r):v.findKey(e,t,r))&&-1!==n)return e[n]},v.filter=v.select=function(e,n,t){var i=[];return n=x(n,t),v.each(e,function(e,t,r){n(e,t,r)&&i.push(e)}),i},v.reject=function(e,t,r){return v.filter(e,v.negate(x(t)),r)},v.every=v.all=function(e,t,r){t=x(t,r);for(var n=!I(e)&&v.keys(e),i=(n||e).length,o=0;o<i;o++){var a=n?n[o]:o;if(!t(e[a],a,e))return!1}return!0},v.some=v.any=function(e,t,r){t=x(t,r);for(var n=!I(e)&&v.keys(e),i=(n||e).length,o=0;o<i;o++){var a=n?n[o]:o;if(t(e[a],a,e))return!0}return!1},v.contains=v.includes=v.include=function(e,t,r,n){return I(e)||(e=v.values(e)),("number"!=typeof r||n)&&(r=0),0<=v.indexOf(e,t,r)},v.invoke=function(e,r){var n=u.call(arguments,2),i=v.isFunction(r);return v.map(e,function(e){var t=i?r:e[r];return null==t?t:t.apply(e,n)})},v.pluck=function(e,t){return v.map(e,v.property(t))},v.where=function(e,t){return v.filter(e,v.matcher(t))},v.findWhere=function(e,t){return v.find(e,v.matcher(t))},v.max=function(e,n,t){var r,i,o=-1/0,a=-1/0;if(null==n&&null!=e)for(var s=0,l=(e=I(e)?e:v.values(e)).length;s<l;s++)r=e[s],o<r&&(o=r);else n=x(n,t),v.each(e,function(e,t,r){i=n(e,t,r),(a<i||i===-1/0&&o===-1/0)&&(o=e,a=i)});return o},v.min=function(e,n,t){var r,i,o=1/0,a=1/0;if(null==n&&null!=e)for(var s=0,l=(e=I(e)?e:v.values(e)).length;s<l;s++)(r=e[s])<o&&(o=r);else n=x(n,t),v.each(e,function(e,t,r){((i=n(e,t,r))<a||i===1/0&&o===1/0)&&(o=e,a=i)});return o},v.shuffle=function(e){for(var t,r=I(e)?e:v.values(e),n=r.length,i=Array(n),o=0;o<n;o++)(t=v.random(0,o))!==o&&(i[o]=i[t]),i[t]=r[o];return i},v.sample=function(e,t,r){return null==t||r?(I(e)||(e=v.values(e)),e[v.random(e.length-1)]):v.shuffle(e).slice(0,Math.max(0,t))},v.sortBy=function(e,n,t){return n=x(n,t),v.pluck(v.map(e,function(e,t,r){return{value:e,index:t,criteria:n(e,t,r)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(n<r||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")};var T=function(a){return function(n,i,e){var o={};return i=x(i,e),v.each(n,function(e,t){var r=i(e,t,n);a(o,e,r)}),o}};v.groupBy=T(function(e,t,r){v.has(e,r)?e[r].push(t):e[r]=[t]}),v.indexBy=T(function(e,t,r){e[r]=t}),v.countBy=T(function(e,t,r){v.has(e,r)?e[r]++:e[r]=1}),v.toArray=function(e){return e?v.isArray(e)?u.call(e):I(e)?v.map(e,v.identity):v.values(e):[]},v.size=function(e){return null==e?0:I(e)?e.length:v.keys(e).length},v.partition=function(e,n,t){n=x(n,t);var i=[],o=[];return v.each(e,function(e,t,r){(n(e,t,r)?i:o).push(e)}),[i,o]},v.first=v.head=v.take=function(e,t,r){if(null!=e)return null==t||r?e[0]:v.initial(e,e.length-t)},v.initial=function(e,t,r){return u.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))},v.last=function(e,t,r){if(null!=e)return null==t||r?e[e.length-1]:v.rest(e,Math.max(0,e.length-t))},v.rest=v.tail=v.drop=function(e,t,r){return u.call(e,null==t||r?1:t)},v.compact=function(e){return v.filter(e,v.identity)};var C=function(e,t,r,n){for(var i=[],o=0,a=n||0,s=M(e);a<s;a++){var l=e[a];if(I(l)&&(v.isArray(l)||v.isArguments(l))){t||(l=C(l,t,r));var c=0,u=l.length;for(i.length+=u;c<u;)i[o++]=l[c++]}else r||(i[o++]=l)}return i};v.flatten=function(e,t){return C(e,t,!1)},v.without=function(e){return v.difference(e,u.call(arguments,1))},v.uniq=v.unique=function(e,t,r,n){v.isBoolean(t)||(n=r,r=t,t=!1),null!=r&&(r=x(r,n));for(var i=[],o=[],a=0,s=M(e);a<s;a++){var l=e[a],c=r?r(l,a,e):l;t?(a&&o===c||i.push(l),o=c):r?v.contains(o,c)||(o.push(c),i.push(l)):v.contains(i,l)||i.push(l)}return i},v.union=function(){return v.uniq(C(arguments,!0,!0))},v.intersection=function(e){for(var t=[],r=arguments.length,n=0,i=M(e);n<i;n++){var o=e[n];if(!v.contains(t,o)){for(var a=1;a<r&&v.contains(arguments[a],o);a++);a===r&&t.push(o)}}return t},v.difference=function(e){var t=C(arguments,!0,!0,1);return v.filter(e,function(e){return!v.contains(t,e)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(e){for(var t=e&&v.max(e,M).length||0,r=Array(t),n=0;n<t;n++)r[n]=v.pluck(e,n);return r},v.object=function(e,t){for(var r={},n=0,i=M(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},v.findIndex=t(1),v.findLastIndex=t(-1),v.sortedIndex=function(e,t,r,n){for(var i=(r=x(r,n,1))(t),o=0,a=M(e);o<a;){var s=Math.floor((o+a)/2);r(e[s])<i?o=s+1:a=s}return o},v.indexOf=r(1,v.findIndex,v.sortedIndex),v.lastIndexOf=r(-1,v.findLastIndex),v.range=function(e,t,r){null==t&&(t=e||0,e=0),r=r||1;for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),o=0;o<n;o++,e+=r)i[o]=e;return i};var k=function(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var o=_(e.prototype),a=e.apply(o,i);return v.isObject(a)?a:o};v.bind=function(e,t){if(g&&e.bind===g)return g.apply(e,u.call(arguments,1));if(!v.isFunction(e))throw new TypeError("Bind must be called on a function");var r=u.call(arguments,2),n=function(){return k(e,n,t,this,r.concat(u.call(arguments)))};return n},v.partial=function(i){var o=u.call(arguments,1),a=function(){for(var e=0,t=o.length,r=Array(t),n=0;n<t;n++)r[n]=o[n]===v?arguments[e++]:o[n];for(;e<arguments.length;)r.push(arguments[e++]);return k(i,a,this,this,r)};return a},v.bindAll=function(e){var t,r,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)e[r=arguments[t]]=v.bind(e[r],e);return e},v.memoize=function(n,i){var o=function(e){var t=o.cache,r=""+(i?i.apply(this,arguments):e);return v.has(t,r)||(t[r]=n.apply(this,arguments)),t[r]};return o.cache={},o},v.delay=function(e,t){var r=u.call(arguments,2);return setTimeout(function(){return e.apply(null,r)},t)},v.defer=v.partial(v.delay,v,1),v.throttle=function(r,n,i){var o,a,s,l=null,c=0;i||(i={});var u=function(){c=!1===i.leading?0:v.now(),l=null,s=r.apply(o,a),l||(o=a=null)};return function(){var e=v.now();c||!1!==i.leading||(c=e);var t=n-(e-c);return o=this,a=arguments,t<=0||n<t?(l&&(clearTimeout(l),l=null),c=e,s=r.apply(o,a),l||(o=a=null)):l||!1===i.trailing||(l=setTimeout(u,t)),s}},v.debounce=function(t,r,n){var i,o,a,s,l,c=function(){var e=v.now()-s;e<r&&0<=e?i=setTimeout(c,r-e):(i=null,n||(l=t.apply(a,o),i||(a=o=null)))};return function(){a=this,o=arguments,s=v.now();var e=n&&!i;return i||(i=setTimeout(c,r)),e&&(l=t.apply(a,o),a=o=null),l}},v.wrap=function(e,t){return v.partial(t,e)},v.negate=function(e){return function(){return!e.apply(this,arguments)}},v.compose=function(){var r=arguments,n=r.length-1;return function(){for(var e=n,t=r[n].apply(this,arguments);e--;)t=r[e].call(this,t);return t}},v.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},v.before=function(e,t){var r;return function(){return 0<--e&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}},v.once=v.partial(v.before,2);var P=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(e){if(!v.isObject(e))return[];if(f)return f(e);var t=[];for(var r in e)v.has(e,r)&&t.push(r);return P&&n(e,t),t},v.allKeys=function(e){if(!v.isObject(e))return[];var t=[];for(var r in e)t.push(r);return P&&n(e,t),t},v.values=function(e){for(var t=v.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n},v.mapObject=function(e,t,r){t=x(t,r);for(var n,i=v.keys(e),o=i.length,a={},s=0;s<o;s++)a[n=i[s]]=t(e[n],n,e);return a},v.pairs=function(e){for(var t=v.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},v.invert=function(e){for(var t={},r=v.keys(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t},v.functions=v.methods=function(e){var t=[];for(var r in e)v.isFunction(e[r])&&t.push(r);return t.sort()},v.extend=w(v.allKeys),v.extendOwn=v.assign=w(v.keys),v.findKey=function(e,t,r){t=x(t,r);for(var n,i=v.keys(e),o=0,a=i.length;o<a;o++)if(t(e[n=i[o]],n,e))return n},v.pick=function(e,t,r){var n,i,o={},a=e;if(null==a)return o;v.isFunction(t)?(i=v.allKeys(a),n=b(t,r)):(i=C(arguments,!1,!1,1),n=function(e,t,r){return t in r},a=Object(a));for(var s=0,l=i.length;s<l;s++){var c=i[s],u=a[c];n(u,c,a)&&(o[c]=u)}return o},v.omit=function(e,t,r){if(v.isFunction(t))t=v.negate(t);else{var n=v.map(C(arguments,!1,!1,1),String);t=function(e,t){return!v.contains(n,t)}}return v.pick(e,t,r)},v.defaults=w(v.allKeys,!0),v.create=function(e,t){var r=_(e);return t&&v.extendOwn(r,t),r},v.clone=function(e){return v.isObject(e)?v.isArray(e)?e.slice():v.extend({},e):e},v.tap=function(e,t){return t(e),e},v.isMatch=function(e,t){var r=v.keys(t),n=r.length;if(null==e)return!n;for(var i=Object(e),o=0;o<n;o++){var a=r[o];if(t[a]!==i[a]||!(a in i))return!1}return!0};var A=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof v&&(e=e._wrapped),t instanceof v&&(t=t._wrapped);var i=p.call(e);if(i!==p.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var o="[object Array]"===i;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!(v.isFunction(a)&&a instanceof a&&v.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}n=n||[];for(var l=(r=r||[]).length;l--;)if(r[l]===e)return n[l]===t;if(r.push(e),n.push(t),o){if((l=e.length)!==t.length)return!1;for(;l--;)if(!A(e[l],t[l],r,n))return!1}else{var c,u=v.keys(e);if(l=u.length,v.keys(t).length!==l)return!1;for(;l--;)if(c=u[l],!v.has(t,c)||!A(e[c],t[c],r,n))return!1}return r.pop(),n.pop(),!0};v.isEqual=function(e,t){return A(e,t)},v.isEmpty=function(e){return null==e||(I(e)&&(v.isArray(e)||v.isString(e)||v.isArguments(e))?0===e.length:0===v.keys(e).length)},v.isElement=function(e){return!(!e||1!==e.nodeType)},v.isArray=h||function(e){return"[object Array]"===p.call(e)},v.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){v["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),v.isArguments(arguments)||(v.isArguments=function(e){return v.has(e,"callee")}),"function"!=typeof/ . /&&"object"!=typeof Int8Array&&(v.isFunction=function(e){return"function"==typeof e||!1}),v.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},v.isNaN=function(e){return v.isNumber(e)&&e!==+e},v.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===p.call(e)},v.isNull=function(e){return null===e},v.isUndefined=function(e){return void 0===e},v.has=function(e,t){return null!=e&&d.call(e,t)},v.noConflict=function(){return i._=o,this},v.identity=function(e){return e},v.constant=function(e){return function(){return e}},v.noop=function(){},v.property=S,v.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},v.matcher=v.matches=function(t){return t=v.extendOwn({},t),function(e){return v.isMatch(e,t)}},v.times=function(e,t,r){var n=Array(Math.max(0,e));t=b(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n},v.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},v.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},O=v.invert(L),q=function(t){var r=function(e){return t[e]},e="(?:"+v.keys(t).join("|")+")",n=RegExp(e),i=RegExp(e,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,r):e}};v.escape=q(L),v.unescape=q(O),v.result=function(e,t,r){var n=null==e?void 0:e[t];return void 0===n&&(n=r),v.isFunction(n)?n.call(e):n};var F=0;v.uniqueId=function(e){var t=++F+"";return e?e+t:t},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\u2028|\u2029/g,j=function(e){return"\\"+R[e]};v.template=function(o,e,t){!e&&t&&(e=t),e=v.defaults({},e,v.templateSettings);var r=RegExp([(e.escape||N).source,(e.interpolate||N).source,(e.evaluate||N).source].join("|")+"|$","g"),a=0,s="__p+='";o.replace(r,function(e,t,r,n,i){return s+=o.slice(a,i).replace(B,j),a=i+e.length,t?s+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":n&&(s+="';\n"+n+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var n=new Function(e.variable||"obj","_",s)}catch(o){throw o.source=s,o}var i=function(e){return n.call(this,e,v)},l=e.variable||"obj";return i.source="function("+l+"){\n"+s+"}",i},v.chain=function(e){var t=v(e);return t._chain=!0,t};var V=function(e,t){return e._chain?v(t).chain():t};v.mixin=function(r){v.each(v.functions(r),function(e){var t=v[e]=r[e];v.prototype[e]=function(){var e=[this._wrapped];return c.apply(e,arguments),V(this,t.apply(v,e))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=a[t];v.prototype[t]=function(){var e=this._wrapped;return r.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],V(this,e)}}),v.each(["concat","join","slice"],function(e){var t=a[e];v.prototype[e]=function(){return V(this,t.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return v})}.call(this),define("lib/inject-css",["require","underscore"],function(e){var o=e("underscore"),a={},s=[];return function(e,t){var r=a[e];if(!r){r=document.createElement("style"),a[e]=r;var n=o.sortedIndex(s,e),i=a[s[n]];i?document.head.insertBefore(r,i):document.head.appendChild(r),s.splice(n,0,e)}r.textContent=t}}),define("loadcss",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("loadcss!touchtracking",function(){}),define("touchtracking",["require","jquery","ipad.ghostevents","keys","loadcss!./touchtracking"],function(e){function t(e,t){var r=O?{passive:!1}:void 0;document.addEventListener(e,function(e){t(c.event.fix(e))},r)}var c=e("jquery"),r=e("ipad.ghostevents"),n=e("keys");e("loadcss!./touchtracking"),null==window._touchtracking_id_counter&&(window._touchtracking_id_counter=0),window._touchtracking_id_counter+=1;var u="touchtracking_id_"+window._touchtracking_id_counter;r.evtInScope=function(e){return w(e.target)},r.isGhostEvent=function(e){return!(window.PointerEvent||h!==p&&h!==d&&!E()||e.target===v||e.target&&c.contains(e.target,v)||v&&c.contains(v,e.target))};var p=1,d=4,h=0,s={},f={},g=[],m=0,y=null,v=null,l=null,i=[],b=function(e){for(var t=[];e;)t.push(e),e=e.parentNode;return t},x=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(t.push(n),c(n).is(".dcg-tap-container, .dcg-no-touchtracking"))return c(n).is(".dcg-tap-container."+u)?t:[]}return[]},o=function(e,t){v=null,g=b((h=e)===p?t.originalEvent.touches[0].target:t.target),c(x(g)).addClass("dcg-depressed").each(function(){var e=c(this);_(e)&&e.addClass("dcg-focus-by-tap")}),c(g).each(function(){var e=c(this);e.data({originalScrollTop:e.scrollTop(),originalScrollLeft:e.scrollLeft()})}),f={}},a=function(e){return e.is("input, textarea, select")||e.hasClass("dcg-mathquill-input-span")},w=function(e){return!!c(e).closest(".dcg-tap-container, .dcg-no-touchtracking").is(".dcg-tap-container."+u)},_=function(e){return 3!==h&&!a(e)&&w(e)},S=function(e){v=null,c(".dcg-depressed").removeClass("dcg-depressed");var t=c(document.activeElement);if(_(t))try{t.blur()}catch(e){}if(c(".dcg-focus-by-tap").removeClass("dcg-focus-by-tap"),c(g).each(function(){var e=c(this),t=e.data("originalScrollTop")-e.scrollTop(),r=e.data("originalScrollLeft")-e.scrollLeft();(t||r)&&(f.scroll=!0)}),1===f["dcg-tapstart"]&&1===f["dcg-tapend"]&&!f["dcg-tapcancel"]&&!f.scroll){var r="mouse"===e.device?e.clientX:e.originalEvent.changedTouches[0].clientX,n="mouse"===e.device?e.clientY:e.originalEvent.changedTouches[0].clientY;if(e&&!e.device&&0===r&&0===n){var i=e.target.getBoundingClientRect();r=(i.left+i.right)/2,n=(i.top+i.bottom)/2,e.device="keyboard"}for(var o=!1,a=0;a<g.length&&!o;a++){var s,l=c(g[a]);if("function"==typeof l[0].getBoundingClientRect&&(s=l[0].getBoundingClientRect()),"true"===l.attr("tapboundary")&&(o=!0),s){if(r<s.left||n<s.top)continue;if(r>s.right)continue;if(n>s.bottom)continue}v=l[0],I("dcg-tap",e,v);break}}h!==p&&h!==d||(y=setTimeout(function(){y=null,m=(new Date).getTime()},1e3)),g=[],h=0},E=function(){return y||(new Date).getTime()-m<500},M=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push({identifier:n.identifier,x:n.pageX,y:n.pageY,screenX:n.screenX,screenY:n.screenY,pageX:n.pageX,pageY:n.pageY,clientX:n.clientX,clientY:n.clientY})}return t},I=function(e,t,r){if("dcg-tapstart"===e)s[t.identifier]={type:e,pageX:t.originalEvent.changedTouches[0].pageX,pageY:t.originalEvent.changedTouches[0].pageY};else if("dcg-tapmove"===e){var n=t.originalEvent.changedTouches[0],i=s[t.identifier];if(i&&n.pageX===i.pageX&&n.pageY===i.pageY)return;if((h===p||h===d)&&i&&"dcg-tapstart"===i.type&&Math.abs(i.pageX-n.pageX)+Math.abs(i.pageY-n.pageY)<2)return;s[t.identifier]={type:e,pageX:t.originalEvent.changedTouches[0].pageX,pageY:t.originalEvent.changedTouches[0].pageY}}void 0===f[e.toLowerCase()]?f[e.toLowerCase()]=1:f[e.toLowerCase()]++;var o=c.event.fix(t.originalEvent);o.type=e,o.device=h===p||h===d?"touch":3===h?"keyboard":"mouse",o.touches=M(t.originalEvent.touches),o.changedTouches=M(t.originalEvent.changedTouches),o.target=r||t.target;var a="keyboard"!==o.device&&0<f["dcg-longhold"];o.wasLongheld=function(){return a},o.preventTap=function(){f["dcg-tapcancel"]=1},clearTimeout(l),"dcg-tapstart"===o.type&&"keyboard"!==o.device&&1===o.touches.length&&(l=setTimeout(function(){I("dcg-longhold",t,r)},500)),c(o.target).trigger(o)},T=function(e){var t=g,r=!!g.length,n=c(".dcg-tap-container."+u+" .dcg-hovered"),i=c.makeArray(n.filter(function(){return w(this)})),o=[],a=[],s=[];x(b(e)).forEach(function(e){r&&-1===t.indexOf(e)||(-1===i.indexOf(e)&&s.push(e),o.push(e))});for(var l=0;l<i.length;l++)e=i[l],-1===o.indexOf(e)&&a.push(e);c(a).removeClass("dcg-hovered").trigger("tipsyhide"),c(s).addClass("dcg-hovered").trigger("tipsyshow")},C=function(e){for(var t=0;t<i.length;t++)if(i[t].pointerId===e)return!0;return!1},k=function(e){for(var t=0;t<i.length;t++)if(i[t].pointerId===e)return i.splice(t,1)[0]},P=function(e){0===h&&o(d,e),T(null),i.push(e.originalEvent),e.originalEvent.identifier=e.originalEvent.pointerId,e.originalEvent.touches=i,e.originalEvent.changedTouches=[e.originalEvent],I("dcg-tapstart",e)},D=function(e){k(e.originalEvent.pointerId),e.originalEvent.identifier=e.originalEvent.pointerId,e.originalEvent.touches=i,e.originalEvent.changedTouches=[e.originalEvent],I("dcg-tapcancel",e),0===i.length&&S(e)},A=function(e){k(e.originalEvent.pointerId),e.originalEvent.identifier=e.originalEvent.pointerId,e.originalEvent.touches=i,e.originalEvent.changedTouches=[e.originalEvent],I("dcg-tapend",e),0===i.length&&S(e)},L=function(e){return"touch"===e.originalEvent.pointerType||2===e.originalEvent.pointerType};c(document).on("pointerdown MSPointerDown",function(e){2!==h&&h!==p&&L(e)&&(C(e.originalEvent.pointerId)||P(e))}),c(document).on("pointermove MSPointerMove",function(e){2!==h&&h!==p&&L(e)&&(C(e.originalEvent.pointerId)||P(e),k(e.originalEvent.pointerId),i.push(e.originalEvent),e.originalEvent.identifier=e.originalEvent.pointerId,e.originalEvent.touches=i,e.originalEvent.changedTouches=[e.originalEvent],I("dcg-tapmove",e))}),c(document).on("pointercancel MSPointerCancel",function(e){if(h===d&&L(e)&&C(e.originalEvent.pointerId)){D(e);for(var t;t=i.pop();){e=c.Event(t,{originalEvent:t});D(e)}}}),c(document).on("pointerup MSPointerUp",function(e){if(h===d&&L(e)&&C(e.originalEvent.pointerId)){A(e);for(var t;t=i.pop();){e=c.Event(t,{originalEvent:t});A(e)}}});var O=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",function(){},t),window.removeEventListener("test",function(){},t)}catch(e){}return e}();return t("touchstart",function(e){2!==h&&h!==d&&(0===h&&o(p,e),T(null),I("dcg-tapstart",e))}),t("touchmove",function(e){h===p&&I("dcg-tapmove",e)}),t("touchcancel",function(e){h===p&&(I("dcg-tapcancel",e),0===e.originalEvent.touches.length&&S(e))}),t("touchend",function(e){h===p&&(I("dcg-tapend",e),0===e.originalEvent.touches.length&&S(e))}),c(document).on("mousedown",function(e){if(1!==e.button&&2!==e.button){if(h===p||h===d||E())return void(!c(e.target).is("input, textarea, select")&&w(e.target)&&e.preventDefault());o(2,e),e.originalEvent.touches=[e],e.originalEvent.changedTouches=[e],I("dcg-tapstart",e)}}),c(document).ready(function(){c(document).on("mousedown",function(e){var t=!!c(e.target).closest(".dcg-do-not-blur").length,r=!!c(e.target).closest(".dcg-do-blur").length;if(t&&!r&&w(e.target)){e.preventDefault();try{var n=window.getSelection();if(1===n.rangeCount){var i=n.getRangeAt(0);i.startContainer===i.endContainer&&c(i.startContainer).closest(".dcg-text-selectable").length&&n.removeAllRanges()}}catch(e){}}})}),c(document).on("mouseleave",function(e){0===h&&(E()||T(null))}),c(document).on("mousemove",function(e){1!==e.button&&2!==e.button&&h!==p&&h!==d&&(E()||(T(e.target),e.originalEvent.touches=[e],e.originalEvent.changedTouches=[e],I("dcg-tapmove",e)))}),c(document).on("mouseup",function(e){1!==e.button&&2!==e.button&&2===h&&(e.originalEvent.touches=[],e.originalEvent.changedTouches=[e],I("dcg-tapend",e),S(e))}),c(document).on("keydown",function(e){if((n.lookup(e)===n.ENTER||n.lookup(e)===n.SPACEBAR)&&w(e.target)&&3!==h){if(c(e.target).is('a:not([ontap]), button, input, textarea, select, [contenteditable="true"]'))return;e.preventDefault(),o(3,e),e.originalEvent.touches=[e],e.originalEvent.changedTouches=[e],I("dcg-tapstart",e)}}),c(document).on("keyup",function(e){n.lookup(e)!==n.ENTER&&n.lookup(e)!==n.SPACEBAR||!w(e.target)||3===h&&(e.originalEvent.touches=[],e.originalEvent.changedTouches=[e],I("dcg-tapend",e),S(e))}),{monitor:function(e){c(e).addClass("dcg-tap-container"),c(e).addClass(u)},ignore:function(e){c(e).addClass("dcg-no-touchtracking")},isTapActive:function(){return 0!==h},elIsFocusable:a}}),define("console",["require"],function(e){var t=function(){},r={};return["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"].forEach(function(e){"undefined"!=typeof window&&window.console&&window.console[e]?r[e]=function(){Function.prototype.apply.call(window.console[e],window.console,arguments)}:r[e]=t}),r}),define("pjs",[],function(){return function(l,c,u){function p(e){return"object"==typeof e}function d(e){return"function"==typeof e}function h(){}return function t(r,e){function n(){var e=new i;return d(e.init)&&e.init.apply(e,arguments),e}function i(){}e===u&&(e=r,r=Object),n.Bare=i;var o,a=h[l]=r[l],s=i[l]=n[l]=new h;return(s.constructor=n).mixin=function(e){return i[l]=n[l]=t(n,e)[l],n},(n.open=function(e){if(o={},d(e)?o=e.call(n,s,a,n,r):p(e)&&(o=e),p(o))for(var t in o)c.call(o,t)&&(s[t]=o[t]);return d(s.init)||(s.init=r),n})(e)}}("prototype",{}.hasOwnProperty)}),define("lib/deepCopy",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var r=t;if(r&&"function"==typeof r.toJSON&&(r=r.toJSON()),!r)return r;if("object"!=typeof r)return r;if(Array.isArray(r))return r.map(e);var n={};for(var i in r)r.hasOwnProperty(i)&&(n[i]=e(r[i]));return n}}),define("config",["require","exports","lib/deepCopy"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},i=location.search;"?"===i[0]&&(i=i.slice(1));for(var o=i.split("&"),a={},s=0;s<o.length;s++){var l=o[s].split("=");a[l[0]]=2!==l.length||l[1]}if("undefined"!=typeof Desmos&&Desmos.config)for(var c in Desmos.config)Desmos.config.hasOwnProperty(c)&&(a[c]=Desmos.config[c]);var u=function(e){return a.hasOwnProperty(e)},p=function(e){n[e]=u(e)},d=function(e){n[e]=!u("no"+e)};p("testing"),p("maintenance"),p("disableScrollFix"),p("nativeOnscreenKeypad"),p("hidden"),p("disableMouseInteractions"),p("advancedStyling"),p("outofdom"),a.lang&&(n.lang=a.lang),a.fontSize&&(n.fontSize=a.fontSize),a.backgroundColor&&(n.backgroundColor="#"+a.backgroundColor),a.textColor&&(n.textColor="#"+a.textColor),n.no_navigation_warning=u("noconcat")||u("testing"),n.previewMessage="You're previewing some new accessibility features.",n.previewFeedbackUrl="mailto:feedback@desmos.com";var h=location&&"preview.desmos.com"===location.hostname;n.previewMode=u("previewMode")||h,p("lockViewport"),p("administerSecretFolders"),p("advancedStyling"),p("degreeMode"),p("clearIntoDegreeMode"),p("plaidMode"),p("editOnWeb"),p("crossOriginSaveTest"),p("decimalToFractionConversion"),d("links"),d("trace"),p("expressionsCollapsed"),p("invertedColors"),p("projectorMode"),d("images"),d("folders"),d("settingsMenu"),d("expressionsTopbar"),d("zoomButtons"),d("keypad"),d("graphpaper"),d("expressions"),d("expressionsTopbar"),d("settingsMenu"),d("branding"),d("pointsOfInterest"),d("plotSingleVariableImplicitEquations"),d("notes"),p("sciKeypad"),p("4fnKeypad"),p("ans"),u("braille")&&(n.braille=!0),d("qwertyKeyboard"),p("restrictedFunctions"),d("functionDefinition"),p("singleExpression"),p("restrictedEditing"),d("labels"),p("bare-i18n"),p("distributions"),p("embosserSupport"),a.additionalFunctions&&"string"==typeof a.additionalFunctions&&(n.additionalFunctions=a.additionalFunctions.split(",")),t.get=function(e){return n[e]},t.all=function(){return r.default(n)}}),define("lib/console",["require","exports","console"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=r.log,t.warn=r.warn}),define("i18n",["require","exports","config","jquery","underscore","lib/console"],function(e,i,a,n,o,s){"use strict";function l(e,t){u=e||"",p=t||{}}function c(e,t,r){var n=void 0!==r?r:u,i=p[n]&&p[n][e]||e||"";if(a.get("bare-i18n")&&(i=function(e){for(var t,r=/(__[^_]+__)/g,n=[];null!==(t=r.exec(e));)n.push({index:t.index,text:t[0]});for(var i=(e=e.replace(/[a-z]/gi,"")).split(""),o=0;o<n.length;o++)for(var a=n[o].index,s=n[o].text,l=0;l<s.length;l++)i[a+l]=s[l];return i.join("")}(i)),t)for(var o in t)t.hasOwnProperty(o)&&(i=i.split("__"+o+"__").join(t[o]));return i}function t(){for(var e=function(e){var n=[];return o.each(e,function(e){if(e){var r=e.split("-")[0];n.push(e),n.push(r),o.each(i.enabled_languages,function(e,t){t.split("-")[0]===r&&e.useAsRoot&&n.push(t)})}}),n}([a.get("lang"),navigator.userLanguage,navigator.language]),t=0;t<e.length;t++){var r=e[t];if(i.enabled_languages.hasOwnProperty(r))return r;if(o.contains(d,r))return r}return"en"}Object.defineProperty(i,"__esModule",{value:!0}),i.locales="undefined"!=typeof Desmos&&Desmos.locales?Desmos.locales:{};var u="",p={};i.enabled_languages={en:{displayName:"English (US)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"en-GB":{displayName:"English (GB)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"es-ES":{displayName:"Espaol (Espaa)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},ru:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugus (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"pt-PT":{displayName:"Portugus (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Franais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!1},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"slenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},hr:{displayName:"Hrvatski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"etina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"Trke",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},sl:{displayName:"Slovenina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_SL.pdf",useAsRoot:!1},lt:{displayName:"Lietuvi",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},ro:{displayName:"Romn",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ting Vit",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},"sr-CS":{displayName:"SRPSKI",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},bg:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_BG.pdf",useAsRoot:!1},mk:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},uk:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"zh-CN":{displayName:"",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var d=["sr","bn","he","hi","ar","fi","kk","ml-IN","tr","fa"];i.init=l,i.t=c,i.detectLanguage=t,i.currentLanguage=function(){return u},i.fetchLanguage=function(t){var r=n.Deferred();return"undefined"==typeof Desmos?r.reject():0<=Desmos.supportedLanguages.indexOf(t)||"en"===t?(l(t,Desmos.locales),r.resolve(!0)):n.get("/api/v1/calculator/language/"+t,function(e){Desmos.locales||(Desmos.locales={}),Desmos.supportedLanguages||(Desmos.supportedLanguages=[]),Desmos.locales[t]=e[t],Desmos.supportedLanguages.push(t),l(t,Desmos.locales),r.resolve(!0)}).fail(function(e){404===e.status&&s.warn(t+" is not an available language."),r.reject()}),r.promise()},i.unpack=function e(t,r){if(null==t)return"";if("string"==typeof t)return t;if("number"==typeof t)return""+t;var n,i=t.vars;if(i)for(var o in n={},i)i.hasOwnProperty(o)&&(n[o]=e(i[o],r));return c(t.msg,n,r)},l(t(),i.locales)}),define("underscore_model",["require","underscore","pjs"],function(e){var i=e("underscore");return{UnderscoreModel:e("pjs")(function(e){var t=0,r="guid_"+Math.round(1e6*Math.random())+"_"+(new Date).getTime()+"_";e.init=function(){this.__observers={},this.__eventObservers={},this.__oldProperties={},this.__propertyComparators={},this.guid=r+ ++t},e.unobserveAll=function(){this.__observers={},this.__eventObservers={}},e.getProperty=function(e){return this[e]},e.getOldProperty=function(e){return this.__oldProperties[e]},e.setProperty=function(e,t){var r=this[e];this[e]=t;var n=this.__propertyComparators[e];if(n){if(n(r,t))return}else if(i.isEqual(r,t))return;this.__oldProperties[e]=r,this.notifyPropertyChange(e)},e.setProperties=function(e){for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])},e.setPropertyComparator=function(e,t){this.__propertyComparators[e]=t},e.notifyPropertyChange=function(e){this.__callObservers(this.__observers,e,this)},e.observe=function(e,t){this.__addObservers(this.__observers,e,t)},e.unobserve=function(e){this.__removeObservers(this.__observers,e)},e.observeAndSync=function(e,t){this.observe(e,t);for(var r=e.split(" "),n=0;n<r.length;n++){var i=r[n].split(".")[0];this.hasOwnProperty(i)&&t(i,this)}},e.triggerEvent=function(e,t){this.__callObservers(this.__eventObservers,e,t)},e.observeEvent=function(e,t){this.__addObservers(this.__eventObservers,e,t)},e.unobserveEvent=function(e){this.__removeObservers(this.__eventObservers,e)},e.__callObservers=function(e,t,r){var n=e[t];if(n)for(var i=0;i<n.length;i++)n[i].callback(t,r)},e.__removeObservers=function(e,t){for(var r=t.split(" "),n=0;n<r.length;n++){var i=r[n].split("."),o=i[0],a=i[1];if(o&&a){var s=e[o],l=[];if(!s)continue;for(var c=0;c<s.length;c++){var u=s[c];u.namespace!==a&&l.push(u)}e[o]=l}else if(o)delete e[o];else if(a)for(o in e)e.hasOwnProperty(o)&&this.__removeObservers(e,o+"."+a)}},e.__addObservers=function(e,t,r){for(var n=t.split(" "),i=0;i<n.length;i++){var o=n[i].split("."),a=o[0];if(!a)throw"Must supply a property to observe";var s={namespace:o[1],callback:r},l=e[a];l?l.push(s):e[a]=[s]}}})}}),define("graphing/axisarrowmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NONE="NONE",t.POSITIVE="POSITIVE",t.BOTH="BOTH"}),define("graphing/graph-defaults",["require","exports","./axisarrowmode"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphDefaults={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:r.NONE,yAxisArrowMode:r.NONE,xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,squareAxes:!0,restrictGridToFirstQuadrant:!1}}),define("lib/color-helpers",["require","exports"],function(e,t){"use strict";function l(e){return c(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function c(e){return"string"==typeof e&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeColor=l,t.isValidHexColor=c,t.shadeColor=function(e,t){if(!c(e=l(e)))return e;1<t&&(t=1),t<-1&&(t=-1);var r=parseInt(e.slice(1),16),n=t<0?0:255,i=t<0?-1*t:t,o=r>>16,a=r>>8&255,s=255&r;return"#"+(16777216+65536*(Math.round((n-o)*i)+o)+256*(Math.round((n-a)*i)+a)+(Math.round((n-s)*i)+s)).toString(16).slice(1)},t.invertColor=function(e){if(!c(e=l(e)))return e;var t="0123456789abcdef";return"#"+e.slice(1).split("").map(function(e){return t[15-t.indexOf(e)]}).join("")},t.mutateOpacity=function(e,t){var r=/(rgba\([\d]+\,\ ?[\d]+\,\ ?[\d]+\,\ ?)[\d.]+(\))/;return e.match(r)?e.replace(r,"$1"+t+"$2"):e},t.colors={RED:"#c74440",BLUE:"#2d70b3",GREEN:"#388c46",PURPLE:"#6042a6",ORANGE:"#fa7e19",BLACK:"#000000",GRAY:"#aaaaaa"}}),define("main/graph_settings",["require","pjs","underscore","underscore_model","graphing/axisarrowmode","console","graphing/graph-defaults","lib/color-helpers"],function(e){var t=e("pjs"),o=e("underscore"),s=e("underscore_model").UnderscoreModel,a=e("graphing/axisarrowmode"),l=e("console"),c=e("graphing/graph-defaults").GraphDefaults,r=e("lib/color-helpers"),u=t(s,function(e,n,t){e.init=function(){function e(e,t,r){function n(){a.setProperty(e,a.config.projectorMode?r:t)}a.cloneProperties.push(e),a.config.observe("projectorMode",n),n()}function t(t,r,n,i,o){function e(){var e;e=a.config.projectorMode?a.highlight?o:i:a.highlight?n:r,a.setProperty(t,e)}a.cloneProperties.push(t),a.observe("highlight",e),a.config.observe("projectorMode",e),e()}for(var r in n.init.call(this),this.stateProperties=[],this.cloneProperties=[],this.config=new s,c)c.hasOwnProperty(r)&&this.addStateProperty(r,c[r]);this.labelHangingColor="rgba(150,150,150,1)",this.lastChangedAxis="x";var a=this;e("labelSize",14,19),e("majorAxisOpacity",.4,1),e("minorAxisOpacity",.12,.25),e("axisOpacity",.9,.9),e("axisLineWidth",1.5,2),e("axisLineOffset",.25,0),e("pixelsPerLabel",80,120),t("curveOpacity",.7,1,.7,1),e("globalCurveColor",void 0,void 0),t("graphLineWidth",2.5,3.5,5,7),t("pointLineWidth",9,11,15,17)},e.addStateProperty=function(e,t){this[e]=t,this.stateProperties.push(e),this.cloneProperties.push(e)},t.fromObject=function(t){var r=u();return r.cloneProperties.forEach(function(e){t.hasOwnProperty(e)&&r.setProperty(e,t[e])}),r},e.registerCallbacks=function(e,t){var r=this,n=function(){e.redrawAllLayers()};this.stateProperties.forEach(function(e){r.observe(e,n)}),this.config.observe("backgroundColor",n),this.config.observe("textColor",n),this.config.observe("invertedColors",n),this.observe("squareAxes",function(){e.viewportController.enforceSquareAxes()}),this.observe("degreeMode",function(){t.setDegreeMode(r.degreeMode)}),this.observe("backgroundColor",function(){e.redrawAllLayers()}),this.observe("textColor",function(){e.redrawAllLayers()}),this.config.observe("enableTabindex",function(){e.redrawAllLayers()}),this.config.observeAndSync("restrictedFunctions",function(){t.setRestrictedFunctions(r.config.restrictedFunctions)}),this.config.observeAndSync("pointsOfInterest",function(){t.setPointsOfInterest(r.config.pointsOfInterest)}),this.config.observeAndSync("projectorMode",function(){e.redrawAllLayers()}),this.config.observeAndSync("plotSingleVariableImplicitEquations",function(){t.setPlotSingleVariableImplicitEquations(r.config.plotSingleVariableImplicitEquations)})};var i=function(e,t){var r;switch(e){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":t!==(r=Math.round(Math.min(Math.max(0,t),5)))&&l.warn("minorSubdivisions must be an integer between 0 and 5. You provided "+t+", which we changed to "+r+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":t!==(r="false"!==t&&!!t)&&l.warn(e+" must be a Boolean. You provided "+t+" ("+typeof t+"), which we changed to "+r+" ("+typeof r+").");break;case"xAxisStep":case"yAxisStep":r=parseFloat(t),isFinite(t)||(r=0,l.warn(e+" must be a number. You provided "+t+", which we changed to "+r+"."));break;case"yAxisMinorSubdivisions":t!==(r=Math.round(Math.min(Math.max(0,t),5)))&&l.warn("minorSubdivisions must be an integer between 0 and 5. You provided "+t+", which we changed to "+r+".");break;case"xAxisArrowMode":case"yAxisArrowMode":(r=a[t])!==t&&(r=a.NONE,l.warn("unknown AxisArrowMode. Allowed values are: \n"+o.keys(a).join("\n")));break;case"xAxisLabel":case"yAxisLabel":"string"!=typeof(r=t)&&(r="",l.warn(e+" must be a string. you provided a "+typeof t+"."));break;case"backgroundColor":"string"!=typeof(r=t)&&(r="",l.warn(e+" must be a string. you provided a "+typeof t+".")),r||(r="#fff"),"#"!==r[0]&&(r="#"+r);break;case"textColor":"string"!=typeof(r=t)&&(r="",l.warn(e+" must be a string. you provided a "+typeof t+".")),r||(r="#000"),"#"!==r[0]&&(r="#"+r);break;case"fontSize":"number"!=typeof(r=t)&&(r=parseInt(r,10),l.warn("fontSize must be a number. Attempted to convert "+t+" to "+r+"."));break;case"language":"string"!=typeof(r=t)&&(r="",l.warn(e+" must be a string. you provided a "+typeof t+".")),"undefined"!=typeof Desmos&&Desmos.supportedLanguages.indexOf(t)<0&&"en"!==t&&(r="en",l.warn(t+" is not currently an available language."));break;default:r=t}return r};e._validateSettings=function(e){var t={},r=!1;for(var n in e)0<=this.stateProperties.indexOf(n)?t[n]=i(n,e[n]):(l.warn('Invalid graph setting "'+n+'".'),r=!0);return r&&l.warn("Available graph settings are: \n"+this.stateProperties.join("\n")),t},e.getBackgroundColor=function(){var e=r.normalizeColor(this.config.backgroundColor||"#fff");return this.config.invertedColors&&"#ffffff"!==e?r.invertColor(e):e},e.getTextColor=function(){var e=r.normalizeColor(this.config.textColor||"#000");return this.config.invertedColors&&"#000000"!==e?r.invertColor(e):e},e.setGraphSettings=function(e){var t=this._validateSettings(e);for(var r in t)t.hasOwnProperty(r)&&("projectorMode"===r||"invertedColors"===r||"fontSize"===r||"language"===r||"backgroundColor"===r||"textColor"===r?this.config.setProperty(r,t[r]):this.setProperty(r,t[r]))}});return u}),define("browser",["require","jquery"],function(e){var t,r,n=e("jquery"),o={IS_IE8:null!==navigator.userAgent.match(/MSIE 8.0/i),IS_IE9:null!==navigator.userAgent.match(/MSIE 9.0/i),IS_IE:null!==navigator.userAgent.match(/MSIE/i),IS_EDGE:null!==navigator.userAgent.match(/Edge/i),IS_IPAD:null!==navigator.userAgent.match(/iPad/i),IS_MOBILE:null!==navigator.userAgent.match(/Mobile|Android/i),IS_ANDROID:null!==navigator.userAgent.match(/Android/i),IS_IOS:null!==navigator.userAgent.match(/(iPad|iPhone|iPod)/i),IS_CHROME:null!==navigator.userAgent.match(/Chrome/i),IS_FIREFOX:null!==navigator.userAgent.match(/Firefox/i),IS_SAFARI:null!==navigator.userAgent.match(/^((?!chrome|android).)*safari/i),IS_APPLE:null!==navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i),IS_WINDOWS:null!==navigator.platform.match(/(Win32)/i),IS_TOUCH:null!==navigator.userAgent.match(/Touch/i),IS_KINDLE:null!==navigator.userAgent.match(/Kindle/i)||null!==navigator.userAgent.match(/Silk/i),IS_BRAILLENOTE:null!==navigator.userAgent.match(/KeyWeb/i),IS_IN_IFRAME:window.parent!==window};return o.IS_TABLET=o.IS_IPAD||o.IS_ANDROID||o.IS_KINDLE,o.IS_TOUCH_DEVICE=o.SHOULD_NOT_AUTOFOCUS=o.IS_IOS||o.IS_ANDROID||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),o.IOS_VERSION=(r=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/))?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3]||0,10)]:null,o.SUPPORTS_TRANSLATE3D=!1,n(document).ready(function(){var e,t,r=document.createElement("p"),n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var i in document.body.insertBefore(r,null),n)if(void 0!==r.style[i]){if(r.style[i]="translate3d(1px,1px,1px)",!(t=window.getComputedStyle(r)))return;e=t.getPropertyValue(n[i])}document.body.removeChild(r),o.SUPPORTS_TRANSLATE3D=void 0!==e&&0<e.length&&"none"!==e}),o.translateRule=function(e,t){return o.SUPPORTS_TRANSLATE3D?"translate3d("+e+(e?"px":"")+","+t+(t?"px":"")+",0)":"translate("+e+(e?"px":"")+","+t+(t?"px":"")+")"},o.SUPPORTS_CANVAS=!(!(t=document.createElement("canvas")).getContext||!t.getContext("2d")),o}),function(){function w(){}function o(e){var t=y.call(arguments,1);return function(){return e.apply(this,t)}}function l(e,t){if(!t)throw new Error("prayer failed: "+e)}function s(e){l("a direction was passed",-1===e||e===S)}function r(){M=!1,x={}}function n(e,t){var r=e[-1];if(r)for(;r!==e[S][S];r=r[S]){if(!1===t(r))break}}function i(e,t,r){var n=e[-1];if(!n)return t;for(;n!==e[S][S];n=n[S])t=r(t,n);return t}function a(e,t,r){l("a parent is always present",e),l("leftward is properly set up",t?t[S]===r&&t.parent===e:e.ends[-1]===r),l("rightward is properly set up",r?r[-1]===t&&r.parent===e:e.ends[S]===t)}function c(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (20142015)  v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function u(e){return c(),Te(e)}function e(a){function s(e){if(!e||!e.nodeType)return null;var t=I.getNodeOfElement(E(e).children(".dcg-mq-root-block")[0]),r=t&&t.controller;return r?l[r.KIND_OF_MQ](r):null}function t(e,t){for(var r in t&&t.handlers&&(t.handlers={fns:t.handlers,APIClasses:l}),t)if(t.hasOwnProperty(r)){var n=t[r],i=q[r];e[r]=i?i(n):n}}if(!(R<=a&&a<=B))throw"Only interface versions between "+R+" and "+B+" supported. You specified: "+a;var l={};s.L=-1,s.R=S,s.saneKeyboardEvents=V,s.config=function(e){return t(O.p,e),this},s.registerEmbed=function(e,t){if(!/^[a-z][a-z0-9]*$/i.test(e))throw"Embed name must start with letter and be only letters and digits";N[e]=t};var e=l.AbstractMathQuill=v(F,function(e){e.init=function(e){this.__controller=e,this.__options=e.options,this.id=e.id,this.data=e.data},e.__mathquillify=function(e){var t=this.__controller,r=t.root,n=t.container;t.createTextarea();var i=n.addClass(e).contents().detach();r.jQ=E('<span class="dcg-mq-root-block"/>').appendTo(n),I.linkElementByBlockId(r.jQ[0],r.id),this.latex(i.text()),this.revert=function(){return n.empty().unbind(".mathquill").removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").append(i)}},e.config=function(e){return t(this.__options,e),this},e.el=function(){return this.__controller.container[0]},e.text=function(){return this.__controller.exportText()},e.mathspeak=function(){return this.__controller.exportMathSpeak()},e.latex=function(e){return 0<arguments.length?(this.__controller.renderLatexMath(e),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},e.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},e.reflow=function(){return this.__controller.root.postOrder(function(e){e.reflow()}),this}});for(var r in s.prototype=e.prototype,l.EditableField=v(e,function(e,t){e.__mathquillify=function(){return t.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},e.focus=function(){return this.__controller.textarea.focus(),this.__controller.scrollHoriz(),this},e.blur=function(){return this.__controller.textarea.blur(),this},e.write=function(e){return this.__controller.writeLatex(e),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},e.cmd=function(e){var t=this.__controller.notify(),r=t.cursor;if(/^\\[a-z]+$/i.test(e)){e=e.slice(1);var n=C[e];n&&(e=n(e),r.selection&&e.replaces(r.replaceSelection()),e.createLeftOf(r.show()))}else r.parent.write(r,e);return t.blurred&&r.hide().parent.blur(),t.scrollHoriz(),this},e.select=function(){var e=this.__controller;for(e.notify("move").cursor.insAtRightEnd(e.root);e.cursor[-1];)e.selectLeft();return this},e.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},e.moveToDirEnd=function(e){return this.__controller.notify("move").cursor.insAtDirEnd(e,this.__controller.root),this},e.moveToLeftEnd=function(){return this.moveToDirEnd(-1)},e.moveToRightEnd=function(){return this.moveToDirEnd(S)},e.keystroke=function(e,t){e=e.replace(/^\s+|\s+$/g,"").split(/\s+/);for(var r=0;r<e.length;r+=1)this.__controller.keystroke(e[r],t||{preventDefault:w});return this},e.typedText=function(e){for(var t=0;t<e.length;t+=1)this.__controller.typedText(e.charAt(t));return this},e.dropEmbedded=function(e,t,r){var n=e-E(window).scrollLeft(),i=t-E(window).scrollTop(),o=document.elementFromPoint(n,i);this.__controller.seek(E(o),e,t),Ie().setOptions(r).createLeftOf(this.__controller.cursor)},e.setAriaLabel=function(e){return this.__controller.ariaLabel=e&&"string"==typeof e&&""!=e?e:"Math Input",this},e.getAriaLabel=function(){return this.__controller.ariaLabel||"Math Input"},e.setAriaPostLabel=function(e,t){var r=this.__controller;return r.ariaPostLabel=e&&"string"==typeof e&&""!=e?(e!==r.ariaPostLabel&&"number"==typeof t&&(this.ariaAlertTimeout&&clearTimeout(this.ariaAlertTimeout),this.ariaAlertTimeout=setTimeout(function(){E(document.activeElement).closest(E(r.container)).length&&G.alert(this.mathspeak().trim()+" "+e.trim())}.bind(this),t)),e):(this.ariaAlertTimeout&&clearTimeout(this.ariaAlertTimeout),""),this},e.getAriaPostLabel=function(){return this.__controller.ariaPostLabel||""},e.clickAt=function(e,t,r){r=r||document.elementFromPoint(e,t);var n=this.__controller,i=n.root;return _.contains(i.jQ[0],r)||(r=i.jQ[0]),n.seek(E(r),e+pageXOffset,t+pageYOffset),n.blurred&&this.focus(),this},e.ignoreNextMousedown=function(e){return this.__controller.cursor.options.ignoreNextMousedown=e,this}}),(s.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"}).prototype=l.EditableField.prototype,L)!function(i,e){var o=l[i]=e(l);(s[i]=function(e,t){var r=s(e);if(r instanceof o||!e||!e.nodeType)return r;var n=A(o.RootBlock(),E(e),O());return n.KIND_OF_MQ=i,o(n).__mathquillify(t,a)}).prototype=o.prototype}(r,L[r]);return s}function p(e){for(var t="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" "),r=0;r<t.length;r+=1)!function(t){e[t]=function(e){this.controller.handle(t,e)}}(t[r]);e.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function d(e){var t=this.parent,r=e;do{if(r[S])return e.insLeftOf(t);r=r.parent.parent}while(r!==t);e.insRightOf(t)}function t(e,t){e.jQadd=function(){t.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")}}function h(e,t,r){t=t||e;var n=Se[e],i=Se[t];k[e]=o(_e,-1,e,n,t,i),k[n]=o(_e,S,e,n,t,i),Ee[e]=Ee[n]=r}var m,_=window.jQuery,g=Math.min,f=Math.max;if(!_)throw"MathQuill requires jQuery 1.5.2+ to be loaded first";var y=[].slice,v=function(l,c,e){function u(e){return"object"==typeof e}function p(e){return"function"==typeof e}function d(){}return function t(r,e){function n(){var e=new i;return p(e.init)&&e.init.apply(e,arguments),e}function i(){}void 0===e&&(e=r,r=Object),n.Bare=i;var o,a=d[l]=r[l],s=i[l]=n[l]=n.p=new d;return(s.constructor=n).extend=function(e){return t(n,e)},(n.open=function(e){if(o={},p(e)?o=e.call(n,s,a,n,r):u(e)&&(o=e),u(o))for(var t in o)c.call(o,t)&&(s[t]=o[t]);return p(s.init)||(s.init=r),n})(e)}}("prototype",{}.hasOwnProperty),S=1,E=v(_,function(e){e.insDirOf=function(e,t){return-1===e?this.insertBefore(t.first()):this.insertAfter(t.last())},e.insAtDirEnd=function(e,t){return-1===e?this.prependTo(t):this.appendTo(t)}}),b=v(function(e){e.parent=0,e[-1]=0,e[S]=0,e.init=function(e,t,r){this.parent=e,this[-1]=t,this[S]=r},this.copy=function(e){return b(e.parent,e[-1],e[S])}}),x={},M=!1,I=v(function(e){e[-1]=0,e[S]=0;var t=e.parent=0;this.getNodeOfElement=function(e){if(e){if(!e.nodeType)throw new Error("must pass an HTMLElement to Node.getNodeOfElement");return e.mqBlockNode||e.mqCmdNode}},this.linkElementByBlockId=function(e,t){I.linkElementByBlockNode(e,x[t])},this.linkElementByBlockNode=function(e,t){e.mqBlockNode=t},this.linkElementByCmdNode=function(e,t){e.mqCmdNode=t},e.init=function(){this.id=t+=1,x[t]=this,M||(M=!0,setTimeout(r)),this.ends={},this.ends[-1]=0,this.ends[S]=0},e.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},e.jQ=E(),e.jQadd=function(e){return this.jQ=this.jQ.add(e)},e.jQize=function(e){function o(e){if(e.getAttribute){var t=e.getAttribute("mathquill-command-id");if(t){e.removeAttribute("mathquill-command-id");var r=x[t];r.jQadd(e),I.linkElementByCmdNode(e,r)}var n=e.getAttribute("mathquill-block-id");if(n){e.removeAttribute("mathquill-block-id");var i=x[n];i.jQadd(e),I.linkElementByBlockNode(e,i)}}for(e=e.firstChild;e;e=e.nextSibling)o(e)}e=E(e||this.html());for(var t=0;t<e.length;t+=1)o(e[t]);return e},e.createDir=function(e,t){s(e);return this.jQize(),this.jQ.insDirOf(e,t.jQ),t[e]=this.adopt(t.parent,t[-1],t[S]),this},e.createLeftOf=function(e){return this.createDir(-1,e)},e.selectChildren=function(e,t){return D(e,t)},e.bubble=function(e){for(var t=this;t;t=t.parent){if(!1===e(t))break}return this},e.postOrder=function(r){return function e(t){t.eachChild(e),r(t)}(this),this},e.isEmpty=function(){return 0===this.ends[-1]&&0===this.ends[S]},e.isEmptyParens=function(){return!!this.isEmpty()&&!!this.parent&&"\\left("===this.parent.ctrlSeq},e.isStyleBlock=function(){return!1},e.children=function(){return T(this.ends[-1],this.ends[S])},e.eachChild=function(e){return n(this.ends,e),this},e.foldChildren=function(e,t){return i(this.ends,e,t)},e.withDirAdopt=function(e,t,r,n){return T(this,this).withDirAdopt(e,t,r,n),this},e.adopt=function(e,t,r){return T(this,this).adopt(e,t,r),this},e.disown=function(){return T(this,this).disown(),this},e.remove=function(){return this.jQ.remove(),this.disown()},e.finalizeTree=function(){},e.contactWeld=function(){},e.blur=function(){},e.intentionalBlur=function(){},e.reflow=function(){},e.registerInnerField=function(){}}),T=v(function(e){e.init=function(e,t,r){if(r===m&&(r=-1),s(r),l("no half-empty fragments",!e==!t),this.ends={},e){l("withDir is passed to Fragment",e instanceof I),l("oppDir is passed to Fragment",t instanceof I),l("withDir and oppDir have the same parent",e.parent===t.parent),this.ends[r]=e,this.ends[-r]=t;var n=this.fold([],function(e,t){return e.push.apply(e,t.jQ.get()),e});this.jQ=this.jQ.add(n)}},e.jQ=E(),e.withDirAdopt=function(e,t,r,n){return-1===e?this.adopt(t,r,n):this.adopt(t,n,r)},e.adopt=function(t,r,e){a(t,r,e);var n=this;n.disowned=!1;var i=n.ends[-1];if(!i)return this;var o=n.ends[S];return r||(t.ends[-1]=i),e?e[-1]=o:t.ends[S]=o,n.ends[S][S]=e,n.each(function(e){e[-1]=r,e.parent=t,r&&(r[S]=e),r=e}),n},e.disown=function(){var e=this,t=e.ends[-1];if(!t||e.disowned)return e;e.disowned=!0;var r=e.ends[S],n=t.parent;return a(n,t[-1],t),a(n,r,r[S]),t[-1]?t[-1][S]=r[S]:n.ends[-1]=r[S],r[S]?r[S][-1]=t[-1]:n.ends[S]=t[-1],e},e.remove=function(){return this.jQ.remove(),this.disown()},e.each=function(e){return n(this.ends,e),this},e.fold=function(e,t){return i(this.ends,e,t)}}),C={},k={},P=v(b,function(e){e.init=function(e,t){this.parent=e,this.options=t;var r=this.jQ=this._jQ=E('<span class="dcg-mq-cursor">&#8203;</span>');this.blink=function(){r.toggleClass("dcg-mq-blink")},this.upDownCache={}},e.show=function(){return this.jQ=this._jQ.removeClass("dcg-mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[S]?this.selection&&this.selection.ends[-1][-1]===this[-1]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[S].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},e.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=E(),this},e.withDirInsertAt=function(e,t,r,n){var i=this.parent;this.parent=t,this[e]=r,this[-e]=n,i!==t&&i.blur&&i.blur(this)},e.insDirOf=function(e,t){return s(e),this.jQ.insDirOf(e,t.jQ),this.withDirInsertAt(e,t.parent,t[e],t),this.parent.jQ.addClass("dcg-mq-hasCursor"),this},e.insLeftOf=function(e){return this.insDirOf(-1,e)},e.insRightOf=function(e){return this.insDirOf(S,e)},e.insAtDirEnd=function(e,t){return s(e),this.jQ.insAtDirEnd(e,t.jQ),this.withDirInsertAt(e,t,0,t.ends[e]),t.focus(),this},e.insAtLeftEnd=function(e){return this.insAtDirEnd(-1,e)},e.insAtRightEnd=function(e){return this.insAtDirEnd(S,e)},e.jumpUpDown=function(e,t){var r=this;r.upDownCache[e.id]=b.copy(r);var n=r.upDownCache[t.id];if(n)n[S]?r.insLeftOf(n[S]):r.insAtRightEnd(n.parent);else{var i=r.offset().left;t.seek(i,r)}G.queue(t,!0)},e.offset=function(){var e=this.jQ.removeClass("dcg-mq-cursor").offset();return this.jQ.addClass("dcg-mq-cursor"),e},e.unwrapGramp=function(){var t=this.parent.parent,r=t.parent,n=t[S],i=t[-1];if(t.disown().eachChild(function(e){e.isEmpty()||(e.children().adopt(r,i,n).each(function(e){e.jQ.insertBefore(t.jQ.first())}),i=e.ends[S])}),!this[S])if(this[-1])this[S]=this[-1][S];else for(;!this[S];){if(this.parent=this.parent[S],!this.parent){this[S]=t[S],this.parent=r;break}this[S]=this.parent.ends[-1]}this[S]?this.insLeftOf(this[S]):this.insAtRightEnd(r),t.jQ.remove(),t[-1].siblingDeleted&&t[-1].siblingDeleted(this.options,S),t[S].siblingDeleted&&t[S].siblingDeleted(this.options,-1)},e.startSelection=function(){for(var e=this.anticursor=b.copy(this),t=e.ancestors={},r=e;r.parent;r=r.parent)t[r.parent.id]=r},e.endSelection=function(){delete this.anticursor},e.select=function(){var e=this.anticursor;if(this[-1]===e[-1]&&this.parent===e.parent)return!1;for(var t=this;t.parent;t=t.parent)if(t.parent.id in e.ancestors){var r=t.parent;break}l("cursor and anticursor in the same tree",r);var n,i,o=e.ancestors[r.id],a=S;if(t[-1]!==o)for(var s=t;s;s=s[S])if(s[S]===o[S]){a=-1,n=t,i=o;break}return a===S&&(n=o,i=t),n instanceof b&&(n=n[S]),i instanceof b&&(i=i[-1]),this.hide().selection=r.selectChildren(n,i),this.insDirOf(a,this.selection.ends[a]),this.selectionChanged(),!0},e.resetToEnd=function(e){this.clearSelection();var t=e.root;this[S]=0,this[-1]=t.ends[S],this.parent=t},e.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},e.deleteSelection=function(){this.selection&&(this[-1]=this.selection.ends[-1][-1],this[S]=this.selection.ends[S][S],this.selection.remove(),this.selectionChanged(),delete this.selection)},e.replaceSelection=function(){var e=this.selection;return e&&(this[-1]=e.ends[-1][-1],this[S]=e.ends[S][S],delete this.selection),e}}),D=v(T,function(e,t){e.init=function(){t.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="dcg-mq-selection"></span>').parent()},e.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),t.adopt.apply(this,arguments)},e.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},e.join=function(r,e){var n=e||"";return this.fold("",function(e,t){return e+n+t[r]()})}}),A=v(function(e){e.init=function(e,t,r){this.id=e.id,this.data={},this.root=e,this.container=t,this.options=r,this.ariaLabel="Math Input",this.ariaPostLabel="",(e.controller=this).cursor=e.cursor=P(e,r)},e.handle=function(e,t){var r=this.options.handlers;if(r&&r.fns[e]){var n=r.APIClasses[this.KIND_OF_MQ](this);-1===t||t===S?r.fns[e](t,n):r.fns[e](n)}};var t=[];this.onNotify=function(e){t.push(e)},e.notify=function(){for(var e=0;e<t.length;e+=1)t[e].apply(this.cursor,arguments);return this}}),L={},O=v(),q={},F=v(),N={};u.prototype=F.p,u.VERSION="v0.10.1",u.interfaceVersion=function(e){if(1!==e)throw"Only interface version 1 supported. You specified: "+e;return(c=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (20142015)  v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),u};var R=(u.getInterface=e).MIN=1,B=e.MAX=2;u.noConflict=function(){return window.MathQuill=j,u};var j=window.MathQuill;window.MathQuill=u;var V=function(){function x(e){var t,r=e.which||e.keyCode,n=o[r],i=[];return e.ctrlKey&&i.push("Ctrl"),e.originalEvent&&e.originalEvent.metaKey&&i.push("Meta"),e.altKey&&i.push("Alt"),e.shiftKey&&i.push("Shift"),t=n||String.fromCharCode(r),i.length||n?(i.push(t),i.join("-")):t}var o={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(e,r){function n(e){v=e,clearTimeout(h),h=setTimeout(e)}function t(t){n(function(e){v=w,clearTimeout(h),t(e)})}function i(){try{m[0].select()}catch(e){}}function o(){r.options&&r.options.overrideKeystroke?r.options.overrideKeystroke(x(f),f):r.keystroke(x(f),f)}function a(e){f=e,g=null,b&&t(function(e){e&&"focusout"===e.type||i()}),o()}function s(e){if(!e||!e.originalEvent)return!1;switch(e.originalEvent.key){case"ArrowRight":case"ArrowLeft":case"ArrowDown":case"ArrowUp":return!0}return!1}function l(e){f&&g&&o(),s(g=e)||n(u)}function c(e){f&&!g&&(s(e)||n(u))}function u(){if(!("selectionStart"in(t=m[0])&&t.selectionStart!==t.selectionEnd)){var e=m.val();1===e.length?(m.val(""),r.options&&r.options.overrideTypedText?r.options.overrideTypedText(e):r.typedText(e)):e&&i()}var t}function p(){f=g=null}function d(){var e=m.val();m.val(""),e&&r.paste(e)}var h,f=null,g=null,m=_(e),y=_(r.container||m),v=w;y.bind("keydown keypress input keyup focusout paste",function(e){v(e)});var b=!1;return r.options&&r.options.disableCopyPaste?y.bind({keydown:a,keypress:l,keyup:c,focusout:p,copy:function(e){e.preventDefault()},cut:function(e){e.preventDefault()},paste:function(e){e.preventDefault()}}):y.bind({keydown:a,keypress:l,keyup:c,focusout:p,cut:function(){t(function(){r.cut()})},copy:function(){t(function(){r.copy()})},paste:function(e){m.focus(),n(d)}}),{select:function(e){v(),v=w,clearTimeout(h),m.val(e),e&&i(),b=!!e}}}}(),U=v(function(e,t,s){function r(e,t){throw"Parse Error: "+t+" at "+(e=e?"'"+e+"'":"EOF")}e.init=function(e){this._=e},e.parse=function(e){return this.skip(o)._(""+e,function(e,t){return t},r)},e.or=function(i){l("or is passed a parser",i instanceof s);var e=this;return s(function(t,r,n){return e._(t,r,function(e){return i._(t,r,n)})})},e.then=function(o){var t=this;return s(function(e,n,i){return t._(e,function(e,t){var r=o instanceof s?o:o(t);return l("a parser is returned",r instanceof s),r._(e,n,i)},i)})},e.many=function(){var a=this;return s(function(r,e,t){function n(e,t){return r=e,o.push(t),!0}function i(){return!1}for(var o=[];a._(r,n,i););return e(r,o)})},e.times=function(u,p){arguments.length<2&&(p=u);var d=this;return s(function(r,e,t){function n(e,t){return s.push(t),r=e,!0}function i(e,t){return a=t,r=e,!1}function o(e,t){return!1}for(var a,s=[],l=!0,c=0;c<u;c+=1)if(!(l=d._(r,n,i)))return t(r,a);for(;c<p&&l;c+=1)l=d._(r,n,o);return e(r,s)})},e.result=function(e){return this.then(i(e))},e.atMost=function(e){return this.times(0,e)},e.atLeast=function(e){var r=this;return r.times(e).then(function(t){return r.many().map(function(e){return t.concat(e)})})},e.map=function(t){return this.then(function(e){return i(t(e))})},e.skip=function(t){return this.then(function(e){return t.result(e)})};var n=(this.string=function(i){var o=i.length,a="expected '"+i+"'";return s(function(e,t,r){var n=e.slice(0,o);return n===i?t(e.slice(o),n):r(e,a)})},this.regex=function(o){l("regexp parser is anchored","^"===o.toString().charAt(1));var a="expected "+o;return s(function(e,t,r){var n=o.exec(e);if(n){var i=n[0];return t(e.slice(i.length),i)}return r(e,a)})}),i=s.succeed=function(r){return s(function(e,t){return t(e,r)})},o=(s.fail=function(n){return s(function(e,t,r){return r(e,n)})},s.letter=n(/^[a-z]/i),s.letters=n(/^[a-z]*/i),s.digit=n(/^[0-9]/),s.digits=n(/^[0-9]*/),s.whitespace=n(/^\s+/),s.optWhitespace=n(/^\s*/),s.any=s(function(e,t,r){return e?t(e.slice(1),e.charAt(0)):r(e,"expected any character")}),s.all=s(function(e,t,r){return t("",e)}),s.eof=s(function(e,t,r){return e?r(e,"expected EOF"):t(e,e)}))});A.open(function(e){e.focusBlurEvents=function(){function e(){clearTimeout(n),a.selection&&a.selection.jQ.addClass("dcg-mq-blur"),t()}function t(){a.hide().parent.blur(),i.container.removeClass("dcg-mq-focused"),E(window).unbind("blur",e),i.options&&i.options.resetCursorOnBlur&&a.resetToEnd(i)}function r(){var e=(i.ariaLabel+": "+o.mathspeak()+" "+i.ariaPostLabel).trim();G.jQ.empty(),i.textarea.attr("aria-label",e),i.container.attr("aria-label",e)}var n,i=this,o=i.root,a=i.cursor;i.textarea.focus(function(){r(),i.blurred=!1,clearTimeout(n),i.container.addClass("dcg-mq-focused"),a.parent||a.insAtRightEnd(o),a.selection?(a.selection.jQ.removeClass("dcg-mq-blur"),i.selectionChanged()):a.show(),i.setOverflowClasses()}).blur(function(){i.textareaSelectionTimeout&&(clearTimeout(i.textareaSelectionTimeout),i.textareaSelectionTimeout=m),i.blurred=!0,n=setTimeout(function(){o.postOrder(function(e){e.intentionalBlur()}),a.clearSelection().endSelection(),t(),r(),i.scrollHoriz()}),E(window).bind("blur",e)}),i.blurred=!0,a.hide().parent.blur()}}),A.open(function(e,t){e.exportText=function(){return this.root.foldChildren("",function(e,t){return e+t.text()})}}),A.open(function(e){var g;O.p.ignoreNextMousedown=w,this.onNotify(function(e){"edit"!==e&&"replace"!==e||g&&g.cursor===this&&g.cb()}),e.delegateMouseEvents=function(){var f=this.root.jQ;this.container.bind("mousedown.mathquill",function(e){function t(e){a=E(e.target)}function r(e){u.anticursor||u.startSelection(),c.seek(a,e.pageX,e.pageY).cursor.select(),u.selection&&G.clear().queue(u.selection.join("mathspeak")+" selected").alert(),a=m}function n(e){l.unbind("mousemove",t),E(e.target.ownerDocument).unbind("mousemove",r).unbind("mouseup",o),g=m}function i(){c.editable?(u.show(),G.queue(u.parent).alert()):d.detach()}function o(e){u.blink=p,u.selection||i(),n(e)}var a,s,l=E(e.target).closest(".dcg-mq-root-block"),c=(I.getNodeOfElement(l[0])||I.getNodeOfElement(f[0])).controller,u=c.cursor,p=u.blink,d=c.textareaSpan,h=c.textarea;(e.preventDefault(),e.target.unselectable=!0,u.options.ignoreNextMousedown(e))||(u.options.ignoreNextMousedown=w,g={cursor:u,cb:function(){s=!0,u.blink=p,u.clearSelection(),i(),n(e)}},c.blurred&&(c.editable||l.prepend(d),h.focus(),s)||(u.blink=w,c.seek(E(e.target),e.pageX,e.pageY).cursor.startSelection(),l.mousemove(t),E(e.target.ownerDocument).mousemove(r).mouseup(o)))})}}),A.open(function(e){e.seek=function(e,t,r){var n,i=this.notify("select").cursor,o=e&&e[0];return o&&((n=I.getNodeOfElement(o))||(n=I.getNodeOfElement(e.parentElement))),n||(n=this.root),l("nodeId is the id of some Node that exists",n),i.clearSelection().show(),n.seek(t,i),this.scrollHoriz(),this}}),A.open(function(e){e.keystroke=function(e,t){this.cursor.parent.keystroke(e,t,this)}}),I.open(function(e){e.keystroke=function(e,t,r){var n=r.cursor;switch(e){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":r.ctrlDeleteDir(-1);break;case"Shift-Backspace":case"Backspace":r.backspace();break;case"Esc":case"Tab":return void r.escapeDir(S,e,t);case"Shift-Tab":case"Shift-Esc":return void r.escapeDir(-1,e,t);case"End":r.notify("move").cursor.insAtRightEnd(n.parent),G.queue("end of").queue(n.parent,!0);break;case"Ctrl-End":r.notify("move").cursor.insAtRightEnd(r.root),G.queue("end of").queue(r.ariaLabel).queue(r.root).queue(r.ariaPostLabel);break;case"Shift-End":for(;n[S];)r.selectRight();break;case"Ctrl-Shift-End":for(;n[S]||n.parent!==r.root;)r.selectRight();break;case"Home":r.notify("move").cursor.insAtLeftEnd(n.parent),G.queue("beginning of").queue(n.parent,!0);break;case"Ctrl-Home":r.notify("move").cursor.insAtLeftEnd(r.root),G.queue("beginning of").queue(r.ariaLabel).queue(r.root).queue(r.ariaPostLabel);break;case"Shift-Home":for(;n[-1];)r.selectLeft();break;case"Ctrl-Shift-Home":for(;n[-1]||n.parent!==r.root;)r.selectLeft();break;case"Left":r.moveLeft();break;case"Shift-Left":r.selectLeft();break;case"Ctrl-Left":break;case"Right":r.moveRight();break;case"Shift-Right":r.selectRight();break;case"Ctrl-Right":break;case"Up":r.moveUp();break;case"Down":r.moveDown();break;case"Shift-Up":if(n[-1])for(;n[-1];)r.selectLeft();else r.selectLeft();case"Shift-Down":if(n[S])for(;n[S];)r.selectRight();else r.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":r.ctrlDeleteDir(S);break;case"Shift-Del":case"Del":r.deleteForward();break;case"Meta-A":case"Ctrl-A":for(r.notify("move").cursor.insAtRightEnd(r.root);n[-1];)r.selectLeft();break;case"Ctrl-Alt-Up":n.parent.parent&&n.parent.parent instanceof I?G.queue(n.parent.parent):G.queue("nothing above");break;case"Ctrl-Alt-Down":n.parent&&n.parent instanceof I?G.queue(n.parent):G.queue("block is empty");break;case"Ctrl-Alt-Left":n.parent.parent&&n.parent.parent.ends&&n.parent.parent.ends[-1]&&n.parent.parent.ends[-1]instanceof I?G.queue(n.parent.parent.ends[-1]):G.queue("nothing to the left");break;case"Ctrl-Alt-Right":n.parent.parent&&n.parent.parent.ends&&n.parent.parent.ends[S]&&n.parent.parent.ends[S]instanceof I?G.queue(n.parent.parent.ends[S]):G.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":n.selection?G.queue(n.selection.join("mathspeak"," ").trim()+" selected"):G.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":r.ariaPostLabel.length?G.queue(r.ariaPostLabel):G.queue("no answer");break;default:return}G.alert(),t.preventDefault(),r.scrollHoriz()},e.moveOutOf=e.moveTowards=e.deleteOutOf=e.deleteTowards=e.unselectInto=e.selectOutOf=e.selectTowards=function(){l("overridden or never called on this node")}}),A.open(function(e){function t(e,t){var r=e.notify("upDown").cursor,n=t+"Into",i=t+"OutOf";return r[S][n]?r.insAtLeftEnd(r[S][n]):r[-1][n]?r.insAtRightEnd(r[-1][n]):r.parent.bubble(function(e){var t=e[i];if(t&&("function"==typeof t&&(t=e[i](r)),t instanceof I&&r.jumpUpDown(e,t),!0!==t))return!1}),e}this.onNotify(function(e){"move"!==e&&"upDown"!==e||this.show().clearSelection()}),e.escapeDir=function(e,t,r){s(e);var n=this.cursor;if(n.parent!==this.root&&r.preventDefault(),n.parent!==this.root)return n.parent.moveOutOf(e,n),G.alert(),this.notify("move")},q.leftRightIntoCmdGoes=function(e){if(e&&"up"!==e&&"down"!==e)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+e+'"';return e},e.moveDir=function(e){s(e);var t=this.cursor,r=t.options.leftRightIntoCmdGoes;return t.selection?t.insDirOf(e,t.selection.ends[e]):t[e]?t[e].moveTowards(e,t,r):t.parent.moveOutOf(e,t,r),this.notify("move")},e.moveLeft=function(){return this.moveDir(-1)},e.moveRight=function(){return this.moveDir(S)},e.moveUp=function(){return t(this,"up")},e.moveDown=function(){return t(this,"down")},this.onNotify(function(e){"upDown"!==e&&(this.upDownCache={})}),this.onNotify(function(e){"edit"===e&&this.show().deleteSelection()}),e.deleteDir=function(e){s(e);var t=this.cursor,r=t[e],n=t.parent.parent;if(r&&r instanceof I)r.sides?G.queue(r.parent.chToCmd(r.sides[-e].ch).mathspeak({createdLeftOf:t})):r.blocks||"\\text"===r.parent.ctrlSeq||G.queue(r);else if(n&&n instanceof I)if(n.sides)G.queue(n.parent.chToCmd(n.sides[e].ch).mathspeak({createdLeftOf:t}));else if(n.blocks&&n.mathspeakTemplate)if(n.upInto&&n.downInto)G.queue(n.mathspeakTemplate[1]);else{var i=n.mathspeakTemplate,o=-1===e?i[0]:i[i.length-1];G.queue(o)}else G.queue(n);var a=t.selection;return this.notify("edit"),a||(t[e]?t[e].deleteTowards(e,t):t.parent.deleteOutOf(e,t)),t[-1].siblingDeleted&&t[-1].siblingDeleted(t.options,S),t[S].siblingDeleted&&t[S].siblingDeleted(t.options,-1),t.parent.bubble(function(e){e.reflow()}),this},e.ctrlDeleteDir=function(e){s(e);var t,r=this.cursor;return!r[e]||r.selection?this.deleteDir(e):(this.notify("edit"),t=-1===e?T(r.parent.ends[-1],r[-1]):T(r[S],r.parent.ends[S]),G.queue(t),t.remove(),r.insAtDirEnd(e,r.parent),r[-1].siblingDeleted&&r[-1].siblingDeleted(r.options,S),r[S].siblingDeleted&&r[S].siblingDeleted(r.options,-1),r.parent.bubble(function(e){e.reflow()}),this)},e.backspace=function(){return this.deleteDir(-1)},e.deleteForward=function(){return this.deleteDir(S)},this.onNotify(function(e){"select"!==e&&this.endSelection()}),e.selectDir=function(e){var t=this.notify("select").cursor,r=t.selection;s(e),t.anticursor||t.startSelection();var n=t[e];n?r&&r.ends[e]===n&&t.anticursor[-e]!==n?n.unselectInto(e,t):n.selectTowards(e,t):t.parent.selectOutOf(e,t),t.clearSelection(),t.select()||t.show(),t.selection&&G.clear().queue(t.selection.join("mathspeak"," ").trim()+" selected")},e.selectLeft=function(){return this.selectDir(-1)},e.selectRight=function(){return this.selectDir(S)}}),A.open(function(e){O.p.substituteTextarea=function(){return E("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true/>")[0]},e.createTextarea=function(){var e=this.textareaSpan=E('<span class="dcg-mq-textarea"></span>'),t=this.options.substituteTextarea();if(!t.nodeType)throw"substituteTextarea() must return a DOM element, got "+t;t=this.textarea=E(t).appendTo(e);var r=this;r.cursor.selectionChanged=function(){r.selectionChanged()}},e.selectionChanged=function(){var e=this;e.textareaSelectionTimeout===m&&(e.textareaSelectionTimeout=setTimeout(function(){e.setTextareaSelection()}))},e.setTextareaSelection=function(){this.textareaSelectionTimeout=m;var e="";this.cursor.selection&&(e=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(e="$"+e+"$")),this.selectFn(e)},e.staticMathTextareaEvents=function(){function e(){o.detach(),t.blurred=!0}var t=this,r=t.root,n=t.cursor,i=t.textarea,o=t.textareaSpan;this.container.prepend('<span aria-hidden="true" class="dcg-mq-selectable">$'+t.exportLatex()+"$</span>"),t.blurred=!0,i.bind("cut paste",!1),t.options.disableCopyPaste?i.bind("copy",!1):i.bind("copy",function(){t.setTextareaSelection()}),i.focus(function(){t.blurred=!1}).blur(function(){n.selection&&n.selection.clear(),setTimeout(e)}),t.selectFn=function(e){i.val(e),e&&i.select()};var a=t&&"Math Input"!==t.ariaLabel?t.ariaLabel+": ":"";t.container.attr("aria-label",a+r.mathspeak().trim())},O.p.substituteKeyboardEvents=V,e.editablesTextareaEvents=function(){var e=this.textarea,t=this.textareaSpan,r=this.options.substituteKeyboardEvents(e,this);this.selectFn=function(e){r.select(e)},this.container.prepend(t),this.focusBlurEvents()},e.typedText=function(e){if("\n"===e)return this.handle("enter");var t=this.notify().cursor;t.parent.write(t,e),this.scrollHoriz()},e.cut=function(){var e=this,t=e.cursor;t.selection&&setTimeout(function(){e.notify("edit"),t.parent.bubble(function(e){e.reflow()}),e.options&&e.options.onCut&&e.options.onCut()})},e.copy=function(){this.setTextareaSelection()},e.paste=function(e){this.options.statelessClipboard&&(e="$"===e.slice(0,1)&&"$"===e.slice(-1)?e.slice(1,-1):"\\text{"+e+"}"),this.writeLatex(e).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()}});var z=function(){function e(e){for(var t=e[0]||$(),r=1;r<e.length;r+=1)e[r].children().adopt(t,t.ends[S],0);return t}var t=U.string,r=U.regex,n=U.letter,i=U.any,o=U.optWhitespace,a=U.succeed,s=U.fail,l=n.map(function(e){return ee(e)}),c=r(/^[^${}\\_^]/).map(function(e){return Y(e)}),u=r(/^[^\\a-eg-zA-Z]/).or(t("\\").then(r(/^[a-z]+/i).or(r(/^\s+/).result(" ")).or(i))).then(function(e){var t=C[e];return t?t(e).parser():s("unknown command: \\"+e)}).or(l).or(c),p=t("{").then(function(){return h}).skip(t("}")),d=o.then(p.or(u.map(function(e){var t=$();return e.adopt(t,0,0),t}))),h=d.many().map(e).skip(o),f=t("[").then(d.then(function(e){return"]"!==e.join("latex")?a(e):s()}).many().map(e).skip(o)).skip(t("]")),g=h;return g.block=d,g.optBlock=f,g}();A.open(function(e,t){e.cleanLatex=function(e){return e.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},e.exportLatex=function(){return this.cleanLatex(this.root.latex())},e.writeLatex=function(e){var t=this.notify("edit").cursor,r=U.all,n=U.eof,i=z.skip(n).or(r.result(!1)).parse(e);i&&!i.isEmpty()&&(i.children().adopt(t.parent,t[-1],t[S]),i.jQize().insertBefore(t.jQ),t[-1]=i.ends[S],i.finalizeInsert(t.options,t),i.ends[S][S].siblingCreated&&i.ends[S][S].siblingCreated(t.options,-1),i.ends[-1][-1].siblingCreated&&i.ends[-1][-1].siblingCreated(t.options,S),t.parent.bubble(function(e){e.reflow()}));return this},e.classifyLatexForEfficientUpdate=function(e){if("string"==typeof e){var t=e.match(/-?[0-9.]+$/g);return t&&1===t.length?{latex:e,prefix:e.substr(0,e.length-t[0].length),digits:t[0]}:void 0}},e.renderLatexMathEfficiently=function(e){var t,r,n=this.classifyLatexForEfficientUpdate(e);if(!n)return!1;if(t=this.exportLatex(),!(r=this.classifyLatexForEfficientUpdate(t))||r.prefix!==n.prefix)return!1;var i=this.root,o=r.digits,a=n.digits,s=!1,l=!1;"-"===o[0]&&(s=!0,o=o.substr(1)),"-"===a[0]&&(l=!0,a=a.substr(1));for(var c=this.root.ends[S],u=[],p=o.length-1;0<=p;p--){if(c.ctrlSeq!==o[p])return!1;if(c.parent!==i)return!1;u.unshift(c),c=c[-1]}if(s&&!l){var d=c;if("-"!==d.ctrlSeq)return!1;if(d[S]!==u[0])return!1;if(d.parent!==i)return!1;if(d[-1]&&d[-1].parent!==i)return!1;u[0][-1]=d[-1],i.ends[-1]===d&&(i.ends[-1]=u[0]),d[-1]&&(d[-1][S]=u[0]),d.jQ.remove()}if(!s&&l){var h=le("-"),f=document.createElement("span");f.textContent="-",h.jQ=E(f),u[0][-1]&&(u[0][-1][S]=h),i.ends[-1]===u[0]&&(i.ends[-1]=h),h.parent=i,h[-1]=u[0][-1],h[S]=u[0],(u[0][-1]=h).contactWeld(),h.jQ.insertBefore(u[0].jQ)}var g=Math.min(o.length,a.length);for(p=0;p<g;p++){var m=a[p];(c=u[p]).ctrlSeq!==m&&(c.ctrlSeq=m,c.jQ[0].textContent=m,c.mathspeakName=m)}if(o.length>a.length)for(c=u[a.length-1],(i.ends[S]=c)[S]=0,p=o.length-1;g<=p;p--)u[p].jQ.remove();if(a.length>o.length){var y=document.createDocumentFragment();for(p=g;p<a.length;p++){var v=document.createElement("span");v.textContent=a[p];var b=Z(a[p]);b.parent=i,b.jQ=E(v),y.appendChild(v),b[-1]=i.ends[S],b[S]=0,b[-1][S]=b,i.ends[S]=b}i.jQ[0].appendChild(y)}var x=this.exportLatex();return x!==e?(console.warn("tried updating latex efficiently but did not work. Attempted: "+e+" but wrote: "+x),!1):(this.cursor.resetToEnd(this),!0)},e.renderLatexMathFromScratch=function(e){var t=this.root,r=this.cursor,n=U.all,i=U.eof,o=z.skip(i).or(n.result(!1)).parse(e);t.ends[-1]=t.ends[S]=0,o&&o.children().adopt(t,0,0);var a=t.jQ;if(o){var s=o.join("html");a.html(s),t.jQize(a.children()),t.finalizeInsert(r.options)}else a.empty();var l=this.ariaLabel&&"Math Input"!==this.ariaLabel?this.ariaLabel+": ":"";this.container.attr("aria-label",l+t.mathspeak().trim()),delete r.selection,r.insAtRightEnd(t)},e.renderLatexMath=function(e){this.notify("replace"),this.renderLatexMathEfficiently(e)||this.renderLatexMathFromScratch(e)},e.renderLatexText=function(e){var t=this.root,n=this.cursor;t.jQ.children().slice(1).remove(),t.ends[-1]=t.ends[S]=0,delete n.selection,n.show().insAtRightEnd(t);var r=U.regex,i=U.string,o=U.eof,a=U.all,s=i("$").then(z).skip(i("$").or(o)).map(function(e){var t=RootMathCommand(n);t.createBlocks();var r=t.ends[-1];return e.children().adopt(r,0,0),t}),l=i("\\$").result("$").or(r(/^[^$]/)).map(Y),c=s.or(l).many().skip(o).or(a.result(!1)).parse(e);if(c){for(var u=0;u<c.length;u+=1)c[u].adopt(t,t.ends[S],0);t.jQize().appendTo(t.jQ),t.finalizeInsert(n.options)}}}),A.open(function(e){e.setOverflowClasses=function(){var e=this.root.jQ[0],t=!1,r=!1;if(!this.blurred){var n=e.getBoundingClientRect().width,i=e.scrollWidth,o=e.scrollLeft;t=n+o<i,r=0<o}e.classList.contains("dcg-mq-editing-overflow-right")!==t&&e.classList.toggle("dcg-mq-editing-overflow-right"),e.classList.contains("dcg-mq-editing-overflow-left")!==r&&e.classList.toggle("dcg-mq-editing-overflow-left")},e.scrollHoriz=function(){var e=this.cursor,t=e.selection,r=this.root.jQ[0].getBoundingClientRect();if(e.jQ[0]||t){if(t){var n=t.jQ[0].getBoundingClientRect(),i=n.left-(r.left+20),o=n.right-(r.right-20);if(t.ends[-1]===e[S])if(i<0)var a=i;else{if(!(0<o))return;if(n.left-o<r.left+20)a=i;else a=o}else if(0<o)a=o;else{if(!(i<0))return;if(n.right-i>r.right-20)a=o;else a=i}}else{var s=e.jQ[0].getBoundingClientRect().left;if(s>r.right-20)a=s-(r.right-20);else{if(!(s<r.left+20))return;a=s-(r.left+20)}}var l=this.root.jQ[0];a<0&&0===l.scrollLeft||0<a&&l.scrollWidth<=l.scrollLeft+r.width||this.root.jQ.stop().animate({scrollLeft:"+="+a},100,function(){this.setOverflowClasses()}.bind(this))}else this.root.jQ.stop().animate({scrollLeft:0},100,function(){this.setOverflowClasses()}.bind(this))}});var G=v(function(e){e.init=function(){this.jQ=_([]),_(document).ready(function(){var e=".dcg-mq-aria-alert";_(e).length||_("body").append("<p aria-live='assertive' aria-atomic='true' class='dcg-mq-aria-alert'></p>"),this.jQ=_(e)}.bind(this)),this.items=[],this.msg=""},e.queue=function(e,t){return e instanceof I&&(e=t?e.parent&&e.parent.ariaLabel&&"block"===e.ariaLabel?e.parent.ariaLabel+" "+e.mathspeak():e.ariaLabel?e.ariaLabel+" "+e.mathspeak():e.mathspeak():e.mathspeak()),this.items.push(e),this},e.queueDirOf=function(e){return s(e),this.queue(-1===e?"before":"after")},e.queueDirEndOf=function(e){return s(e),this.queue(-1===e?"beginning of":"end of")},e.alert=function(e){return e&&this.queue(e),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.jQ.empty().text(this.msg)),this.clear()},e.clear=function(){return this.items.length=0,this}})();A.open(function(e){e.aria=G,e.exportMathSpeak=function(){return this.root.mathspeak()}});var H=v(I,function(e,t){e.finalizeInsert=function(t,r){this.postOrder(function(e){e.finalizeTree(t)}),this.postOrder(function(e){e.contactWeld(r)}),this.postOrder(function(e){e.blur()}),this.postOrder(function(e){e.reflow()}),this[S].siblingCreated&&this[S].siblingCreated(t,-1),this[-1].siblingCreated&&this[-1].siblingCreated(t,S),this.bubble(function(e){e.reflow()})}}),W=v(H,function(e,n){e.init=function(e,t,r){n.init.call(this),this.ctrlSeq||(this.ctrlSeq=e),t&&(this.htmlTemplate=t),r&&(this.textTemplate=r)},e.replaces=function(e){e.disown(),this.replacedFragment=e},e.isEmpty=function(){return this.foldChildren(!0,function(e,t){return e&&t.isEmpty()})},e.parser=function(){var e=z.block,r=this;return e.times(r.numBlocks()).map(function(e){r.blocks=e;for(var t=0;t<e.length;t+=1)e[t].adopt(r,r.ends[S],0);return r})},e.createLeftOf=function(e){var t=this.replacedFragment;this.createBlocks(),n.createLeftOf.call(this,e),t&&(t.adopt(this.ends[-1],0,0),t.jQ.appendTo(this.ends[-1].jQ)),this.finalizeInsert(e.options),this.placeCursor(e)},e.createBlocks=function(){for(var e=this.numBlocks(),t=this.blocks=Array(e),r=0;r<e;r+=1){(t[r]=$()).adopt(this,this.ends[S],0)}},e.placeCursor=function(e){e.insAtRightEnd(this.foldChildren(this.ends[-1],function(e,t){return e.isEmpty()?e:t}))},e.moveTowards=function(e,t,r){var n=r&&this[r+"Into"];t.insAtDirEnd(-e,n||this.ends[-e]),G.queueDirEndOf(-e).queue(t.parent,!0)},e.deleteTowards=function(e,t){this.isEmpty()?t[e]=this.remove()[e]:this.moveTowards(e,t,null)},e.selectTowards=function(e,t){t[-e]=this,t[e]=this[e]},e.selectChildren=function(){return D(this,this)},e.unselectInto=function(e,t){t.insAtDirEnd(-e,t.anticursor.ancestors[this.id])},e.seek=function(r,n){function i(e){var t={};return t[-1]=e.jQ.offset().left,t[S]=t[-1]+e.jQ.outerWidth(),t}var o=this,a=i(o);if(r<a[-1])return n.insLeftOf(o);if(r>a[S])return n.insRightOf(o);var s=a[-1];o.eachChild(function(e){var t=i(e);return r<t[-1]?(r-s<t[-1]-r?e[-1]?n.insAtRightEnd(e[-1]):n.insLeftOf(o):n.insAtLeftEnd(e),!1):r>t[S]?void(e[S]?s=t[S]:a[S]-r<r-t[S]?n.insRightOf(o):n.insAtRightEnd(e)):(e.seek(r,n),!1)})},e.numBlocks=function(){var e=this.htmlTemplate.match(/&\d+/g);return e?e.length:0},e.html=function(){var r=this.blocks,e=" mathquill-command-id="+this.id,t=this.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);l("no unmatched angle brackets",t.join("")===this.htmlTemplate);for(var n=0,i=t[0];i;i=t[n+=1])if("/>"===i.slice(-2))t[n]=i.slice(0,-2)+e+' aria-hidden="true"/>';else if("<"===i.charAt(0)){l("not an unmatched top-level close tag","/"!==i.charAt(1)),t[n]=i.slice(0,-1)+e+' aria-hidden="true">';for(var o=1;l("no missing close tags",i=t[n+=1]),"</"===i.slice(0,2)?o-=1:"<"===i.charAt(0)&&"/>"!==i.slice(-2)&&(o+=1),0<o;);}return t.join("").replace(/>&(\d+)/g,function(e,t){return" mathquill-block-id="+r[t].id+' aria-hidden="true">'+r[t].join("html")})},e.latex=function(){return this.foldChildren(this.ctrlSeq,function(e,t){return e+"{"+(t.latex()||" ")+"}"})},e.textTemplate=[""],e.text=function(){var n=this,i=0;return n.foldChildren(n.textTemplate[i],function(e,t){i+=1;var r=t.text();return e&&"("===n.textTemplate[i]&&"("===r[0]&&")"===r.slice(-1)?e+r.slice(1,-1)+n.textTemplate[i]:e+r+(n.textTemplate[i]||"")})},e.mathspeakTemplate=[],e.mathspeak=function(){var r=this,n=0;return r.foldChildren(r.mathspeakTemplate[n]||"Start"+r.ctrlSeq+" ",function(e,t){return n+=1,e+" "+t.mathspeak()+" "+(r.mathspeakTemplate[n]+" "||"End"+r.ctrlSeq+" ")})}}),K=v(W,function(e,i){e.init=function(e,t,r,n){r||(r=e&&1<e.length?e.slice(1):e),this.mathspeakName=n||r,i.init.call(this,e,t,[r])},e.parser=function(){return U.succeed(this)},e.numBlocks=function(){return 0},e.replaces=function(e){e.remove()},e.createBlocks=w,e.moveTowards=function(e,t){t.jQ.insDirOf(e,this.jQ),t[-e]=this,t[e]=this[e],G.queue(this)},e.deleteTowards=function(e,t){t[e]=this.remove()[e]},e.seek=function(e,t){e-this.jQ.offset().left<this.jQ.outerWidth()/2?t.insLeftOf(this):t.insRightOf(this)},e.latex=function(){return this.ctrlSeq},e.text=function(){return this.textTemplate.join("")},e.mathspeak=function(){return this.mathspeakName},e.placeCursor=w,e.isEmpty=function(){return!0}}),Y=v(K,function(e,n){e.init=function(e,t,r){n.init.call(this,e,"<span>"+(t||e)+"</span>",m,r)}}),X=v(K,function(e,i){e.init=function(e,t,r,n){i.init.call(this,e,'<span class="dcg-mq-binary-operator">'+t+"</span>",r,n)}}),$=v(H,function(e,n){e.join=function(r){return this.foldChildren("",function(e,t){return e+t[r]()})},e.html=function(){return this.join("html")},e.latex=function(){return this.join("latex")},e.text=function(){return this.ends[-1]===this.ends[S]&&0!==this.ends[-1]?this.ends[-1].text():this.join("text")},e.mathspeak=function(){var o="",a={};return this.controller&&(a=this.controller.options.autoOperatorNames),this.foldChildren([],function(e,t){if(t.isPartOfOperator)o+=t.mathspeak();else{if(""!==o){if(a!=={}&&0<a._maxLength){var r=a[o.toLowerCase()];"string"==typeof r&&(o=r)}e.push(o+" "),o=""}var n=t.mathspeak(),i=t.ctrlSeq;isNaN(i)&&(n=" "+n,"."!==i&&(n+=" ")),e.push(n)}return e}).join("").replace(/ +(?= )/g,"")},e.ariaLabel="block",e.keystroke=function(e,t,r){return!r.options.spaceBehavesLikeTab||"Spacebar"!==e&&"Shift-Spacebar"!==e?n.keystroke.apply(this,arguments):(t.preventDefault(),void r.escapeDir("Shift-Spacebar"===e?-1:S,e,t))},e.moveOutOf=function(e,t,r){!(r&&this.parent[r+"Into"])&&this[e]?(t.insAtDirEnd(-e,this[e]),G.queueDirEndOf(-e).queue(t.parent,!0)):(t.insDirOf(e,this.parent),G.queueDirOf(e).queue(this.parent))},e.selectOutOf=function(e,t){t.insDirOf(e,this.parent)},e.deleteOutOf=function(e,t){t.unwrapGramp()},e.seek=function(e,t){var r=this.ends[S];if(!r||r.jQ.offset().left+r.jQ.outerWidth()<e)return t.insAtRightEnd(this);if(e<this.ends[-1].jQ.offset().left)return t.insAtLeftEnd(this);for(;e<r.jQ.offset().left;)r=r[-1];return r.seek(e,t)},e.chToCmd=function(e,t){var r;return e.match(/^[a-eg-zA-Z]$/)?ee(e):/^\d$/.test(e)?Z(e):t&&t.typingSlashWritesDivisionSymbol&&"/"===e?C[""](e):t&&t.typingAsteriskWritesTimesSymbol&&"*"===e?C[""](e):t&&t.typingPercentWritesPercentOf&&"%"===e?C.percentof(e):(r=k[e]||C[e])?r(e):Y(e)},e.write=function(e,t){var r=this.chToCmd(t,e.options);e.selection&&r.replaces(e.replaceSelection()),r.createLeftOf(e.show()),"/"===t?G.alert("over"):G.alert(r.mathspeak({createdLeftOf:e}))},e.focus=function(){return this.jQ.addClass("dcg-mq-hasCursor"),this.jQ.removeClass("dcg-mq-empty"),this},e.blur=function(){return this.jQ.removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.jQ.addClass("dcg-mq-empty"),this.isEmptyParens()&&this.jQ.addClass("dcg-mq-empty-parens")),this}});L.StaticMath=function(n){return v(n.AbstractMathQuill,function(e,r){this.RootBlock=$,e.__mathquillify=function(e,t){return this.config(e),r.__mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){r.init.apply(this,arguments);var t=this.innerFields=[];this.__controller.root.postOrder(function(e){e.registerInnerField(t,n.MathField)})},e.latex=function(){var e=r.latex.apply(this,arguments);if(0<arguments.length){var t=this.innerFields=[];this.__controller.root.postOrder(function(e){e.registerInnerField(t,n.MathField)})}return e},e.setAriaLabel=function(e){this.__controller.ariaLabel="string"==typeof e?e:"";var t="Math Input"!==this.__controller.ariaLabel?this.__controller.ariaLabel+": ":"";return this.__controller.container.attr("aria-label",t+this.__controller.root.mathspeak().trim()),this},e.getAriaLabel=function(){return this.__controller.ariaLabel||""}})};var Q=v($,p);L.MathField=function(e){return v(e.EditableField,function(e,r){this.RootBlock=Q,e.__mathquillify=function(e,t){return this.config(e),1<t&&(this.__controller.root.reflow=w),r.__mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this}})};var Z=v(Y,function(e,r){e.createLeftOf=function(e){e.options.autoSubscriptNumerals&&e.parent!==e.parent.parent.sub&&(e[-1]instanceof J&&!1!==e[-1].isItalic||e[-1]instanceof ge&&e[-1][-1]instanceof J&&!1!==e[-1][-1].isItalic)?(C._().createLeftOf(e),r.createLeftOf.call(this,e),e.insRightOf(e.parent.parent)):r.createLeftOf.call(this,e)},e.mathspeak=function(e){if(e&&e.createdLeftOf){var t=e.createdLeftOf;if(t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[-1]instanceof J&&!1!==t[-1].isItalic||t[-1]instanceof ge&&t[-1][-1]instanceof J&&!1!==t[-1][-1].isItalic))return"Subscript "+r.mathspeak.call(this)+" Baseline"}return r.mathspeak.apply(this,arguments)}}),J=v(K,function(e,r){e.init=function(e,t){r.init.call(this,e,"<var>"+(t||e)+"</var>")},e.text=function(){var e=this.ctrlSeq;return this.isPartOfOperator?"\\"==e[0]?e=e.slice(1,e.length):" "==e[e.length-1]&&(e=e.slice(0,-1)):(!this[-1]||this[-1]instanceof J||this[-1]instanceof X||"\\ "===this[-1].ctrlSeq||(e="*"+e),!this[S]||this[S]instanceof X||this[S]instanceof ge||(e+="*")),e},e.mathspeak=function(){var e=this.ctrlSeq;return this.isPartOfOperator||1!==e.length?r.mathspeak.call(this):'"'+e+'"'}});O.p.autoCommands={_maxLength:0},q.autoCommands=function(e){if(!/^[a-z]+(?: [a-z]+)*$/i.test(e))throw'"'+e+'" not a space-delimited list of only letters';for(var t=e.split(" "),r={},n=0,i=0;i<t.length;i+=1){var o=t[i];if(o.length<2)throw'autocommand "'+o+'" not minimum length of 2';if(C[o]===ie)throw'"'+o+'" is a built-in operator name';r[o]=1,n=f(n,o.length)}return r._maxLength=n,r},O.p.autoParenthesizedFunctions={_maxLength:0},q.autoParenthesizedFunctions=function(e){if(!/^[a-z]+(?: [a-z]+)*$/i.test(e))throw'"'+e+'" not a space-delimited list of only letters';for(var t=e.split(" "),r={},n=0,i=0;i<t.length;i+=1){var o=t[i];if(o.length<2)throw'autocommand "'+o+'" not minimum length of 2';r[o]=1,n=f(n,o.length)}return r._maxLength=n,r};var ee=v(J,function(e,t){function f(e){return!e||e instanceof X||e instanceof me}e.init=function(e){return t.init.call(this,this.letter=e)},e.checkAutoCmds=function(e){var t=e.options.autoCommands,r=t._maxLength;if(0<r){for(var n="",i=this,o=0;i instanceof ee&&i.ctrlSeq===i.letter&&o<r;)n=i.letter+n,i=i[-1],o+=1;for(;n.length;){if(t.hasOwnProperty(n)){for(o=1,i=this;o<n.length;o+=1,i=i[-1]);return T(i,this).remove(),e[-1]=i[-1],C[n](n).createLeftOf(e)}n=n.slice(1)}}},e.autoParenthesize=function(e){var t=e.parent.ends[S];if(!(t&&t instanceof _e&&"\\left("===t.ctrlSeq)){for(var r="",n=this,i=0,o=e.options.autoParenthesizedFunctions,a=o._maxLength,s=e.options.autoOperatorNames;n instanceof ee&&i<a;)r=n.letter+r,n=n[-1],i+=1;for(;r.length;){if(o.hasOwnProperty(r)&&s.hasOwnProperty(r))return e.parent.write(e,"(");r=r.slice(1)}}},e.createLeftOf=function(e){t.createLeftOf.apply(this,arguments),this.checkAutoCmds(e),this.autoParenthesize(e)},e.italicize=function(e){return this.isItalic=e,this.isPartOfOperator=!e,this.jQ.toggleClass("dcg-mq-operator-name",!e),this},e.finalizeTree=e.siblingDeleted=e.siblingCreated=function(e,t){-1!==t&&this[S]instanceof ee||this.autoUnItalicize(e)},e.autoUnItalicize=function(e){var t=e.autoOperatorNames;if(0!==t._maxLength){for(var r=this.letter,n=this[-1];n instanceof ee;n=n[-1])r=n.letter+r;for(var i=this[S];i instanceof ee;i=i[S])r+=i.letter;T(n[S]||this.parent.ends[-1],i[-1]||this.parent.ends[S]).each(function(e){e.italicize(!0).jQ.removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),e.ctrlSeq=e.letter});e:for(var o=0,a=n[S]||this.parent.ends[-1];o<r.length;o+=1,a=a[S])for(var s=g(t._maxLength,r.length-o);0<s;s-=1){var l=r.slice(o,o+s);if(t.hasOwnProperty(l)){for(var c=0,u=a;c<s;c+=1,u=u[S]){u.italicize(!1);var p=u}var d=te.hasOwnProperty(l);if(a.ctrlSeq=(d?"\\":"\\operatorname{")+a.ctrlSeq,p.ctrlSeq+=d?" ":"}",ne.hasOwnProperty(l)&&p[-1][-1][-1].jQ.addClass("dcg-mq-last"),f(a[-1])||a.jQ.addClass("dcg-mq-first"),!f(p[S]))if(p[S]instanceof ge){var h=p[S];(h.siblingCreated=h.siblingDeleted=function(){h.jQ.toggleClass("dcg-mq-after-operator-name",!(h[S]instanceof _e))})()}else p.jQ.toggleClass("dcg-mq-last",!(p[S]instanceof _e));o+=s-1,a=p;continue e}}}}}),te={},re=O.p.autoOperatorNames={_maxLength:9},ne={limsup:1,liminf:1,projlim:1,injlim:1};!function(){for(var e="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),t=0;t<e.length;t+=1)te[e[t]]=re[e[t]]=1;var r="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");for(t=0;t<r.length;t+=1)te[r[t]]=1;var n="sin cos tan sec cosec csc cotan cot ctg".split(" ");for(t=0;t<n.length;t+=1)re[n[t]]=re["arc"+n[t]]=re[n[t]+"h"]=re["ar"+n[t]+"h"]=re["arc"+n[t]+"h"]=1;var i="gcf hcf lcm proj span".split(" ");for(t=0;t<i.length;t+=1)re[i[t]]=1}(),q.autoOperatorNames=function(e){if("string"!=typeof e)throw'"'+e+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(e))throw'"'+e+'" not a space-delimited list of letters or "|"';for(var t=e.split(" "),r={},n=0,i=0;i<t.length;i+=1){var o=t[i];if(o.length<2)throw'"'+o+'" not minimum length of 2';if(o.indexOf("|")<0)r[o]=o,n=f(n,o.length);else{var a=o.split("|");if(2<a.length)throw'"'+o+'" has more than 1 mathspeak delimiter';if(a[0].length<2)throw'"'+o[0]+'" not minimum length of 2';r[a[0]]=a[1].replace(/-/g," "),n=f(n,a[0].length)}}return r._maxLength=n,r};var ie=v(K,function(e,t){e.init=function(e){this.ctrlSeq=e},e.createLeftOf=function(e){for(var t=this.ctrlSeq,r=0;r<t.length;r+=1)ee(t.charAt(r)).createLeftOf(e)},e.parser=function(){for(var e=this.ctrlSeq,t=$(),r=0;r<e.length;r+=1)ee(e.charAt(r)).adopt(t,t.ends[S],0);return U.succeed(t.children())}});for(var oe in re)re.hasOwnProperty(oe)&&(C[oe]=ie);C.operatorname=v(W,function(e){e.createLeftOf=w,e.numBlocks=function(){return 1},e.parser=function(){return z.block.map(function(e){var t=!0,r="",n=e.children();return n.each(function(e){e instanceof ee?r+=e.letter:t=!1}),t&&"ans"===r?C[r](r):n})}}),C.f=v(ee,function(e,t){e.init=function(){K.p.init.call(this,this.letter="f",'<var class="dcg-mq-f">f</var>')},e.italicize=function(e){return this.jQ.html("f").toggleClass("dcg-mq-f",e),t.italicize.apply(this,arguments)}}),C[" "]=C.space=o(Y,"\\ ","&nbsp;","space"),C["'"]=C.prime=o(Y,"'","&prime;","prime"),C[""]=C.dprime=o(Y,"","&Prime;","double prime"),C.backslash=o(Y,"\\backslash ","\\","backslash"),k["\\"]||(k["\\"]=C.backslash),C.$=o(Y,"\\$","$","dollar"),C.square=o(Y,"\\square ","","square"),C.mid=o(Y,"\\mid ","","mid");var ae=v(K,function(e,r){e.init=function(e,t){r.init.call(this,e,'<span class="dcg-mq-nonSymbola">'+(t||e)+"</span>")}});C["@"]=ae,C["&"]=o(ae,"\\&","&amp;","and"),C["%"]=v(ae,function(e,r){e.init=function(){r.init.call(this,"\\%","%","percent")},e.parser=function(){var e=U.optWhitespace,t=U.string;return e.then(t("\\operatorname{of}").map(function(){return C.percentof()})).or(r.parser.call(this))}}),C[""]=C.parallel=o(Y,"\\parallel ","&#x2225;","parallel"),C[""]=C.nparallel=o(Y,"\\nparallel ","&#x2226;","not parallel"),C[""]=C.perp=o(Y,"\\perp ","&#x27C2;","perpendicular"),C.alpha=C.beta=C.gamma=C.delta=C.zeta=C.eta=C.theta=C.iota=C.kappa=C.mu=C.nu=C.xi=C.rho=C.sigma=C.tau=C.chi=C.psi=C.omega=v(J,function(e,t){e.init=function(e){t.init.call(this,"\\"+e+" ","&"+e+";")}}),C.phi=o(J,"\\phi ","&#981;","phi"),C.phiv=C.varphi=o(J,"\\varphi ","&phi;","phi"),C.epsilon=o(J,"\\epsilon ","&#1013;","epsilon"),C.epsiv=C.varepsilon=o(J,"\\varepsilon ","&epsilon;","epsilon"),C.piv=C.varpi=o(J,"\\varpi ","&piv;","piv"),C.sigmaf=C.sigmav=C.varsigma=o(J,"\\varsigma ","&sigmaf;","sigma"),C.thetav=C.vartheta=C.thetasym=o(J,"\\vartheta ","&thetasym;","theta"),C.upsilon=C.upsi=o(J,"\\upsilon ","&upsilon;","upsilon"),C.gammad=C.Gammad=C.digamma=o(J,"\\digamma ","&#989;","gamma"),C.kappav=C.varkappa=o(J,"\\varkappa ","&#1008;","kappa"),C.rhov=C.varrho=o(J,"\\varrho ","&#1009;","rho"),C.pi=C[""]=o(ae,"\\pi ","&pi;","pi"),C.lambda=o(ae,"\\lambda ","&lambda;","lambda"),C.Upsilon=C.Upsi=C.upsih=C.Upsih=o(K,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>',"capital upsilon"),C.Gamma=C.Delta=C.Theta=C.Lambda=C.Xi=C.Pi=C.Sigma=C.Phi=C.Psi=C.Omega=C.forall=v(Y,function(e,t){e.init=function(e){t.init.call(this,"\\"+e+" ","&"+e+";")}});var se=v(W,function(e){e.init=function(e){this.latex=e},e.createLeftOf=function(e){var t=z.parse(this.latex);t.children().adopt(e.parent,e[-1],e[S]),e[-1]=t.ends[S],t.jQize().insertBefore(e.jQ),t.finalizeInsert(e.options,e),t.ends[S][S].siblingCreated&&t.ends[S][S].siblingCreated(e.options,-1),t.ends[-1][-1].siblingCreated&&t.ends[-1][-1].siblingCreated(e.options,S),e.parent.bubble(function(e){e.reflow()})},e.mathspeak=function(){return z.parse(this.latex).mathspeak()},e.parser=function(){var e=z.parse(this.latex).children();return U.succeed(e)}});C[""]=o(se,"^1"),C[""]=o(se,"^2"),C[""]=o(se,"^3"),C[""]=o(se,"\\frac14"),C[""]=o(se,"\\frac12"),C[""]=o(se,"\\frac34");var le=v(X,function(e){e.init=Y.prototype.init,e.contactWeld=e.siblingCreated=e.siblingDeleted=function(e,t){if(t!==S)return this.jQ[0].className=function e(t){return t[-1]?t[-1]instanceof X||/^[,;:\(\[]$/.test(t[-1].ctrlSeq)?"":"dcg-mq-binary-operator":t.parent&&t.parent.parent&&t.parent.parent.isStyleBlock()?e(t.parent.parent):""}(this),this}});C["+"]=o(le,"+","+","plus"),C[""]=C[""]=C[""]=C["-"]=o(le,"-","&minus;","minus"),C[""]=C.pm=C.plusmn=C.plusminus=o(le,"\\pm ","&plusmn;","plus-or-minus"),C.mp=C.mnplus=C.minusplus=o(le,"\\mp ","&#8723;","minus-or-plus"),k["*"]=C.sdot=C.cdot=o(X,"\\cdot ","&middot;","*","times");var ce=v(X,function(e,n){e.init=function(e,t){this.data=e;var r=(this.strict=t)?"Strict":"";n.init.call(this,e["ctrlSeq"+r],e["html"+r],e["text"+r],e["mathspeak"+r])},e.swap=function(e){var t=(this.strict=e)?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+t],this.jQ.html(this.data["html"+t]),this.textTemplate=[this.data["text"+t]],this.mathspeakName=this.data["mathspeak"+t]},e.deleteTowards=function(e,t){return-1!==e||this.strict?void n.deleteTowards.apply(this,arguments):(this.swap(!0),void this.bubble(function(e){e.reflow()}))}}),ue={ctrlSeq:"\\le ",html:"&le;",text:"",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},pe={ctrlSeq:"\\ge ",html:"&ge;",text:"",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"};C["<"]=C.lt=o(ce,ue,!0),C[">"]=C.gt=o(ce,pe,!0),C[""]=C.le=C.leq=o(ce,ue,!1),C[""]=C.ge=C.geq=o(ce,pe,!1);var de=v(X,function(e,t){e.init=function(){t.init.call(this,"=","=","=","equals")},e.createLeftOf=function(e){return e[-1]instanceof ce&&e[-1].strict?(e[-1].swap(!1),void e[-1].bubble(function(e){e.reflow()})):void t.createLeftOf.apply(this,arguments)}});C["="]=de,C[""]=C.times=o(X,"\\times ","&times;","[x]","times"),C[""]=C.div=C.divide=C.divides=o(X,"\\div ","&divide;","[/]","over"),k["~"]=C.sim=o(X,"\\sim ","~","~","tilde");var he={sqrt:{html:'<svg preserveAspectRatio="none" viewBox="0 0 32 54"><path d="M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33" /></svg>'},"|":{width:".4em",html:'<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M4.4 0 L4.4 54 L5.6 54 L5.6 0" /></svg>'},"[":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="0 0 11 24"><path d="M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1" /></svg>'},"]":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="0 0 11 24"><path d="M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1" /></svg>'},"(":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="3 0 106 186"><path d="M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0" /></svg>'},")":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="3 0 106 186"><path d="M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0" /></svg>'},"{":{width:".7em",html:'<svg preserveAspectRatio="none" viewBox="10 0 210 350"><path d="M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0" /></svg>'},"}":{width:".7em",html:'<svg preserveAspectRatio="none" viewBox="10 0 210 350"><path d="M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0" /></svg>'},"&#8741;":{width:".7em",html:'<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0" /></svg>'},"&lang;":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0" /></svg>'},"&rang;":{width:".55em",html:'<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0" /></svg>'}},fe=v(W,function(e,n){e.init=function(e,t,r){n.init.call(this,e,"<"+t+" "+r+">&0</"+t+">")}});C.mathrm=o(fe,"\\mathrm","span",'class="dcg-mq-roman dcg-mq-font"'),C.mathit=o(fe,"\\mathit","i",'class="dcg-mq-font"'),C.mathbf=o(fe,"\\mathbf","b",'class="dcg-mq-font"'),C.mathsf=o(fe,"\\mathsf","span",'class="dcg-mq-sans-serif dcg-mq-font"'),C.mathtt=o(fe,"\\mathtt","span",'class="dcg-mq-monospace dcg-mq-font"'),C.underline=o(fe,"\\underline","span",'class="dcg-mq-non-leaf dcg-mq-underline"'),C.overline=C.bar=o(fe,"\\overline","span",'class="dcg-mq-non-leaf dcg-mq-overline"'),C.overrightarrow=o(fe,"\\overrightarrow","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"'),C.overleftarrow=o(fe,"\\overleftarrow","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"'),C.overleftrightarrow=o(fe,"\\overleftrightarrow ","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"'),C.overarc=o(fe,"\\overarc","span",'class="dcg-mq-non-leaf dcg-mq-overarc"');var ge=(C.textcolor=v(W,function(e,i){e.setColor=function(e){this.color=e,this.htmlTemplate='<span class="dcg-mq-textcolor" style="color:'+e+'">&0</span>'},e.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},e.parser=function(){var t=this,e=U.optWhitespace,r=U.string,n=U.regex;return e.then(r("{")).then(n(/^[#\w\s.,()%-]*/)).skip(r("}")).then(function(e){return t.setColor(e),i.parser.call(t)})},e.isStyleBlock=function(){return!0}}),C.class=v(W,function(e,n){e.parser=function(){var t=this,e=U.string,r=U.regex;return U.optWhitespace.then(e("{")).then(r(/^[-\w\s\\\xA0-\xFF]*/)).skip(e("}")).then(function(e){return t.cls=e||"",t.htmlTemplate='<span class="dcg-mq-class '+e+'">&0</span>',n.parser.call(t)})},e.latex=function(){return"\\class{"+this.cls+"}{"+this.blocks[0].latex()+"}"},e.isStyleBlock=function(){return!0}}),v(W,function(e,n){e.ctrlSeq="_{...}^{...}",e.createLeftOf=function(e){if(this.replacedFragment||e[-1]||!e.options.supSubsRequireOperand)return n.createLeftOf.apply(this,arguments)},e.contactWeld=function(e){for(var n=-1;n;n=-1===n&&S)if(this[n]instanceof ge){for(var t="sub";t;t="sub"===t&&"sup"){var r=this[t],i=this[n][t];if(r){if(i)if(r.isEmpty())var o=b(i,0,i.ends[-1]);else{r.jQ.children().insAtDirEnd(-n,i.jQ);var a=r.children().disown();o=b(i,a.ends[S],i.ends[-1]);-1===n?a.adopt(i,i.ends[S],0):a.adopt(i,0,i.ends[-1])}else this[n].addBlock(r.disown());this.placeCursor=function(t,r){return function(e){e.insAtDirEnd(-n,t||r)}}(i,r)}}this.remove(),e&&e[-1]===this&&(n===S&&o?o[-1]?e.insRightOf(o[-1]):e.insAtLeftEnd(o.parent):e.insRightOf(this[n]));break}},O.p.charsThatBreakOutOfSupSub="",e.finalizeTree=function(){this.ends[-1].write=function(e,t){if(e.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===t)return;var r=this.chToCmd(t,e.options);return r instanceof K?e.deleteSelection():e.clearSelection().insRightOf(this.parent),r.createLeftOf(e.show()),void G.queue("Baseline").alert(r.mathspeak({createdLeftOf:e}))}e[-1]&&!e[S]&&!e.selection&&-1<e.options.charsThatBreakOutOfSupSub.indexOf(t)&&(e.insRightOf(this.parent),G.queue("Baseline")),$.p.write.apply(this,arguments)}},e.moveTowards=function(e,t,r){t.options.autoSubscriptNumerals&&!this.sup?t.insDirOf(e,this):n.moveTowards.apply(this,arguments)},e.deleteTowards=function(e,t){if(t.options.autoSubscriptNumerals&&this.sub){var r=this.sub.ends[-e];r instanceof K?r.remove():r&&r.deleteTowards(e,t.insAtDirEnd(-e,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(-1,t.insAtLeftEnd(this.sub)),this.sup&&t.insDirOf(-e,this))}else n.deleteTowards.apply(this,arguments)},e.latex=function(){function e(e,t){var r=t&&t.latex();return t?e+(1===r.length?r:"{"+(r||" ")+"}"):""}return e("_",this.sub)+e("^",this.sup)},e.addBlock=function(e){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=e,e.adopt(this,this.sub,0).downOutOf=this.sub,e.jQ=E('<span class="dcg-mq-sup"/>').append(e.jQ.children()).prependTo(this.jQ),I.linkElementByBlockNode(e.jQ[0],e)):(this.sub=this.downInto=this.sup.downOutOf=e,e.adopt(this,0,this.sup).upOutOf=this.sup,e.jQ=E('<span class="dcg-mq-sub"></span>').append(e.jQ.children()).appendTo(this.jQ.removeClass("dcg-mq-sup-only")),I.linkElementByBlockNode(e.jQ[0],e),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var t=0;t<2;t+=1)!function(n,i,o,a){n[i].deleteOutOf=function(e,t){if(t.insDirOf(this[e]?-e:e,this.parent),!this.isEmpty()){var r=this.ends[e];this.children().disown().withDirAdopt(e,t.parent,t[e],t[-e]).jQ.insDirOf(-e,t.jQ),t[-e]=r}n.supsub=o,delete n[i],delete n[a+"Into"],n[o][a+"OutOf"]=d,delete n[o].deleteOutOf,"sub"===i&&E(n.jQ.addClass("dcg-mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[t],"sup sub".split(" ")[t],"down up".split(" ")[t])}}));C.subscript=C._=v(ge,function(e,t){e.supsub="sub",e.htmlTemplate='<span class="dcg-mq-supsub dcg-mq-non-leaf"><span class="dcg-mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',e.textTemplate=["_"],e.mathspeakTemplate=["Subscript,",", Baseline"],e.ariaLabel="subscript",e.finalizeTree=function(){this.downInto=this.sub=this.ends[-1],this.sub.upOutOf=d,t.finalizeTree.call(this)}}),C.superscript=C.supscript=C["^"]=v(ge,function(e,t){e.supsub="sup",e.htmlTemplate='<span class="dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"><span class="dcg-mq-sup">&0</span></span>',e.textTemplate=["^"],e.mathspeakTemplate=["Superscript,",", Baseline"],e.ariaLabel="superscript",e.finalizeTree=function(){this.upInto=this.sup=this.ends[S],this.sup.downOutOf=d,t.finalizeTree.call(this)}});var me=v(W,function(i,t){i.init=function(e,t,r){i.ariaLabel=r||ctrlSeq;var n='<span class="dcg-mq-large-operator dcg-mq-non-leaf"><span class="dcg-mq-to"><span>&1</span></span><big>'+t+'</big><span class="dcg-mq-from"><span>&0</span></span></span>';K.prototype.init.call(this,e,n)},i.createLeftOf=function(e){t.createLeftOf.apply(this,arguments),e.options.sumStartsWithNEquals&&(ee("n").createLeftOf(e),de().createLeftOf(e))},i.latex=function(){function e(e){return 1===e.length?e:"{"+(e||" ")+"}"}return this.ctrlSeq+"_"+e(this.ends[-1].latex())+"^"+e(this.ends[S].latex())},i.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.ends[-1].mathspeak()+" to "+this.ends[S].mathspeak()+", end "+this.ariaLabel+", "},i.parser=function(){for(var e=U.string,t=U.optWhitespace,r=U.succeed,n=z.block,i=this,o=i.blocks=[$(),$()],a=0;a<o.length;a+=1)o[a].adopt(i,i.ends[S],0);return t.then(e("_").or(e("^"))).then(function(e){var t=o["_"===e?0:1];return n.then(function(e){return e.children().adopt(t,t.ends[S],0),r(i)})}).many().result(i)},i.finalizeTree=function(){this.ends[-1].ariaLabel="lower bound",this.ends[S].ariaLabel="upper bound",this.downInto=this.ends[-1],this.upInto=this.ends[S],this.ends[-1].upOutOf=this.ends[S],this.ends[S].downOutOf=this.ends[-1]}});C[""]=C.sum=C.summation=o(me,"\\sum ","&sum;","sum"),C[""]=C.prod=C.product=o(me,"\\prod ","&prod;","product"),C.coprod=C.coproduct=o(me,"\\coprod ","&#8720;","co product"),C[""]=C.int=C.integral=v(me,function(e,t){e.init=function(){e.ariaLabel="integral";K.prototype.init.call(this,"\\int ",'<span class="dcg-mq-int dcg-mq-non-leaf"><big>&int;</big><span class="dcg-mq-supsub dcg-mq-non-leaf"><span class="dcg-mq-sup"><span class="dcg-mq-sup-inner">&1</span></span><span class="dcg-mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>',"integral")},e.createLeftOf=W.p.createLeftOf});var ye=C.frac=C.dfrac=C.cfrac=C.fraction=v(W,function(e,t){e.ctrlSeq="\\frac",e.htmlTemplate='<span class="dcg-mq-fraction dcg-mq-non-leaf"><span class="dcg-mq-numerator">&0</span><span class="dcg-mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',e.textTemplate=["(",")/(",")"],e.finalizeTree=function(){this.upInto=this.ends[S].upOutOf=this.ends[-1],this.downInto=this.ends[-1].downOutOf=this.ends[S],this.ends[-1].ariaLabel="numerator",this.ends[S].ariaLabel="denominator",1<this.getFracDepth()?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},e.mathspeak=function(e){return e&&e.createdLeftOf?e.createdLeftOf.parent.mathspeak():t.mathspeak.apply(this,arguments)},e.getFracDepth=function(){var r=function(e,t){return e instanceof I&&e.ctrlSeq&&0<=e.ctrlSeq.toLowerCase().search("frac")&&(t+=1),e.parent?r(e.parent,t):t};return r(this,0)}}),ve=C.over=k["/"]=v(ye,function(e,r){e.createLeftOf=function(e){if(!this.replacedFragment){var t=e[-1];if(!e.options.typingSlashCreatesNewFraction)for(;t&&!(t instanceof X||t instanceof(C.text||w)||t instanceof me||"\\ "===t.ctrlSeq||/^[,;:]$/.test(t.ctrlSeq));)t=t[-1];t instanceof me&&t[S]instanceof ge&&((t=t[S])[S]instanceof ge&&t[S].ctrlSeq!=t.ctrlSeq&&(t=t[S])),t!==e[-1]&&(this.replaces(T(t[S]||e.parent.ends[-1],e[-1])),e[-1]=t)}r.createLeftOf.call(this,e)}});C.ans=v(K,function(e,t){e.init=function(e){t.init.call(this,"\\operatorname{ans}",'<span class="dcg-mq-ans">ans</span>',"ans")}}),C.percent=C.percentof=v(K,function(e,t){e.init=function(){t.init.call(this,"\\%\\operatorname{of}",'<span class="dcg-mq-nonSymbola dcg-mq-operator-name">% of </span>',"percent of")}});var be=C.sqrt=C[""]=v(W,function(e,t){e.ctrlSeq="\\sqrt",e.htmlTemplate='<span class="dcg-mq-non-leaf dcg-mq-sqrt-container"><span class="dcg-mq-scaled dcg-mq-sqrt-prefix">'+he.sqrt.html+'</span><span class="dcg-mq-non-leaf dcg-mq-sqrt-stem">&0</span></span>',e.textTemplate=["sqrt(",")"],e.mathspeakTemplate=["StartRoot,",", EndRoot"],e.ariaLabel="root",e.parser=function(){return z.optBlock.then(function(r){return z.block.map(function(e){var t=xe();return t.blocks=[r,e],r.adopt(t,0,0),e.adopt(t,r,0),t})}).or(t.parser.call(this))}}),xe=(C.hat=v(W,function(e,t){e.ctrlSeq="\\hat",e.htmlTemplate='<span class="dcg-mq-non-leaf"><span class="dcg-mq-hat-prefix">^</span><span class="dcg-mq-hat-stem">&0</span></span>',e.textTemplate=["hat(",")"]}),C.nthroot=v(be,function(e,t){e.htmlTemplate='<sup class="dcg-mq-nthroot dcg-mq-non-leaf">&0</sup><span class="dcg-mq-scaled dcg-mq-sqrt-container"><span class="dcg-mq-sqrt-prefix dcg-mq-scaled">'+he.sqrt.html+'</span><span class="dcg-mq-sqrt-stem dcg-mq-non-leaf">&1</span></span>',e.textTemplate=["sqrt[","](",")"],e.latex=function(){return"\\sqrt["+this.ends[-1].latex()+"]{"+this.ends[S].latex()+"}"},e.mathspeak=function(){return this.ends[-1].ariaLabel="Index",this.ends[S].ariaLabel="Radicand","Start "+this.ends[-1].mathspeak()+" Root, "+this.ends[S].mathspeak()+", End Root"}})),we=v(W,function(e,i){e.init=function(e,t,r){var n='<span class="dcg-mq-non-leaf"><span class="dcg-mq-diacritic-above">'+t+'</span><span class="dcg-mq-diacritic-stem">&0</span></span>';i.init.call(this,e,n,r)}});C.vec=o(we,"\\vec","&rarr;",["vec(",")"]),C.tilde=o(we,"\\tilde","~",["tilde(",")"]);var _e=v(v(W,t),function(e,o){e.init=function(e,t,r,n,i){o.init.call(this,"\\left"+n,m,[t,r]),this.side=e,this.sides={},this.sides[-1]={ch:t,ctrlSeq:n},this.sides[S]={ch:r,ctrlSeq:i}},e.numBlocks=function(){return 1},e.html=function(){var e=this.getSymbol(-1),t=this.getSymbol(S);return this.htmlTemplate='<span class="dcg-mq-non-leaf dcg-mq-bracket-container"><span style="width:'+e.width+'" class="dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren'+(this.side===S?" dcg-mq-ghost":"")+'">'+e.html+'</span><span style="margin-left:'+e.width+";margin-right:"+t.width+'" class="dcg-mq-bracket-middle dcg-mq-non-leaf">&0</span><span style="width:'+t.width+'" class="dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren'+(-1===this.side?" dcg-mq-ghost":"")+'">'+t.html+"</span></span>",o.html.call(this)},e.getSymbol=function(e){return he[this.sides[e||S].ch]||{width:"0",html:""}},e.latex=function(){return"\\left"+this.sides[-1].ctrlSeq+this.ends[-1].latex()+"\\right"+this.sides[S].ctrlSeq},e.mathspeak=function(e){var t=this.sides[-1].ch,r=this.sides[S].ch;if("|"===t&&"|"===r)this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else{if(e&&e.createdLeftOf&&this.side){var n="";return-1===this.side?n=this.textTemplate[0]:this.side===S&&(n=this.textTemplate[1]),(-1===this.side?"left ":"right ")+Ee[n]}this.mathspeakTemplate=["left "+Ee[t]+",",", right "+Ee[r]],this.ariaLabel=Ee[t]+" block"}return o.mathspeak.call(this)},e.matchBrack=function(e,t,r){return r instanceof _e&&r.side&&r.side!==-t&&(!e.restrictMismatchedBrackets||Se[this.sides[this.side].ch]===r.sides[r.side].ch||{"(":"]","[":")"}[this.sides[-1].ch]===r.sides[S].ch)&&r},e.closeOpposing=function(e){e.side=0,e.sides[this.side]=this.sides[this.side];var t=e.delimjQs.eq(-1===this.side?0:1).removeClass("dcg-mq-ghost");this.replaceBracket(t,this.side)},e.createLeftOf=function(e){if(!this.replacedFragment){var t=e.options;if("|"===this.sides[-1].ch)var r=this.matchBrack(t,S,e[S])||this.matchBrack(t,-1,e[-1])||this.matchBrack(t,0,e.parent.parent);else r=this.matchBrack(t,-this.side,e[-this.side])||this.matchBrack(t,-this.side,e.parent.parent)}if(r){var n=this.side=-r.side;this.closeOpposing(r),r===e.parent.parent&&e[n]&&T(e[n],e.parent.ends[n],-n).disown().withDirAdopt(-n,r.parent,r,r[n]).jQ.insDirOf(n,r.jQ),r.bubble(function(e){e.reflow()})}else n=(r=this).side,r.replacedFragment?r.side=0:e[-n]&&(r.replaces(T(e[-n],e.parent.ends[-n],n)),e[-n]=0),o.createLeftOf.call(r,e);-1===n?e.insAtLeftEnd(r.ends[-1]):e.insRightOf(r)},e.placeCursor=w,e.unwrap=function(){this.ends[-1].children().disown().adopt(this.parent,this,this[S]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(e,t,r){var n=this.parent,i=this[e],o=n.ends[e];if(e===this.side)return this.unwrap(),void(i?r.insDirOf(-e,i):r.insAtDirEnd(e,n));var a=r.options,s=!this.side;if(this.side=-e,this.matchBrack(a,e,this.ends[-1].ends[this.side])){this.closeOpposing(this.ends[-1].ends[this.side]);var l=this.ends[-1].ends[e];this.unwrap(),l.siblingCreated&&l.siblingCreated(r.options,e),i?r.insDirOf(-e,i):r.insAtDirEnd(e,n)}else{if(this.matchBrack(a,e,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(t&&s)return this.unwrap(),void(i?r.insDirOf(-e,i):r.insAtDirEnd(e,n));this.sides[e]={ch:Se[this.sides[this.side].ch],ctrlSeq:Se[this.sides[this.side].ctrlSeq]};var c=this.delimjQs.removeClass("dcg-mq-ghost").eq(-1===e?0:1).addClass("dcg-mq-ghost");this.replaceBracket(c,e)}if(i){l=this.ends[-1].ends[e];T(i,o,-e).disown().withDirAdopt(-e,this.ends[-1],l,0).jQ.insAtDirEnd(e,this.ends[-1].jQ.removeClass("dcg-mq-empty")),l.siblingCreated&&l.siblingCreated(r.options,e),r.insDirOf(-e,i)}else t?r.insDirOf(e,this):r.insAtDirEnd(e,this.ends[-1])}},e.replaceBracket=function(e,t){var r=this.getSymbol(t);e.html(r.html).css("width",r.width),-1===t?e.next().css("margin-left",r.width):e.prev().css("margin-right",r.width)},e.deleteTowards=function(e,t){this.deleteSide(-e,!1,t)},e.finalizeTree=function(){this.ends[-1].deleteOutOf=function(e,t){this.parent.deleteSide(e,!0,t)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(-1===this.side?1:0).removeClass("dcg-mq-ghost"),this.side=0}},e.siblingCreated=function(e,t){t===-this.side&&this.finalizeTree()}}),Se={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},Ee={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};h("(",null,"parenthesis"),h("[",null,"bracket"),h("{","\\{","brace"),C.langle=o(_e,-1,"&lang;","&rang;","\\langle ","\\rangle "),C.rangle=o(_e,S,"&lang;","&rang;","\\langle ","\\rangle "),k["|"]=o(_e,-1,"|","|","|","|"),C.lVert=o(_e,-1,"&#8741;","&#8741;","\\lVert ","\\rVert "),C.rVert=o(_e,S,"&#8741;","&#8741;","\\lVert ","\\rVert "),C.left=v(W,function(e){e.parser=function(){var e=U.regex,t=U.string,r=(U.succeed,U.optWhitespace);return r.then(e(/^(?:[([|]|\\\{|\\langle\b|\\lVert\b)/)).then(function(i){var o="\\"===i.charAt(0)?i.slice(1):i;return"\\langle"==i&&(o="&lang;",i+=" "),"\\lVert"==i&&(o="&#8741;",i+=" "),z.then(function(n){return t("\\right").skip(r).then(e(/^(?:[\])|]|\\\}|\\rangle\b|\\rVert\b)/)).map(function(e){var t="\\"===e.charAt(0)?e.slice(1):e;"\\rangle"==e&&(t="&rang;",e+=" "),"\\rVert"==e&&(t="&#8741;",e+=" ");var r=_e(0,o,t,i,e);return r.blocks=[n],n.adopt(r,0,0),r})})})}}),C.right=v(W,function(e){e.parser=function(){return U.fail("unmatched \\right")}});var Me=C.binom=C.binomial=v(v(W,t),function(e,t){var r=he["("],n=he[")"];e.ctrlSeq="\\binom",e.htmlTemplate='<span class="dcg-mq-non-leaf dcg-mq-bracket-container"><span style="width:'+r.width+'" class="dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled">'+r.html+'</span><span style="margin-left:'+r.width+"; margin-right:"+n.width+';" class="dcg-mq-non-leaf dcg-mq-bracket-middle"><span class="dcg-mq-array dcg-mq-non-leaf"><span>&0</span><span>&1</span></span></span><span style="width:'+n.width+'" class="dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled">'+n.html+"</span></span>",e.textTemplate=["choose(",",",")"],e.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],e.ariaLabel="binomial"});C.choose=v(Me,function(e){e.createLeftOf=ve.prototype.createLeftOf}),C.editable=C.MathQuillMathField=v(W,function(e,i){e.ctrlSeq="\\MathQuillMathField",e.htmlTemplate='<span class="dcg-mq-editable-field"><span class="dcg-mq-root-block">&0</span></span>',e.parser=function(){var t=this,e=U.string,r=U.regex,n=U.succeed;return e("[").then(r(/^[a-z][a-z0-9]*/i)).skip(e("]")).map(function(e){t.name=e}).or(n()).then(i.parser.call(t))},e.finalizeTree=function(e){var t=A(this.ends[-1],this.jQ,e);t.KIND_OF_MQ="MathField",t.editable=!0,t.createTextarea(),t.editablesTextareaEvents(),t.cursor.insAtRightEnd(t.root),p(t.root)},e.registerInnerField=function(e,t){e.push(e[this.name]=t(this.ends[-1].controller))},e.latex=function(){return this.ends[-1].latex()},e.text=function(){return this.ends[-1].text()}});var Ie=C.embed=v(K,function(e,t){e.setOptions=function(e){function t(){return""}return this.text=e.text||t,this.htmlTemplate=e.htmlString||"",this.latex=e.latex||t,this},e.parser=function(){var r=this,e=U.string,n=U.regex,i=U.succeed;return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then(function(t){return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(i()).map(function(e){return r.setOptions(N[t](e))})})}}),Te=e(1);for(var Ce in Te)!function(e,t){"function"==typeof t?(u[e]=function(){return c(),t.apply(this,arguments)}).prototype=t.prototype:u[e]=t}(Ce,Te[Ce])}(),define("mathquill_src",["jquery"],function(){}),define("loadcss!Symbola-basic",function(){}),define("loadcss!vendor_css/mathquill/mathquill-basic",function(){}),define("toplevel/mathquill",["require","mathquill_src","loadcss!Symbola-basic","loadcss!vendor_css/mathquill/mathquill-basic"],function(e){return e("mathquill_src"),e("loadcss!Symbola-basic"),e("loadcss!vendor_css/mathquill/mathquill-basic"),window.MathQuill.noConflict()}),define("mathquill",["require","browser","jquery","toplevel/mathquill","config"],function(e){var t=e("browser"),r=e("jquery"),n=e("toplevel/mathquill").getInterface(1),i=e("config"),o=["erf invNorm","TTest Ttest ttest TScore","TScore Tscore tscore","ZScore Zscore zscore","normdist tdist poissondist binomdist","pdf cdf","histogram dotplot boxplot"].join(" ");return n.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>",autoCommands:"alpha beta sqrt theta phi pi tau nthroot sum prod int ans percent",autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){return t.IS_IOS||t.IS_ANDROID?r('<span class="dcg-mathquill-input-span" tabindex=0 role="textbox" style="display:inline-block;height:1px;width:1px">')[0]:t.IS_WINDOWS&&t.IS_TOUCH?r("<textarea readonly>").on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0})[0]:r("<textarea>")[0]},autoOperatorNames:["exp|exponent ln|natural-log log","total length mean median quantile quartile nCr nPr","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance corr|correlation","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","polygon","distance midpoint"+(i.get("distributions")?" "+o:"")].join(" "),resetCursorOnBlur:!0})}),define("scroll_helpers",["require"],function(e){return{scrollVisible:function(e,t,r){var n,i=t.height(),o=e.height(),a=t[0].scrollTop,s=e.offset().top+a-t.offset().top,l=s-r,c=o+s+r-i;return(n=c<=l?Math.min(Math.max(a,c),l):.5*(l+c))!==a&&(t[0].scrollTop=n,t[0].scrollTop!=a)}}}),define("tours/trip",["require","jquery","pjs","mathquill","scroll_helpers"],function(e){var p=e("jquery"),t=e("pjs"),d=e("mathquill"),h=e("scroll_helpers");return t({init:function(e){this.settings=e,this.__cachedStepName=null},ensureTripBlock:function(){if(!this.$tripBlock){var e=['<div class="trip-block">','<div class="trip-interior">','<a class="trip-close">&times;</a>','<div class="trip-content"></div>',"</div>",'<div class="trip-arrow"></div>',"</div>"].join(""),t=this,r=this.$tripBlock=p(e);r.css({top:"-100px"}),p("body").append(r),r.find(".trip-close").on("dcg-tap",function(e){e.preventDefault(),t.stop()}),this.bindKeyEvents()}},cleanup:function(){return this.unbindKeyEvents(),this.hideTripBlock(),!1},bindKeyEvents:function(){var t=this;p(document).on({"keydown.Trip":function(e){t.keyEvent.call(t,e)}})},unbindKeyEvents:function(){p(document).off("keydown.Trip")},keyEvent:function(e){27===e.which&&this.stop()},stop:function(){this.hideTripBlock(),this.settings.onTripStop(),this.__cachedContent=null,this.__cachedSel=null},showTripBlock:function(e){if(this.ensureTripBlock(),"string"==typeof e.sel&&(e.sel=p(e.sel)),e.sel=e.sel.filter(":visible"),e.content!==this.__cachedContent||e.sel[0]!==this.__cachedSel){this.__cachedContent=e.content,this.__cachedSel=e.sel[0],e.scrollContainer&&h.scrollVisible(e.sel,e.scrollContainer,0);var t=this.$tripBlock;t.find(".trip-content").html(e.content),t.toggleClass("trip-hidden",!!e.hidden);var r=e.sel,n=r.outerWidth(),i=r.outerHeight(),o=t.outerWidth(),a=t.outerHeight();if(t.removeClass("trip-e trip-s trip-w trip-n"),!r.offset()){for(var s="",l=r;s=l.selector+s,l=l.prevObject;);throw new Error("TourError: no offset() for: "+e.content+"("+s+")")}var c=0;switch(e.position){case"e":t.addClass("trip-e"),t.css({left:r.offset().left+n+10,top:r.offset().top-(a-i)/2});break;case"s":t.addClass("trip-s");var u=r.offset().left+(n-o)/2;t.css({left:u,top:r.offset().top+i+10}),u+o>p(window).width()-1&&(c=p(window).width()-1-u-o),u<1&&(c=1-u);break;case"w":t.addClass("trip-w"),t.css({left:r.offset().left-(10+o),top:r.offset().top-(a-i)/2});break;default:t.addClass("trip-n"),t.css({left:r.offset().left+(n-o)/2,top:r.offset().top-10-a})}t.find(".trip-interior").css("transform","translate("+c+"px, 0)"),t.css({display:"inline-block"}),t.find(".trip-math:not(.dcg-mq-math-mode)").each(function(){d.StaticMath(this)})}},fadeInTripBlock:function(){this.ensureTripBlock();var e=this.$tripBlock;setTimeout(function(){e.addClass("trip-is-loaded")},0)},hideTripBlock:function(){this.$tripBlock&&this.$tripBlock.removeClass("trip-is-loaded")}})}),define("tours/tour_manager",["require","pjs","./trip"],function(e){var t=e("pjs"),r=e("./trip");return t(function(e,t){e.init=function(){this.tripManager=new r({onTripStop:this.stopTour.bind(this)}),this.currentStep=void 0,this.currentTour=void 0},e._tripLoop=function(){if(clearTimeout(this.__tripLoopTimeout),this.running){this._advanceTrip(),this.__tripLoopTimeout=setTimeout(this._tripLoop.bind(this),200)}},e._advanceTrip=function(){var e=this.currentTour.update(),t=(new Date).getTime();if(e&&this.currentStep&&e.content!==this.currentStep.content){if(this.currentStep.delayBeforeExit){if(this.throttleTimer&&t-this.throttleTimer<this.currentStep.delayBeforeExit)return;if(!this.throttleTimer)return void(this.throttleTimer=t)}e.delayBeforeEnter&&(this.currentStep=e,this.throttleTimer=t)}if(!(e&&this.currentStep&&e.content===this.currentStep.content&&this.throttleTimer&&t-this.throttleTimer<this.currentStep.delayBeforeEnter)&&(this.throttleTimer=null,e&&!e.doNotUpdate)){if((this.currentStep=e).final)return void this.finishTour(e,5);this.tripManager.showTripBlock(e)}},e.updateNow=e._advanceTrip,e.startTour=function(e){this.running||(this.currentTour=e,this.running=!0,this._tripLoop(),this.tripManager.fadeInTripBlock())},e.closingMsg="<b>__endingMessage__</b><br>This message will self-destruct in __seconds__...",e.finishTour=function(e,t){clearTimeout(this.__tripLoopTimeout),this.running=!1;var r=this;return t<0?void r.tripManager.stop():(e.endingMsg&&(e.content=r.closingMsg.replace("__endingMessage__",e.endingMsg).replace("__seconds__",t)),r.tripManager.showTripBlock(e),void setTimeout(function(){r.finishTour(e,t-1)},1e3))},e.stopTour=function(){this.running=!1,this.currentStep=void 0,this.currentTour=void 0}})}),function(){var t,r,i,o,a,s,l,c,u,p,d,h,f,g,m,y,e={};!function(t){function r(r,n){return function(e,t){return r[e]=n?n(e,t):t}}var n="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){t(r(n,r(e)))}):t("object"==typeof module&&"object"==typeof module.exports?r(n,r(module.exports)):r(n))}(function(e){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};t=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r},o=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,r,a):i(t,r))||a);return 3<o&&a&&Object.defineProperty(t,r,a),a},a=function(r,n){return function(e,t){n(e,t,r)}},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(o,a,s,l){return new(s||(s=Promise))(function(e,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function n(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}i((l=l.apply(o,a||[])).next())})},c=function(r,n){function e(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}var i,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t},u=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},p=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},d=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},h=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},f=function(e){return this instanceof f?(this.v=e,this):new f(e)},g=function(e,t,r){function n(n){c[n]&&(l[n]=function(r){return new Promise(function(e,t){1<u.push([n,r,e,t])||i(n,r)})})}function i(e,t){try{(r=c[e](t)).value instanceof f?Promise.resolve(r.value.v).then(o,a):s(u[0][2],r)}catch(e){s(u[0][3],e)}var r}function o(e){i("next",e)}function a(e){i("throw",e)}function s(e,t){e(t),u.shift(),u.length&&i(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,c=r.apply(e,t||[]),u=[];return l={},n("next"),n("throw"),n("return"),l[Symbol.asyncIterator]=function(){return this},l},m=function(n){function e(t,r){n[t]&&(i[t]=function(e){return(o=!o)?{value:f(n[t](e)),done:"return"===t}:r?r(e):e})}var i,o;return i={},e("next"),e("throw",function(e){throw e}),e("return"),i[Symbol.iterator]=function(){return this},i},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):p(e)},e("__extends",t),e("__assign",r),e("__rest",i),e("__decorate",o),e("__param",a),e("__metadata",s),e("__awaiter",l),e("__generator",c),e("__exportStar",u),e("__values",p),e("__read",d),e("__spread",h),e("__await",f),e("__asyncGenerator",g),e("__asyncDelegator",m),e("__asyncValues",y)})}(),define("main/validate-state",["require","exports","lib/deepCopy"],function(e,t,r){"use strict";function n(e){for(var t,r,n=function(e){for(var t=0,r=0,n=e;r<n.length;r++){var i=n[r];if(t=h(t,i.id),"table"===i.type)for(var o=0,a=i.columns;o<a.length;o++){var s=a[o];h(t,s.id)}}return t}(e)+1,i={},o=0,a=e;o<a.length;o++){var s=a[o];if(d=void 0,(p=s).slider&&("number"==typeof(d=p.slider).min&&(d.min=""+d.min),"number"==typeof d.max&&(d.max=""+d.max),"number"==typeof d.step&&(d.step=""+d.step)),"string"!=typeof p.id&&(p.id=""+p.id),"folder"===s.type)t=s.id,i[s.id]&&(s.id=""+n,n+=1),r=s.id,i[s.id]=!0;else{if(void 0!==t&&s.folderId===t?s.folderId=r:(s.folderId&&(s.folderId=""),r=t=void 0),"table"===s.type)for(var l=0,c=s.columns;l<c.length;l++){var u=c[l];i[u.id]&&(u.id=""+n,n+=1),i[u.id]=!0}i[s.id]&&(s.id=""+n,n+=1),i[s.id]=!0}}var p,d}function h(e,t){var r=parseFloat(t);return r!==Math.floor(r)?e:Math.max(e,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.validateState=function(e){var t=r.default(e);return n(t.expressions.list),t}}),define("migrations/0",["require","graphing/axisarrowmode"],function(e){function i(e){return e.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]="latex"===r?i(e[r]):"values"===r?e[r].map(i):e[r]);return t}function r(e){var t,r=function(e){if(e.type){if(a.hasOwnProperty(e.type))return e.type;throw new Error("Invalid item type: '"+e.type+"'.")}return void 0!==e.text?"text":void 0!==e.columns||void 0!==e.headings?"table":"expression"}(e),n={};switch(r){case"expression":for(t in e)e.hasOwnProperty(t)&&(n[t]="latex"===t?i(e[t]):e[t]);return n.type=r,n;case"table":for(t in e)e.hasOwnProperty(t)&&(n[t]="columns"===t?e[t].map(o):e[t]);return n.type=r,n;case"image":for(t in e)e.hasOwnProperty(t)&&(n[t]="width"===t||"height"===t||"x"===t||"y"===t?i(e[t]):e[t]);return n.type=r,n;case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n.type=r,n}}var t=e("graphing/axisarrowmode"),a={expression:!0,table:!0,image:!0,folder:!0,text:!0},n={none:t.NONE,both:t.BOTH,positive:t.POSITIVE};return function(e){if(e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&"xAxisArrows"!==r&&"yAxisArrows"!==r&&(t[r]=e[r]);return t.xAxisArrowMode=n[e.xAxisArrows||"none"],t.yAxisArrowMode=n[e.yAxisArrows||"none"],t}(e.graph),t.expressions={list:e.expressions.list.map(r)},t.version=0,t}}),define("migrations/1",["require"],function(e){function i(e){return e.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]="latex"===r?i(e[r]):"values"===r?e[r].map(i):e[r]);return t}function r(e){var t,r=e.type,n={};switch(r){case"expression":for(t in e)e.hasOwnProperty(t)&&(n[t]="latex"===t?i(e[t]):e[t]);return n;case"table":for(t in e)e.hasOwnProperty(t)&&(n[t]="columns"===t?e[t].map(o):e[t]);return n;case"image":for(t in e)e.hasOwnProperty(t)&&(n[t]="width"===t||"height"===t||"x"===t||"y"===t?i(e[t]):e[t]);return n;case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n;default:throw new Error("Unexpected expression type: "+r)}}return function(e){if(e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(r)},t.version=1,t}}),define("expressions/colors",["require","lib/color-helpers"],function(e){var t=e("lib/color-helpers").colors;return{all:[t.RED,t.BLUE,t.GREEN,t.PURPLE,t.ORANGE,t.BLACK],RED:t.RED,BLUE:t.BLUE,GREEN:t.GREEN,PURPLE:t.PURPLE,ORANGE:t.ORANGE,BLACK:t.BLACK}}),define("migrations/2",["require","expressions/colors"],function(e){function i(e){switch(e){case n:return t.RED;case a:return t.BLUE;case s:return t.GREEN;case l:return t.PURPLE;case c:return t.ORANGE;case u:return t.BLACK;default:return e}}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]="color"===r?i(e[r]):e[r]);return t}function r(e){var t,r=e.type,n={};switch(r){case"expression":for(t in e)e.hasOwnProperty(t)&&(n[t]="color"===t?i(e[t]):e[t]);return n;case"table":for(t in e)e.hasOwnProperty(t)&&(n[t]="columns"===t?e[t].map(o):e[t]);return n;case"image":case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n;default:throw new Error("Unexpected expression type: "+r)}}var t=e("expressions/colors"),n="#C0504D",a="#4F81BD",s="#9BBB59",l="#8064A2",c="#F79646",u="#000000";return function(e){if(1<e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(r)},t.version=2,t}}),define("lib/number-to-latex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("string"==typeof e)return e;if(void 0===e)return"";var t=e+"";return(t=t.replace(/1e\+?([-\d]+)/,"10^{$1}")).replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}")}}),define("migrations/3",["require","lib/number-to-latex"],function(e){function r(e){var t,r=e.type,n={};switch(r){case"expression":for(t in e)e.hasOwnProperty(t)&&(n[t]="sliderMax"===t||"sliderMin"===t||"sliderInterval"===t?i(e[t]):"domain"===t?{max:i(e[t].max),min:i(e[t].min)}:e[t]);return n.hasOwnProperty("sliderMin")&&void 0===n.sliderInterval&&(n.sliderInterval=""),n;case"image":case"table":case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n;default:throw new Error("Unexpected expression type: "+r)}}var i=e("lib/number-to-latex").default;return function(e){if(2<e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(r)},t.version=3,t}}),define("expressions/styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.POINT="POINT",t.OPEN="OPEN",t.CROSS="CROSS",t.SOLID="SOLID",t.DASHED="DASHED",t.DOTTED="DOTTED",t.SINGLE_PIXEL="SINGLE_PIXEL"}),define("migrations/4",["require","expressions/styles"],function(e){function i(e){switch(e){case n:return t.POINT;case a:return t.CROSS;case s:return t.OPEN;case l:return t.SOLID;case c:return t.DASHED;case u:return t.DOTTED;default:return e}}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]="style"===r?i(e[r]):e[r]);return t}function r(e){var t,r=e.type,n={};switch(r){case"expression":for(t in e)e.hasOwnProperty(t)&&(n[t]="style"===t?i(e[t]):e[t]);return n;case"table":for(t in e)e.hasOwnProperty(t)&&(n[t]="columns"===t?e[t].map(o):e[t]);return n;case"image":case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n;default:throw new Error("Unexpected expression type: "+r)}}var t=e("expressions/styles"),n="point",a="cross",s="open",l="normal",c="dashed",u="dotted";return function(e){if(3!==e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=e.graph,t.expressions={list:e.expressions.list.map(r)},t.version=4,t}}),define("graphing/columnmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.POINTS="POINTS",t.LINES="LINES",t.POINTS_AND_LINES="POINTS_AND_LINES"}),define("migrations/5",["require","graphing/columnmode"],function(e){function l(e){var t={};for(var r in e)e.hasOwnProperty(r)&&"showPoints"!==r&&"showLine"!==r&&(t[r]=e[r]);return void 0===e.showPoints&&void 0===e.showLine||(e.showPoints&&e.showLine?t.columnMode=n.POINTS_AND_LINES:e.showPoints?t.columnMode=n.POINTS:e.showLine?t.columnMode=n.LINES:(t.hidden=!0,t.columnMode=n.POINTS)),t}function r(e){var t,r=e.type,n={};switch(r){case"expression":for(t in void 0===e.hidden?e.hasOwnProperty("graphed")?n.hidden=!e.graphed:e.hasOwnProperty("userRequestedGraphing")?n.hidden="never"===e.userRequestedGraphing:n.hidden=!1:n.hidden=e.hidden,e)e.hasOwnProperty(t)&&"graphed"!==t&&"userRequestedGraphing"!==t&&"hidden"!==t&&"slider"!==t&&("color"!==t?"style"!==t?"sliderInterval"!==t?n[t]=e[t]:n.sliderInterval="undefined"===e.sliderInterval?"":e.sliderInterval:n.style="normal"===e.style?"SOLID":e.style:"object"==typeof e.color?n.color=e.color.value:n.color=e.color);return n;case"table":if(e.headings||e.columns){var i=e.headings?e.headings:e.columns;if(n.columns=i.map(l),e.rows)for(var o=0;o<n.columns.length;o++){var a=n.columns[o];a.values=[];for(var s=0;s<e.rows.length;s++)a.values.push(e.rows[s][o])}}for(t in e)e.hasOwnProperty(t)&&"rows"!==t&&"headings"!==t&&"columns"!==t&&(n[t]=e[t]);return n;case"image":case"text":case"folder":for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n;default:throw new Error("Unexpected expression type: "+r)}}var n=e("graphing/columnmode");return function(e){if(4!==e.version)throw new Error("Unexpected version: "+e.version);var t={};return t.graph=function(e){var t,r={};for(var n in e)if(e.hasOwnProperty(n))switch(t=e[n],n){case"showAxes":r.showXAxis=t,r.showYAxis=t;break;case"showLabels":r.xAxisNumbers=t,r.yAxisNumbers=t,r.polarNumbers=t;break;case"labelXMode":r.xAxisStep="pi"===t?Math.PI:0;break;case"labelYMode":r.yAxisStep="pi"===t?Math.PI:0;break;default:r[n]=t}return r}(e.graph),t.expressions={list:e.expressions.list.map(r)},t.version=5,t}}),define("expressions/opacity",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOW=.2,t.DEFAULT=.4,t.HIGH=.8}),define("main/label-sizes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SMALL="small",t.MEDIUM="medium",t.LARGE="large",t.ALL=[t.SMALL,t.MEDIUM,t.LARGE]}),define("main/label-orientations",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT="default",t.LEFT="left",t.RIGHT="right",t.ABOVE="above",t.BELOW="below",t.ALL=[t.DEFAULT,t.LEFT,t.RIGHT,t.ABOVE,t.BELOW]}),define("migrations/legacy-interpolated-label-parser",["require","exports"],function(e,t){"use strict";function c(e){return!(e.length<2)&&"`"===e[0]&&"`"===e[e.length-1]}Object.defineProperty(t,"__esModule",{value:!0}),t.isMathLabel=c,t.parse=function(e){if(c(e))return{raw:e,parts:[e]};for(var t,r="({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"].join("})|({")+"})",n=new RegExp(r,"g"),i=[],o=0,a=0;t=n.exec(e);){o<(a=t.index)&&i.push(e.substr(o,a-o));var s=t[0],l=s.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");i.push({symbol:l,str:s}),o=t.index+s.length}return o<e.length&&i.push(e.substr(o)),{raw:e,parts:i}}}),define("math/sliders",["require","exports"],function(e,t){"use strict";function l(e,t){var r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function i(e){var t=e.target,r=e.hardMin,n=e.hardMax,i=e.step,o=1e-10;if(void 0!==r&&void 0!==n&&(o=Math.min(o,Math.abs(n-r)/1e3)),i&&(o=Math.min(o,i/10)),void 0!==r&&(r=l(r,o)),void 0!==n&&(n=l(n,o)),n<r)return r;if(t<=r)return r;if(n<=t)return n;if(i){var a=void 0!==r?r:0;t=i*Math.round((t-a)/i)+a}var s=l(t,o);return i?t=s:r===s?t=s:n===s&&(t=s),t<=r?r:n<=t?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.roundToReasonableDecimal=l,t.determineWhichLimitsAreCompatibleWithValue=function(e){var t=!0,r=!0,n=!0;return void 0!==e.hardMin&&e.target<e.hardMin&&(t=!1),void 0!==e.hardMax&&e.target>e.hardMax&&(r=!1),e.step&&i({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0})!==e.target&&(n=!1),{min:t,max:r,step:n}},t.constrainSliderValueLikeEvaluator=i}),define("lib/worker-i18n",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.t=function(e,t){return{msg:e,vars:t}}}),define("math/mathshim",["require"],function(e){var n={};return n.cosh=Math.cosh||function(e){return.5*(Math.exp(e)+Math.exp(-e))},n.sinh=Math.sinh&&0!==Math.sinh(1e-20)?Math.sinh:function(e){var t=0<e?1:-1;return e=0<e?e:-e,.5*-t*Math.exp(e)*n.expm1(-2*e)},n.tanh=Math.tanh&&0!==Math.tanh(1e-20)?Math.tanh:function(e){var t=0<e?1:-1;e=0<e?e:-e;var r=n.expm1(-2*e);return-t*r/(2+r)},n.acosh=Math.acosh||function(e){return e<1?NaN:Math.log(e+n.sqrtxsqm1(e))},n.asinh=Math.asinh&&0!==Math.asinh(1e-20)?Math.asinh:function(e){var t=0<e?1:-1;return 1+(e=0<e?e:-e)*e==1?t*n.log1p(e):t*Math.log(e+n.sqrtxsqp1(e))},n.atanh=Math.atanh&&0!==Math.atanh(1e-20)?Math.atanh:function(e){return.5*(n.log1p(e)-n.log1p(-e))},n.expm1=Math.expm1||function(e){return e+.5*e*e===e?e:Math.exp(e)-1},n.log1p=Math.log1p||function(e){return e-.5*e*e===e?e:Math.log(1+e)},n.sqrtxsqp1=function(e){var t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},n.sqrtxsqm1=function(e){var t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)},n}),define("math/distance",["require","exports"],function(e,s){"use strict";function l(e,t,r,n,i,o){var a=s.hypot(i-r,o-n);return 0===a?0:(e-r)/a*((i-r)/a)+(t-n)/a*((o-n)/a)}function c(e,t,r,n,i,o){var a=l(e,t,r,n,i,o);return a<=0?[r,n]:1<=a?[i,o]:[r+a*(i-r),n+a*(o-n)]}Object.defineProperty(s,"__esModule",{value:!0}),s.hypot=Math.hypot||function(e,t){if(0===e&&0===t)return 0;if(Math.abs(e)>Math.abs(t)){var r=t/e;return Math.abs(e)*Math.sqrt(r*r+1)}r=e/t;return Math.abs(t)*Math.sqrt(r*r+1)},s.mean=function(e,t){return 0<e==0<t?e+.5*(t-e):.5*(e+t)},s.pointToSegmentParameter=l,s.closestPointOnSegment=c,s.pointToSegment=function(e,t,r,n,i,o){var a=c(e,t,r,n,i,o);return s.hypot(e-a[0],t-a[1])},s.approx=function(e,t,r){if(void 0===r&&(r=1),50<r)throw new Error("Within "+(52-r)+" bits isn't really approximate any more");var n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1);return n===n+(1===r?.5:Math.pow(.5,r))*Math.abs(t-e)}}),define("math/poi-type",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INTERSECTION=1001,t.ZERO=1002,t.INTERCEPT=1003,t.EXTREMUM=1004,t.EDGE=1005,t.DEFINITION=1006,t.TRACE=1007,t.LABEL=1008}),define("math/poi",["require","exports","./distance","lib/console","./poi-type"],function(e,t,y,p,r){"use strict";function v(e,t){var r;t<e&&(r=e,e=t,t=r);var n=0<e,i=0<t,o=.01<Math.abs(e),a=.01<Math.abs(t);if(o||a)return y.mean(e,t);if(0===e)return t*Math.abs(t);if(0===t)return e*Math.abs(e);if(n!==i)return 0;var s=n?Math.sqrt(e*t):-Math.sqrt(e*t);return e<=s&&s<=t?s:y.mean(e,t)}function d(e,t,r,n,i,o,a){var s,l,c,u;if(isFinite(n))return isFinite(t)||(s=b(e,t,r,n,a))&&(e=s[0],t=s[1]),isFinite(o)||(s=b(r,n,i,o,a))&&(i=s[0],o=s[1]),l=t===n?[e,t]:h(e,t,r,n,a,n),c=o===n?[i,o]:h(r,n,i,o,a,n),l&&c&&(u=v(l[0],c[0])),void 0!==u?[u,a(u)]:void 0}function b(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){var o=v(e,r),a=i(o);if(o===e||o===r)return isFinite(t)?[e,t]:[r,n];isFinite(a)!==isFinite(t)?(r=o,n=a):(e=o,t=a)}else p.log("bisectFinite called with bad y values",[t,n])}function h(e,t,r,n,i,o){if(t===o!=(n===o))for(;;){var a=v(e,r),s=i(a);if(a===e||a===r)return t===o?[e,t]:[r,n];s===o!=(t===o)?(r=a,n=s):(e=a,t=s)}else p.log("bisectConstant called with bad y values",[t,n,o])}function x(e,t,r,n,i,o,a,s){var l=Math.abs(n-t),c=Math.abs(o-n),u=Math.abs(s-o);return c<l&&u<l?[[e,t],[r,n]]:c<u&&l<u?[[i,o],[a,s]]:[[r,n],[i,o]]}Object.defineProperty(t,"__esModule",{value:!0}),t.floatMiddle=v,t.default={bisectJump:function(e,t,r,n,i,o,a,s){if(s||(s=0),!((r-e)*(i-r)<=0)&&isFinite(e)&&isFinite(r)&&isFinite(i)&&isFinite(t)&&isFinite(o)){if(!isFinite(n)){var l=b(e,t,r,n,a),c=b(r,n,i,o,a);if(!l||!c)return;return[l,c]}if(!(Math.abs(n-((i-r)*t+(r-e)*o)/(i-e))<s))for(;;){var u=v(e,r),p=a(u),d=v(r,i),h=a(d),f=Math.abs(p-y.mean(t,n)),g=Math.abs(n-y.mean(p,h)),m=Math.abs(h-y.mean(n,o));if(f<=s&&g<=s&&m<=s)return;if(!isFinite(p)){if(l=b(e,t,u,p,a),c=b(u,p,i,o,a),!l||!c)return;return[l,c]}if(!isFinite(h)){if(l=b(e,t,d,h,a),c=b(d,h,i,o,a),!l||!c)return;return[l,c]}if(!(u!==e&&u!==r||d!==r&&d!==i))return Math.abs(n-t)>Math.abs(o-n)?[[e,t],[r,n]]:[[r,n],[i,o]];if(u===e||u===r)return x(e,t,r,n,d,h,i,o);if(d===r||d===i)return x(e,t,u,p,r,n,i,o);m<f&&g<=f?(i=r,o=n,r=u,n=p):f<m&&g<=m?(e=r,t=n,r=d,n=h):(e=u,t=p,i=d,o=h)}}},bisectExtremum:function(e,t,r,n,i,o,a){if(e<r&&r<i)if(isFinite(t)&&isFinite(n)&&isFinite(o)&&t!==n&&n!==o&&t<n==o<n)for(;;){var s=v(e,r),l=a(s),c=v(r,i),u=a(c);if(!isFinite(l)||!isFinite(u))return;if(s===e||s===r||c===r||c===i)return n<l==t<n?[s,l]:n<u==t<n?[c,u]:[r,n];if(l===n||u===n)return d(e,t,r,n,i,o,a);t<l==t<n&&t<l==n<l?(i=r,o=n,r=s,n=l):o<u==o<n&&n<u==o<u?(e=r,t=n,r=c,n=u):(e=s,t=l,i=c,o=u)}else p.log("bisectExtremum called with bad y values",[t,n,o]);else p.log("bisectExtremum called with bad x values",[e,r,i])},bisectFinite:b,bisectZero:function(e,t,r,n,i){if(isNaN(t)||isNaN(n)||t<0==n<0)p.log("bisectZero called with bad y values",[t,n]);else for(;;){var o=v(e,r),a=i(o);if(!isFinite(a))return;if(o===e||o===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(0===a)return d(e,t,o,a,r,n,i);t<0!=a<0?(r=o,n=a):(e=o,t=a)}},flatCenter:d,INTERSECTION:r.INTERSECTION,ZERO:r.ZERO,INTERCEPT:r.INTERCEPT,EXTREMUM:r.EXTREMUM,EDGE:r.EDGE,DEFINITION:r.DEFINITION,TRACE:r.TRACE,LABEL:r.LABEL}}),define("math/quadrature",["require","math/mathshim","math/poi"],function(e){"use strict";function T(e,t,r){return.5*(t*(2-r)+e*r)}function C(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function k(e,t,r){var n=Math.abs(e(T(t,r,o))),i=Math.abs(e(T(t,r,2*o)));return!(n<o||i<o)&&1.95*i<n}function g(e,t,r){var n,i,o=T(r,t,L[0]),a=T(t,r,L[0]),s=e(o),l=e(a),c=T(t,r,1),u=e(c);if(isFinite(u)&&!isFinite(s)){if(n=P(o,s,c,u,e),Math.abs((n[0]-t)/(r-t))>D)return C(t,r,NaN,NaN,NaN);t=n[0],s=n[1]}if(isFinite(u)&&!isFinite(l)){if(i=P(c,u,a,l,e),Math.abs((i[0]-r)/(r-t))>D)return C(t,r,NaN,NaN,NaN);r=i[0],l=i[1]}if(isFinite(s)&&isFinite(l)&&!isFinite(u)){if(n=P(o,s,c,u,e),i=P(c,u,a,l,e),Math.abs((i[0]-n[0])/(r-t))>D)return C(t,r,NaN,NaN,NaN);u=.5*(n[1]+i[1])}if(k(e,t,r)||k(e,r,t))return C(t,r,NaN,NaN,NaN);for(var p=u,d=0,h=0,f=0,g=0,m=0,y=0,v=0;v<A;v+=4)m=e(T(t,r,L[v])),y=e(T(r,t,L[v])),g=Math.max(g,Math.abs(m),Math.abs(y)),d+=O[v]*(m+y),m=e(T(t,r,L[v+1])),y=e(T(r,t,L[v+1])),g=Math.max(g,Math.abs(m),Math.abs(y)),f+=O[v+1]*(m+y),m=e(T(t,r,L[v+2])),y=e(T(r,t,L[v+2])),g=Math.max(g,Math.abs(m),Math.abs(y)),h+=O[v+2]*(m+y),m=e(T(t,r,L[v+3])),y=e(T(r,t,L[v+3])),g=Math.max(g,Math.abs(m),Math.abs(y)),f+=O[v+3]*(m+y);var b,x=p+d,w=x+h,_=w+f,S=Math.abs(h-x),E=Math.abs(f-w),M=q*(r-t)*_,I=q*Math.abs(r-t)*g*O[0];return b=0===S?q*Math.abs(r-t)*E:q*Math.abs(r-t)*E*(E/S)*(E/S),C(t,r,M,b=Math.max(b,I),I)}function m(e){for(var t=-1/0,r=-1/0,n=-1,i=0,o=0;o<e.length;o++){var a=e[o];i+=a.value,a.error>t&&(t=a.error,n=o),a.minerror>r&&(r=a.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}var l=e("math/mathshim"),t=e("math/poi").default,y=t.bisectJump,P=t.bisectFinite,r=Math.pow(2,-13),o=r*r,v=o*o,D=o,A=32,L=[],O=[];!function(e,t){for(var r=A;0<r;r--){var n=3.154019550531224/A*r,i=l.sinh(n),o=l.cosh(Math.PI/2*i),a=1/(Math.exp(Math.PI/2*i)*o),s=l.cosh(n)/(o*o);e.push(a),t.push(s)}}(L,O);for(var n=0,i=0;i<O.length;i++)n+=O[i];var q=1/(1+2*n);return{quad:function(e,t,r,n){if(void 0===n&&(n=32),!isFinite(t)||!isFinite(r))return NaN;for(var i=[g(e,t,r)],o=m(i),a=1;a<n&&!(Math.abs(o.maxerror/o.totalvalue)<=32*v||o.maxerror<=32*v||o.maxerror<=32*o.maxminerror);a++){var s=i[i.length-1];i[i.length-1]=i[o.maxindex],i[o.maxindex]=s;var l=i.pop(),c=(u=e,p=T(l.x2,l.x1,.125),d=T(l.x1,l.x2,.125),h=.5*(p+d),(f=y(p,u(p),h,u(h),d,u(d),u,0))?.5*(f[0][0]+f[1][0]):h);i.push(g(e,l.x1,c)),i.push(g(e,c,l.x2)),o=m(i)}var u,p,d,h,f;return o.totalvalue}}}),define("math/studentt",["require","math/poi"],function(e){var l=e("math/poi").floatMiddle,c=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349],o=function(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<.001)return 1/(e*(1+.5772156649015329*e));if(e<12){var t=e,r=0,n=t<1;n?t+=1:t-=r=Math.floor(t)-1;for(var i=0,o=1,a=t-1,s=0;s<8;s++)i=(i+c[s])*a,o=o*a+u[s];var l=i/o+1;if(n)l/=t-1;else for(s=0;s<r;s++)l*=t++;return l}return 171.624<e?1/0:Math.exp(p(e))},a=[1/12,-1/360,1/1260,-1/1680,1/1188,-691/360360,1/156,-3617/122400],p=function(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<12)return Math.log(Math.abs(o(e)));for(var t=1/(e*e),r=a[7],n=6;0<=n;n--)r*=t,r+=a[n];var i=r/e;return(e-.5)*Math.log(e)-e+.9189385332046728+i},n=function(e,t,r){if(e<0||1<e)throw new RangeError("First argument must be between 0 and 1.");if(1===t&&1===r)return e;if(0===e)return 0;if(1===e)return 1;if(0===t)return 1;if(0===r)return 0;var n=Math.exp(p(t+r)-p(t)-p(r)+t*Math.log(e)+r*function(e){if(e<=-1)throw new RangeError("Argument mustbe greater than -1.0");return 1e-4<Math.abs(e)?Math.log(1+e):(-.5*e+1)*e}(-e));return e<(t+1)/(t+r+2)?n*i(e,t,r)/t:1-n*i(1-e,r,t)/r},i=function(e,t,r){var n,i,o,a,s,l,c,u,p,d=1e-30,h=1;for(u=t-1,a=(o=1)-(c=t+r)*e/(p=t+1),Math.abs(a)<d&&(a=d),l=a=1/a;h<=100&&(a=1+(i=h*(r-h)*e/((u+(n=2*h))*(t+n)))*a,Math.abs(a)<d&&(a=d),o=1+i/o,Math.abs(o)<d&&(o=d),l*=(a=1/a)*o,a=1+(i=-(t+h)*(c+h)*e/((t+n)*(p+n)))*a,Math.abs(a)<d&&(a=d),o=1+i/o,Math.abs(o)<d&&(o=d),l*=s=(a=1/a)*o,!(Math.abs(s-1)<3e-7));h++);return l},d=function(e,t){var r=Math.sqrt(t*t+e);return n((t+r)/(2*r),e/2,e/2)};return{cdf:d,pdf:function(e,t){return o((e+1)/2)/(Math.sqrt(e*Math.PI)*o(e/2))*Math.pow(1+t*t/e,-(e+1)/2)},gamma:o,simpleInverse:function(e,t){var r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:var n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return 2*Math.sign(t-.5)*Math.sqrt(n-1);default:throw new Error("studentT.simpleInverse() must be called with 1, 2, or 4 df.")}},bisectInverse:function(e,t,r,n){for(var i,o,a=r,s=n;;){if(i=l(a,s),o=d(e,i),i===a||i===s)return t<o?a:s;o<t?a=i:s=i}}}}),define("math/tofraction",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===t&&(t=1e6),e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};for(var r,n,i,o=0,a=1,s=1,l=0;n=(r=Math.floor(e))*a+o,!(t<(i=r*l+s))&&(o=a,s=l,a=n,l=i,e!==r);)e=1/(e-r);return{n:a,d:l}}}),define("math/builtin",["require","math/mathshim","math/distance","math/quadrature","math/studentt","math/tofraction"],function(e){function r(e){return!(1e12<e)&&Math.round(c*e)*Math.PI===e}function n(e){if(1e12<e)return!1;var t=Math.round(2*c*e);return t%2==1&&t*Math.PI==2*e}function i(e,t,r){return r<0?d.tcdf(-1/0,e,t):0<r?d.tcdf(-1/0,-e,t):2*d.tcdf(-1/0,-Math.abs(e),t)}var t=e("math/mathshim"),o=e("math/distance"),a=e("math/quadrature"),s=e("math/studentt"),l=e("math/tofraction").default,d={};d.cosh=t.cosh,d.sinh=t.sinh,d.tanh=t.tanh,d.acosh=t.acosh,d.asinh=t.asinh,d.atanh=t.atanh,d.expm1=t.expm1,d.log1p=t.log1p,d.sqrtxsqp1=t.sqrtxsqp1,d.sqrtxsqm1=t.sqrtxsqm1,d.mod=function(e,t){return e-t*Math.floor(e/t)},d.round=function(e,t){if(void 0===t&&(t=0),0===(t=Math.round(t)))return Math.round(e);var r=Math.pow(10,t);return Math.round(e*r)/r},d.sign=Math.sign||function(e){return 0===e?0:0<e?1:e<0?-1:NaN},d.lcm=function(e,t){e=Math.round(e),t=Math.round(t);var r=d.gcd(e,t);return Math.abs(e/r*t)},d.gcd=function(e,t){if((e=Math.round(e))<0&&(e=-e),(t=Math.round(t))<0&&(t=-t),e<t){var r=t;t=e,e=r}if(0===t)return e;for(var n=e%t;0<n;)n=(e=t)%(t=n);return t},d.listGCD=function(e){if(0===e.length)return NaN;for(var t=e[0],r=1;r<e.length;r++)t=d.gcd(t,e[r]);return t},d.listLCM=function(e){if(0===e.length)return NaN;for(var t=e[0],r=1;r<e.length;r++)t=d.lcm(t,e[r]);return t},d.nCr=function(e,t){if((e=Math.round(e))<(t=Math.round(t))||e<0||t<0)return 0;for(var r=1,n=0;n<t;n++)r*=(e-n)/(n+1);return r},d.nPr=function(e,t){if((e=Math.round(e))<(t=Math.round(t))||e<0||t<0)return 0;for(var r=1,n=0;n<t;n++)r*=e-n;return r},d.factorial=function(e){return d.gamma(e+1)},d._integerFactorial=function(e){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(170<e)return NaN;if(0===e||1===e)return 1;for(var t=1,r=2;r<=e;r++)t*=r;return t},d.gamma=function(e){return e===Math.floor(e)?d._integerFactorial(e-1):e<0?Math.PI/(Math.sin(Math.PI*e)*d.gamma(1-e)):Math.exp(d.lnGamma(e))},d.lnGamma=function(e){if(e<0)return NaN;for(var t=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],r=.9999999999999971,n=0;n<14;n++)r+=t[n]/(e+n+1);var i=e+5.2421875;return(e+.5)*Math.log(i)-i+Math.log(2.5066282746310007*r/e)},d.bernoulliTable=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870],d.cotDerivative=function(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(0===e)return 1/d.tan(t);var r=d.sin(t);if(1===e)return-1/(r*r);var n=d.cos(t);if(2===e)return 2*n/(r*r*r);var i,o,a,s,l,c=[0,2];for(o=3;o<=e;o++){for(i=[],a=0;a<o;a++)(l=s=0)<a&&(s=(o-a+1)*c[a-1]),a+2<o&&(l=(a+1)*c[a+1]),i.push(-(s+l));c=i}var u=0;for(a=e-1;0<=a;a--)u=i[a]+n*u;return u/Math.pow(r,e+1)},d.polyGamma=function(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;var r=e%2==0?-1:1;if(t<0)return-r*d.polyGamma(e,1-t)-Math.pow(Math.PI,e+1)*d.cotDerivative(e,Math.PI*t);for(var n=d.factorial(e),i=0,o=Math.pow(t,-(e+1));t<10;)i+=o,t++,o=Math.pow(t,-(e+1));i+=0===e?-Math.log(t):o*t/e,i+=.5*o;for(var a=d.bernoulliTable,s=e+1,l=2,c=o*t*s/l,u=1/(t*t),p=1;p<=14;p++)i+=(c*=u)*a[p-1],c*=++s/++l,c*=++s/++l;return n*r*i},d.toFraction=l,d.log=function(e){var t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t},d.log_base=function(e,t){if(0===t)return NaN;var r=Math.log(e)/Math.log(t);return Math.pow(t,Math.round(r))===e?Math.round(r):r},d.common_log=function(e){return d.log_base(e,10)},d.pow=function(e,t){if(!isFinite(e)&&0===t)return NaN;if(0<=e||t===Math.floor(t))return Math.pow(e,t);var r=d.toFraction(t,100);return o.approx(r.n/r.d,t,2)&&r.d%2==1?(r.n%2==0?1:-1)*Math.pow(-e,t):NaN},d.nthroot=function(e,t){return d.pow(e,1/t)};var c=1/Math.PI;d.sin=function(e){return r(Math.abs(e))?0:Math.sin(e)},d.cos=function(e){return n(Math.abs(e))?0:Math.cos(e)},d.tan=function(e){var t=Math.abs(e);return r(t)?0:n(t)?1/0:Math.tan(e)},d.sec=function(e){return n(Math.abs(e))?1/0:1/Math.cos(e)},d.csc=function(e){return r(Math.abs(e))?1/0:1/Math.sin(e)},d.cot=function(e){var t=Math.abs(e);return r(t)?1/0:n(t)?0:1/Math.tan(e)},d.acot=function(e){return Math.PI/2-Math.atan(e)},d.acsc=function(e){return Math.asin(1/e)},d.asec=function(e){return Math.acos(1/e)},d.sech=function(e){return 1/d.cosh(e)},d.csch=function(e){return 1/d.sinh(e)},d.coth=function(e){return 1/d.tanh(e)},d.asech=function(e){return d.acosh(1/e)},d.acsch=function(e){return d.asinh(1/e)},d.acoth=function(e){return d.atanh(1/e)},d.mean=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length},d.total=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t},d.tpdf=function(e,t){return t<=0?NaN:s.pdf(t,e)},d.tcdf=function(e,t,r){return r<=0?NaN:e===-1/0?s.cdf(r,t):0<e&&0<t?s.cdf(r,-e)-s.cdf(r,-t):s.cdf(r,t)-s.cdf(r,e)};var u=function(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))},p=function(e){return e<0?.5*Math.exp(-e*e)*d.erfcx(-e):1-.5*Math.exp(-e*e)*d.erfcx(e)};d.normalcdf=function(e,t,r,n){var i=u(t,r,n);if(e===-1/0)return p(i);var o=u(e,r,n);return 0<e&&0<t?p(-o)-p(-i):p(i)-p(o)},d.normalpdf=function(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))};var h=function(e,t,r){for(var n=r/(1-r),i=Math.pow(1-r,t),o=i,a=1;a<=Math.min(t,e);a++)o+=i*=(t-a+1)/a*n;return o};d.binomcdf=function(e,t,r,n){return r!==Math.round(r)?NaN:n<0||1<n?NaN:t<0||r<0?0:(e=Math.floor(e),t=Math.floor(t),e===-1/0?h(t,r,n):h(t,r,n)-h(e,r,n))},d.binompdf=function(e,t,r){return t!==Math.round(t)?NaN:(e=Math.round(e),r<0||1<r?NaN:e<0||t<0?0:d.nCr(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e))},d.poissonpdf=function(e,t){return t<=0?NaN:(e=Math.round(e))<0?0:Math.exp(-t+e*Math.log(t)-d.lnGamma(e+1))};var f=function(e,t){if(e===1/0)return 1;if(e<=0)return 0;for(var r=1,n=1,i=1;i<=e;i++){var o=n;if((n+=r*=t/i)===o)break}return Math.exp(-t)*n};return d.poissoncdf=function(e,t,r){return r<=0?NaN:(e=Math.floor(e),(t=Math.floor(t))<0?0:e===-1/0?f(t,r):f(t,r)-f(e,r))},d.erf=function(e){var t=-e*e;if(t<-750)return 0<=e?1:-1;if(.065<=e)return 1-Math.exp(t)*d.erfcx(e);if(e<=-.065)return Math.exp(t)*d.erfcx(-e)-1;return e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+.005223977625442188*t))))},d.erfcx=function(e){if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-d.erfcx(-e);if(50<e){var t=.5641895835477563,r=e*e;return 5e7<e?t/e:t*(r*(r+4.5)+2)/(e*(r*(r+5)+3.75))}return(.9999999999999999+e*(2.224574423459406+e*(2.444115549920689+e*(1.7057986861852539+e*(.8257463703357973+e*(.28647031042892007+e*(.07124513844341643+e*(.012296749268608364+e*(.001347817214557592+7263959403471071e-20*e)))))))))/(1+e*(3.352953590554884+e*(5.227518529742423+e*(5.003720878235473+e*(3.266590890998987+e*(1.5255421920765353+e*(.5185887413188858+e*(.12747319185915415+e*(.02185979575963238+e*(.0023889438122503674+.00012875032817508128*e))))))))))},d.invNorm=function(e){var t,r,n;return.5<e?-d.invNorm(1-e):.5===e?0:e<0?NaN:0===e?-1/0:(n=e<.02425?(((((-.00778489400243029*(t=Math.sqrt(-2*Math.log(e)))-.322396458041136)*t-2.40075827716184)*t-2.54973253934373)*t+4.37466414146497)*t+2.93816398269878)/((((.00778469570904146*t+.32246712907004)*t+2.445134137143)*t+3.75440866190742)*t+1):(((((-39.6968302866538*(r=(t=e-.5)*t)+220.946098424521)*r-275.928510446969)*r+138.357751867269)*r-30.6647980661472)*r+2.50662827745924)*t/(((((-54.4760987982241*r+161.585836858041)*r-155.698979859887)*r+66.8013118877197)*r-13.2806815528857)*r+1))-Math.sqrt(2*Math.PI)*(.5*d.erfcx(-n/Math.SQRT2)-Math.exp(.5*n*n)*e)},d.invPoisson=function(e,t){if(t<=0||e<0||1<e)return NaN;if(0===e)return 0;if(1===e)return 1/0;for(var r=1,n=1,i=1;Math.exp(-t)*n<e;)n+=r*=t/i,i+=1;return i-1},d.invBinom=function(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||1<r)return NaN;if(e<0||1<e)return NaN;if(0===e)return 0;if(1===e)return t;if(0===t)return 0;if(1===r)return t;if(0===r)return 0;for(var n=r/(1-r),i=Math.pow(1-r,t),o=i,a=1;o<e;)o+=i*=(t-a+1)/a*n,a+=1;return a-1},d.invT=function(e,t){return t<=0||e<0||1<e?NaN:0===e?-1/0:1===e?1/0:1===t||2===t||4===t?s.simpleInverse(t,e):.5===e?0:.5<e?(r=1<t?d.invNorm(e):s.simpleInverse(1,e),n=1<t?s.simpleInverse(1,e):Math.pow(d.tpdf(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t),s.bisectInverse(t,e,r,n)):-d.invT(1-e,t);var r,n},d.ZScore=function(e,t,r){return r<0?NaN:(e-t)/r},d.TScore=function(e,t){var r=d.stdev(e);return(d.mean(e)-t)*Math.sqrt(e.length)/r},d.IndependentTScore=function(e,t){var r=e.length,n=d.mean(e),i=d.stdev(e),o=t.length,a=d.mean(t),s=d.stdev(t);return(n-a)/(Math.sqrt(((r-1)*i*i+(o-1)*s*s)/(r+o-2))*Math.sqrt(1/r+1/o))},d.TTest=function(e,t){return i(d.TScore(e,0),e.length-1,t)},d.IndependentTTest=function(e,t,r){return i(d.IndependentTScore(e,t),e.length+t.length-2,r)},d.length=function(e){return e.length},d.listMin=function(e){if(e.length<1)return NaN;var t=e[0];if(isNaN(t))return NaN;for(var r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t},d.listMax=function(e){if(e.length<1)return NaN;var t=e[0];if(isNaN(t))return NaN;for(var r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t},d.quantile=function(e,t){if(!isFinite(t)||t<0||1<t)return NaN;var r=e.length,n=d.sortPerm(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]},d.quartile=function(e,t){if(!isFinite(t)||t<0||4<t)return NaN;var r=d.sortPerm(e),n=d.quartileIndex(e,t),i=Math.floor(n),o=Math.ceil(n);return(e[r[i]]+e[r[o]])/2},d.sortPerm=function(r){for(var e=r.length,t=[],n=0;n<e;n++)t.push(n);return t.sort(function(e,t){return r[e]-r[t]}),t},d.quartileIndex=function(e,t){t=Math.round(t);var r,n=e.length,i=n%2==1;return 1===n?0:(0===t&&(r=0),2===t&&(r=(n-1)/2),4===t&&(r=n-1),1===t&&(r=i?(n+1)/4-1:(n+2)/4-1),3===t&&(r=i?(3*n+3)/4-1:(3*n+2)/4-1),r)},d.upperQuantileIndex=function(e,t){return d.sortPerm(e)[Math.ceil(t*(e.length-1))]+1},d.lowerQuantileIndex=function(e,t){return d.sortPerm(e)[Math.floor(t*(e.length-1))]+1},d.upperQuartileIndex=function(e,t){return d.sortPerm(e)[Math.ceil(d.quartileIndex(e,t))]+1},d.lowerQuartileIndex=function(e,t){return d.sortPerm(e)[Math.floor(d.quartileIndex(e,t))]+1},d.median=function(e){return d.quantile(e,.5)},d.argMin=function(e){if(e.length<1)return 0;var t=e[0];if(isNaN(t))return 0;for(var r=0,n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(t=e[r=n])}return r+1},d.argMax=function(e){if(e.length<1)return 0;var t=e[0];if(isNaN(t))return 0;for(var r=0,n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;t=e[r=n]}return r+1},d.varp=function(e){for(var t=d.mean(e),r=0,n=0;n<e.length;n++){var i=e[n]-t;r+=i*i}return r/e.length},d.mad=function(e){for(var t=d.mean(e),r=0,n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length},d.var=function(e){var t=e.length;return d.varp(e)*t/(t-1)},d.covp=function(e,t){if(e.length!==t.length)return NaN;for(var r=e.length,n=d.mean(e),i=d.mean(t),o=0,a=0;a<r;a++)o+=(e[a]-n)*(t[a]-i);return o/r},d.cov=function(e,t){if(e.length!==t.length)return NaN;var r=e.length;return d.covp(e,t)*r/(r-1)},d.corr=function(e,t){if(e.length!==t.length)return NaN;for(var r,n,i=e.length,o=d.mean(e),a=d.mean(t),s=0,l=0,c=0,u=0;u<i;u++)s+=(r=e[u]-o)*r,l+=(n=t[u]-a)*n,c+=r*n;return c/Math.sqrt(s*l)},d.stdev=function(e){return Math.sqrt(d.var(e))},d.stdevp=function(e){return Math.sqrt(d.varp(e))},d.quad=a.quad,d.distance=function(e,t){return o.hypot(t[0]-e[0],t[1]-e[1])},d.midpoint=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]},d}),define("math/functions",["require","math/builtin"],function(e){function i(e,t){var r=e.join(",");return new Function(["BuiltIn"],"return (function("+r+"){"+t+"})")(n)}var n=e("math/builtin");return{dehydrateGraphData:function(e){for(var t=0;t<e.length;t++)e[t].compiled&&delete e[t].compiled.fn},rehydrateGraphData:function(e){for(var t=0;t<e.length;t++){var r=e[t].compiled;r&&(r.fn=i(r.args,r.source))}},closureFunctionWithBuiltIn:i,createEvaluateFunction:function(e,t){for(var r=[],n=0;n<t;n++)r.push("values["+n+"]");return i(["values"],"return "+e(r))}}}),define("math/parser/input-span",["require","exports"],function(e,t){"use strict";function r(e,t,r){return{input:e,start:t,end:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.Span=r,t.emptySpanAt=function(e,t){return r(e,t,t)},t.joinSpans=function(e,t){if(e.input!==t.input)throw new Error("Programming Error: cannot form a span on different inputs");return r(e.input,e.start,t.end)},t.slice=function(e){return e.input.slice(e.start,e.end)}}),define("math/parsenode/base",["require","pjs","math/functions","math/parser/input-span"],function(e){var t=e("pjs"),o=e("math/functions"),i=e("math/parser/input-span");return t(function(e,t,r){e.init=function(){this._dependencies=[],this._dummyDependencies=[],this._exports=[]};var n=e.exportPenalty=0;e.tmpVar=function(){return"tmp"+n++},e.dependencies=function(){return this.getDependencies()},e.evaluateOnce=function(e){void 0===e&&(e={});var t=this.getConcreteTree(e).getEvaluationInfo();return t?t[0].val:NaN},e.setInputSpan=function(e){this._inputSpan=e},e.getInputString=function(){return void 0===this._inputSpan?"":i.slice(this._inputSpan)},e.getInputSpan=function(){return this._inputSpan},e.shouldExportAns=function(){return!1},e.getAnsVariable=function(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]},e.addDependency=function(e){this.dependsOn(e)||this._dependencies.push(e)},e.addDependencies=function(e){for(var t=0;t<e.length;t++)this.addDependency(e[t])},e.addDummyDependency=function(e){-1===this._dummyDependencies.indexOf(e)&&this._dummyDependencies.push(e)},e.addDummyDependencies=function(e){for(var t=0;t<e.length;t++)this.addDummyDependency(e[t])},e.mergeDependencies=function(){for(var e=0;e<arguments.length;e++)this.addDependencies(arguments[e].getDependencies()),this.addDummyDependencies(arguments[e].getDummyDependencies())},e.getDependencies=function(){return this._dependencies},e.getDummyDependencies=function(){return this._dummyDependencies},e.removeDependency=function(e){var t=this._dependencies.indexOf(e);0<=t&&this._dependencies.splice(t,1)},e.dependsOn=function(e){return-1<this._dependencies.indexOf(e)},e.getExports=function(){return(this._exports||[]).concat(this.getAnsVariable())},e.getLegalExports=function(t){return this.getExports().filter(function(e){return!t.assignmentForbidden(e)})},e.exportsSymbol=function(e){return-1<this._exports.indexOf(e)},e.exportTo=function(e,t,r){for(var n=this.getLegalExports(e),i=0;i<n.length;i++){var o=n[i];if(r[o])return;r[o]=t.blocksExport?t:this}},e.getOperator=function(){return this.operator||"="},e.isInequality=function(){return!1},e.isShadeBetween=function(){return!1},e.getAllIds=function(){return this.userData?[this.userData.id]:[]},e.getEvaluationInfo=function(){return!1},e.shouldPromoteToSlider=function(e){return!1},e.getSliderVariables=function(e,t){return e.sliderVariables(t.getDependencies())},e.getCompiledFunction=function(e){var t=this.getEvalStrings(),r=t.statements.join(";")+";return "+t.expression;if(void 0===e){var n=(e=this.getDependencies()).indexOf("x");if(-1!==n){var i=e[0];e[0]=e[n],e[n]=i}}return{args:e,source:r,fn:o.closureFunctionWithBuiltIn(e,r)}},e.getCompiledDerivative=function(){var e=this.getDependencies();return this.takeDerivative(e[0]||"x").getCompiledFunction()},e.asValue=function(){}})}),define("math/parsenode/error",["require","pjs","./base"],function(e){return e("pjs")(e("./base"),function(e,t){e.init=function(e){t.init.call(this),this._msg=e,this._sliderVariables=[],this.blocksExport=!0},e.evaluateOnce=function(e){return this._msg},e.isError=!0,e.getError=function(){return this._msg},e.setDependencies=function(e){return this._dependencies=e,this},e.allowExport=function(){return this.blocksExport=!1,this}})}),define("graphing/label",["require","exports","underscore","math/distance","math/tofraction"],function(e,t,n,l,p){"use strict";function o(e,t){if(void 0===t&&(t=e),isNaN(e)||!isFinite(e))return{ariaString:"undefined",string:"undefined",value:e};if(0===e)return{ariaString:"0",string:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);var r,n,i=p.default(e/Math.PI,24);if(u(t)&&l.approx(i.n/i.d*Math.PI,e,3))return{ariaString:c(r=(0===i.n?"0":1===i.n?"":-1===i.n?"-":i.n.toString()+"")+(1===i.d?"":"/"+i.d.toString())),string:r,value:i.n/i.d*Math.PI};if(u(t))return{ariaString:c(r="-0"===(n=d(e.toFixed(f(t))))?"0":n),string:r,value:parseFloat(r)};var o=h(e.toExponential(f(t/e))).split("e"),a=o[0]+"10",s=o[1].replace("+","");return{ariaString:c(r=h(e.toExponential(f(t/e))).replace("+","")),string:r,mantissa:a,superscript:s,value:parseFloat(r)}}function r(e){return m["["+e+"]"]}function i(e){return e[0]+e.slice(1).split("").join(" ")}function c(e){return e.replace(v,i).replace(y,r).replace(/ +/gi," ").trim()}function d(e){return-1===e.indexOf(".")?e:e.replace(b,"")}function h(e){return e.replace(/\.?0+e/,"e")}function u(e){return 1e-4<(e=Math.abs(e))&&e<1e7}function f(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function g(e,t){var r=p.default(e,t);return 1!==r.d&&l.approx(r.n/r.d,e,3)}function a(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:"undefined"};if(0===e||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:"decimal",value:"0"};var r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,o=t.denominatorCutoff||1e6,a=h(e.toExponential(i-2)).match(/([\d\.\-]+)e\+?([\d\-]+)/);if(!a)return{type:"undefined"};var s=parseInt(a[2],10)>=i,l=g(e,o);if(Math.abs(e)>n||Math.abs(e)<r||s)return{type:"scientific",mantissa:a[1],exponent:a[2]};if(l&&t.displayAsFraction){var c=p.default(e,o);return{type:"fraction",numerator:c.n.toString(),denominator:c.d.toString()}}var u=d(e.toPrecision(i));return e!==Number(u)&&t.addEllipses&&(u+="..."),{type:"decimal",value:u}}function s(e){e=e.replace("\\","");var t={pi:"",tau:"",theta:"",phi:""};return t.hasOwnProperty(e)?t[e]:e}Object.defineProperty(t,"__esModule",{value:!0}),t.value=o;var m={"[e]":" times 10 to the ","[+]":" plus ","[-]":" minus ","[*]":" times ","[/]":" over ","[]":" pi ","[]":" tau ","[]":" theta ","[]":" phi "},y=new RegExp(Object.keys(m).join("|"),"gi"),v=/\.\d+/g;t.point=function(e,t,r,n){var i=o(e,t);return[i,o(n(i.value),r)]};var b=/\.?0+$/;t.canDisplayAsFraction=g,t.numericLabel=a,t.truncatedHTMLLabel=function(e,t){var r=a(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"<span class='dcg-cross'></span>10<sup>"+r.exponent+"</sup>";case"fraction":return"1"===r.denominator?r.numerator:r.numerator+"/"+r.denominator;default:return r}},t.truncatedPlainmathLabel=function(e,t){var r=a(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+" * 10^"+r.exponent;case"fraction":return"1"===r.denominator?r.numerator:r.numerator+"/"+r.denominator;default:return r}},t.truncatedLatexLabel=function(e,t){var r=a(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"\\times10^{"+r.exponent+"}";case"fraction":return"1"===r.denominator?r.numerator:"-"===r.numerator[0]?"-\\frac{"+r.numerator.slice(1)+"}{"+r.denominator+"}":"\\frac{"+r.numerator+"}{"+r.denominator+"}";default:return r}},t.truncatedAriaLabel=function(e,t){var r=a(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return c(r.value);case"scientific":return c(r.mantissa+"e"+r.exponent);case"fraction":return c(r.numerator+"/"+r.denominator);default:return r}},t.formatSymbol=s,t.identifierToLatex=function(e){var t=e.split("_"),r="";return 1<t[0].length&&(r+="\\"),r+=t[0],t[1]&&(r+=1===t[1].length?"_"+t[1]:"_{"+t[1]+"}"),r},t.identifierToHTML=function(e){if(!e)return"";var t=e.split("_").map(s).map(n.escape),r=t[0];return t[1]&&(r+="<sub>"+t[1]+"</sub>"),r},t.latexToIdentifier=function(e){return(e=e.replace(/\\operatorname\{(.*)\}/,"$1")).replace(/[{}\\]/g,"")},t.trimLatex=function(e){return e.replace(/^(\\ | |\\space)+/,"").replace(/(\\ | |\\space)+$/,"")}}),define("math/types",["require","lib/worker-i18n"],function(e){function t(e){switch(e){case n:return"Any";case i:return"Number";case o:return"Bool";case a:return"Point";case s:return"Distribution";case l:return"ListOfAny";case c:return"ListOfNumber";case u:return"ListOfBool";case p:return"ListOfPoint";case d:return"ListOfDistribution";case h:return"ErrorType";default:throw new Error("Invalid type")}}var r=e("lib/worker-i18n"),n=0,i=1,o=2,a=3,s=4,l=5,c=6,u=7,p=8,d=9,h=10;return{Any:n,Number:i,Bool:o,Point:a,Distribution:s,ListOfAny:l,ListOfNumber:c,ListOfBool:u,ListOfPoint:p,ListOfDistribution:d,ErrorType:h,repr:t,prettyPrint:function(e){switch(e){case n:return r.t("an unknown object");case i:return r.t("a number");case o:return r.t("a true/false value");case a:return r.t("a point");case s:return r.t("a distribution");case l:return r.t("a list of unknown objects");case c:return r.t("a list of numbers");case u:return r.t("a list of true/false values");case p:return r.t("a list of points");case d:return r.t("a list of distributions");case h:return r.t("an error object");default:throw new Error("Invalid type")}},isList:function(e){switch(e){case l:case c:case u:case p:case d:return!0;default:return!1}},elementType:function(e){switch(e){case l:return n;case c:return i;case u:return o;case p:return a;case d:return s;default:return n}},listType:function(e){switch(e){case n:return l;case i:return c;case o:return u;case a:return p;case s:return d;default:throw new Error("Type "+t(e)+" does not implement listType.")}},hasListType:function(e){switch(e){case n:case i:case o:case a:case s:return!0;default:return!1}}}}),define("math/errormsg",["require","lib/worker-i18n","math/parsenode/error","graphing/label","math/types"],function(e){var l=e("lib/worker-i18n"),c=e("math/parsenode/error"),u=e("graphing/label"),t=e("math/types");return{parseError:function(){return c(l.t("Sorry, I don't understand this."))},unrecognizedSymbol:function(e){return e=u.formatSymbol(e),c(l.t("Sorry, I don't understand the '__symbol__' symbol.",{symbol:e}))},unexpectedInequality:function(){return c(l.t("Cannot use an inequality here."))},unexpectedSymbol:function(e){return e=u.formatSymbol(e),c(l.t("Sorry, I don't understand the way that '__symbol__' is used here.",{symbol:e}))},addTypeError:function(e){return c(l.t("Cannot add __symbol1__ and __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},subtractTypeError:function(e){return c(l.t("Cannot subtract __symbol2__ from __symbol1__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},multiplyTypeError:function(e){return c(l.t("Cannot multiply __symbol1__ by __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},divideTypeError:function(e){return c(l.t("Cannot divide __symbol1__ by __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},exponentTypeError:function(e){return c(l.t("Cannot raise __symbol1__ to __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},negativeTypeError:function(e){return c(l.t("Cannot negate __symbol__.",{symbol:e[0]})).allowExport()},comparatorTypeError:function(e){return c(l.t("Cannot compare __symbol1__ to __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},andTypeError:function(e){return c(l.t("Cannot apply __symbol__ to __symbol1__ and __symbol2__.",{symbol:"and",symbol1:e[0],symbol2:e[1]})).allowExport()},listTypeError:function(e){return c(l.t("Cannot store __symbol1__ in a list.",{symbol1:e[0]})).allowExport()},pointTypeError:function(e){return c(l.t("Cannot use __symbol1__ and __symbol2__ as the coordinates of __symbol3__.",{symbol1:e[0],symbol2:e[1],symbol3:t.prettyPrint(t.Point)})).allowExport()},indexTypeError:function(e){return c(l.t("Cannot index __symbol1__ with __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},functionTypeError:function(e,t){switch(t.length){case 1:return c(l.t("Function '__fn__' cannot be applied to __arg__.",{fn:u.formatSymbol(e),arg:t[0]})).allowExport();case 2:return c(l.t("Function '__fn__' cannot be applied to __arg1__ and __arg2__.",{fn:u.formatSymbol(e),arg1:t[0],arg2:t[1]})).allowExport();default:return c(l.t("Function '__fn__' cannot be applied to these arguments.",{fn:u.formatSymbol(e)})).allowExport()}},sumLowerBoundTypeError:function(e){return c(l.t("Lower bound of a sum cannot be __symbol__.",{symbol:e[0]})).allowExport()},sumUpperBoundTypeError:function(e){return c(l.t("Upper bound of a sum cannot be __symbol__.",{symbol:e[0]})).allowExport()},sumArgumentTypeError:function(e){return c(l.t("Cannot take the sum of __symbol__.",{symbol:e[0]})).allowExport()},productLowerBoundTypeError:function(e){return c(l.t("Lower bound of a product cannot be __symbol__.",{symbol:e[0]})).allowExport()},productUpperBoundTypeError:function(e){return c(l.t("Upper bound of a product cannot be __symbol__.",{symbol:e[0]})).allowExport()},productArgumentTypeError:function(e){return c(l.t("Cannot take the product of __symbol__.",{symbol:e[0]})).allowExport()},integralLowerBoundTypeError:function(e){return c(l.t("Lower bound of an integral cannot be __symbol__.",{symbol:e[0]})).allowExport()},integralUpperBoundTypeError:function(e){return c(l.t("Upper bound of an integral cannot be __symbol__.",{symbol:e[0]})).allowExport()},integralArgumentTypeError:function(e){return c(l.t("Cannot take the integral of __symbol__.",{symbol:e[0]})).allowExport()},derivativeTypeError:function(e){return c(l.t("Cannot take the derivative of __symbol__.",{symbol:e[0]})).allowExport()},derivativeVariableTypeError:function(e,t){return c(l.t("Cannot take derivative with respect to '__symbol1__' because it is __symbol2__.",{symbol1:u.formatSymbol(e),symbol2:t[0]}))},piecewiseConditionTypeError:function(e){return c(l.t("The condition in a piecewise expression must be __symbol1__ but was __symbol2__.",{symbol1:t.prettyPrint(t.Bool),symbol2:e[0]})).allowExport()},piecewiseBranchTypeError:function(e){return c(l.t("Cannot use __symbol__ as a branch of a piecewise expression.",{symbol:e[0]})).allowExport()},tableHeaderTypeError:function(e){return c(l.t("Table header cannot be __symbol__.",{symbol:e[0]}))},tableEntryTypeError:function(e){return c(l.t("Table entry cannot be __symbol__.",{symbol:e[0]}))},regressionTypeError:function(e){return c(l.t("Cannot regress __symbol1__ against __symbol2__.",{symbol1:e[0],symbol2:e[1]}))},heterogeneousList:function(){return c(l.t("All elements of a list must have the same type.")).allowExport()},deeplyNested:function(){return c(l.t("Definitions are nested too deeply.")).allowExport()},polygonListTypeError:function(e){return c(l.t("A single argument to polygon should be a point list, not __type__.",{type:e[0]}))},polygonPointArgsError:function(){return c(l.t("Some of your arguments are not points."))},polygonTwoNumbersError:function(){return c(l.t("Cannot make a polygon from two numbers."))},histogramListTypeError:function(e){return c(l.t("The first argument to 'histogram' should be a number list, not __type__.",{type:e}))},histogramRequiresArguments:function(){return c(l.t("The first argument to 'histogram' should be a number list."))},histogramTooManyArguments:function(){return c(l.t("'histogram' can only take 3 arguments."))},histogramBinWidthTypeError:function(e){return c(l.t("The 'binwidth' argument to 'histogram' should be a number, not __type__.",{type:e}))},histogramBinOffsetTypeError:function(e){return c(l.t("The 'binoffset' argument to 'histogram' should be a number, not __type__.",{type:e}))},dotplotListTypeError:function(e){return c(l.t("The first argument to 'dotplot' should be a number list, not __type__.",{type:e}))},dotplotRequiresArguments:function(){return c(l.t("The first argument to 'dotplot' should be a number list."))},dotplotTooManyArguments:function(){return c(l.t("'dotplot' can only take 3 arguments."))},dotplotBinWidthTypeError:function(e){return c(l.t("The 'binwidth' argument to 'dotplot' should be a number, not __type__.",{type:e}))},dotplotBinOffsetTypeError:function(e){return c(l.t("The 'binoffset' argument to 'dotplot' should be a number, not __type__.",{type:e}))},boxplotListTypeError:function(e){return c(l.t("The first argument to 'boxplot' should be a number list, not __type__.",{type:e}))},boxplotRequiresArguments:function(){return c(l.t("The first argument to 'boxplot' should be a number list."))},boxplotTooManyArguments:function(){return c(l.t("'boxplot' can only take 3 arguments."))},boxplotOffsetTypeError:function(e){return c(l.t("The 'offset' argument to 'boxplot' should be a number, not __type__.",{type:e}))},boxplotHeightTypeError:function(e){return c(l.t("The 'height' argument to 'boxplot' should be a number, not __type__.",{type:e}))},wrongArity:function(e,t,r){var n,i;if(e=u.formatSymbol(e),1===t)i=l.t("For example, try typing: __dependency__(x).",{dependency:e}),n=1<r?l.t("Function '__dependency__' requires only 1 argument. __supplement__",{dependency:e,supplement:i}):l.t("Function '__dependency__' requires an argument. __supplement__",{dependency:e,supplement:i});else{for(var o=[],a=0;a<t;a++)o[a]=a+1;var s=u.formatSymbol(e)+"("+o.join(", ")+")";i=l.t("For example, try typing: __recommendation__.",{recommendation:s}),n=l.t("Function '__dependency__' requires __assignment_arity__ arguments. __supplement__",{dependency:e,assignment_arity:t,supplement:i})}return c(n)},wrongParametrizedReducerArity:function(e){return c(l.t("Function '__symbol__' requires 2 arguments. For example, try typing: __recommendation__.",{symbol:u.formatSymbol(e),recommendation:u.formatSymbol(e)+"([1,2,3], 1)"}))},wrongDoubleReducerArity:function(e){return c(l.t("Function '__symbol__' requires 2 arguments. For example, try typing: __recommendation__.",{symbol:u.formatSymbol(e),recommendation:u.formatSymbol(e)+"([1,2,3], [3,2,1])"}))},primedFunctionArity:function(){return c(l.t("Prime notation can only be used for functions of a single argument."))},zeroArgReducer:function(e){return c(l.t("Function '__symbol__' requires at least one argument. For example, try typing: __symbol__(1, 2).",{symbol:u.formatSymbol(e)}))},missingRHS:function(e){return e=u.formatSymbol(e),c(l.t("What do you want '__symbol__' to equal?",{symbol:e}))},malformedPoint:function(){return c(l.t("Points are written like this: (1, 2)."))},nonPairTuple:function(){return c(l.t("Points may only have 2 coordinates."))},badImplicitCall:function(e){return e=u.formatSymbol(e),c(l.t("Use parentheses around the argument of '__symbol__'.",{symbol:e}))},badImplicitMultiply:function(){return c(l.t("Confusing implicit multiplication. Use parentheses or a '*' symbol."))},binaryOperatorMissingOperand:function(e){return c(l.t("You need something on both sides of the '__symbol__' symbol.",{symbol:e}))},unaryOperatorMissingLeft:function(e){return c(l.t("You need something before the '__symbol__' symbol.",{symbol:e}))},unaryOperatorMissingRight:function(e){return c(l.t("You need something after the '__symbol__' symbol.",{symbol:e}))},fractionMissingNumerator:function(){return c(l.t("You need a numerator for the top of your fraction."))},fractionMissingDenominator:function(){return c(l.t("You need a denominator for the bottom of your fraction."))},fractionEmpty:function(){return c(l.t("You need a numerator and denominator for your fraction."))},emptySubscript:function(){return c(l.t("Subscripts cannot be empty."))},emptySuperscript:function(){return c(l.t("Superscripts cannot be empty."))},invalidSubscript:function(e){return e=u.formatSymbol(e),c(l.t("Subscripts may only contain letters and digits. '__symbol__' is not allowed.",{symbol:e}))},invalidOperatorName:function(){return c(l.t("Operator names may only contain letters."))},unexpectedSubscript:function(){return c(l.t("Only functions and variables may have subscripts."))},superscriptWithPrime:function(){return c(l.t("Superscripts and primes cannot be combined."))},unexpectedPrime:function(){return c(l.t("Sorry, I don't understand this use of prime notation."))},primeWithoutParen:function(){return c(l.t("Primed function calls must use parentheses."))},emptyRadical:function(){return c(l.t("Radical cannot be empty."))},emptyRadicand:function(){return c(l.t("Radicand cannot be empty."))},emptyParen:function(){return c(l.t("Parentheses cannot be empty."))},emptySquareBracket:function(){return c(l.t("Square brackets cannot be empty."))},emptyPipe:function(){return c(l.t("Absolute value symbol cannot be empty."))},badTrigExponent:function(e){var t=e+"^2",r=e+"^-1";return c(l.t("Only __form1__ and __form2__ are supported. Otherwise, use parens.",{form1:t,form2:r}))},badLogExponent:function(e){var t=e+"^2";return c(l.t("Only __form__ is supported. Otherwise, use parens.",{form:t}))},inequalityChainTooLong:function(){return c(l.t("Cannot chain more than 2 inequalities."))},piecewiseMissingCondition:function(){return c(l.t("A piecewise expression must have at least one condition."))},piecewisePartMissingCondition:function(){return c(l.t("Every part of a piecewise expression must have a condition except the last."))},colonMissingCondition:function(){return c(l.t("The left side of a ':' must be a condition, like 'x>1'."))},blankExpression:function(){return c(l.t("You haven't written anything yet."))},functionNotDefined:function(e){return e=u.formatSymbol(e),c(l.t("Function '__dependency__' is not defined.",{dependency:e}))},parameterAlreadyDefined:function(e){return e=u.formatSymbol(e),c(l.t("You can't use '__dependency__' as a parameter of this function because '__dependency__' is already defined.",{dependency:e}))},cannotRedefine:function(e,t){return e=u.formatSymbol(e),c(void 0===t?l.t("You can't redefine '__symbol__' because it's already defined.",{symbol:e}):l.t("You can't define '__symbol__' because '__symbolRoot__' is already defined.",{symbol:e,symbolRoot:t}))},cannotSubscript:function(e){return e=u.formatSymbol(e),c(l.t("'__symbol__' cannot have a subscript.",{symbol:e}))},multiplyDefined:function(e){return e=u.formatSymbol(e),c(l.t("You've defined '__dependency__' in more than one place. Try deleting some of the definitions of '__dependency__'.",{dependency:e}))},shadowedIndex:function(e){return e=u.formatSymbol(e),c(l.t("You can't use '__symbol__' as an index because it's already defined.",{symbol:e}))},cycle:function(e){var t=(e=e.map(u.formatSymbol)).pop();return c(l.t("'__symbols__' and '__lastSymbol__' can't be defined in terms of each other.",{symbols:e.join("', '"),lastSymbol:t}))},selfReferentialFunction:function(e){return c(l.t("The definition of function '__symbol__' cannot depend on '__symbol__'.",{symbol:u.formatSymbol(e)}))},sliderLimitReferencesExport:function(e){return c(l.t("Slider limits cannot depend on the slider variable '__symbol__'.",{symbol:u.formatSymbol(e)}))},sliderMinInvalid:function(){return c(l.t("Invalid slider min. Try using any number."))},sliderMaxInvalid:function(){return c(l.t("Invalid slider max. Try using any number."))},sliderMaxLessThanMin:function(){return c(l.t("Invalid slider limits. Min should be less than max."))},sliderStepInvalid:function(){return c(l.t("Invalid slider step. Try using any number."))},domainMinInvalid:function(){return c(l.t("Invalid domain min. Try using any number."))},domainMaxInvalid:function(){return c(l.t("Invalid domain max. Try using any number."))},domainMaxLessThanMin:function(){return c(l.t("Invalid domain limits. Min should be less than max."))},cdfMinInvalid:function(){return c(l.t("Invalid cdf min. Try using any number."))},cdfMaxInvalid:function(){return c(l.t("Invalid cdf max. Try using any number."))},cdfMaxLessThanMin:function(){return c(l.t("Invalid cdf limits. Min should be less than max."))},tooManyVariables:function(e){if(0===(e=e.map(u.formatSymbol)).length)return c(l.t("Too many variables, I don't know what to do with this."));var t=e.pop();return c(l.t("Too many variables. Try defining '__variables__'.",{variables:(e.length?e.join("', '")+"' or '":"")+t}))},addArgumentsToDefinition:function(e,t,r){e=e.map(u.formatSymbol);var n=(t=u.formatSymbol(t))+"("+(r=r.map(u.formatSymbol)).join(",")+","+e.join(",")+")",i=e.pop(),o={symbols:e.join("', '"),lastSymbol:i,newSignature:n};return c(e.length?l.t("Try including '__symbols__' and '__lastSymbol__' as arguments by defining the function as '__newSignature__'.",o):l.t("Try including '__lastSymbol__' as an argument by defining the function as '__newSignature__'.",o))},invalidLHS:function(e){return e=u.formatSymbol(e),c(l.t("Sorry, you can't graph __symbol__ as a function of anything yet.",{symbol:e}))},unplottablePolarFunction:function(){return c(l.t("We can't plot  as a function of r. Try plotting r() instead."))},invalidInequalityVariables:function(){return c(l.t("We only plot inequalities of x and y, or r and ."))},invalidImplicitVariables:function(){return c(l.t("We only support implicit equations of x and y."))},singleVariableImplicitEquationsDisabled:function(){return c(l.t("Plotting single-variable implicit equations is disabled."))},complicatedImplicitInequality:function(){return c(l.t("We can only plot inequalities when one variable is quadratic or linear."))},complicatedPolarImplicit:function(){return c(l.t("Polar equations must be linear in r."))},invalidDoubleInequalityVariables:function(){return c(l.t("We only plot double inequalities of x and y."))},mismatchedDoubleInequality:function(){return c(l.t("Double inequalities must both go the same way, e.g. 1 < y < 2."))},complicatedDoubleInequality:function(){return c(l.t("We only support solved double inequalities. Try deleting one side of the inequality."))},equationRequired:function(e){return e?(e=u.formatSymbol(e),c(l.t("Try adding '__lhs__' to the beginning of this equation.",{lhs:e+"="}))):c(l.t("Try adding an equals sign to turn this into an equation."))},variableAsFunction:function(e){return e=u.formatSymbol(e),c(l.t("Variable '__dependency__' can't be used as a function.",{dependency:e}))},emptyList:function(){return c(l.t("Empty lists are not allowed."))},invalidTableHeader:function(e){return c(l.t("Table headers must be simple expressions. __supplement__",{supplement:e}))},invalidTableEntry:function(e){return c(l.t("Table entries must be simple expressions. __supplement__",{supplement:e}))},invalidFirstTableColumn:function(){return c(l.t("First column may not be __most__ or __last__.",{most:"'y', 'r',",last:"''"}))},invalidDependentFirstTableColumn:function(){return c(l.t("This column header can't be defined elsewhere in the calculator."))},invalidRegressionParameter:function(e){return c(l.t("'__symbol__' may not be used as a regression parameter.",{symbol:u.formatSymbol(e)}))},optimizationError:function(){return c(l.t("We couldn't find any region where this model is defined."))},badListInReducer:function(e){return c(l.t("When __symbol__ is called with more than two arguments, no argument can be a list.",{symbol:u.formatSymbol(e)})).allowExport()},nonListDoubleReducer:function(e){return c(l.t("Both arguments of '__symbol__' must be lists. For example, try typing: __recommendation__.",{symbol:u.formatSymbol(e),recommendation:u.formatSymbol(e)+"([1,2,3], [3,2,1])"})).allowExport()},nonListParametrizedReducer:function(e){return c(l.t("The first argument of '__symbol__' must be a list. For example, try typing: __recommendation__.",{symbol:u.formatSymbol(e),recommendation:u.formatSymbol(e)+"([1,2,3], 1)"})).allowExport()},variableRange:function(e){return c(l.t("Range cannot depend on free variable '__symbol__'.",{symbol:u.formatSymbol(e[0])})).allowExport()},nonArithmeticRange:function(e){return c(l.t("Ranges must be arithmetic sequences.")).allowExport()},sumMissingBound:function(){return c(l.t("Sums must have upper and lower bounds."))},productMissingBound:function(){return c(l.t("Products must have upper and lower bounds."))},incorrectSumLowerBound:function(){return c(l.t("Lower bound of a sum must set a variable equal to a number. Try n=1."))},incorrectProductLowerBound:function(){return c(l.t("Lower bound of a product must set a variable equal to a number. Try n=1."))},integralMissingBound:function(){return c(l.t("Integrals must have upper and lower bounds."))},integralMissingDifferential:function(){return c(l.t("Integrand must end with an integration variable, like dx."))},differentialWithSuperscript:function(){return c(l.t("Integration variable cannot have a superscript."))},sumMissingBody:function(){return c(l.t("What do you want to take the sum of?"))},productMissingBody:function(){return c(l.t("What do you want to take the product of?"))},integralMissingBody:function(){return c(l.t("What do you want to take the integral of?"))},derivativeMissingBody:function(){return c(l.t("What do you want to take the derivative of?"))},mismatchedBraces:function(e,t){return e=u.formatSymbol(e),t=u.formatSymbol(t),c(l.t("Expected '__symbol1__' to match '__symbol2__'.",{symbol1:e,symbol2:t}))},shadowedIntegrationVariable:function(e){return c(l.t("You can't use '__symbol__' as an integration variable because it's already defined.",{symbol:u.formatSymbol(e)}))},badIntegralBoundDependency:function(e){return c(l.t("Integration bounds can't depend on integration variable '__symbol__'.",{symbol:u.formatSymbol(e)}))},percentMissingOf:function(){return c(l.t("'%' must be used with 'of'. Try '25% of 12'."))},badAnsContext:function(){return c(l.t("You can't use 'ans' in this context."))},ansUndefined:function(){return c(l.t("The previous expression didn't define any value for ans."))},variablesUnsupported:function(e){return c(l.t("This calculator does not support variables like '__variable__'.",{variable:u.formatSymbol(e)}))},functionUnsupported:function(e){return c(l.t("This calculator does not support the '__symbol__' function.",{symbol:u.formatSymbol(e)}))},constantUnsupported:function(e){return c(l.t("This calculator does not support the constant '__symbol__'.",{symbol:u.formatSymbol(e)}))},assignmentsUnsupported:function(){return c(l.t("This calculator does not support defining variables."))},functionDefinitionsUnsupported:function(){return c(l.t("This calculator does not support function definitions."))},equationsUnsupported:function(){return c(l.t("This calculator does not support this type of equation."))},inequalitiesUnsupported:function(){return c(l.t("This calculator does not support inequalities."))},regressionsUnsupported:function(){return c(l.t("This calculator does not support regressions."))},pointsUnsupported:function(){return c(l.t("This calculator does not support points."))},featureUnavailable:function(){return c(l.t("This feature is not available in the current calculator."))},nonSquareDeterminant:function(){return c(l.t("Only square matrices have a determinant."))},nonSquareInverse:function(){return c(l.t("Only square matrices have an inverse."))},singularInverse:function(){return c(l.t("Singular matrices do not have an inverse."))},matrixAssignment:function(){return c(l.t("This calculator does not support this type of variable definition. Try using 'New Matrix'."))},matrixAddDimensions:function(){return c(l.t("Cannot add matrices with different dimensions."))},matrixSubtractDimensions:function(){return c(l.t("Cannot subtract matrices with different dimensions."))},matrixMultiplyDimensions:function(){return c(l.t("Cannot multiply matrices with incompatible dimensions."))},matrixFractionalPower:function(){return c(l.t("A matrix can only be raised to integer powers."))},matrixPowerDimensions:function(){return c(l.t("Only square matrices can be raised to a power."))},matrixElementTypeError:function(e){return c(l.t("Cannot use __arg__ as an element of a matrix.",{arg:e[0]}))},matrixInvalidVariable:function(e){return c(l.t("Cannot use '__symbol__' as a variable.",{symbol:u.formatSymbol(e)}))}}}),define("math/parsenode/expression",["require","pjs","./base","math/errormsg","math/types"],function(e){var t=e("pjs"),r=e("./base"),n=e("math/errormsg"),i=e("math/types");return t(r,function(e,t){e.init=function(e){if(!Array.isArray(e))throw new TypeError("Argument to expression constructor must be an Array.");t.init.call(this),this.args=e,this.valueType=this._getValueType(e),this.registerDependencies(),this.computeTreeSize()},e._getValueType=function(e){return i.Any},e.shouldExportAns=function(){return!0},e.registerDependencies=function(){for(var e=0;e<this.args.length;e++)this.mergeDependencies(this.args[e])},e.computeTreeSize=function(){for(var e=0,t=0;t<this.args.length;t++)this.args[t].treeSize&&(e+=this.args[t].treeSize);if(this.treeSize=e+1,1e4<e)throw n.deeplyNested()},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/scalarexpression",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e)},e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();e=e.concat(n.statements),t.push(n.expression)}return{statements:e,expression:this.scalarEvalExpression(t)}}})}),define("math/parsenode/expressionTypes",["require","pjs","./scalarexpression"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n={Add:t(r,{}),Subtract:t(r,{}),Multiply:t(r,{}),Divide:t(r,{}),Exponent:t(r,{}),Negative:t(r,{}),And:t(r,{isInequality:function(){return this.args[0].isInequality()&&this.args[1].isInequality()}}),PercentOf:t(r,{})};return n.RawExponent=t(n.Exponent,{}),n}),define("math/maybe-rational",["require","exports","math/builtin"],function(e,t,s){"use strict";function i(e,t){return{n:e,d:t}}function l(e){return"object"==typeof e&&"number"==typeof e.n&&"number"==typeof e.d}function c(e){return l(e)?e.n/e.d:e}function u(e,t){if(!isFinite(e)||!isFinite(t)||0===t||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>g||Math.abs(t)>g)return e/t;t<0&&(e=-e,t=-t);var r=s.gcd(e,t);return i(e/r,t/r)}function p(e){return l(e)?i(-e.n,e.d):-e}function d(e){return l(e)?0===e.n?e.d/e.n:i(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function o(e,t){if(!l(e)||!l(t))return c(e)+c(t);var r=s.gcd(e.d,t.d);return u(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function a(e,t){if(!l(e)||!l(t))return c(e)*c(t);var r=s.gcd(e.n,t.d),n=s.gcd(t.n,e.d);return u(e.n/r*(t.n/n),e.d/n*(t.d/r))}function h(e,t){return o(e,p(t))}function f(e,t){return l(e)&&l(t)?a(e,d(t)):c(e)/c(t)}function r(e,t){if(!l(e)||!l(t))return s.pow(c(e),c(t));var r=function(e,t){var r=e,n=t;if(t.n<0&&(n=p(t),r=d(e)),!l(r)||!l(n))return s.pow(c(e),c(t));if(e=r,1===(t=n).d)return u(Math.pow(e.n,t.n),Math.pow(e.d,t.n));var i=e.n<0;if(i&&t.d%2!=1)return NaN;var o=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?s.pow(c(e),c(t)):u(Math.pow(o,t.n),Math.pow(a,t.n))}(e,t);return l(r)?r:s.pow(c(e),c(t))}Object.defineProperty(t,"__esModule",{value:!0}),t.isRational=l;var g=Math.pow(2,53)-1;t.fromDecimalString=function(e){var t=e.match(/^(-)?(\d*)?(?:\.(\d*))?$/);if(!t)return NaN;var r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;var o=!!r;if(i){var a=i.replace(/0+$/,""),s=a.length,l=Math.pow(10,s),c=parseInt(n||"0",10)*l+parseInt(a||"0",10);return g<c||g<l?parseFloat(e):u(o?-c:c,l)}return c=parseInt(n,10),g<c?parseFloat(e):u(o?-c:c,1)},t.asFloat=c,t.maybeRational=u,t.neg=p,t.abs=function(e){return l(e)?i(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)},t.reciprocal=d,t.add=o,t.mul=a,t.sub=h,t.div=f,t.pow=r,t.sqrt=function(e){if(!l(e))return Math.sqrt(e);var t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(c(e)):u(t,r)},t.nthroot=function(e,t){return r(e,d(t))},t.mod=function(e,t){if(l(e)&&l(t))return h(e,a(t,i(Math.floor(c(f(e,t))),1)));var r=c(e),n=c(t);return r-n*Math.floor(r/n)},t.total=function(e){for(var t=i(0,1),r=0,n=e;r<n.length;r++)t=o(t,n[r]);return t}}),define("math/parsenode/constant",["require","pjs","./scalarexpression","math/maybe-rational"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("math/maybe-rational");return t(r,function(e,t){e.init=function(e){"number"==typeof e&&(e=n.maybeRational(e,1)),this._constantValue=e,t.init.call(this,[])},e.isConstant=!0,e.getEvalStrings=function(){return{statements:[],expression:this.scalarExprString()}},e.asValue=function(){return"boolean"==typeof this._constantValue?this._constantValue:n.asFloat(this._constantValue)},e.asMaybeRationalValue=function(){return"boolean"==typeof this._constantValue?NaN:this._constantValue},e.scalarExprString=function(){return 0<this.asValue()?String(this.asValue()):"("+String(this.asValue())+")"},e.getEvaluationInfo=function(){return[{val:this.asValue()}]},e.isNaN=function(){return"number"==typeof this.asValue()&&isNaN(this.asValue())}})}),define("math/parsenode/mixednumber",["require","pjs","./constant"],function(e){return e("pjs")(e("./constant"),function(e,t){e.init=function(e){t.init.call(this,e)},e.is_mixed_number=!0})}),define("math/parsenode/identifier",["require","pjs","./expression","graphing/label","math/parser/input-span"],function(e){var t=e("pjs"),r=e("./expression"),n=e("graphing/label"),i=e("math/parser/input-span");return t(r,function(e,t,r){e.init=function(e){t.init.call(this,[]),this._symbol=n.latexToIdentifier(e),this.setInputSpan(new i.Span(e,0,e.length)),this.addDependency(this._symbol)},e.evaluate=function(){throw"Cannot evaluate undefined variable "+this._symbol}})}),define("math/parsenode/ans",["require","pjs","./identifier"],function(e){return e("pjs")(e("./identifier"),function(e,t,r){})}),define("math/parsenode/freevariable",["require","pjs","./scalarexpression"],function(e){return e("pjs")(e("./scalarexpression"),function(e,t){e.init=function(e){t.init.call(this,[]),this.addDependency(e),this._symbol=e},e.isFreeVariable=!0,e.scalarEvalExpression=function(e){return this._symbol},e.copyWithArgs=function(e){return this}})}),define("math/parsenode/dummyindex",["require","pjs","./freevariable"],function(e){return e("pjs")(e("./freevariable"),function(){})}),define("math/parsenode/list",["require","pjs","./expression","math/errormsg","math/types"],function(e){var t=e("pjs"),r=e("./expression"),i=e("math/errormsg"),a=e("math/types");return t(r,function(e,t,n){e.init=function(e){if(t.init.call(this,e),this.length=e.length,0===this.length)throw i.emptyList()},e.isList=!0,e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();Array.prototype.push.apply(e,n.statements),t.push(n.expression)}return{statements:e,expression:"["+t.join(",")+"]"}},e.asValue=function(){for(var e=[],t=0;t<this.args.length;t++)e.push(this.args[t].asValue());return e},e.asMaybeRationalValue=function(){for(var e=[],t=0;t<this.args.length;t++)e.push(this.args[t].asMaybeRationalValue());return e},e.getEvaluationInfo=function(){if(this.args.every(function(e){return e.isConstant}))return[{val:this.args.map(function(e){return e.asValue()})}]},n.eachArgs=function(e,t){var r=function(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}(e);if(isFinite(r))for(var n=0;n<r;n++){for(var i=[],o=0;o<e.length;o++)i.push(e[o].isList||a.isList(e[o].valueType)?e[o].elementAt(n):e[o]);t(i)}else t(e)},n.mapArgs=function(e,t){var r=[];return n.eachArgs(e,function(e){r.push(t(e))}),r},n.wrap=function(e){return e.isList||a.isList(e.valueType)?e:n([e])}})}),define("math/parsenode/range",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t,r){e.init=function(e){t.init.call(this,e),this.beginning=e[0],this.end=e[1]}})}),define("math/parsenode/broadcast",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,o,t){e.init=function(e,t){if(o.init.call(this,t),this._replacedSymbols=e,this._expression=t[0],this._lists=t.slice(1),!e.length)throw new Error("Cannot construct a broadcast node with no replaced symbols");for(var r=0;r<e.length;r++)this.removeDependency(e[r]);for(var n=1/0,i=0;i<this._lists.length;i++){if(!this._lists[i].isList)throw new Error("List arguments of broadcast must be list literals");n=Math.min(n,this._lists[i].length)}this.length=n},e.isBroadcast=!0,e.copyWithArgs=function(e){return new this.constructor(this._replacedSymbols,e)},e.evaluate=function(e){for(var t=this._expression.getCompiledFunction(this._replacedSymbols).fn,r=[],n=0;n<this.length;n++){for(var i=[],o=0;o<e.length;o++)i.push(e[o][n]);r.push(t.apply(void 0,i))}return r},e.getEvalStrings=function(){var e=[],t=this._expression.getEvalStrings();Array.prototype.push.apply(e,t.statements);var r,n=[],i=[];for(r=0;r<this._lists.length;r++){var o=this._lists[r].getEvalStrings();Array.prototype.push.apply(e,o.statements);var a=this.tmpVar();i.push(a),n.push("var "+a+" = "+o.expression)}var s=this.tmpVar(),l=this.tmpVar();n.push("var "+s+" = []");var c=[];for(r=0;r<i.length;r++)c.push("var "+this._replacedSymbols[r]+" = "+i[r]+"["+l+"]");return n.push("for (var "+l+" = 0; "+l+" < "+this.length+"; "+l+"++) {\n  "+c.join(";\n  ")+";\n  "+s+".push("+t.expression+");\n}"),{statements:e.concat(n),expression:s}}})}),define("math/parsenode/listaccess",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e),this.list=e[0],this.index=e[1]},e.getEvalStrings=function(){var e=this.index.getEvalStrings(),t=this.list.getEvalStrings(),r=e.statements.concat(t.statements),n=this.tmpVar();r.push(n+" = "+t.expression);var i=this.tmpVar();return r.push(i+" = Math.floor("+e.expression+") - 1"),{statements:r,expression:"("+i+" >= 0 && "+i+" < "+n+".length ? "+n+"["+i+"] : NaN)"}}})}),define("math/parsenode/orderedpair",["require","pjs","./scalarexpression"],function(e){return e("pjs")(e("./scalarexpression"),function(e,t,r){e.asArray=function(){return[+this.args[0].asValue(),+this.args[1].asValue()]},e.asValue=e.asArray,e.getSliderVariables=function(t,e){return t.sliderVariables(e.getDependencies()).filter(function(e){return!t.validParametricVariable(e)})},e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();e=e.concat(n.statements),t.push(n.expression)}return{statements:e,expression:"["+t.join(",")+"]"}}})}),define("math/parsenode/movablepoint",["require","pjs","./orderedpair"],function(e){return e("pjs")(e("./orderedpair"),function(e,n){e.init=function(e,t,r){n.init.call(this,e),this.moveStrategy=t,this.defaultDragMode=r},e.isMovablePoint=!0})}),define("math/parsenode/orderedpairaccess",["require","pjs","./scalarexpression"],function(e){return e("pjs")(e("./scalarexpression"),function(e,t){e.init=function(e){t.init.call(this,e),this.point=e[0],this.index=e[1]},e.getEvalStrings=function(){var e=this.index.getEvalStrings(),t=this.point.getEvalStrings(),r=[];return Array.prototype.push.apply(r,e.statements),Array.prototype.push.apply(r,t.statements),{statements:r,expression:t.expression+"["+e.expression+"-1]"}}})}),define("math/parsenode/polygon",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/comparators",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.table={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}},t.get=function(e,t){switch(t){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}}),define("math/parsenode/basecomparator",["require","pjs","./scalarexpression","./expressionTypes","math/comparators","math/functions"],function(e){var o=e("pjs"),t=e("./scalarexpression"),r=e("./expressionTypes").Subtract,a=e("math/comparators").table,s=e("math/functions");return o(t,function(e,t,i){i.create=function(r,n){return n=n||r,o(i,function(e,t){e.operator=r,e.isInequality=function(){return 0!==a[r].direction},e.compiledOperator=n,e.scalarEvalExpression=function(e){return e.join(n)},e.evaluate=s.createEvaluateFunction(e.scalarEvalExpression,2)})},e.init=function(e){t.init.call(this,e),this._difference=r(-1===a[this.operator].direction?[e[1],e[0]]:[e[0],e[1]])}})}),define("math/parsenode/comparator",["require","math/parsenode/basecomparator"],function(e){var t=e("math/parsenode/basecomparator");return{"<":t.create("<"),">":t.create(">"),"<=":t.create("<="),">=":t.create(">="),"=":t.create("=","===")}}),define("math/parsenode/doubleinequality",["require","pjs","./base","math/comparators","./comparator"],function(e){var t=e("pjs"),r=e("./base"),n=e("math/comparators"),i=e("./comparator");return t(r,function(e,r){e.init=function(e){r.init.call(this),this.args=e,this._symbol=e[2]._symbol,this._operators=[e[1],e[3]],this._expressions=[e[0],e[4]];var t=n.get(n.table[e[1]].inclusive&&n.table[e[3]].inclusive,n.table[e[1]].direction);this._indicator=i[t]([e[0],e[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])},e.isInequality=function(){return!0},e.isShadeBetween=function(){return!0}})}),define("math/parsenode/repeatedoperator",["require","pjs","./scalarexpression","./dummyindex"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./dummyindex");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this._index=e[0],this.addDummyDependency(this._index._symbol),this._index instanceof n&&this.removeDependency(this._index._symbol)},e.getEvalStrings=function(){var e=[],t=this.tmpVar(),r=this._index._symbol,n=this.tmpVar(),i=this.tmpVar(),o=this.args[1].getEvalStrings(),a=this.args[2].getEvalStrings(),s=this.args[3].getEvalStrings();Array.prototype.push.apply(e,o.statements),e.push("var "+n+" = Math.round("+o.expression+")"),Array.prototype.push.apply(e,a.statements),e.push("var "+i+" = Math.round("+a.expression+")"),e.push("var "+t+"="+this.starting_value);var l="for (var "+r+"="+n+";"+r+"<="+i+";"+r+"++) {"+s.statements.join(";")+";"+t+this.in_place_operator+s.expression+"};",c="if(!isFinite("+i+"-"+n+")) {"+t+"=("+i+"<"+n+"?"+this.starting_value+":NaN);}else{"+l+"}";return e.push(c),{statements:e,expression:t}},e.evaluate=function(e,t,r){var n=r.getCompiledFunction([this._index._symbol]).fn;if(t=Math.round(t),e=Math.round(e),!isFinite(t-e))return t<e?this.starting_value:NaN;for(var i=this.starting_value,o=e;o<=t;o++)i=this.update(i,n(o));return i}})}),define("math/parsenode/sum",["require","pjs","./repeatedoperator"],function(e){return e("pjs")(e("./repeatedoperator"),function(e,t){e.in_place_operator="+=",e.starting_value=0,e.evaluateConstant=function(e){var t=1+Math.round(e[1])-Math.round(e[0]);return t<=0?this.starting_value:t*e[2]},e.update=function(e,t){return e+t}})}),define("math/parsenode/product",["require","pjs","./repeatedoperator"],function(e){return e("pjs")(e("./repeatedoperator"),function(e,t){e.in_place_operator="*=",e.starting_value=1,e.evaluateConstant=function(e){var t=1+Math.round(e[1])-Math.round(e[0]);return t<=0?this.starting_value:Math.pow(e[2],t)},e.update=function(e,t){return e*t}})}),define("math/parsenode/integral",["require","pjs","./scalarexpression","./dummyindex","math/builtin"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./dummyindex"),o=e("math/builtin");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this._differential=e[0],this.addDummyDependency(this._differential._symbol),this._differential instanceof n&&this.removeDependency(this._differential._symbol)},e.getEvalStrings=function(){var e=this.args[0],t=this.args[1],r=this.args[2],n=this.args[3],i=[],o=this.tmpVar(),a=e._symbol,s=this.tmpVar(),l=this.tmpVar(),c=t.getEvalStrings(),u=r.getEvalStrings(),p=n.getEvalStrings();return Array.prototype.push.apply(i,c.statements),Array.prototype.push.apply(i,u.statements),i.push("var "+s+" = "+c.expression),i.push("var "+l+" = "+u.expression),i.push("var "+o+" = function ("+a+") { "+p.statements.join("; ")+"; return "+p.expression+";}"),{statements:i,expression:"BuiltIn.quad("+[o,s,l].join(", ")+")"}},e.evaluate=function(e,t,r){var n=this.args[0],i=r.getCompiledFunction([n._symbol]).fn;return o.quad(i,e,t)}})}),define("math/parsenode/functioncall",["require","pjs","./expression","./identifier"],function(e){var t=e("pjs"),r=e("./expression"),n=e("./identifier");return t(r,function(e,r){e.init=function(e,t){"string"==typeof e&&(e=n(e)),this._identifier=e,this._symbol=e._symbol,r.init.call(this,t),this.addDependency(this._symbol)},e.copyWithArgs=function(e){return new this.constructor(n(this._symbol),e)}})}),define("math/parsenode/functionexponent",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){})}),define("math/parsenode/functionfactorial",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){})}),define("math/parsenode/prime",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,r){e.init=function(e,t){r.init.call(this,t),this.order=e},e.copyWithArgs=function(e){return new this.constructor(this.order,e)}})}),define("math/parsenode/piecewise",["require","pjs","./scalarexpression","./constant","math/maybe-rational"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./constant"),i=e("math/maybe-rational").maybeRational,o=t(r,{});return o.chain=function(e){for(var t,r=n(NaN);e.length;)t=e.pop(),r=o([t.condition,t.if_expr,r]);return r},o.empty=function(){return o([n(!0),n(i(1,1)),n(NaN)])},o}),define("math/parsenode/derivative",["require","pjs","./scalarexpression","./identifier"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./identifier");return t(r,function(e,r){e.init=function(e,t){this._symbol=e instanceof n?e._symbol:n(e)._symbol,r.init.call(this,t)}})}),define("math/parsenode/nativefunction",["require","pjs","./scalarexpression","math/errormsg","math/functions"],function(e){var n=e("pjs"),t=e("./scalarexpression"),o=e("math/errormsg"),s=e("math/functions");return n(t,function(e,i,t){e.init=function(e){var t=e.length,r="logbase"===this._symbol?"log":this._symbol,n="logbase"===this._symbol?1:0;if(t<this._requiredArity)throw o.wrongArity(r,this._requiredArity-n,t-n);if(t>this._maxArity)throw o.wrongArity(r,this._maxArity-n,t-n);for(;e.length<this._maxArity;)e.push(this._optionalArguments[t-this._requiredArity]);i.init.call(this,e)},e.scalarEvalExpression=function(e){return this.head+"("+e.join(",")+")"},t.create=function(r,i,o,a){return n(this,function(e,t,n){n.isFunction=!0,e._symbol=r,e.head=i,e._requiredArity=o,e._optionalArguments=a||[],e._maxArity=e._requiredArity+e._optionalArguments.length,e.evaluate=s.createEvaluateFunction(e.scalarEvalExpression.bind(e),e._maxArity),n.getConcreteInvocationTree=function(e,t,r){return n(t).getConcreteTree(e,r)},n.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/typedfunction",["require","pjs","./nativefunction"],function(e){return e("pjs")(e("./nativefunction"),function(e,t,r,a){r.create=function(e,t,r,n){var i=r.length,o=a.create.call(this,e,t,i);return o.prototype._inputTypes=r,o.prototype._outputType=n,o}})}),define("math/parsenode/trigfunction",["require","pjs","./nativefunction","./expressionTypes","math/errormsg"],function(e){var t=e("pjs"),r=e("./nativefunction"),a=e("./expressionTypes").Multiply,s=e("math/errormsg");return t(r,function(e,t,r,n){r.create=function(i,e){var o=n.create(i,e,1);return o.getConcreteInvocationTree=function(e,t,r){if(t.length<1)throw s.wrongArity(i,1,t.length);var n=e.trigAngleMultiplier?[a([t[0],e.trigAngleMultiplier])].concat(t.slice(1)):t;return o(n).getConcreteTree(e,r)},o.getCacheKeys=function(){return["trigAngleMultiplier"]},o}})}),define("math/parsenode/inversetrigfunction",["require","pjs","./nativefunction","./expressionTypes"],function(e){var t=e("pjs"),r=e("./nativefunction"),o=e("./expressionTypes").Divide;return t(r,function(e,t,r,n){r.create=function(e,t,r){var i=n.create(e,t,1,r);return i.getConcreteInvocationTree=function(e,t,r){var n=i(t);return(e.trigAngleMultiplier?o([n,e.trigAngleMultiplier]):n).getConcreteTree(e,r)},i.getCacheKeys=function(){return["trigAngleMultiplier"]},i}})}),define("math/parsenode/reducerfunction",["require","pjs","./expression","math/functions"],function(e){var o=e("pjs"),t=e("./expression"),a=e("math/functions");return o(t,function(e,t,n){e.evalExpression=function(e){return this.head+"("+e+")"},e.getEvalStrings=function(){var e=this.args[0].getEvalStrings();return{statements:e.statements,expression:this.evalExpression(e.expression)}},n.create=function(r,i){return o(n,function(e,t,n){e._symbol=r,e.head=i,e._arity=1,n.isFunction=!0,e.evaluate=a.createEvaluateFunction(e.evalExpression.bind(e),e._arity),n.getConcreteInvocationTree=function(e,t,r){return n(t).getConcreteTree(e,r)},n.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/doublereducerfunction",["require","pjs","./expression","math/functions","math/errormsg"],function(e){var o=e("pjs"),t=e("./expression"),a=e("math/functions"),r=e("math/errormsg");return o(t,function(e,t,n){e.init=function(){if(t.init.apply(this,arguments),2!==this.args.length)throw r.wrongDoubleReducerArity(this._symbol)},e.evalExpression=function(e){return this.head+"("+e.join(",")+")"},e.getEvalStrings=function(){for(var e=[],t=[],r=Math.min(this.args[0].length,this.args[1].length),n=0;n<this.args.length;n++){var i=this.args[n],o=i.getEvalStrings();Array.prototype.push.apply(e,o.statements),t.push(i.length===r?o.expression:o.expression+".slice(0,"+r+")")}return{statements:e,expression:this.evalExpression(t)}},n.create=function(r,i){return o(n,function(e,t,n){e._symbol=r,e.head=i,e._arity=2,n.isFunction=!0,e.evaluate=a.createEvaluateFunction(e.evalExpression.bind(e),e._arity),n.getConcreteInvocationTree=function(e,t,r){return n(t).getConcreteTree(e,r)},n.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/parametrizedreducerfunction",["require","pjs","./expression","math/functions","math/errormsg"],function(e){var o=e("pjs"),t=e("./expression"),a=e("math/functions"),r=e("math/errormsg");return o(t,function(e,t,n){e.init=function(){if(t.init.apply(this,arguments),2!==this.args.length)throw r.wrongParametrizedReducerArity(this._symbol)},e.evalExpression=function(e){return this.head+"("+e.join(",")+")"},e.getEvalStrings=function(){var e=[],t=this.args[0].getEvalStrings(),r=this.args[1].getEvalStrings();return Array.prototype.push.apply(e,t.statements),Array.prototype.push.apply(e,r.statements),{statements:e,expression:this.evalExpression([t.expression,r.expression])}},n.create=function(r,i){return o(n,function(e,t,n){e._symbol=r,e.head=i,e._arity=2,n.isFunction=!0,e.evaluate=a.createEvaluateFunction(e.evalExpression.bind(e),e._arity),n.getConcreteInvocationTree=function(e,t,r){return n(t).getConcreteTree(e,r)},n.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/distribution",["require","pjs","./scalarexpression","math/errormsg"],function(e){var n=e("pjs"),t=e("./scalarexpression"),i=e("math/errormsg");return n(t,function(e,t,r){e.init=function(e){if(e.length<this._requiredArity)throw i.wrongArity(this._symbol,this._requiredArity,e.length);if(e.length>this._maxArity)throw i.wrongArity(this._symbol,this._maxArity,e.length);for(;e.length<this._maxArity;)e.push(this._optionalArguments[e.length-this._requiredArity]);t.init.call(this,e)},e.scalarEvalExpression=function(e){return this.head+"("+e.join(",")+")"},r.create=function(r,i,o){return n(this,function(e,t,n){n.isFunction=!0,e._symbol=r,e._requiredArity=i,e._optionalArguments=o||[],e._maxArity=e._requiredArity+e._optionalArguments.length,n.getConcreteInvocationTree=function(e,t,r){return n(t)},n.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/toplevelfunction",["require","pjs","./nativefunction","math/errormsg"],function(e){var i=e("pjs"),t=e("./nativefunction"),o=e("math/errormsg");return i(t,function(e,t,r,n){r.create=function(n){return i(r,function(e,t,r){r.isFunction=!0,r.getConcreteInvocationTree=function(e,t,r){throw o.unexpectedSymbol(n)}})}})}),define("math/parsenode/builtinfunction",["require","math/parsenode/nativefunction","math/parsenode/typedfunction","math/parsenode/trigfunction","math/parsenode/inversetrigfunction","math/parsenode/reducerfunction","math/parsenode/doublereducerfunction","math/parsenode/parametrizedreducerfunction","math/parsenode/distribution","math/parsenode/toplevelfunction","math/types","math/maybe-rational","math/parsenode/constant","math/parsenode/identifier"],function(e){var t=e("math/parsenode/nativefunction"),r=e("math/parsenode/typedfunction"),n=e("math/parsenode/trigfunction"),i=e("math/parsenode/inversetrigfunction"),o=e("math/parsenode/reducerfunction"),a=e("math/parsenode/doublereducerfunction"),s=e("math/parsenode/parametrizedreducerfunction"),l=e("math/parsenode/distribution"),c=e("math/parsenode/toplevelfunction"),u=e("math/types"),p=e("math/maybe-rational").maybeRational,d=e("math/parsenode/constant"),h=e("math/parsenode/identifier"),f=d(p(1,1)),g=d(p(0,1)),m=d(p(1,2)),y=d(-1/0);return{sin:n.create("sin","BuiltIn.sin"),cos:n.create("cos","BuiltIn.cos"),tan:n.create("tan","BuiltIn.tan"),cot:n.create("cot","BuiltIn.cot"),sec:n.create("sec","BuiltIn.sec"),csc:n.create("csc","BuiltIn.csc"),arcsin:i.create("arcsin","Math.asin"),arccos:i.create("arccos","Math.acos"),arctan:i.create("arctan","Math.atan2",[f]),arccot:i.create("arccot","BuiltIn.acot"),arcsec:i.create("arcsec","BuiltIn.asec"),arccsc:i.create("arccsc","BuiltIn.acsc"),sinh:t.create("sinh","BuiltIn.sinh",1),cosh:t.create("cosh","BuiltIn.cosh",1),tanh:t.create("tanh","BuiltIn.tanh",1),coth:t.create("coth","BuiltIn.coth",1),sech:t.create("sech","BuiltIn.sech",1),csch:t.create("csch","BuiltIn.csch",1),arcsinh:t.create("arcsinh","BuiltIn.asinh",1),arccosh:t.create("arccosh","BuiltIn.acosh",1),arctanh:t.create("arctanh","BuiltIn.atanh",1),arccoth:t.create("arccoth","BuiltIn.acoth",1),arcsech:t.create("arcsech","BuiltIn.asech",1),arccsch:t.create("arccsch","BuiltIn.acsch",1),sqrt:t.create("sqrt","Math.sqrt",1),rtxsqpone:t.create("rtxsqpone","BuiltIn.sqrtxsqp1",1),rtxsqmone:t.create("rtxsqmone","BuiltIn.sqrtxsqm1",1),nthroot:t.create("nthroot","BuiltIn.nthroot",2),log:t.create("log","BuiltIn.common_log",1),logbase:t.create("logbase","BuiltIn.log_base",2),ln:t.create("ln","BuiltIn.log",1),exp:t.create("exp","Math.exp",1),floor:t.create("floor","Math.floor",1),ceil:t.create("ceil","Math.ceil",1),round:t.create("round","BuiltIn.round",1,[g]),abs:t.create("abs","Math.abs",1),sign:t.create("sign","BuiltIn.sign",1),mod:t.create("mod","BuiltIn.mod",2),nCr:t.create("nCr","BuiltIn.nCr",2),nPr:t.create("nPr","BuiltIn.nPr",2),factorial:t.create("factorial","BuiltIn.factorial",1),polyGamma:t.create("polyGamma","BuiltIn.polyGamma",2),lcm:o.create("lcm","BuiltIn.listLCM"),gcd:o.create("gcd","BuiltIn.listGCD"),mean:o.create("mean","BuiltIn.mean"),total:o.create("total","BuiltIn.total"),stdev:o.create("stdev","BuiltIn.stdev"),stdevp:o.create("stdevp","BuiltIn.stdevp"),mad:o.create("mad","BuiltIn.mad"),length:o.create("length","BuiltIn.length"),min:o.create("min","BuiltIn.listMin"),max:o.create("max","BuiltIn.listMax"),argmin:o.create("argmin","BuiltIn.argMin"),argmax:o.create("argmax","BuiltIn.argMax"),median:o.create("median","BuiltIn.median"),var:o.create("var","BuiltIn.var"),varp:o.create("varp","BuiltIn.varp"),cov:a.create("cov","BuiltIn.cov"),covp:a.create("covp","BuiltIn.covp"),corr:a.create("corr","BuiltIn.corr"),quantile:s.create("quantile","BuiltIn.quantile"),quartile:s.create("quartile","BuiltIn.quartile"),upperQuantileIndex:s.create("upperQuantileIndex","BuiltIn.upperQuantileIndex"),lowerQuantileIndex:s.create("lowerQuantileIndex","BuiltIn.lowerQuantileIndex"),quartileIndex:s.create("quartileIndex","BuiltIn.quartileIndex"),upperQuartileIndex:s.create("upperQuartileIndex","BuiltIn.upperQuartileIndex"),lowerQuartileIndex:s.create("lowerQuartileIndex","BuiltIn.lowerQuartileIndex"),normalcdf:t.create("normalcdf","BuiltIn.normalcdf",2,[g,f]),normalpdf:t.create("normalpdf","BuiltIn.normalpdf",1,[g,f]),binomcdf:t.create("binomcdf","BuiltIn.binomcdf",3,[m]),binompdf:t.create("binompdf","BuiltIn.binompdf",2,[m]),poissoncdf:t.create("poissoncdf","BuiltIn.poissoncdf",3),poissonpdf:t.create("poissonpdf","BuiltIn.poissonpdf",2),invNorm:t.create("invNorm","BuiltIn.invNorm",1),invT:t.create("invT","BuiltIn.invT",2),invPoisson:t.create("invPoisson","BuiltIn.invPoisson",2),invBinom:t.create("invBinom","BuiltIn.invBinom",3),ZScore:t.create("ZScore","BuiltIn.ZScore",3),erf:t.create("erf","BuiltIn.erf",1),tpdf:t.create("tpdf","BuiltIn.tpdf",2),tcdf:t.create("tcdf","BuiltIn.tcdf",3),TTest:s.create("TTest","BuiltIn.TTest"),TScore:s.create("TScore","BuiltIn.TScore"),distance:r.create("distance","BuiltIn.distance",[u.Point,u.Point],u.Number),midpoint:r.create("midpoint","BuiltIn.midpoint",[u.Point,u.Point],u.Point),normdist:l.create("normdist",0,[g,f]),tdist:l.create("tdist",1),binomdist:l.create("binomdist",1,[m]),poissondist:l.create("poissondist",1),pdf:t.create("pdf","BuiltIn.normpdf",1,[h("x")]),cdf:t.create("cdf","BuiltIn.normcdf",1,[h("x"),y]),polygon:c.create("polygon"),histogram:c.create("histogram"),dotplot:c.create("dotplot"),boxplot:c.create("boxplot")}}),define("math/parsenode/histogram",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/dotplot",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/boxplot",["require","pjs","./expression"],function(e){return e("pjs")(e("./expression"),function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/equation",["require","./base","pjs","./expressionTypes","math/parsenode/comparator"],function(e){var t=e("./base"),r=e("pjs"),n=e("./expressionTypes").Subtract,i=e("math/parsenode/comparator");return r(t,function(e,r){e.init=function(e,t){r.init.call(this),this.mergeDependencies(e,t),this._lhs=e,this._rhs=t,this._difference=n([this._lhs,this._rhs])},e.asComparator=function(){return i["="]([this._lhs,this._rhs])}})}),define("math/parsenode/assignment",["require","./base","./equation","./identifier","pjs"],function(e){var t=e("./base"),n=e("./equation"),i=e("./identifier");return e("pjs")(t,function(e,r){e.init=function(e,t){r.init.call(this),e=e._symbol,this.mergeDependencies(t),this._expression=t,this._symbol=e,this._exports=this.computeExports()},e.shouldExportAns=function(){return!0},e.computeExports=function(){for(var e=this._symbol,t=this.getDependencies(),r=0;r<t.length;r++)if(t[r]===e)return[];return[e]},e.isEquation=function(e){return-1!==e.getDependencies().indexOf(this._symbol)},e.asEquation=function(){var e=n(i(this._symbol),this._expression);return e.userData=this.userData,e.metaData=this.metaData,e},e.shouldPromoteToSlider=function(e){return!!this._expression.isConstant&&!this._expression.is_mixed_number&&"number"==typeof this._expression.asValue()&&!!isFinite(this._expression.asValue())&&e.isValidSlider(this._symbol)}})}),define("math/parsenode/functiondefinition",["require","pjs","./base","math/errormsg","./equation","./identifier","./functioncall"],function(e){var t=e("pjs"),r=e("./base"),o=e("math/errormsg"),i=e("./equation"),a=e("./identifier"),s=e("./functioncall");return t(r,function(e,n){e.init=function(e,t,r){n.init.call(this),e=e._symbol,this._argSymbols=t.map(function(e){return e._symbol}),this._symbol=e,this._exports=[e],this._expression=r,this.addDependencies(this._argSymbols),this.addDummyDependencies(this._argSymbols),this.mergeDependencies(this._expression)},e.isFunction=!0,e.getConcreteInvocationTree=function(e,t,r){if(t.length!==this._argSymbols.length)throw o.wrongArity(this._symbol,this._argSymbols.length,t.length);for(var n=Object.create(e),i=0;i<this._argSymbols.length;i++)n[this._argSymbols[i]]=t[i];return this._expression.getConcreteTree(n,r)},e.getSliderVariables=function(e,t){var r=this._argSymbols;return e.sliderVariables(t.getDependencies()).filter(function(e){return-1===r.indexOf(e)})},e.asEquation=function(){var e=this._argSymbols.map(function(e){return a(e)}),t=i(s(a(this._symbol),e),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}})}),define("numeric",[],function(){"use strict";var I="undefined"==typeof exports?function(){}:exports;return"undefined"!=typeof global&&(global.numeric=I),I.version="1.2.6",I._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},I.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:I._myIndexOf,I.precision=4,I.largeArray=50,I.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t="return function ("+e.join(",")+") {"+t+"}",new Function(["numeric"],t)(I)},I._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},I.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?I._dim(e):[e.length,t.length]:[e.length]:[]},I.mapreduce=function(e,t){return I.compile("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},I.mapreduce2=function(e,t){return I.compile("x","var n = x.length;\nvar i,xi;\n"+t+"\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},I.rep=function(e,t,r){void 0===r&&(r=0);var n,i=e[r],o=Array(i);if(r===e.length-1){for(n=i-2;0<=n;n-=2)o[n+1]=t,o[n]=t;return-1===n&&(o[0]=t),o}for(n=i-1;0<=n;n--)o[n]=I.rep(e,t,r+1);return o},I.dotMMsmall=function(e,t){var r,n,i,o,a,s,l,c,u,p,d;for(o=e.length,a=t.length,s=t[0].length,l=Array(o),r=o-1;0<=r;r--){for(c=Array(s),u=e[r],i=s-1;0<=i;i--){for(p=u[a-1]*t[a-1][i],n=a-2;1<=n;n-=2)d=n-1,p+=u[n]*t[n][i]+u[d]*t[d][i];0===n&&(p+=u[0]*t[0][i]),c[i]=p}l[r]=c}return l},I._getCol=function(e,t,r){var n;for(n=e.length-1;0<n;--n)r[n]=e[n][t],r[--n]=e[n][t];0===n&&(r[0]=e[0][t])},I.dotMMbig=function(e,t){var r,n,i,o=I._getCol,a=t.length,s=Array(a),l=e.length,c=t[0].length,u=new Array(l),p=I.dotVV;for(--a,n=--l;-1!==n;--n)u[n]=Array(c);for(n=--c;-1!==n;--n)for(o(t,n,s),i=l;-1!==i;--i)0,r=e[i],u[i][n]=p(r,s);return u},I.dotMV=function(e,t){var r,n=e.length,i=(t.length,Array(n)),o=I.dotVV;for(r=n-1;0<=r;r--)i[r]=o(e[r],t);return i},I.dotVM=function(e,t){var r,n,i,o,a,s,l;for(i=e.length,o=t[0].length,a=Array(o),n=o-1;0<=n;n--){for(s=e[i-1]*t[i-1][n],r=i-2;1<=r;r-=2)l=r-1,s+=e[r]*t[r][n]+e[l]*t[l][n];0===r&&(s+=e[0]*t[0][n]),a[n]=s}return a},I.dotVV=function(e,t){var r,n,i=e.length,o=e[i-1]*t[i-1];for(r=i-2;1<=r;r-=2)n=r-1,o+=e[r]*t[r]+e[n]*t[n];return 0===r&&(o+=e[0]*t[0]),o},I.dot=function(e,t){var r=I.dim;switch(1e3*r(e).length+r(t).length){case 2002:return t.length<10?I.dotMMsmall(e,t):I.dotMMbig(e,t);case 2001:return I.dotMV(e,t);case 1002:return I.dotVM(e,t);case 1001:return I.dotVV(e,t);case 1e3:return I.mulVS(e,t);case 1:return I.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},I.diag=function(e){var t,r,n,i,o=e.length,a=Array(o);for(t=o-1;0<=t;t--){for(i=Array(o),r=t+2,n=o-1;r<=n;n-=2)i[n]=0,i[n-1]=0;for(t<n&&(i[n]=0),i[t]=e[t],n=t-1;1<=n;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),a[t]=i}return a},I.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;1<=t;--t)n[t]=e[t][t],n[--t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},I.identity=function(e){return I.diag(I.rep([e],1))},I.pointwise=function(e,t,r){void 0===r&&(r="");var n,i,o=[],a=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)a.test(e[n])?s=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),o.push(i);return o[e.length]="_s",o[e.length+1]="_k",o[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",I.compile.apply(null,o)},I.pointwise2=function(e,t,r){void 0===r&&(r="");var n,i,o=[],a=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)a.test(e[n])?s=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),o.push(i);return o[e.length]="var _n = "+s+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",I.compile.apply(null,o)},I._biforeach=function e(t,r,n,i,o){var a;if(i!==n.length-1)for(a=n[i]-1;0<=a;a--)e("object"==typeof t?t[a]:t,"object"==typeof r?r[a]:r,n,i+1,o);else o(t,r)},I._biforeach2=function e(t,r,n,i,o){if(i===n.length-1)return o(t,r);var a,s=n[i],l=Array(s);for(a=s-1;0<=a;--a)l[a]=e("object"==typeof t?t[a]:t,"object"==typeof r?r[a]:r,n,i+1,o);return l},I._foreach=function e(t,r,n,i){var o;if(n!==r.length-1)for(o=r[n]-1;0<=o;o--)e(t[o],r,n+1,i);else i(t)},I._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var o,a=r[n],s=Array(a);for(o=a-1;0<=o;o--)s[o]=e(t[o],r,n+1,i);return s},I.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},I.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},I.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],I.mathfuns2=["atan2","pow","max","min"],I.ops1={neg:"-",not:"!",bnot:"~",clone:""},I.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,n;for(e=0;e<I.mathfuns2.length;++e)n=I.mathfuns2[e],I.ops2[n]=n;for(e in I.ops2)if(I.ops2.hasOwnProperty(e)){n=I.ops2[e];var t,r,i="";r=-1!==I.myIndexOf.call(I.mathfuns2,e)?(i="var "+n+" = Math."+n+";\n",t=function(e,t,r){return e+" = "+n+"("+t+","+r+")"},function(e,t){return e+" = "+n+"("+e+","+t+")"}):(t=function(e,t,r){return e+" = "+t+" "+n+" "+r},I.opseq.hasOwnProperty(e+"eq")?function(e,t){return e+" "+n+"= "+t}:function(e,t){return e+" = "+e+" "+n+" "+t}),I[e+"VV"]=I.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),i),I[e+"SV"]=I.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),i),I[e+"VS"]=I.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),i),I[e]=I.compile("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),I[n]=I[e],I[e+"eqV"]=I.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),I[e+"eqS"]=I.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),I[e+"eq"]=I.compile("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<I.mathfuns2.length;++e)n=I.mathfuns2[e],delete I.ops2[n];for(e=0;e<I.mathfuns.length;++e)n=I.mathfuns[e],I.ops1[n]=n;for(e in I.ops1)I.ops1.hasOwnProperty(e)&&(i="",n=I.ops1[e],-1!==I.myIndexOf.call(I.mathfuns,e)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\n"),I[e+"eqV"]=I.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),I[e+"eq"]=I.compile("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),I[e+"V"]=I.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),I[e]=I.compile("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<I.mathfuns.length;++e)n=I.mathfuns[e],delete I.ops1[n];for(e in I.mapreducers)I.mapreducers.hasOwnProperty(e)&&(n=I.mapreducers[e],I[e+"V"]=I.mapreduce2(n[0],n[1]),I[e]=I.compile("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+'\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+"\n}\nreturn accum;\n"))}(),I.inv=function(e){var t,r,n,i,o,a,s,l=I.dim(e),c=Math.abs,u=l[0],p=l[1],d=I.clone(e),h=I.identity(u);for(a=0;a<p;++a){var f=-1,g=-1;for(o=a;o!==u;++o)g<(s=c(d[o][a]))&&(f=o,g=s);for(r=d[f],d[f]=d[a],d[a]=r,i=h[f],h[f]=h[a],h[a]=i,e=r[a],s=a;s!==p;++s)r[s]/=e;for(s=p-1;-1!==s;--s)i[s]/=e;for(o=u-1;-1!==o;--o)if(o!==a){for(t=d[o],n=h[o],e=t[a],s=a+1;s!==p;++s)t[s]-=r[s]*e;for(s=p-1;0<s;--s)n[s]-=i[s]*e,n[--s]-=i[s]*e;0===s&&(n[0]-=i[0]*e)}}return h},I.det=function(e){var t=I.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r,n,i,o,a,s,l,c,u=t[0],p=1,d=I.clone(e);for(n=0;n<u-1;n++){for(r=(i=n)+1;r<u;r++)Math.abs(d[r][n])>Math.abs(d[i][n])&&(i=r);for(i!==n&&(l=d[i],d[i]=d[n],d[n]=l,p*=-1),o=d[n],r=n+1;r<u;r++){for(s=(a=d[r])[n]/o[n],i=n+1;i<u-1;i+=2)c=i+1,a[i]-=o[i]*s,a[c]-=o[c]*s;i!==u&&(a[i]-=o[i]*s)}if(0===o[n])return 0;p*=o[n]}return p*d[n][n]},I.transpose=function(e){var t,r,n,i,o,a=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(a);for(t=a-1;1<=t;t-=2){for(i=e[t],n=e[t-1],r=s-1;1<=r;--r)(o=l[r])[t]=i[r],o[t-1]=n[r],(o=l[--r])[t]=i[r],o[t-1]=n[r];0===r&&((o=l[0])[t]=i[0],o[t-1]=n[0])}if(0===t){for(n=e[0],r=s-1;1<=r;--r)l[r][0]=n[r],l[--r][0]=n[r];0===r&&(l[0][0]=n[0])}return l},I.negtranspose=function(e){var t,r,n,i,o,a=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(a);for(t=a-1;1<=t;t-=2){for(i=e[t],n=e[t-1],r=s-1;1<=r;--r)(o=l[r])[t]=-i[r],o[t-1]=-n[r],(o=l[--r])[t]=-i[r],o[t-1]=-n[r];0===r&&((o=l[0])[t]=-i[0],o[t-1]=-n[0])}if(0===t){for(n=e[0],r=s-1;1<=r;--r)l[r][0]=-n[r],l[--r][0]=-n[r];0===r&&(l[0][0]=-n[0])}return l},I.norm2=function(e){return Math.sqrt(I.norm2Squared(e))},I.linspace=function(e,t,r){if(void 0===r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,i=Array(r);for(n=--r;0<=n;n--)i[n]=(n*t+(r-n)*e)/r;return i},I.getBlock=function(e,s,l){var c=I.dim(e);return function e(t,r){var n,i=s[r],o=l[r]-i,a=Array(o);if(r===c.length-1){for(n=o;0<=n;n--)a[n]=t[n+i];return a}for(n=o;0<=n;n--)a[n]=e(t[n+i],r+1);return a}(e,0)},I.setBlock=function(e,s,l,t){var c=I.dim(e);return function e(t,r,n){var i,o=s[n],a=l[n]-o;if(n===c.length-1)for(i=a;0<=i;i--)t[i+o]=r[i];for(i=a;0<=i;i--)e(t[i+o],r[i],n+1)}(e,t,0),e},I.getRange=function(e,t,r){var n,i,o,a,s=t.length,l=r.length,c=Array(s);for(n=s-1;-1!==n;--n)for(c[n]=Array(l),o=c[n],a=e[t[n]],i=l-1;-1!==i;--i)o[i]=a[r[i]];return c},I.blockMatrix=function(e){var t=I.dim(e);if(t.length<4)return I.blockMatrix([e]);var r,n,i,o,a,s=t[0],l=t[1];for(i=n=r=0;i<s;++i)r+=e[i][0].length;for(o=0;o<l;++o)n+=e[0][o][0].length;var c=Array(r);for(i=0;i<r;++i)c[i]=Array(n);var u,p,d,h,f,g=0;for(i=0;i<s;++i){for(u=n,o=l-1;-1!==o;--o)for(u-=(a=e[i][o])[0].length,d=a.length-1;-1!==d;--d)for(f=a[d],p=c[g+d],h=f.length-1;-1!==h;--h)p[u+h]=f[h];g+=e[i][0].length}return c},I.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return I.mul(e,t);var r=I.dim(e),n=I.dim(t);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,s,l=r[0],c=n[0],u=Array(l);for(o=l-1;0<=o;o--){for(i=Array(c),s=e[o],a=c-1;3<=a;--a)i[a]=s*t[a],i[--a]=s*t[a],i[--a]=s*t[a],i[--a]=s*t[a];for(;0<=a;)i[a]=s*t[a],--a;u[o]=i}return u},I.epsilon=2220446049250313e-31,I.LU=function(e,t){t=t||!1;var r,n,i,o,a,s,l,c,u,p=Math.abs,d=e.length,h=d-1,f=new Array(d);for(t||(e=I.clone(e)),i=0;i<d;++i){for(u=p((s=e[l=i])[i]),n=i+1;n<d;++n)u<(o=p(e[n][i]))&&(u=o,l=n);for((f[i]=l)!=i&&(e[i]=e[l],e[l]=s,s=e[i]),a=s[i],r=i+1;r<d;++r)e[r][i]/=a;for(r=i+1;r<d;++r){for(c=e[r],n=i+1;n<h;++n)c[n]-=c[i]*s[n],c[++n]-=c[i]*s[n];n===h&&(c[n]-=c[i]*s[n])}}return{LU:e,P:f}},I.LUsolve=function(e,t){var r,n,i,o,a,s=e.LU,l=s.length,c=I.clone(t),u=e.P;for(r=l-1;-1!==r;--r)c[r]=t[r];for(r=0;r<l;++r)for(i=u[r],u[r]!==r&&(a=c[r],c[r]=c[i],c[i]=a),o=s[r],n=0;n<r;++n)c[r]-=c[n]*o[n];for(r=l-1;0<=r;--r){for(o=s[r],n=r+1;n<l;++n)c[r]-=c[n]*o[n];c[r]/=o[r]}return c},I.solve=function(e,t,r){return I.LUsolve(I.LU(e,r),t)},I.svd=function(e){function t(e,t){return e=Math.abs(e),(t=Math.abs(t))<e?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var r,n=I.epsilon,i=1e-64/n,o=0,a=0,s=0,l=0,c=0,u=I.clone(e),p=u.length,d=u[0].length;if(p<d)throw"Need more rows than columns";var h=new Array(d),f=new Array(d);for(a=0;a<d;a++)h[a]=f[a]=0;var g=I.rep([d,d],0),m=0,y=0,v=0,b=0,x=0,w=0,_=0;for(a=0;a<d;a++){for(h[a]=y,_=0,c=a+1,s=a;s<p;s++)_+=u[s][a]*u[s][a];if(_<=i)y=0;else for(m=u[a][a],y=Math.sqrt(_),0<=m&&(y=-y),v=m*y-_,u[a][a]=m-y,s=c;s<d;s++){for(_=0,l=a;l<p;l++)_+=u[l][a]*u[l][s];for(m=_/v,l=a;l<p;l++)u[l][s]+=m*u[l][a]}for(f[a]=y,_=0,s=c;s<d;s++)_+=u[a][s]*u[a][s];if(_<=i)y=0;else{for(m=u[a][a+1],y=Math.sqrt(_),0<=m&&(y=-y),v=m*y-_,u[a][a+1]=m-y,s=c;s<d;s++)h[s]=u[a][s]/v;for(s=c;s<p;s++){for(_=0,l=c;l<d;l++)_+=u[s][l]*u[a][l];for(l=c;l<d;l++)u[s][l]+=_*h[l]}}b<(x=Math.abs(f[a])+Math.abs(h[a]))&&(b=x)}for(a=d-1;-1!=a;a+=-1){if(0!=y){for(v=y*u[a][a+1],s=c;s<d;s++)g[s][a]=u[a][s]/v;for(s=c;s<d;s++){for(_=0,l=c;l<d;l++)_+=u[a][l]*g[l][s];for(l=c;l<d;l++)g[l][s]+=_*g[l][a]}}for(s=c;s<d;s++)g[a][s]=0,g[s][a]=0;g[a][a]=1,y=h[a],c=a}for(a=d-1;-1!=a;a+=-1){for(c=a+1,y=f[a],s=c;s<d;s++)u[a][s]=0;if(0!=y){for(v=u[a][a]*y,s=c;s<d;s++){for(_=0,l=c;l<p;l++)_+=u[l][a]*u[l][s];for(m=_/v,l=a;l<p;l++)u[l][s]+=m*u[l][a]}for(s=a;s<p;s++)u[s][a]=u[s][a]/y}else for(s=a;s<p;s++)u[s][a]=0;u[a][a]+=1}for(n*=b,l=d-1;-1!=l;l+=-1)for(var S=0;S<50;S++){var E=!1;for(c=l;-1!=c;c+=-1){if(Math.abs(h[c])<=n){E=!0;break}if(Math.abs(f[c-1])<=n)break}if(!E){o=0;var M=c-(_=1);for(a=c;a<l+1&&(m=_*h[a],h[a]=o*h[a],!(Math.abs(m)<=n));a++)for(v=t(m,y=f[a]),o=y/(f[a]=v),_=-m/v,s=0;s<p;s++)x=u[s][M],w=u[s][a],u[s][M]=x*o+w*_,u[s][a]=-x*_+w*o}if(w=f[l],c==l){if(w<0)for(f[l]=-w,s=0;s<d;s++)g[s][l]=-g[s][l];break}if(49<=S)throw"Error: no convergence.";for(b=f[c],y=t(m=(((x=f[l-1])-w)*(x+w)+((y=h[l-1])-(v=h[l]))*(y+v))/(2*v*x),1),m=m<0?((b-w)*(b+w)+v*(x/(m-y)-v))/b:((b-w)*(b+w)+v*(x/(m+y)-v))/b,a=c+(_=o=1);a<l+1;a++){for(y=h[a],x=f[a],v=_*y,y*=o,w=t(m,v),m=b*(o=m/(h[a-1]=w))+y*(_=v/w),y=-b*_+y*o,v=x*_,x*=o,s=0;s<d;s++)b=g[s][a-1],w=g[s][a],g[s][a-1]=b*o+w*_,g[s][a]=-b*_+w*o;for(w=t(m,v),m=(o=m/(f[a-1]=w))*y+(_=v/w)*x,b=-_*y+o*x,s=0;s<p;s++)x=u[s][a-1],w=u[s][a],u[s][a-1]=x*o+w*_,u[s][a]=-x*_+w*o}h[c]=0,h[l]=m,f[l]=b}for(a=0;a<f.length;a++)f[a]<n&&(f[a]=0);for(a=0;a<d;a++)for(s=a-1;0<=s;s--)if(f[s]<f[a]){for(o=f[s],f[s]=f[a],f[a]=o,l=0;l<u.length;l++)r=u[l][a],u[l][a]=u[l][s],u[l][s]=r;for(l=0;l<g.length;l++)r=g[l][a],g[l][a]=g[l][s],g[l][s]=r;a=s}return{U:u,S:f,V:g}},I}),define("math/parsenode/optimizedregression",["require","pjs","./base"],function(e){return e("pjs")(e("./base"),function(e,a){e.init=function(e,t,r,n,i){for(var o in a.init.call(this),this.parameters=e,this.residuals=t,this.statistics=r,this.model=n,this.isModelValid=i.isModelValid,this.residualVariable=i.residualVariable,this.residualSuggestionId=i.residualSuggestionId,this.shouldSuggestLogMode=i.shouldSuggestLogMode,this._exports=[this.residualVariable],e)e.hasOwnProperty(o)&&this._exports.push(o);this.mergeDependencies(n)},e.getCompiledFunction=function(){return this.model.getCompiledFunction.apply(this.model,arguments)},e.getCompiledDerivative=function(){return this.model.getCompiledDerivative.apply(this.model,arguments)},e.evaluate=function(){return this.model.evaluate.apply(this.model,arguments)}})}),define("math/parsenode/regression",["require","pjs","./base","numeric","math/distance","math/builtin","graphing/label","math/errormsg","./error","./optimizedregression","./list","./functioncall","./identifier","./constant","./freevariable","./expressionTypes","math/types"],function(e){var t=e("pjs"),r=e("./base"),E=e("numeric"),m=e("math/distance"),x=e("math/builtin"),M=e("graphing/label"),I=e("math/errormsg"),n=e("./error"),T=e("./optimizedregression"),C=e("./list"),i=e("./functioncall"),o=e("./identifier"),k=e("./constant"),P=e("./freevariable"),a=e("./expressionTypes"),D=e("math/types"),l=a.Subtract;return t(r,function(e,r,t){function w(e,t){for(var r=0,n=e.fn.apply(void 0,t),i=0;i<n.length;i++){var o=n[i];r+=o*o}return r/n.length}function _(e,t){return e.fn.apply(void 0,t)}function S(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n].fn.apply(void 0,t);r.push(i)}return r}function d(e,t,r,n){for(var i=r,o=w(e,i),a=.001,s=[],l=0;l<t.length;l++)s.push(1);for(var c=0,u=!1,p=S(t,i),d=i,h=o;c<n&&!u;){var f=_(e,i),g=E.transpose(p),m=E.dot(p,g);if(!E.all(E.isFinite(f)))break;if(!E.all(E.isFinite(m)))break;for(var y=!1;c<n&&!u&&!y;){c+=1;var v,b=E.LU(E.add(m,E.diag(E.mul(a,s))),!0),x=E.neg(E.LUsolve(b,E.dot(p,f)));if(o=w(e,i=E.add(d,x)),u=E.all(E.eq(i,d))){d=i,h=o;break}if(isFinite(o)&&o<=h&&(v=S(t,i),y=E.all(E.isFinite(v))),y){p=v,d=i,h=o,a*=.1,a=Math.max(1e-64,a);break}a*=2}}return{solution:d,MSE:w(e,d)}}function h(e,t,r,n,i){var o,a=[];for(n||(n={}),i||(i={}),o=0;o<r.length;o++){var s=r[o];i[s]&&isFinite(i[s].asValue())?a.push(+i[s].asValue()):n.hasOwnProperty(s)&&isFinite(n[s])?a.push(+n[s]):a.push(1)}var l=f(30,r),c=g(e,t,l,3,5),u=d(e,t,g(e,t,c,60,1)[0],250),p=d(e,t,a,100);return isFinite(p.MSE)?p.MSE<u.MSE?p:m.approx(p.MSE,u.MSE,8)?p:u:u}function y(e,t,r,n){var i,o,a=t.getDependencies();for(o=0;o<a.length;o++)if(!e.validRegressionParameter(a[o]))throw I.invalidRegressionParameter(a[o]);var s=t.getCompiledFunction(a);if(a.length){var l={};for(o=1;o<a.length;o++)l[a[o]]=P(a[0]);var c=t.substitute(l).isLinear(a[0]),u=[];for(o=0;o<a.length;o++)u.push(t.takeDerivative(a[o]).getCompiledFunction(a));i=c?function(e,t,r,n,i){for(var o=[],a=0;a<t.length;a++)o.push(0);for(var s=S(t,o),l=E.LU(E.dot(s,E.transpose(s)),!0),c=o,u=0;u<2;u++){var p=_(e,o),d=E.neg(E.LUsolve(l,E.dot(s,p)));if(!E.all(E.isFinite(d)))return h(e,t,r,n,i);c=o=E.add(c,d)}return{solution:o,MSE:w(e,o)}}(s,u,a,r,n):h(s,u,a,r,n)}else i={solution:[],MSE:w(s,[])};var p={};for(o=0;o<a.length;o++)p[a[o]]=k(i.solution[o]);return p}function p(e,t){var r=e.length,n=e[0],i=t[0],o=e[r-1],a=t[r-1];if(!(isFinite(n)&&isFinite(o)&&isFinite(i)&&isFinite(a)))return!1;if(a-i==0)return!1;var s=o-n;if(0===s)return!1;for(var l=1;l<r-1;l++){var c=e[l],u=t[l],p=(a*(c-n)+i*(o-c))/s;if(!m.approx(u,p,5))return!1}return!0}function v(e,t,r){var n=Object.create(t);for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i]);return C.wrap(e.getConcreteTree(n))}e.init=function(e,t){r.init.call(this),this._lhs=e,this.isLhsSimple=e instanceof o||e instanceof C,this._logLhs=i("ln",[e]),this._rhs=t,this._difference=l([e,t]),this._logDifference=l([i("ln",[e]),i("ln",[t])]),this.mergeDependencies(e,t)},e.isRegression=!0,e.chooseResidualVariable=function(e){if(this.userData&&this.userData.residualVariable){var t=M.latexToIdentifier(this.userData.residualVariable);if(!e[t])return t}for(var r,n=this.getDependencies(),i=0;i<n.length;i++){var o=n[i].match(/_(.*)/);if(o&&!e[r="e_"+o[1]])return r}for(var a=1;;){if(!e[r="e_"+a])return r;a++}},e.getRHSModel=function(e,t){function r(e,t){for(var r=0;r<o.length;r++)if(o[r].node===this)return o[r].tmpVar;var n=P(this.tmpVar()),i=this.getConcreteTree(e);return i.getDependencies().length&&(a=!1),o.push({node:this,tmpVar:n,symbol:n._symbol,concrete:i}),n}var o=[],a=!0,n={List:r,TableColumn:r,Range:r},i=this._rhs.tryGetConcreteTree(e,n);return{node:i,substituted:i.isError?i:i.substitute(t),replacedNodes:o,isValid:a}};var s=[18.9,.105,.0113,.089,4.414,34.32,8.61,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1.89,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777],f=function(e,t){for(var r,n=[],i=t.length,o=0;o<e;o++){r=[];for(var a=0;a<i;a++)r[a]=0===o?0:1===o?1:s[503*(o*i+a)%s.length];n.push(r)}return n},g=function(e,t,r,n,i){for(var o=[],a=0;a<r.length;a++)o.push({soln:d(e,t,r[a],n),startingVals:r[a]});o.sort(function(e,t){return isNaN(e.soln.MSE)?1:isNaN(t.soln.MSE)?-1:e.soln.MSE-t.soln.MSE});for(var s=[],l=0;l<i;l++)s.push(o[l].startingVals);return s};e.computeStatistics=function(e,t,r,n,i){if(r.getDependencies().length)throw I.optimizationError();var o=0;r.eachElement(function(e){var t=e.asValue();o+=t*t});var a=o/r.length;if(!isFinite(a))throw I.optimizationError();if(0<e.getDependencies().length)return{RMSE:Math.sqrt(a)};var s=D.isList(e.valueType)?x.varp(e.asValue()):0;if(e.getDependencies().length||!isFinite(s)||s<=0||!this.isLhsSimple)return{RMSE:Math.sqrt(a)};var l=1-a/s;if(t.isValid&&1===t.replacedNodes.length){var c=[],u=[],p=n&&(i===b.LINLOG||i===b.LOGLOG);C.eachArgs([t.replacedNodes[0].concrete,e],function(e){c.push(p?Math.log(e[0].asValue()):+e[0].asValue()),u.push(+e[1].asValue())});var d=x.corr(c,u);if(m.approx(d*d,l,8))return{r:d,rsquared:d*d}}return{Rsquared:l}},e.getResidualSuggestionId=function(e,t){var r,n=this._rhs.getDependencies();for(var i in t)if(t.hasOwnProperty(i)&&t[i].concreteTree.isTable&&t[i].concreteTree.columns[0]){var o=t[i].rawTree.columns;if(o&&o.length){var a=o[0].getExports();if(1===a.length&&-1!==n.indexOf(a[0])){for(var s=1;s<o.length;s++)if(-1!==o[s].getDependencies().indexOf(e))return;r=r||i}}}return r||void 0};var b={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};e.linearizingTransformation=function(e,t){if(!this.isLhsSimple)return b.NONE;var r=t.substituted;if(r.isError)return b.NONE;if(r.valueType!==D.Number)return b.NONE;var n=r.getDependencies();if(1!==n.length)return b.NONE;if(isFinite(t.node.polynomialOrder(n[0])))return b.NONE;var i=r.getCompiledFunction(n).fn,o=t.replacedNodes[0].concrete;if(r.valueType!==D.Number)return b.NONE;var a=o.mapElements(function(e){return+e.asValue()});if(a.length<3)return b.NONE;a.sort(function(e,t){return e-t});var s=a.map(i),l=s.map(Math.log),c=a.map(Math.log),u=!0;return C.wrap(e).eachElement(function(e){isFinite(Math.log(+e.asValue()))||(u=!1)}),p(a,l)&&u?b.LOGLIN:p(c,l)&&u?b.LOGLOG:p(c,s)?b.LINLOG:b.NONE},e.optimize=function(e,t,r,n,i){var o=this._lhs.getConcreteTree(t),a=this._rhs.getConcreteTree(t);this.typeCheck([o,a]);var s,l=y(e,C.wrap(this._difference.getConcreteTree(t)),this.userData.regressionParameters,n),c=this.getRHSModel(t,l),u=v(this._difference,t,l),p=this.linearizingTransformation(o,c);if(!this.userData.isLogModeRegression||p!==b.LOGLIN&&p!==b.LOGLOG)s=this.computeStatistics(o,c,u,this.userData.isLogModeRegression,p);else{var d=this._logDifference.getConcreteTree(t),h=this._logLhs.getConcreteTree(t);l=y(e,d,this.userData.regressionParamters,n),c=this.getRHSModel(t,l),u=v(this._difference,t,l);var f=v(this._logDifference,t,l);s=this.computeStatistics(h,c,f,this.userData.isLogModeRegression,p)}var g=this.chooseResidualVariable(r),m=this.getResidualSuggestionId(g,i);return this.userData.residualVariable=M.identifierToLatex(g),T(l,u,s,c.substituted,{isModelValid:c.isValid,residualVariable:g,residualSuggestionId:m,shouldSuggestLogMode:p!==b.NONE})},e.tryOptimize=function(){try{return this.optimize.apply(this,arguments)}catch(e){if(e instanceof n)return e;throw e}},e.exportTo=function(e,t,r){if(!t.isError){for(var n in t.parameters)t.parameters.hasOwnProperty(n)&&(e.assignmentForbidden(n)||(r[n]=r[n]?I.multiplyDefined(n):t.parameters[n]));e.assignmentForbidden(t.residualVariable)||(r[t.residualVariable]=t.residuals)}},e.getSliderVariables=function(){return[]}})}),define("math/parsenode/image",["require","pjs","./base"],function(e){return e("pjs")(e("./base"),function(e,r,t,n){e.isImage=!0,e.init=function(e,t){r.init.call(this),this.center=e.center,this.radianAngle=e.radianAngle,this.width=e.width,this.height=e.height,this.moveStrategy=t,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height)}})}),define("math/parsenode/slider",["require","pjs","./assignment","./identifier"],function(e){var t=e("pjs"),r=e("./assignment"),i=e("./identifier");return t(r,function(e,r,t,n){e.isSlider=!0,e.init=function(e,t){r.init.call(this,i(e._symbol),e._expression),this.setInputSpan(e._inputSpan),this.sliderAssignment=e,this.sliderMin=t.sliderMin,this.sliderMax=t.sliderMax,this.sliderStep=t.sliderStep,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)},e.shouldPromoteToSlider=function(e){return!1}})}),define("math/parsenode/table",["require","pjs","./base"],function(e){return e("pjs")(e("./base"),function(e,r){e.init=function(e){r.init.call(this),this.columns=e,this._exports=[],this.mergeDependencies.apply(this,e);for(var t=0;t<e.length;t++)Array.prototype.push.apply(this._exports,e[t].getExports())},e.exportPenalty=1,e.isTable=!0,e.exportTo=function(e,t,r){for(var n=0;n<this.columns.length;n++){var i=this.columns[n].getExports();if(i.length){var o=i[0];e.assignmentForbidden(o)||r[o]||(t.isError?r[o]=t:this.columns[n].exportTo(e,t.columns[n],r))}}},e.getAllIds=function(){return this.columns.map(function(e){return e.header.userData.id})}})}),define("math/parsenode/tablecolumn",["require","pjs","./base","./list","./constant","./identifier"],function(e){var t=e("pjs"),o=e("./base"),a=e("./list"),r=e("./constant"),s=e("./identifier");return t(o,function(e,n){function i(e){return e.isError?r(NaN):e}e.init=function(e,t,r){n.init.call(this),this.header=e,this.length=t,this.values=r,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()},e.registerDependencies=function(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)},e.computeExports=function(){return this.header instanceof s?[this.header._symbol]:[]},e.isDiscrete=function(e){return 1!==this.header.getDependencies().length||1!==e.header.getDependencies().length||this.header.getDependencies()[0]!==e.header.getDependencies()[0]},e._exportSymbolsTo=function(e,t,r){if(e.length){var n=e[0];if(t.isError)r[n]=t;else try{r[n]=a(t.values.map(i))}catch(e){if(!(e instanceof o))throw e;r[n]=e}}},e.exportTo=function(e,t,r){var n=this.getLegalExports(e);this._exportSymbolsTo(n,t,r)},e.exportToLocal=function(e,t){this._exportSymbolsTo(this.getExports(),e,t)}})}),define("math/parsenode/solvedequation",["require","pjs","./base"],function(e){return e("pjs")(e("./base"),function(e,r){e.init=function(e,t){r.init.call(this),this._symbol=e,this._expression=t,this.mergeDependencies(t)},e.getCompiledFunction=function(){return this._expression.getCompiledFunction.apply(this._expression,arguments)},e.getCompiledDerivative=function(){return this._expression.getCompiledDerivative.apply(this._expression,arguments)},e.evaluate=function(){return this._expression.evaluate.apply(this._expression,arguments)}})}),define("parsenodes",["require","math/parsenode/expressionTypes","math/parsenode/base","math/parsenode/expression","math/parsenode/scalarexpression","math/parsenode/error","math/parsenode/constant","math/parsenode/mixednumber","math/parsenode/identifier","math/parsenode/ans","math/parsenode/freevariable","math/parsenode/dummyindex","math/parsenode/list","math/parsenode/range","math/parsenode/broadcast","math/parsenode/listaccess","math/parsenode/orderedpair","math/parsenode/movablepoint","math/parsenode/orderedpairaccess","math/parsenode/polygon","math/parsenode/basecomparator","math/parsenode/comparator","math/parsenode/doubleinequality","math/parsenode/repeatedoperator","math/parsenode/sum","math/parsenode/product","math/parsenode/integral","math/parsenode/functioncall","math/parsenode/functionexponent","math/parsenode/functionfactorial","math/parsenode/prime","math/parsenode/piecewise","math/parsenode/derivative","math/parsenode/builtinfunction","math/parsenode/nativefunction","math/parsenode/typedfunction","math/parsenode/reducerfunction","math/parsenode/parametrizedreducerfunction","math/parsenode/doublereducerfunction","math/parsenode/toplevelfunction","math/parsenode/distribution","math/parsenode/histogram","math/parsenode/dotplot","math/parsenode/boxplot","math/parsenode/assignment","math/parsenode/functiondefinition","math/parsenode/equation","math/parsenode/regression","math/parsenode/image","math/parsenode/slider","math/parsenode/table","math/parsenode/tablecolumn","math/parsenode/solvedequation","math/parsenode/optimizedregression"],function(e){var t=e("math/parsenode/expressionTypes"),r={Base:e("math/parsenode/base"),Expression:e("math/parsenode/expression"),ScalarExpression:e("math/parsenode/scalarexpression"),Error:e("math/parsenode/error"),Constant:e("math/parsenode/constant"),MixedNumber:e("math/parsenode/mixednumber"),Identifier:e("math/parsenode/identifier"),Ans:e("math/parsenode/ans"),FreeVariable:e("math/parsenode/freevariable"),DummyIndex:e("math/parsenode/dummyindex"),List:e("math/parsenode/list"),Range:e("math/parsenode/range"),Broadcast:e("math/parsenode/broadcast"),ListAccess:e("math/parsenode/listaccess"),OrderedPair:e("math/parsenode/orderedpair"),MovablePoint:e("math/parsenode/movablepoint"),OrderedPairAccess:e("math/parsenode/orderedpairaccess"),Polygon:e("math/parsenode/polygon"),BaseComparator:e("math/parsenode/basecomparator"),Comparator:e("math/parsenode/comparator"),DoubleInequality:e("math/parsenode/doubleinequality"),RepeatedOperator:e("math/parsenode/repeatedoperator"),Sum:e("math/parsenode/sum"),Product:e("math/parsenode/product"),Integral:e("math/parsenode/integral"),FunctionCall:e("math/parsenode/functioncall"),FunctionExponent:e("math/parsenode/functionexponent"),FunctionFactorial:e("math/parsenode/functionfactorial"),Prime:e("math/parsenode/prime"),Piecewise:e("math/parsenode/piecewise"),Derivative:e("math/parsenode/derivative"),BuiltInFunction:e("math/parsenode/builtinfunction"),NativeFunction:e("math/parsenode/nativefunction"),TypedFunction:e("math/parsenode/typedfunction"),ReducerFunction:e("math/parsenode/reducerfunction"),ParametrizedReducerFunction:e("math/parsenode/parametrizedreducerfunction"),DoubleReducerFunction:e("math/parsenode/doublereducerfunction"),TopLevelFunction:e("math/parsenode/toplevelfunction"),Distribution:e("math/parsenode/distribution"),Histogram:e("math/parsenode/histogram"),DotPlot:e("math/parsenode/dotplot"),BoxPlot:e("math/parsenode/boxplot"),Assignment:e("math/parsenode/assignment"),FunctionDefinition:e("math/parsenode/functiondefinition"),Equation:e("math/parsenode/equation"),Regression:e("math/parsenode/regression"),Image:e("math/parsenode/image"),Slider:e("math/parsenode/slider"),Table:e("math/parsenode/table"),TableColumn:e("math/parsenode/tablecolumn"),SolvedEquation:e("math/parsenode/solvedequation"),OptimizedRegression:e("math/parsenode/optimizedregression")};for(var n in t)r[n]=t[n];for(var i in r)r.hasOwnProperty(i)&&"Comparator"!==i&&"BuiltInFunction"!==i&&(r[i].prototype.type=i);for(var o in r.Comparator)r.Comparator.hasOwnProperty(o)&&(r.Comparator[o].prototype.type="Comparator['"+o+"']");for(var a in r.BuiltInFunction)r.BuiltInFunction.hasOwnProperty(a)&&(r.BuiltInFunction[a].prototype.type="BuiltInFunction['"+a+"']");return r}),define("math/parser/char-codes",["require","exports"],function(e,t){"use strict";function r(e){return 97<=e&&e<=122}function n(e){return 65<=e&&e<=90}Object.defineProperty(t,"__esModule",{value:!0}),t.isDigit=function(e){return 48<=e&&e<=57},t.isLowerCaseLetter=r,t.isUpperCaseLetter=n,t.isLetter=function(e){return r(e)||n(e)},t.isBackslash=function(e){return 92===e},t.isDot=function(e){return 46===e},t.isSingleQuote=function(e){return 39===e},t.isWhitespace=function(e){if(9<=e&&e<=13)return!0;if(8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}}),define("math/parser/latex-lexer",["require","exports","./char-codes","./input-span"],function(e,t,s,l){"use strict";function c(e,t,r){return{type:e,span:t,val:r}}function r(e,t,r){for(;s.isWhitespace(e.charCodeAt(t));)t+=1;var n=function(e,t){var r=t;if(t>=e.length)return c("End",l.emptySpanAt(e,t),"");var n=e.charCodeAt(t);if(s.isDigit(n)){var i=l.Span(e,r,t+1);return c("Digit",i,e.charAt(r))}if(s.isLetter(n)){var i=l.Span(e,r,t+1);return c("Letter",i,e.charAt(r))}if(s.isBackslash(n)){if(t+=1,s.isLetter(e.charCodeAt(t))){for(;s.isLetter(e.charCodeAt(t));)t+=1;var i=l.Span(e,r,t),o=l.slice(i),a=u[o]||"Cmd";return c(a,i,o)}t+=1;var i=l.Span(e,r,t),o=l.slice(i);return c("EscapedSymbol",i,o)}if(s.isSingleQuote(n)){for(t+=1;s.isSingleQuote(e.charCodeAt(t));)t+=1;if("^"===e.charAt(t)){t+=1;var i=l.Span(e,r,t),o=l.slice(i);return c("Primes^",i,o)}var i=l.Span(e,r,t),o=l.slice(i);return c("Primes",i,o)}var i=l.Span(e,r,t+1),o=e.charAt(r);return c(a=p[o]||"Symbol",i,o)}(e,t);return{input:e,prevSpan:r,pos:t,token:n}}function n(e){return r(e.input,e.token.span.end,e.token.span)}function i(e){return e.token}Object.defineProperty(t,"__esModule",{value:!0}),t.spanStates=function(e,t){return l.joinSpans(e.token.span,t.prevSpan)},t.LatexToken=c,t.lex=function(e){return r(e,0,l.emptySpanAt(e,0))},t.advance=n,t.peek=i,t.eat=function(e,t){if(i(e).type!==t)throw"Parse Error: expected "+t+".";return n(e)},t.isAt=function(e,t){return i(e).type===t},t.isDone=function(e){return e.pos>=e.input.length};var u={"\\left":"Left","\\right":"Right","\\sqrt":"Sqrt","\\frac":"Frac","\\operatorname":"OperatorName"},p={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"}}),define("math/parser/latex-node",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Group=function(e,t){return{type:"Group",span:e,args:t}},t.Sqrt=function(e,t,r){return{type:"Sqrt",span:e,optArg:t,arg:r}},t.Frac=function(e,t,r){return{type:"Frac",span:e,num:t,den:r}},t.SupSub=function(e,t,r,n){return{type:"SupSub",span:e,sup:t,sub:r,nprimes:n}},t.LeftRight=function(e,t,r,n){return{type:"LeftRight",span:e,left:t,right:r,arg:n}},t.OperatorName=function(e,t){return{type:"OperatorName",span:e,arg:t}},t.Symbol=function(e,t){return{type:"Symbol",span:e,val:t}}}),define("math/parser/latex-parser",["require","exports","./latex-lexer","./input-span","./latex-node"],function(e,t,p,s,d){"use strict";function l(e){switch(e){case"Frac":return 2;case"^":case"_":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":return 1;default:return 0}}function h(e,t){return{state:e,tree:t}}function f(e,t){var r,n=e,i=[];e:for(;!p.isDone(e);){var o=p.peek(e);switch(o.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":case"]":if("]"===o.type&&t)break e;var a;if(e=(r=g(e)).state,"Group"===(a=r.tree).type)for(var s=0,l=a.args;s<l.length;s++){var c=l[s];i.push(c)}else i.push(a);break;case"}":case"Right":case"End":break e;default:throw"Unexpected token type "+o.type+"."}}var u=p.spanStates(n,e);return h(e,d.Group(u,i))}function g(e){var t,r=p.peek(e);switch(r.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return h(e=p.advance(e),r);case"[":case"]":return h(e=p.advance(e),d.Symbol(r.span,r.val));case"{":var n;return e=(t=f(e=p.advance(e),!1)).state,n=t.tree,h(e=p.eat(e,"}"),n);case"^":case"_":case"Primes":case"Primes^":return function(e){var t,r,n,i,o,a=e,s=0;e:for(;!p.isDone(e);){var l=p.peek(e);switch(l.type){case"^":if(e=p.advance(e),i)throw"Parse Error: double superscript.";t=m(e,l),e=t.state,i=t.tree;break;case"_":if(e=p.advance(e),o)throw"Parse Error: double subscript.";r=m(e,l),e=r.state,o=r.tree;break;case"Primes":if(e=p.advance(e),0<s)throw"Parse Error: double primes.";s=l.val.length;break;case"Primes^":if(e=p.advance(e),0<s)throw"Parse Error: double primes.";if(i)throw"Parse Error: double superscript";s=l.val.length-1,n=m(e,l),e=n.state,i=n.tree;break;default:break e}}var c=p.spanStates(a,e);return h(e,d.SupSub(c,i,o,s))}(e);case"Left":return function(e){var t,r=e;e=p.eat(e,"Left");var n,i=p.peek(e);e=p.advance(e),t=f(e,!1),e=t.state,n=t.tree,e=p.eat(e,"Right");var o=p.peek(e);e=p.advance(e);var a=p.spanStates(r,e);return h(e,d.LeftRight(a,i,o,n))}(e);case"Frac":return function(e){var t,r,n,i,o=e,a=p.peek(e);e=p.eat(e,"Frac"),t=m(e,a),e=t.state,n=t.tree,r=m(e,a),e=r.state,i=r.tree;var s=p.spanStates(o,e);return h(e,d.Frac(s,n,i))}(e);case"Sqrt":return function(e){var t,r,n,i,o=e,a=p.peek(e);e=p.eat(e,"Sqrt"),p.isAt(e,"[")&&(s=e,s=p.eat(s,"["),l=f(s,!0),s=l.state,c=l.tree,t=h(s=p.eat(s,"]"),c),e=t.state,n=t.tree),r=m(e,a),e=r.state,i=r.tree;var s,l,c;var u=p.spanStates(o,e);return h(e,d.Sqrt(u,n,i))}(e);case"OperatorName":return function(e){var t,r,n=e,i=p.peek(e);e=p.eat(e,"OperatorName"),t=m(e,i),e=t.state,r=t.tree;var o=p.spanStates(n,e);return h(e,d.OperatorName(o,r))}(e);case"}":case"Right":throw"Parse Error: unexpected "+r.val+".";case"End":throw"Parse Error: unexpected end.";default:throw"Unexpected token type "+r.type+"."}}function m(e,t){var r,n,i=l(t.type);if(i<=0)throw new Error("Programming Error: greediness must be greater than 0.");var o=l(p.peek(e).type);if(0<o&&o<=i){var a=s.slice(t.span);throw"Parse Error: can't use "+s.slice(p.peek(e).span)+" as argument of "+a+". Use {}."}return e=(r=g(e)).state,"Group"!==(n=r.tree).type&&(n=d.Group(n.span,[n])),h(e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e){var t=f(p.lex(e),!1),r=t.state,n=t.tree;if(!p.isDone(r))throw"Parse error: unexpected "+s.slice(p.peek(r).span)+".";return n}}),define("math/parser/command-aliases",["require","exports","./char-codes"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",ttest:"TTest",Ttest:"TTest",tscore:"TScore",Tscore:"TScore",zscore:"ZScore",Zscore:"ZScore"};t.translateCmd=function(e){for(var t=0;r.isBackslash(e.charCodeAt(t));)t+=1;return 0<t&&(e=e.slice(t)),n[e]||e}}),define("math/parser/surface-node",["require","exports","./command-aliases"],function(e,t,r){"use strict";function o(e){if("Subscript"===e.type){if("Alphanumeric"!==e.args[1].type)return!1;e=e.args[0]}switch(e.type){case"Cmd":case"Letter":return!0;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.Equals=function(e,t){return{type:"Equals",span:e,args:t}},t.Inequality=function(e,t,r){return{type:"Inequality",span:e,symbol:t,args:r}},t.TrailingInequalityPiece=function(e,t,r){return{type:"TrailingInequalityPiece",span:e,symbol:t,args:r}},t.InequalityChain=function(e,t,r){return{type:"InequalityChain",span:e,first:t,chain:r}},t.Tilde=function(e,t){return{type:"Tilde",span:e,args:t}},t.Pos=function(e,t){return{type:"Pos",span:e,args:t}},t.Neg=function(e,t){return{type:"Neg",span:e,args:t}},t.Add=function(e,t){return{type:"Add",span:e,args:t}},t.Sub=function(e,t){return{type:"Sub",span:e,args:t}},t.Mul=function(e,t){return{type:"Mul",span:e,args:t}},t.Div=function(e,t){return{type:"Div",span:e,args:t}},t.Bang=function(e,t){return{type:"Bang",span:e,args:t}},t.Call=function(e,t){return{type:"Call",span:e,args:t}},t.ImplicitCall=function(e,t){return{type:"ImplicitCall",span:e,args:t}},t.Index=function(e,t){return{type:"Index",span:e,args:t}},t.Paren=function(e,t){return{type:"Paren",span:e,args:t}},t.List=function(e,t){return{type:"List",span:e,args:t}},t.Pipes=function(e,t){return{type:"Pipes",span:e,args:t}},t.Subscript=function(e,t){return{type:"Subscript",span:e,args:t}},t.Superscript=function(e,t){return{type:"Superscript",span:e,args:t}},t.Prime=function(e,t,r){return{type:"Prime",span:e,nprimes:t,args:r}},t.Seq=function(e,t){return{type:"Seq",span:e,args:t}},t.Sqrt=function(e,t){return{type:"Sqrt",span:e,args:t}},t.Nthroot=function(e,t){return{type:"Nthroot",span:e,args:t}},t.Frac=function(e,t){return{type:"Frac",span:e,args:t}},t.Derivative=function(e,t){return{type:"Derivative",span:e,args:t}},t.Integral=function(e,t){return{type:"Integral",span:e,args:t}},t.EmptyIntegral=function(e,t){return{type:"EmptyIntegral",span:e,args:t}},t.Sum=function(e,t){return{type:"Sum",span:e,args:t}},t.Product=function(e,t){return{type:"Product",span:e,args:t}},t.Piecewise=function(e,t){return{type:"Piecewise",span:e,args:t}},t.EmptyPiecewise=function(e){return{type:"EmptyPiecewise",span:e}},t.Colon=function(e,t){return{type:"Colon",span:e,args:t}},t.Ellipsis=function(e,t){return{type:"Ellipsis",span:e,args:t}},t.PercentOf=function(e,t){return{type:"PercentOf",span:e,args:t}},t.Juxt=function(e,t){return{type:"Juxt",span:e,args:t}},t.Letter=function(e,t){return{type:"Letter",span:e,val:t}},t.Decimal=function(e,t){return{type:"Decimal",span:e,val:t}},t.Cmd=function(e,t){return{type:"Cmd",span:e,val:r.translateCmd(t)}},t.Alphanumeric=function(e,t){return{type:"Alphanumeric",span:e,val:t}},t.MixedNumber=function(e,t,r,n){return{type:"MixedNumber",span:e,whole:t,num:r,den:n}},t.isIdentifier=o,t.isSuperscriptedIdentifier=function(e){return"Superscript"===e.type&&o(e.args[0])},t.isDerivative=function(e,t){if("Letter"!==e.type||"d"!==e.val)return!1;if("Juxt"!==t.type)return!1;var r=t.args,n=r[0],i=r[1];return"Letter"===n.type&&"d"===n.val&&o(i)},t.unwrapSeq=function(e){return"Seq"===e.type?e.args:[e]}}),define("math/parser/surface-node-error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Err=function(e,t){return{type:"Err",span:e,error:t}},t.UnexpectedParseError=function(){return{type:"UnexpectedParseError"}},t.EmptyInput=function(){return{type:"EmptyInput"}},t.EmptyGroup=function(){return{type:"EmptyGroup"}},t.EmptySubscript=function(){return{type:"EmptySubscript"}},t.EmptySuperscript=function(){return{type:"EmptySuperscript"}},t.EmptyRadical=function(){return{type:"EmptyRadical"}},t.EmptySquareBracket=function(){return{type:"EmptySquareBracket"}},t.EmptyPipe=function(){return{type:"EmptyPipe"}},t.EmptyRadicand=function(){return{type:"EmptyRadicand"}},t.UnexpectedEnd=function(){return{type:"UnexpectedEnd"}},t.BinaryOperatorMissingRight=function(e){return{type:"BinaryOperatorMissingRight",val:e}},t.BinaryOperatorMissingLeft=function(e){return{type:"BinaryOperatorMissingLeft",val:e}},t.UnaryOperatorMissingRight=function(e){return{type:"UnaryOperatorMissingRight",val:e}},t.UnaryOperatorMissingLeft=function(e){return{type:"UnaryOperatorMissingLeft",val:e}},t.MissingCloseDelimiter=function(e,t){return{type:"MissingCloseDelimiter",open:e,close:t}},t.UnexpectedCloseDelimiter=function(e,t){return{type:"UnexpectedCloseDelimiter",open:e,close:t}},t.UnexpectedDifferential=function(){return{type:"UnexpectedDifferential"}},t.UnrecognizedSymbol=function(e){return{type:"UnrecognizedSymbol",val:e}},t.InvalidOperatorName=function(e){return{type:"InvalidOperatorName",val:e}},t.InvalidSubscript=function(e){return{type:"InvalidSubscript",val:e}},t.UnexpectedSubscript=function(e){return{type:"UnexpectedSubscript",base:e}},t.FunctionMissingArgument=function(e){return{type:"FunctionMissingArgument",val:e}},t.PercentMissingOf=function(){return{type:"PercentMissingOf"}},t.PrimeWithoutParen=function(){return{type:"PrimeWithoutParen"}},t.SuperscriptWithPrime=function(){return{type:"SuperscriptWithPrime"}},t.UnexpectedPrime=function(){return{type:"UnexpectedPrime"}},t.SumMissingBound=function(){return{type:"SumMissingBound"}},t.ProductMissingBound=function(){return{type:"ProductMissingBound"}},t.MissingBound=function(){return{type:"MissingBound"}},t.IntegralMissingBound=function(){return{type:"IntegralMissingBound"}},t.SumMissingBody=function(){return{type:"SumMissingBody"}},t.ProductMissingBody=function(){return{type:"ProductMissingBody"}},t.IntegralMissingBody=function(){return{type:"IntegralMissingBody"}},t.DerivativeMissingBody=function(){return{type:"DerivativeMissingBody"}},t.IntegralMissingDifferential=function(){return{type:"IntegralMissingDifferential"}},t.DifferentialWithSuperscript=function(){return{type:"DifferentialWithSuperscript"}},t.FractionMissingNumerator=function(){return{type:"FractionMissingNumerator"}},t.FractionMissingDenominator=function(){return{type:"FractionMissingDenominator"}},t.FractionEmpty=function(){return{type:"FractionEmpty"}}}),define("math/parser/expression-token-tables",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandTable={"\\lt":"<","\\gt":">","\\le":"<=","\\ge":">=","\\ldots":"...","\\sim":"~","\\cdot":"*","\\times":"*","\\div":"/","\\ln":"Ln","\\log":"Log","\\int":"Int","\\sum":"Sum","\\prod":"Prod","\\backslash":"Err"};for(var r=0,n=["sin","cos","tan","cot","sec","csc"];r<n.length;r++){var i=n[r];t.commandTable["\\"+i]="Trig",t.commandTable["\\"+i+"h"]="Trig",t.commandTable["\\arc"+i]="Trig",t.commandTable["\\arc"+i+"h"]="Trig"}t.symbolTable={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~"},t.escapedSymbolTable={"\\{":"\\{","\\}":"\\}","\\%":"%"},t.leftTable={"|":"(|","\\{":"\\{","[":"[","(":"("},t.rightTable={"|":"|)","\\}":"\\}","]":"]",")":")"},t.allTokenTypes=Object.keys({"+":!0,"-":!0,"*":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\{":!0,"\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"~":!0,"%":!0,Letter:!0,Decimal:!0,Cmd:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0})}),define("math/parser/expression-lexer",["require","exports","./expression-token-tables","./input-span","./input-span","./surface-node"],function(e,t,I,T,r,f){"use strict";function p(e,t,r,n,i,o,a){return{input:e,prevSpan:t,startIndex:r,endIndex:n,token:i,mode:o,parent:a}}function C(e,t,r){return{type:e,span:t,val:r}}function n(e,t,r,n,i){var o=e.args;if(t>o.length&&i)return d(i,r);var a=function e(t,r,n){var i=t.args;if(r>=i.length){var o=T.emptySpanAt(t.span.input,t.span.end);return k(r,C("End",o,""))}var a=t.args[r];switch(a.type){case"Sqrt":case"Frac":case"SupSub":return k(r,a);case"Letter":if(!n||"integral"!==n.type)return k(r,a);if("d"!=a.val)return k(r,a);var s=e(t,r+1,n),l=s.endIndex,c=s.token;if("Letter"!==c.type&&"Cmd"!==c.type)return k(r,a);var u=(E=T.joinSpans(a.span,c.span),M=c.val,{type:"Differential",span:E,val:M});return k(l,u);case"LeftRight":var p=a.left,d=I.leftTable[p.val]||"Err",h=T.joinSpans(a.span,p.span);return k(r,C(d,h,p.val));case"OperatorName":for(var f=[],g=0,m=a.arg.args;g<m.length;g++){var y=m[g];if("Letter"!==y.type)return k(r,C("Err",a.span,T.slice(a.arg.span)));f.push(y.val)}var v="\\"+f.join(""),b=I.commandTable[v]||"Cmd";return k(r,C(b,a.span,v));case"Cmd":var x=I.commandTable[a.val]||"Cmd";return k(r,C(x,a.span,a.val));case"EscapedSymbol":var w=I.escapedSymbolTable[a.val]||"Err";return k(r,C(w,a.span,a.val));case"Symbol":if(A(a))return P(t,r);var _=I.symbolTable[a.val]||"Err";return k(r,C(_,a.span,a.val));case"Digit":return D(t,r);default:var S=a;throw"Unexpected atom "+S.type+"."}var E,M}(e,t=m(o,t),n),s=a.token,l=a.endIndex;if("End"===s.type&&i){var c=i.input.args[i.startIndex];if("LeftRight"===c.type){var u=c.right;return p(e,r,t,l,C(I.rightTable[u.val]||"Err",u.span,u.val),n,i)}}else"Int"===s.type?n=h(n):"Differential"===s.type&&(n=g(n));return p(e,r,t,l,s,n,i)}function d(e,t){return n(e.input,e.endIndex+1,t,e.mode,e.parent)}function i(e){return e.token}function h(e){return{type:"integral",parent:e}}function g(e){if(!e||"integral"!==e.type)throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function k(e,t){return{token:t,endIndex:e}}function P(e,t){var r=e.args[t];if("Symbol"!==r.type||"."!==r.val)throw new Error("Programming Error: expected '.'");if(t+2<e.args.length&&A(e.args[t+1])&&A(e.args[t+2])){var n=T.joinSpans(r.span,e.args[t+2].span);return k(t+2,C("...",n,T.slice(n)))}return t+1<e.args.length&&"Digit"===e.args[t+1].type?D(e,t):k(t,C(I.symbolTable[r.val]||"Err",r.span,r.val))}function D(e,t){var r=function(e,t){for(var r=e.args,n=r[t].span,i=[];t<r.length;t++){var o=r[t];if("Digit"!==o.type)break;i.push(o.val)}if(!((t=m(r,t))>=r.length)){var a=r[t];if("Frac"===a.type){for(var s=[],l=[],c=0,u=a.num.args;c<u.length;c++){var o=u[c];if("Digit"!==o.type)return;s.push(o.val)}for(var p=0,d=a.den.args;p<d.length;p++){var o=d[p];if("Digit"!==o.type)return;l.push(o.val)}var h=T.joinSpans(n,a.span);return k(t,f.MixedNumber(h,i.join(""),s.join(""),l.join("")))}}}(e,t);if(r)return r;for(var n=e.args,i=e.args[t].span,o=[],a=!1,s=!1;t<n.length;t++){var l=n[t];if("Digit"===l.type)a=!0,o.push(l.val);else{if(s||!A(l))break;if(t+1<n.length&&A(e.args[t+1]))break;s=!0,o.push(".")}}if(!a)throw new Error("Programming Error: decimals must have at least one digit.");return k(t-1,C("Decimal",T.joinSpans(i,e.args[t-1].span),o.join("")))}function o(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return"\\space"===e.val;case"EscapedSymbol":return"\\ "===e.val||"\\:"===e.val||"\\,"===e.val||"\\;"===e.val;default:throw"Unexpected atom "+e.type+"."}}function m(e,t){for(;t<e.length&&o(e[t]);)t+=1;return t}function A(e){return"Symbol"===e.type&&"."===e.val}Object.defineProperty(t,"__esModule",{value:!0}),t.Span=r.Span,t.spanStates=function(e,t){return T.joinSpans(e.token.span,t.prevSpan)},t.joinState=function(e,t){return T.joinSpans(e,t.prevSpan)},t.emptySpanAtState=function(e){return T.emptySpanAt(e.token.span.input,e.token.span.start)},t.lex=function(e){return n(e,0,T.emptySpanAt(e.span.input,e.span.start),void 0,void 0)},t.lexAt=n,t.advance=function(e){var t=e.input.args[e.startIndex],r=e.token.span;return t&&"LeftRight"===t.type?n(t.arg,0,r,e.mode,e):d(e,r)},t.peek=i,t.beginIntegral=h,t.endIntegral=g,t.isAt=function(e,t){return i(e).type===t},t.isDone=function(e){return e.startIndex>=e.input.args.length},t.didAdvance=function(e,t){return t.token.span.start>e.token.span.start}}),define("math/parser/precspec",["require","exports","./expression-token-tables"],function(e,t,o){"use strict";function p(e,t){for(var r=0,n=o.allTokenTypes;r<n.length;r++){var i=n[r];if(void 0===t[i])throw new Error("Programming Error: token "+i+" must be a assigned a "+e+" precedence")}}function d(e,t,r,n){if(void 0!==t[r])throw new Error("Programming Error: duplicate "+e+" entry for token "+r+".");t[r]=n}Object.defineProperty(t,"__esModule",{value:!0}),t.initial=function(e){return{type:"initial",tokenType:e}},t.l=function(e){return{type:"l",tokenType:e}},t.r=function(e){return{type:"r",tokenType:e}},t.la=function(e){return{type:"la",tokenType:e}},t.ra=function(e){return{type:"ra",tokenType:e}},t.precSpec=function(e){function r(e){return i[e]}for(var n={},t={},i={},o=0;o<e.length;o++)for(var a=0,s=e[o];a<s.length;a++){var l=s[a],c=l.type,u=l.tokenType;switch(c){case"initial":d("initial",n,u,o);break;case"l":d("left",t,u,o);break;case"r":d("right",i,u,o);break;case"la":d("left",t,u,o),d("right",i,u,o);break;case"ra":d("left",t,u,o),d("right",i,u,o-1)}}return p("left",t),p("right",i),{rightPrec:r,leftPrec:function(e){return t[e]},initialPrec:function(e){var t=n[e];return void 0===t?r(e):t}}}}),define("math/parser/expression-parser",["require","exports","./surface-node","./surface-node-error","./input-span","./expression-lexer","./precspec"],function(e,t,U,z,s,G,r){"use strict";function H(e){var t=G.lex(e);if(G.isDone(t))return z.Err(G.spanStates(t,t),z.EmptyGroup());var r=K(t,0),n=r.state,i=r.tree;return"Err"===i.type||G.isDone(n)?i:te(n).tree}function W(e,t){return{state:e,tree:t}}function K(e,t){var r,n,i,o,a=e;if(e=(r=function(e){var t,r,n,i,o,a,s,l,c,u,p,d,h,f,g,m,y,v,b,x=e,w=G.peek(e),_=ne(w.type);switch(w.type){case"+":if(e=G.advance(e),t=K(e,_),e=t.state,"Err"!==(b=t.tree).type)return W(e,U.Pos(G.spanStates(x,e),[b]));if(!Y(b.error))return W(e,b);var S=G.spanStates(x,e),E=z.Err(S,z.UnaryOperatorMissingRight(w.type));return W(e,E);case"-":if(e=G.advance(e),r=K(e,_),e=r.state,"Err"!==(b=r.tree).type)return W(e,U.Neg(G.spanStates(x,e),[b]));if(!Y(b.error))return W(e,b);var S=G.spanStates(x,e),E=z.Err(S,z.UnaryOperatorMissingRight(w.type));return W(e,E);case"(":return Z(e);case"\\{":return e=G.advance(e),G.isAt(e,"\\}")?W(e=G.advance(e),U.EmptyPiecewise(G.spanStates(x,e))):(n=K(e,_),e=n.state,b=n.tree,i=ee(x,e,b,"\\{","\\}"),e=i.state,"Err"===(b=i.tree).type?W(e,b):W(e,U.Piecewise(G.spanStates(x,e),[b])));case"[":if(e=G.advance(e),G.isAt(e,"]")){e=G.advance(e);var S=G.spanStates(x,e);return W(e,z.Err(S,z.EmptySquareBracket()))}return o=K(e,_),e=o.state,b=o.tree,a=ee(x,e,b,"[","]"),e=a.state,"Err"===(b=a.tree).type?W(e,b):W(e,U.List(G.spanStates(x,e),[b]));case"(|":if(e=G.advance(e),G.isAt(e,"|)")){e=G.advance(e);var S=G.spanStates(x,e);return W(e,z.Err(S,z.EmptyPipe()))}return s=K(e,_),e=s.state,b=s.tree,l=ee(x,e,b,"(|","|)"),e=l.state,"Err"===(b=l.tree).type?W(e,b):W(e,U.Pipes(G.spanStates(x,e),[b]));case"Frac":e=G.advance(e);var M=H(w.num),I=H(w.den);if("Err"===M.type&&"EmptyGroup"===M.error.type&&"Err"===I.type&&"EmptyGroup"===I.error.type){var S=G.spanStates(x,e),E=z.Err(S,z.FractionEmpty());return W(e,E)}if("Err"===M.type&&"EmptyGroup"===M.error.type){var S=G.spanStates(x,e),E=z.Err(S,z.FractionMissingNumerator());return W(e,E)}if("Err"===I.type&&"EmptyGroup"===I.error.type){var S=G.spanStates(x,e),E=z.Err(S,z.FractionMissingDenominator());return W(e,E)}if("Err"===M.type)return W(e,M);if("Err"===I.type)return W(e,I);if(U.isDerivative(M,I)&&"Juxt"===I.type){var T=I.args[1],C=void 0;if(c=K(e,re("*")-1),e=c.state,"Err"!==(C=c.tree).type)return W(e,U.Derivative(G.spanStates(x,e),[T,C]));if(Y(C.error)){var S=G.spanStates(x,e);return W(e,z.Err(S,z.DerivativeMissingBody()))}return W(e,C)}return W(e,U.Frac(G.spanStates(x,e),[M,I]));case"Sqrt":if(e=G.advance(e),w.optArg){var k=H(w.optArg);if("Err"===k.type)return"EmptyGroup"===k.error.type?W(e,z.Err(k.span,z.EmptyRadicand())):W(e,k);var P=H(w.arg);return"Err"===P.type?"EmptyGroup"===P.error.type?W(e,z.Err(P.span,z.EmptyRadical())):W(e,P):W(e,U.Nthroot(G.spanStates(x,e),[k,P]))}var P=H(w.arg);return"Err"===P.type?"EmptyGroup"===P.error.type?W(e,z.Err(P.span,z.EmptyRadical())):W(e,P):W(e,U.Sqrt(G.spanStates(x,e),[P]));case"Trig":case"Ln":e=G.advance(e);var D=U.Cmd(G.spanStates(x,e),w.val),A=0,L=G.peek(e);if("SupSub"===L.type){if(e=G.advance(e),L.sub){var S=G.spanStates(x,e),E=z.Err(S,z.UnexpectedSubscript(D.val));return W(e,E)}var O=$(L);if(O){if("Err"===O.type)return W(e,O);D=U.Superscript(G.spanStates(x,e),[D,O])}A=L.nprimes}var q=G.isAt(e,"(");if(q){if(u=Z(e),e=u.state,"Err"===(b=u.tree).type)return W(e,b);b=U.Call(G.spanStates(x,e),[D,b.args[0]])}else{if(p=K(e,_-1),e=p.state,"Err"===(b=p.tree).type)return Y(b.error)?W(e,z.Err(G.spanStates(x,e),z.FunctionMissingArgument(w.val))):W(e,b);b=U.ImplicitCall(G.spanStates(x,e),[D,b])}if(0<A){var S=G.spanStates(x,e);if(!q){var E=z.Err(S,z.PrimeWithoutParen());return W(e,E)}b=U.Prime(S,A,[b])}return W(e,b);case"Log":e=G.advance(e);var D=U.Cmd(G.spanStates(x,e),w.val),A=0,F=void 0,O=void 0,L=G.peek(e);if("SupSub"===L.type&&(e=G.advance(e),F=X(L),O=$(L),A=L.nprimes),F&&"Err"===F.type)return W(e,F);if(O&&"Err"===O.type)return W(e,O);var q=G.isAt(e,"(");if(q){if(d=Z(e),e=d.state,"Err"===(b=d.tree).type)return W(e,b);b=b.args[0]}else if(h=K(e,_-1),e=h.state,"Err"===(b=h.tree).type)return Y(b.error)?W(e,z.Err(G.spanStates(x,e),z.FunctionMissingArgument(w.val))):W(e,b);var N=F?U.Seq(G.spanStates(x,e),U.unwrapSeq(b).concat(F)):b,R=F?U.Cmd(G.spanStates(x,e),"\\logbase"):D;if(O&&(R=U.Superscript(G.spanStates(x,e),[R,O])),b=q?U.Call(G.spanStates(x,e),[R,N]):U.ImplicitCall(G.spanStates(x,e),[R,N]),0<A){var S=G.spanStates(x,e);if(!q){var E=z.Err(S,z.PrimeWithoutParen());return W(e,E)}b=U.Prime(S,A,[b])}return W(e,b);case"Int":e=G.advance(e);var L=G.peek(e);e=G.advance(e);var B=Q(L,x,e);if("Err"===B.type)return"MissingBound"===B.error.type?W(e,z.Err(B.span,z.IntegralMissingBound())):W(e,B);var O=B.sup,F=B.sub,T=void 0;if(G.isAt(e,"Differential"))return f=J(e),e=f.state,"Err"===(T=f.tree).type?W(e,T):W(e,U.EmptyIntegral(G.spanStates(x,e),[T,F,O]));if(g=K(e,_),e=g.state,"Err"===(b=g.tree).type)return Y(b.error)?W(e,z.Err(b.span,z.IntegralMissingBody())):W(e,b);var j=b;return G.isAt(e,"Differential")?(m=J(e),e=m.state,"Err"===(T=m.tree).type?W(e,T):W(e,U.Integral(G.spanStates(x,e),[T,F,O,j]))):W(e,z.Err(G.spanStates(x,e),z.IntegralMissingDifferential()));case"Sum":e=G.advance(e);var L=G.peek(e);e=G.advance(e);var B=Q(L,x,e);if("Err"===B.type)return"MissingBound"===B.error.type?W(e,z.Err(B.span,z.SumMissingBound())):W(e,B);var O=B.sup,F=B.sub;return y=K(e,_),e=y.state,"Err"===(b=y.tree).type?Y(b.error)?W(e,z.Err(b.span,z.SumMissingBody())):W(e,b):W(e,U.Sum(G.spanStates(x,e),[b,F,O]));case"Prod":e=G.advance(e);var L=G.peek(e);e=G.advance(e);var B=Q(L,x,e);if("Err"===B.type)return"MissingBound"===B.error.type?W(e,z.Err(B.span,z.ProductMissingBound())):W(e,B);var O=B.sup,F=B.sub;return v=K(e,_),e=v.state,"Err"===(b=v.tree).type?Y(b.error)?W(e,z.Err(b.span,z.ProductMissingBody())):W(e,b):W(e,U.Product(G.spanStates(x,e),[b,F,O]));case"Cmd":return e=G.advance(e),b=U.Cmd(G.spanStates(x,e),w.val),W(e,b);case"Letter":return e=G.advance(e),b=U.Letter(G.spanStates(x,e),w.val),W(e,b);case"Decimal":return W(e=G.advance(e),U.Decimal(G.spanStates(x,e),w.val));case"MixedNumber":return W(e=G.advance(e),w);case"*":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"~":case":":case"...":case"%":e=G.advance(e);var S=G.spanStates(x,e),E=z.Err(S,z.BinaryOperatorMissingLeft(w.type));return W(e,E);case"!":case"SupSub":e=G.advance(e);var S=G.spanStates(x,e),E=z.Err(S,z.UnaryOperatorMissingLeft(w.type));return W(e,E);case")":case"\\}":case"]":case"|)":case"Differential":return te(e);case"Err":e=G.advance(e);var S=G.spanStates(x,e),E=z.Err(S,z.UnrecognizedSymbol(w.val));return W(e,E);case"End":var S=G.spanStates(x,e),E=z.Err(S,z.UnexpectedEnd());return W(e,E);default:var V=w;throw"Unexpected token type "+V.type+"."}}(e)).state,"Err"===(i=r.tree).type)return W(e,i);if(!G.didAdvance(a,e))throw new Error("Programming Error: parseInitial did not advance state.");for(;!G.isDone(e);){if((!G.isAt(e,"(")||(o=i,U.isIdentifier(o)||"Prime"===o.type&&U.isIdentifier(o.args[0]))?re(G.peek(e).type):D("("))<=t)break;var s=e;if(e=(n=l(e,i)).state,"Err"===(i=n.tree).type)return W(e,i);if(!G.didAdvance(s,e))throw new Error("Programming Error: parseSuccessor did not advance state.")}return W(e,i)}function Y(e){return"UnexpectedDifferential"===e.type||"UnexpectedCloseDelimiter"===e.type||"UnexpectedEnd"===e.type||"BinaryOperatorMissingLeft"===e.type}function l(e,t){var r,n,i,o,a,s,l,c,u,p,d,h,f,g,m,y=G.peek(e),v=D(y.type);switch(y.type){case"+":case"-":case"*":case"/":case"=":case"~":case":":if(e=(r=K(e=G.advance(e),v)).state,"Err"!==(m=r.tree).type)return W(e,function(e,t,r){switch(e){case"+":return U.Add(t,r);case"-":return U.Sub(t,r);case"*":return U.Mul(t,r);case"/":return U.Div(t,r);case"=":return U.Equals(t,r);case"~":return U.Tilde(t,r);case":":return U.Colon(t,r);default:var n=e;throw"Unexpected token type "+n+"."}}(y.type,G.joinState(t.span,e),[t,m]));if(Y(m.error)){var b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m);case"%":e=G.advance(e);var x=G.peek(e);if("Cmd"!==x.type||"of"!==x.val&&"\\of"!==x.val)return W(e,z.Err(y.span,z.PercentMissingOf()));if(e=(n=K(e=G.advance(e),v)).state,"Err"!==(m=n.tree).type)return W(e,U.PercentOf(G.joinState(t.span,e),[t,m]));if(Y(m.error)){b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m);case">=":case"<=":case">":case"<":var w=y.type;if(e=(i=k(e=G.advance(e),w)).state,w=i.symbol,e=(o=K(e,v)).state,"Err"===(m=o.tree).type){if(Y(m.error)){b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m)}for(var _=U.Inequality(G.joinState(t.span,e),w,[t,m]),S=[],E=G.peek(e).type;">="===E||"<="===E||">"===E||"<"===E;){var M=e;if(w=E,e=(a=k(e=G.advance(e),w)).state,w=a.symbol,e=(s=K(e,v)).state,"Err"===(m=s.tree).type){if(Y(m.error)){b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m)}S.push(U.TrailingInequalityPiece(G.spanStates(M,e),w,[m])),E=G.peek(e).type}return S.length?W(e,U.InequalityChain(G.joinState(t.span,e),_,S)):W(e,_);case"!":return W(e=G.advance(e),U.Bang(G.joinState(t.span,e),[t]));case"[":M=e;if(e=G.advance(e),G.isAt(e,"]")){e=G.advance(e);b=G.spanStates(M,e);return W(e,z.Err(b,z.EmptySquareBracket()))}return e=(c=ee(M,e=(l=K(e,v)).state,m=l.tree,"[","]")).state,"Err"===(m=c.tree).type?W(e,m):W(e,U.Index(G.joinState(t.span,e),[t,m]));case"Sqrt":case"Frac":case"Letter":case"Cmd":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\{":case"(|":return e=(u=K(e,v)).state,"Err"===(m=u.tree).type?W(e,m):W(e,U.Juxt(G.joinState(t.span,e),[t,m]));case"(":if(U.isIdentifier(t)){if(e=(p=Z(e)).state,"Err"===(m=p.tree).type)return W(e,m);b=G.joinState(t.span,e);return W(e,U.Call(b,[t,m.args[0]]))}if("Prime"===t.type&&U.isIdentifier(t.args[0])){if(e=(d=Z(e)).state,"Err"===(m=d.tree).type)return W(e,m);b=G.joinState(t.span,e);return W(e,U.Prime(b,t.nprimes,[U.Call(b,[t.args[0],m.args[0]])]))}return e=(h=K(e,v)).state,"Err"===(m=h.tree).type?W(e,m):W(e,U.Juxt(G.joinState(t.span,e),[t,m]));case"SupSub":e=G.advance(e);var I=P(y),T=$(y);if(I&&"Err"===I.type)return W(e,I);if(T&&"Err"===T.type)return W(e,T);if(I&&(t=U.Subscript(G.joinState(t.span,e),[t,I])),T&&(t=U.Superscript(G.joinState(t.span,e),[t,T])),0<y.nprimes){b=G.joinState(t.span,e);if(!U.isIdentifier(t))return W(e,z.Err(b,z.UnexpectedPrime()));t=U.Prime(b,y.nprimes,[t])}return W(e,t);case",":for(var C=[t];G.isAt(e,",")&&(e=G.advance(e),!G.isAt(e,"..."));){if(e=(f=K(e,v)).state,"Err"===(m=f.tree).type){if(Y(m.error)){b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m)}C.push(m)}return W(e,U.Seq(G.joinState(t.span,e),C));case"...":if(e=G.advance(e),G.isAt(e,",")&&(e=G.advance(e)),e=(g=K(e,v)).state,"Err"!==(m=g.tree).type)return W(e,U.Ellipsis(G.joinState(t.span,e),[t,m]));if(Y(m.error)){b=G.joinState(t.span,e);return W(e,z.Err(b,z.BinaryOperatorMissingRight(y.type)))}return W(e,m);case"]":case")":case"\\}":case"|)":case"Differential":return te(e);case"Err":return K(e,v);case"End":b=G.spanStates(e,e);return W(e,z.Err(b,z.UnexpectedEnd()));default:throw"Unexpected token type "+y.type+"."}}function k(e,t){if(!G.isAt(e,"="))return{state:e,symbol:t};switch(t){case">":e=G.advance(e),t=">=";break;case"<":e=G.advance(e),t="<="}return{state:e,symbol:t}}function X(e){if(e.sub){var t=H(e.sub);return"Err"===t.type&&"EmptyGroup"===t.error.type?z.Err(t.span,z.EmptySubscript()):t}}function P(e){if(e.sub){var t=e.sub;if(0===t.args.length)return z.Err(t.span,z.EmptySubscript());for(var r=[],n=0,i=t.args;n<i.length;n++){var o=i[n];if("Digit"!==o.type&&"Letter"!==o.type){var a=o.span;return z.Err(a,z.InvalidSubscript(s.slice(a)))}r.push(o.val)}return U.Alphanumeric(t.span,r.join(""))}}function $(e){if(e.sup){var t=H(e.sup);return"Err"===t.type?"EmptyGroup"===t.error.type?z.Err(t.span,z.EmptySuperscript()):t:0<e.nprimes?z.Err(e.span,z.SuperscriptWithPrime()):t}}function Q(e,t,r){if("SupSub"!==e.type){var n=G.spanStates(t,r);return z.Err(n,z.MissingBound())}if(0<e.nprimes){n=G.spanStates(t,r);return z.Err(n,z.UnexpectedPrime())}var i=X(e),o=$(e);if(!i||"Err"===i.type&&"EmptySubscript"===i.error.type||!o||"Err"===o.type&&"EmptySuperscript"===o.error.type){n=G.spanStates(t,r);return z.Err(n,z.MissingBound())}return"Err"===i.type?i:"Err"===o.type?o:{type:"Bounds",sup:o,sub:i}}function Z(e){var t,r,n,i=e,o=G.peek(e),a=ne(o.type);if(!G.isAt(e,"("))throw new Error("Programming Error: expected '(' at start of parseParen.");if(e=G.advance(e),G.isAt(e,")")){var s=U.Seq(G.emptySpanAtState(e),[]);e=G.advance(e);var l=G.spanStates(i,e);return W(e,U.Paren(l,[s]))}return e=(r=ee(i,e=(t=K(e,a)).state,n=t.tree,"(",")")).state,"Err"===(n=r.tree).type?W(e,n):W(e,U.Paren(G.spanStates(i,e),[n]))}function J(e){var t=e,r=G.peek(e);if("Differential"!==r.type)throw new Error("Programming Error: expected differential");e=G.advance(e);var n=U.Cmd(r.span,r.val),i=G.peek(e);if("SupSub"===i.type){e=G.advance(e);var o=G.spanStates(t,e),a=P(i);if(a){if("Err"===a.type)return W(e,a);n=U.Subscript(o,[n,a])}if(i.sup)return W(e,z.Err(o,z.DifferentialWithSuperscript()));if(0<i.nprimes)return W(e,z.Err(o,z.UnexpectedPrime()))}return W(e,n)}function ee(e,t,r,n,i){if("Err"===r.type&&"UnexpectedEnd"!==r.error.type)return W(t,r);if("Err"!==r.type&&G.isAt(t,i))return W(t=G.advance(t),r);var o=G.spanStates(e,t);return W(t,z.Err(o,z.MissingCloseDelimiter(n,i)))}function te(e){var t=e;switch(G.peek(e).type){case")":e=G.advance(e);var r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedCloseDelimiter("(",")")));case"]":e=G.advance(e);r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedCloseDelimiter("[","]")));case"\\}":e=G.advance(e);r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedCloseDelimiter("\\{","\\}")));case"|)":e=G.advance(e);r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedCloseDelimiter("|","|")));case"Differential":e=G.advance(e);r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedDifferential()));default:e=G.advance(e);r=G.spanStates(t,e);return W(e,z.Err(r,z.UnexpectedParseError()))}}Object.defineProperty(t,"__esModule",{value:!0});var n=[[r.initial("("),r.la(")"),r.initial("\\{"),r.la("\\}"),r.r("["),r.la("]"),r.initial("(|"),r.la("|)"),r.la("Differential"),r.la("End")],[r.ra("...")],[r.la(",")],[r.ra(":")],[r.la("="),r.la(">"),r.la("<"),r.la(">="),r.la("<="),r.la("~")],[r.la("+"),r.la("-")],[r.la("*"),r.la("/"),r.la("Decimal"),r.la("MixedNumber"),r.la("Letter"),r.la("Cmd"),r.la("%"),r.r("("),r.la("\\{"),r.la("(|"),r.la("Frac"),r.la("Sqrt"),r.la("Trig"),r.la("Ln"),r.la("Log"),r.ra("Int"),r.ra("Sum"),r.ra("Prod")],[r.initial("+"),r.initial("-")],[r.l("("),r.l("[")],[r.la("!")],[r.la("SupSub")],[r.la("Err")]],i=r.precSpec(n),re=i.leftPrec,D=i.rightPrec,ne=i.initialPrec;t.parse=function(e){var t=H(e);return"Err"===t.type&&"EmptyGroup"===t.error.type?z.Err(t.span,z.EmptyInput()):t}}),define("math/inverses",[],function(){var t={};return["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"].forEach(function(e){t[e]="arc"+e,t["arc"+e]=e}),t}),define("math/parser/lower",["require","exports","math/inverses","math/errormsg","./input-span","./surface-node","../maybe-rational"],function(e,t,f,N,d,R,B){"use strict";function j(e,t){for(var r=[],n=0;n<t.length;n++)r.push(V(e,t[n]));return r}function I(e){if("Paren"!==e.type)return!1;var t=e.args[0];return"Seq"===t.type&&2===t.args.length}function V(e,t){return e.setInput(U(e,t),t.span)}function U(e,t){var r=e.nodes;switch(t.type){case"Pos":return U(e,t.args[0]);case"Neg":for(var n=-1,i=t.args[0];;)if("Pos"===i.type||"Paren"===i.type)i=i.args[0];else{if("Neg"!==i.type)break;i=i.args[0],n*=-1}switch(i.type){case"Decimal":var o=K(i);return r.Constant(-1===n?B.neg(o):o);case"MixedNumber":o=Y(i);return r.MixedNumber(-1===n?B.neg(o):o);default:return-1===n?r.Negative([V(e,i)]):U(e,i)}case"Add":return r.Add(j(e,t.args));case"Sub":return r.Subtract(j(e,t.args));case"Mul":return r.Multiply(j(e,t.args));case"Div":return r.Divide(j(e,t.args));case"Bang":var a=t.args[0];return"Call"===a.type?r.FunctionFactorial(j(e,a.args)):r.FunctionCall("\\factorial",j(e,t.args));case"PercentOf":return r.PercentOf(j(e,t.args));case"Call":return H(e,t);case"ImplicitCall":return function(e){var t=e.args,r=t[0],n=t[1];if("Superscript"===r.type&&(r=r.args[0]),"Cmd"===r.type&&"logbase"===r.val&&"Seq"===n.type&&2===n.args.length){if(!X(n.args[0]))throw N.badImplicitCall("log")}else if(!X(n)){if("Cmd"===r.type)throw N.badImplicitCall(r.val);throw N.parseError()}}(t),H(e,t);case"Prime":var s=t.args[0];if("Call"!==s.type)throw"ImplicitCall"===s.type?N.primeWithoutParen():N.unexpectedPrime();var l=s.args,c=l[0],u=l[1],p=R.unwrapSeq(u).length;if("Cmd"===c.type&&"logbase"===c.val){if(2!==p)throw N.primedFunctionArity()}else if(1!==p)throw N.primedFunctionArity();return r.Prime(t.nprimes,j(e,t.args));case"Index":return r.ListAccess(j(e,t.args));case"Paren":var d=t.args[0];if("Seq"!==d.type)return U(e,d);if(2===d.args.length)return r.OrderedPair(j(e,d.args));throw 0===d.args.length?N.emptyParen():N.nonPairTuple();case"List":var h=t.args[0];if("Ellipsis"!==h.type)return r.List(j(e,R.unwrapSeq(h)));var f=h.args,g=f[0],m=f[1];return r.Range([r.List(j(e,R.unwrapSeq(g))),r.List(j(e,R.unwrapSeq(m)))]);case"Pipes":return r.FunctionCall("\\abs",j(e,t.args));case"Subscript":var y=t.args,v=y[0],b=y[1];if(0===b.val.length)throw N.emptySubscript();var x=void 0;switch(v.type){case"Letter":case"Cmd":x=v.val;break;default:throw N.unexpectedSubscript()}return r.Identifier(x+"_"+b.val);case"Superscript":var w=t.args,_=(v=w[0],w[1]);return"Call"!==v.type||"Seq"===v.args[1].type||function(e){if("Call"!==e.type)return!1;for(var t=e.args[0];"Superscript"===t.type||"Subscript"===t.type||"Prime"===t.type;)t=t.args[0];return"Cmd"===t.type&&(z(t.val)||G(t.val))}(v)?r.Exponent(j(e,t.args)):r.FunctionExponent(j(e,[v.args[0],v.args[1],_]));case"Sqrt":return r.FunctionCall("sqrt",j(e,t.args));case"Nthroot":return r.FunctionCall("nthroot",j(e,[t.args[1],t.args[0]]));case"Frac":return r.Divide(j(e,t.args));case"Derivative":var S=j(e,t.args);if(!R.isIdentifier(t.args[0]))throw N.parseError();return r.Derivative(S[0],[S[1]]);case"Integral":var E=t.args;S=j(e,[I=E[0],E[1],C=E[2],k=E[3]]);return r.Integral(S);case"EmptyIntegral":var M=j(e,t.args),I=M[0],T=M[1],C=M[2],k=r.Constant(B.maybeRational(1,1));return r.Integral([I,T,C,k]);case"Sum":var P=t.args,D=P[0],A=P[1];C=P[2];if("Equals"!=A.type)throw N.incorrectSumLowerBound();if(!R.isIdentifier(A.args[0]))throw N.incorrectSumLowerBound();S=j(e,[A.args[0],A.args[1],C,D]);return r.Sum(S);case"Product":var L=t.args,O=L[0],q=L[1];C=L[2];if("Equals"!=q.type)throw N.incorrectProductLowerBound();if(!R.isIdentifier(q.args[0]))throw N.incorrectProductLowerBound();S=j(e,[q.args[0],q.args[1],C,O]);return r.Product(S);case"Juxt":return function(e,t){var r=e.nodes.Multiply(j(e,t.args));if(!function e(t){switch(t.type){case"Letter":case"Cmd":case"Mul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"EmptyPiecewise":case"Paren":case"Juxt":return!0;case"Subscript":case"Superscript":case"Bang":case"Index":return e(t.args[0]);case"Decimal":case"MixedNumber":case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":return!1;default:var r=t;throw"Unexpected surface node "+r.type+"."}}(t.args[1]))throw N.badImplicitMultiply();return r}(e,t);case"Letter":return r.Identifier(t.val);case"Cmd":var F=t.val;if("ans"!==F)return r.Identifier(F);if(void 0===e.currentIndex)throw N.badAnsContext();return r.Ans("ans_{"+(e.currentIndex-1)+"}");case"Decimal":return r.Constant(K(t));case"MixedNumber":return r.MixedNumber(Y(t));case"Piecewise":return function(e,t){var r,n=e.nodes,i=t.args[0],o=R.unwrapSeq(i),a=[];e:for(r=0;r<o.length;r++){var s=o[r];switch(s.type){case"Colon":var l=s.args,c=l[0],u=l[1];if("Equals"!==(p=c).type&&"Inequality"!==p.type&&"InequalityChain"!==p.type)throw N.colonMissingCondition();a.push({condition:W(e,c),if_expr:V(e,u)});break;case"Equals":case"Inequality":case"InequalityChain":a.push({condition:W(e,s),if_expr:n.Constant(B.maybeRational(1,1))});break;default:break e}}var p;if(0===r)throw N.piecewiseMissingCondition();if(r<o.length-1)throw N.piecewisePartMissingCondition();if(r===o.length-1&&a.push({condition:n.Constant(!0),if_expr:V(e,o[r])}),!n.Piecewise.chain)throw N.featureUnavailable();return n.Piecewise.chain(a)}(e,t);case"EmptyPiecewise":if(!r.Piecewise.empty)throw N.featureUnavailable();return r.Piecewise.empty();case"Equals":throw N.unexpectedSymbol("=");case"Inequality":case"InequalityChain":throw N.unexpectedInequality();case"Tilde":throw N.unexpectedSymbol("~");case"Seq":throw N.unexpectedSymbol(",");case"Colon":throw N.unexpectedSymbol(":");case"Ellipsis":throw N.unexpectedSymbol("...");case"Err":throw function(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return N.parseError();case"InvalidOperatorName":return N.invalidOperatorName();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return N.mismatchedBraces(e.open,e.close);case"UnrecognizedSymbol":return"."===e.val?N.unexpectedSymbol(e.val):N.unrecognizedSymbol(e.val);case"EmptyInput":return N.blankExpression();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return N.binaryOperatorMissingOperand("%"===e.val?"% of":e.val);case"UnaryOperatorMissingLeft":return N.unaryOperatorMissingLeft(e.val);case"UnaryOperatorMissingRight":return N.unaryOperatorMissingRight(e.val);case"UnexpectedSubscript":return N.cannotSubscript(e.base);case"PercentMissingOf":return N.percentMissingOf();case"SumMissingBound":return N.sumMissingBound();case"ProductMissingBound":return N.productMissingBound();case"IntegralMissingBound":return N.integralMissingBound();case"SumMissingBody":return N.sumMissingBody();case"ProductMissingBody":return N.productMissingBody();case"IntegralMissingBody":return N.integralMissingBody();case"DerivativeMissingBody":return N.derivativeMissingBody();case"IntegralMissingDifferential":return N.integralMissingDifferential();case"DifferentialWithSuperscript":return N.differentialWithSuperscript();case"FractionMissingNumerator":return N.fractionMissingNumerator();case"FractionMissingDenominator":return N.fractionMissingDenominator();case"FractionEmpty":return N.fractionEmpty();case"EmptySuperscript":return N.emptySuperscript();case"EmptySubscript":return N.emptySubscript();case"InvalidSubscript":return N.invalidSubscript(e.val);case"SuperscriptWithPrime":return N.superscriptWithPrime();case"PrimeWithoutParen":return N.primeWithoutParen();case"UnexpectedPrime":return N.unexpectedPrime();case"EmptyRadical":return N.emptyRadical();case"EmptyRadicand":return N.emptyRadicand();case"EmptySquareBracket":return N.emptySquareBracket();case"EmptyPipe":return N.emptyPipe();case"FunctionMissingArgument":return N.wrongArity(e.val,1,0);default:var t=e;throw"Unexpected surface node "+t.type+"."}}(t.error);default:throw"Unexpected surface node "+t.type+"."}}function z(e){return f.hasOwnProperty(e)}function G(e){return"ln"===e||"log"===e||"logbase"===e}function H(e,t){var r,n,i=e.nodes,o=t.args,a=o[0],s=o[1],l=V(e,a),c=j(e,R.unwrapSeq(s));if(R.isIdentifier(a))return i.FunctionCall(l,c);if("Superscript"===a.type){var u=a.args,p=u[0],d=u[1];if("Cmd"===p.type){var h=p.val;if(z(h)||G(h)){if("Decimal"===(n=d).type&&"2"===n.val)return i.Exponent([i.FunctionCall(h,c),V(e,d)]);if("Neg"===(r=d).type&&"Decimal"===(r=r.args[0]).type&&"1"===r.val&&void 0!==f[h])return i.FunctionCall(f[h],c);throw z(h)?N.badTrigExponent(h):N.badLogExponent("logbase"===h?"log":h)}}}return i.Multiply([l,V(e,s)])}function W(e,t){var r=e.nodes;switch(t.type){case"Equals":return r.Comparator["="](j(e,t.args));case"Inequality":return r.Comparator[t.symbol](j(e,t.args));case"InequalityChain":if(1<t.chain.length)throw N.inequalityChainTooLong();var n=t.first,i=n.symbol,o=n.args,a=o[0],s=o[1],l=t.chain[0],c=l.symbol,u=l.args[0],p=d.emptySpanAt(t.span.input,t.span.start);return r.And([W(e,R.Inequality(p,i,[a,s])),W(e,R.Inequality(p,c,[s,u]))]);default:throw N.parseError()}}function K(e){return B.fromDecimalString(e.val)}function Y(e){var t=B.fromDecimalString(e.whole),r=B.fromDecimalString(e.num),n=B.fromDecimalString(e.den);return B.add(t,B.div(r,n))}function X(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":for(var t=e.args[0];;)if("Pos"===t.type||"Paren"===t.type)t=t.args[0];else{if("Neg"!==t.type)break;t=t.args[0]}return"Decimal"===t.type||"MixedNumber"===t.type;case"Pos":case"Paren":return X(e.args[0]);case"Juxt":case"Mul":case"Div":return X(e.args[0])&&X(e.args[1]);case"Subscript":return X(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return X(e.args[0])&&X(e.args[1]);case"Piecewise":return"Equals"===(t=e.args[0]).type||"Inequality"===t.type||"InequalityChain"===t.type;case"Call":var r=e.args,n=r[0],i=r[1];return!R.isIdentifier(n)&&!R.isSuperscriptedIdentifier(n)&&X(n)&&X(i);case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Neg":case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"PercentOf":case"Prime":return!1;default:throw"Unexpected surface node "+e.type+"."}}Object.defineProperty(t,"__esModule",{value:!0}),t.lower=function(e,t){return n=t,(r=e).setInput(function(e,t){var r,n,i,o,a=e.nodes;switch(t.type){case"Equals":var s=t.args,l=s[0],c=s[1];if("Call"===l.type){var u=l.args,p=u[0],d=u[1],h=R.unwrapSeq(d);if(R.isIdentifier(p)&&h.every(R.isIdentifier))return a.FunctionDefinition(V(e,p),j(e,h),V(e,c))}else if(R.isIdentifier(l))return a.Assignment(V(e,l),V(e,c));return a.Equation(V(e,l),V(e,c));case"Tilde":var f=j(e,t.args),l=f[0],c=f[1];return a.Regression(l,c);case"Inequality":return W(e,t);case"InequalityChain":if(1<t.chain.length)throw N.inequalityChainTooLong();var g=t.first,m=g.symbol,y=g.args,v=y[0],b=y[1],x=t.chain[0],w=x.symbol,_=x.args[0];return R.isIdentifier(b)?a.DoubleInequality([V(e,v),m,V(e,b),w,V(e,_)]):W(e,t);case"Seq":if(!t.args.every(I))throw N.malformedPoint();return a.List(j(e,t.args));case"Call":var S=t.args,E=S[0],M=S[1];return"Cmd"===(o=E).type&&"polygon"===o.val?a.Polygon(j(e,R.unwrapSeq(M))):"Cmd"===(i=E).type&&"histogram"===i.val?a.Histogram(j(e,R.unwrapSeq(M))):"Cmd"===(n=E).type&&"dotplot"===n.val?a.DotPlot(j(e,R.unwrapSeq(M))):"Cmd"===(r=E).type&&"boxplot"===r.val?a.BoxPlot(j(e,R.unwrapSeq(M))):U(e,t);default:return U(e,t)}}(r,n),n.span);var r,n}}),define("math/baseparser",["require","exports","math/errormsg","parsenodes","math/parser/latex-parser","math/parser/expression-parser","math/parser/lower"],function(e,t,c,u,p,d,h){"use strict";function f(){throw c.featureUnavailable()}function g(e,t){return e.setInputSpan(t),e}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e,t){if("string"!=typeof e)throw new Error("Type Error: parse can only be called with strings");var r=u;if((t=t||{}).disabledFeatures){r=Object.create(r);for(var n=0,i=t.disabledFeatures;n<i.length;n++){var o=i[n];if(!r[o])throw new Error("Programming Error: "+o+" cannot be disabled because it is not a parsenode.");r[o]=f}}var a={nodes:r,currentIndex:t.index,setInput:g};try{var s=p.parse(e),l=d.parse(s);return h.lower(a,l)}catch(e){return e instanceof u.Error?e:"string"==typeof e?u.Error(e):c.parseError()}}}),define("math/rational-arithmetic-sequence",["require","math/distance","math/builtin"],function(e){var a=e("math/distance"),s=e("math/builtin");return function(e,t){var r=s.toFraction(e),n=s.toFraction(t);if(a.approx(r.n/r.d,e)&&a.approx(n.n/n.d,t)){var i=s.lcm(r.d,n.d),o=r.n*(i/r.d);return{nstart:o,nstep:n.n*(i/n.d)-o,lcm:i}}}}),define("math/features/getConcreteTree",["require","parsenodes","math/errormsg","math/types","graphing/label","math/distance","math/maybe-rational","math/rational-arithmetic-sequence","math/sliders"],function(e){function u(e,t,r){if(t){var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(0<n.length){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}else r.valids[e]=!0}function f(e,t,r,n,i){if(r<e.length&&!o.approx(i,e.elementAt(r).asValue(),10))throw g.nonArithmeticRange();if(n-r<=t.length&&1<n-r&&!o.approx(i,t.elementAt(t.length-n+r).asValue(),10))throw g.nonArithmeticRange()}function a(e,t){for(var r=!1,n=!1,i=0;i<e.length;i++){var o=e[i];(o.isList||o.isBroadcast)&&(n=!0);for(var a=o.getDependencies(),s=0;s<a.length;s++)if(-1!==t.indexOf(a[s])){if(o.isList||o.isBroadcast)return"list"}else r=!0}return n?r?"broadcast":"list":"none"}function s(e){var t,r=[],n=[],i=[];for(t=0;t<e.length;t++){var o,a=e[t];if(a.isList){for(var s=!1,l=0;l<i.length;l++)if(a===i[l]){s=!0,(o=p.DummyIndex(n[l])).valueType=d.elementType(a.valueType),r.push(o);break}if(!s){var c=p.Base.prototype.tmpVar();n.push(c),i.push(a),(o=p.DummyIndex(c)).valueType=d.elementType(a.valueType),r.push(o)}}else a.isBroadcast?(Array.prototype.push.apply(n,a._replacedSymbols),Array.prototype.push.apply(i,a._lists),r.push(a._expression)):r.push(a)}return{replacedArgs:i,concreteArgs:r,replacedSymbols:n}}function t(t,e){if(e&&e[this.type])return e[this.type].call(this,t,e);var r=this.args.map(function(e){return e.getConcreteTree(t)});return this.typeCheck(r),new this.constructor(r)}var p=e("parsenodes"),g=e("math/errormsg"),d=e("math/types"),l=e("graphing/label"),o=e("math/distance"),h=e("math/maybe-rational"),m=h.maybeRational,y=e("math/rational-arithmetic-sequence"),v=p.List,n=p.OrderedPair,c=p.ScalarExpression,b=p.Constant,x=p.Multiply,w=p.Identifier,_=p.DummyIndex,S=p.BuiltInFunction,E=e("math/sliders");p.Base.prototype.tryGetConcreteTree=function(){var t;try{t=this.getConcreteTree.apply(this,arguments)}catch(e){t=e instanceof p.Base?e:g.parseError()}return t},p.Base.prototype.getConcreteTree=function(e,t){if(t)return this._getConcreteTree(e,t);if(this.isConcreteTreeCacheValid(e))return this.__cachedConcreteTree.value;for(var r=this._getConcreteTree(e,t),n={},i=this.getCacheKeys().slice();i.length;){var o=i.pop();if(!n.hasOwnProperty(o)){var a=e[o];(n[o]=a)&&Array.prototype.push.apply(i,a.getCacheKeys())}}return this.__cachedConcreteTree={keys:n,value:r},r},p.Base.prototype.getCacheKeys=function(){return this.getDependencies()},p.Base.prototype.isConcreteTreeCacheValid=function(e){if(!this.__cachedConcreteTree)return!1;for(var t in this.__cachedConcreteTree.keys)if(this.__cachedConcreteTree.keys.hasOwnProperty(t)&&e[t]!==this.__cachedConcreteTree.keys[t])return!1;return!0},p.PercentOf.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):p.Divide([p.Multiply(this.args),p.Constant(m(100,1))]).getConcreteTree(e,t)},p.Assignment.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this._expression.getConcreteTree(e,t)},p.Identifier.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=e[this._symbol];if(r){if(r.isError)throw r;return r.isFunction?r.getConcreteInvocationTree(e,[],t):r.getConcreteTree(e,t)}if(S.hasOwnProperty(this._symbol))throw g.functionUnsupported(l.latexToIdentifier(this.getInputString()));return p.FreeVariable(this._symbol)},p.Ans.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(void 0===e[this._symbol])throw g.ansUndefined();return w.prototype._getConcreteTree.call(this,e,t)},p.Equation.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this.asComparator().getConcreteTree(e,t)},p.Constant.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._constantValue)},p.Derivative.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r;if(e[this._symbol]){var n=Object.create(e);n[this._symbol]=p.FreeVariable(this._symbol);var i=e[this._symbol].getConcreteTree(e,t);if(i.valueType!==d.Number&&i.valueType!==d.ListOfNumber)throw g.derivativeVariableTypeError(this._symbol,[d.prettyPrint(i.valueType)]);var o={};return o[this._symbol]=i,r=this.args[0].getConcreteTree(n,t),this.typeCheck([r]),r.takeDerivative(this._symbol).substitute(o).getConcreteTree(e,t)}return r=this.args[0].getConcreteTree(e,t),this.typeCheck([r]),r.takeDerivative(this._symbol).getConcreteTree(e,t)},p.DoubleInequality.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor([p.Piecewise([this._indicator,this._expressions[0],b(NaN)]).getConcreteTree(e,t),this._operators[0],w(this._symbol),this._operators[1],p.Piecewise([this._indicator,this._expressions[1],b(NaN)]).getConcreteTree(e,t)])},p.Expression.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].getConcreteTree(e,t));return this.typeCheck(r),this._constantCollapsedCopy(r)},p.Error.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this},p.FreeVariable.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this},p.FunctionCall.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=e[this._symbol];if(r&&r.isError)throw r;if(!r||!r.isFunction){if(S.hasOwnProperty(this._symbol))throw g.functionUnsupported(l.latexToIdentifier(this._identifier.getInputString()));if(1==this.args.length){var n=[w(this._symbol),this.args[0]];return x(n).getConcreteTree(e,t)}if(r)throw g.variableAsFunction(this._symbol);throw g.functionNotDefined(this._symbol)}for(var i=[],o=0;o<this.args.length;o++){var a=this.args[o].getConcreteTree(e,t);i.push(a)}return r.getConcreteInvocationTree(e,i,t)},p.FunctionExponent.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0]._symbol;return e[r]&&e[r].isFunction?p.Exponent([p.FunctionCall(r,[this.args[1]]),this.args[2]]).getConcreteTree(e,t):x([this.args[0],p.Exponent([this.args[1],this.args[2]])]).getConcreteTree(e,t)},p.FunctionFactorial.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0]._symbol;return e[r]&&e[r].isFunction?p.FunctionCall("\\factorial",[p.FunctionCall(r,[this.args[1]])]).getConcreteTree(e,t):x([this.args[0],p.FunctionCall("\\factorial",[this.args[1]])]).getConcreteTree(e,t)},p.FunctionDefinition.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=0;r<this._argSymbols.length;r++){if(e[this._argSymbols[r]])throw g.parameterAlreadyDefined(this._argSymbols[r]);if(this._argSymbols[r]===this._symbol)throw g.parameterAlreadyDefined(this._argSymbols[r])}return this._expression.getConcreteTree(e,t)},p.Image.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):p.Image({center:this.center.tryGetConcreteTree(e,t),radianAngle:this.radianAngle.tryGetConcreteTree(e,t),width:this.width.tryGetConcreteTree(e,t),height:this.height.tryGetConcreteTree(e,t)},this.moveStrategy)},p.Slider.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this._expression.getConcreteTree(e,t),n=this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t),i=this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t),o=this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t),a={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(u("min",n,a),u("max",i,a),u("step",o,a),o&&a.valids.step&&(0===a.values.step?delete a.values.step:a.values.step=Math.abs(a.values.step)),a.errors.cycle?r=g.sliderLimitReferencesExport(a.exportedSymbol):(a.errors.min||!a.valids.min?a.errMsg=g.sliderMinInvalid():a.errors.max||!a.valids.max?a.errMsg=g.sliderMaxInvalid():!a.errors.step&&a.valids.step||(a.errMsg=g.sliderStepInvalid()),a.values.min>a.values.max&&(a.valids.min=!1,a.valids.max=!1,a.errMsg||(a.errMsg=g.sliderMaxLessThanMin()))),r.isConstant){var s=E.constrainSliderValueLikeEvaluator({target:r.asValue(),hardMin:a.values.min,hardMax:a.values.max,step:a.values.step}),l=h.fromDecimalString(s.toString()),c=isFinite(h.asFloat(l))?l:s;r=b(c)}return r.sliderInfo=a,r},p.Integral.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(e[this._differential._symbol])throw g.shadowedIntegrationVariable(this._differential._symbol);var r=this.args[0],n=this.args[1],i=this.args[2];if(n.dependsOn(r._symbol)||i.dependsOn(r._symbol))throw g.badIntegralBoundDependency(r._symbol);var o=Object.create(e);return o[this._differential._symbol]=_(this._differential._symbol),c.prototype._getConcreteTree.call(this,o,t)},p.ListAccess.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.index.getConcreteTree(e,t),n=[this.list.getConcreteTree(e,t),r];return this.typeCheck(n),this._constantCollapsedCopy(n)},p.List.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=0;n<this.args.length;n++){var i=this.args[n].getConcreteTree(e,t);r.push(i)}return this.typeCheck(r),new this.constructor(r)},p.ParametrizedReducerFunction.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(this.args[0]instanceof p.Distribution){if(this.args[0][this._symbol])return this.args[0][this._symbol](this.args.slice(1)).getConcreteTree(e,t);throw g.functionTypeError(this._symbol,[d.prettyPrint(this.args[0].valueType)])}for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].getConcreteTree(e,t));switch(a([r[1]],this.getDummyDependencies())){case"none":return this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return p.List(p.List.mapArgs([r[1]],function(e){return e=[r[0]].concat(e),this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var i=s([r[1]]),o=[r[0]].concat(i.concreteArgs);return this.typeCheck(o),p.Broadcast(i.replacedSymbols,[this.copyWithArgs(o)].concat(i.replacedArgs))}},p.Prime.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0],n=r.args[0];if(!e[r._symbol])throw g.functionNotDefined(r._symbol);var i,o=this.tmpVar();if("logbase"===r._symbol){if(2!==r.args.length)throw g.primedFunctionArity();i=[w(o),r.args[1]]}else{if(1!==r.args.length)throw g.primedFunctionArity();i=[w(o)]}for(var a=r.copyWithArgs(i).getConcreteTree(e,t),s=0;s<this.order;s++)a=a.takeDerivative(o);var l={};return l[o]=n,a.substitute(l).getConcreteTree(e,t)},p.Range.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.beginning.getConcreteTree(e,t),n=this.end.getConcreteTree(e,t);if(r.getDependencies().length)throw g.variableRange(r.getDependencies());if(n.getDependencies().length)throw g.variableRange(n.getDependencies());if(!r.isList||!n.isList)throw new Error("Programming Error: range bounds must be List nodes.");var i,o,a=r.elementAt(0).asValue(),s=n.elementAt(n.length-1).asValue()-a;if(1===r.length)i=0<=s?1:-1;else{var l=r.elementAt(1).asValue();o=y(a,l),i=r.elementAt(1).asValue()-a}var c=Math.round(s/i)+1;if(!isFinite(c)||c<r.length||c<n.length)throw g.nonArithmeticRange();var u,p,d=[];if(o){var h=o.nstart;for(u=0;u<c;u++)f(r,n,u,c,h/o.lcm),d.push(b(m(h,o.lcm))),h+=o.nstep}else for(d.push(b(a)),u=1;u<c;u++)f(r,n,u,c,p=a+u*i),d.push(b(m(p,1)));return v(d)},p.ReducerFunction.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(0===this.args.length)throw g.zeroArgReducer(this._symbol);if(this.args[0]instanceof p.Distribution){if(this.args[0][this._symbol])return this.args[0][this._symbol]().getConcreteTree(e,t);throw g.functionTypeError(this._symbol,[d.prettyPrint(this.args[0].valueType)])}for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].getConcreteTree(e,t));if(1===this.args.length)return r=[p.List.wrap(r[0])],this.typeCheck(r),this._constantCollapsedCopy(r);switch(a(r,this.getDummyDependencies())){case"none":return r=[p.List(r)],this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return p.List(p.List.mapArgs(r,function(e){return e=[p.List(e)],this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var i=s(r);return r=[p.List(i.concreteArgs)],this.typeCheck(r),p.Broadcast(i.replacedSymbols,[this.copyWithArgs(r)].concat(i.replacedArgs))}},p.RepeatedOperator.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(e[this._index._symbol])throw g.shadowedIndex(this._index._symbol);var r=Object.create(e);return r[this._index._symbol]=_(this._index._symbol),c.prototype._getConcreteTree.call(this,r,t)},p.ScalarExpression.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].getConcreteTree(e,t));switch(a(r,this.getDummyDependencies())){case"none":return this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return p.List(p.List.mapArgs(r,function(e){return this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var i=s(r);return this.typeCheck(i.concreteArgs),p.Broadcast(i.replacedSymbols,[this.copyWithArgs(i.concreteArgs)].concat(i.replacedArgs))}},p.Regression.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._lhs,this._rhs)},p.Polygon.prototype._getConcreteTree=function(t,e){if(e&&e[this.type])return e[this.type].call(this,t,e);var r=this.args.map(function(e){return e.getConcreteTree(t)});return this.typeCheck(r),1===r.length&&r[0].valueType===d.ListOfPoint?new this.constructor(r):r.every(function(e){return e.valueType===d.Point})?new this.constructor([v(r)]):2===r.length?new this.constructor([n(this.args).getConcreteTree(t)]):g.parseError()},p.Histogram.prototype._getConcreteTree=t,p.DotPlot.prototype._getConcreteTree=t,p.BoxPlot.prototype._getConcreteTree=t,p.SolvedEquation.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._symbol,this._expression.getConcreteTree(e,t))},p.Table.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=Object.create(e),i=0;i<this.columns.length;i++){var o=this.columns[i].getConcreteTree(n,e,t);o.isIndependent&&this.columns[i].exportToLocal(o,n),r.push(o)}return new this.constructor(r)},p.TableColumn.prototype._getConcreteTree=function(e,t){var r,n,i=this.header.getConcreteTree(e);if(i.isFreeVariable){r=[];for(var o=0;o<this.values.length;o++)if(this.values[o].tableError())r.push(g.invalidTableEntry(this.values[o].tableError()));else{var a=this.values[o].tryGetConcreteTree(e);a.isError?r.push(a):a.tableError()?r.push(g.invalidTableEntry(a.tableError())):a.valueType===d.Number?r.push(a):r.push(g.tableEntryTypeError([d.prettyPrint(a.valueType)]))}return(n=new this.constructor(i,this.length,r)).isIndependent=!0,n}if(i.isConstant){for(var s=[],l=0;l<this.length;l++)s.push(i);r=s}else r=i.isList?i.args:[];return(i=this.header.getConcreteTree(t)).isError||i.valueType===d.Number||i.valueType===d.ListOfNumber||(i=g.tableHeaderTypeError([d.prettyPrint(i.valueType)])),new this.constructor(i,this.length,r)},p.BuiltInFunction.pdf.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(!(this.args[0]instanceof p.Distribution))throw g.functionTypeError(this._symbol,[d.prettyPrint(this.args[0].valueType)]);return this.args[0].pdf([this.args[1]]).getConcreteTree(e,t)},p.BuiltInFunction.cdf.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(!(this.args[0]instanceof p.Distribution))throw g.functionTypeError(this._symbol,[d.prettyPrint(this.args[0].valueType)]);var r,n;return n=this.args[2].asValue()===-1/0?(r=p.Constant(-1/0),this.args[1]):(r=this.args[1],this.args[2]),this.args[0].cdf([r,n]).getConcreteTree(e,t)}}),define("math/features/getValueType",["require","parsenodes","math/types"],function(e){function t(){return i.Number}function r(){return i.Bool}var n=e("parsenodes"),i=e("math/types"),o={Add:t,Multiply:t,Divide:t,Subtract:t,Exponent:t,Negative:t,And:r,Piecewise:function(e){return e[1].valueType},BaseComparator:r,RepeatedOperator:t,List:function(e){if(0===e.length)return i.ListOfAny;for(var t=e[0].valueType,r=1;r<e.length;r++)if(e[r].valueType!==t)return i.ListOfAny;return i.hasListType(t)?i.listType(t):i.ListOfAny},ListAccess:function(e){return i.elementType(e[0].valueType)},Broadcast:function(e){return i.listType(e[0].valueType)},OrderedPairAccess:t,OrderedPair:function(){return i.Point},NativeFunction:t,ReducerFunction:t,DoubleReducerFunction:t,ParametrizedReducerFunction:t,Distribution:function(){return i.Distribution},DummyIndex:t,FreeVariable:t,Constant:function(){switch(typeof this.asValue()){case"number":return i.Number;case"boolean":return i.Bool;default:throw new Error("Constant node expects value of type number or boolean, but saw "+typeof value)}},TypedFunction:function(){return this._outputType},Derivative:t,Integral:t,Identifier:function(){return i.Any}};for(var a in o)n[a].prototype._getValueType=o[a]}),define("math/features/typeCheck",["require","parsenodes","math/types","math/errormsg"],function(e){function i(e){for(var t=[],r=0;r<e.length;r++)t.push(o.prettyPrint(e[r].valueType));return t}function t(r,n){return function(e){for(var t=0;t<e.length;t++)if(e[t].valueType!==r[t])throw n(i(e))}}var r=e("parsenodes"),o=e("math/types"),a=e("math/errormsg"),n={Add:t([o.Number,o.Number],a.addTypeError),Multiply:t([o.Number,o.Number],a.multiplyTypeError),Divide:t([o.Number,o.Number],a.divideTypeError),Subtract:t([o.Number,o.Number],a.subtractTypeError),Exponent:t([o.Number,o.Number],a.exponentTypeError),Negative:t([o.Number],a.negativeTypeError),BaseComparator:t([o.Number,o.Number],a.comparatorTypeError),And:t([o.Bool,o.Bool],a.andTypeError),List:function(e){if(0!==e.length){var t=e[0].valueType;if(!o.hasListType(t))throw a.listTypeError([o.prettyPrint(t)]);for(var r=0;r<e.length;r++){var n=e[r].valueType;if(!o.hasListType(n))throw a.listTypeError([o.prettyPrint(n)]);if(n!==t)throw a.heterogeneousList()}}},Broadcast:function(e){},OrderedPair:t([o.Number,o.Number],a.pointTypeError),Piecewise:function(e){if(e[0].valueType!==o.Bool)throw a.piecewiseConditionTypeError(i(e));if(e[1].valueType!==o.Number)throw a.piecewiseBranchTypeError([o.prettyPrint(e[1].valueType)]);if(e[2].valueType!==o.Number)throw a.piecewiseBranchTypeError([o.prettyPrint(e[2].valueType)])},ListAccess:function(e){if(!o.isList(e[0].valueType)||e[1].valueType!==o.Number)throw a.indexTypeError(i(e))},OrderedPairAccess:t([o.Point,o.Number],a.indexTypeError),Sum:function(e){if(e[1].valueType!==o.Number)throw a.sumLowerBoundTypeError([o.prettyPrint(e[1].valueType)]);if(e[2].valueType!==o.Number)throw a.sumUpperBoundTypeError([o.prettyPrint(e[2].valueType)]);if(e[3].valueType!==o.Number)throw a.sumArgumentTypeError([o.prettyPrint(e[3].valueType)])},Product:function(e){if(e[1].valueType!==o.Number)throw a.productLowerBoundTypeError([o.prettyPrint(e[1].valueType)]);if(e[2].valueType!==o.Number)throw a.productUpperBoundTypeError([o.prettyPrint(e[2].valueType)]);if(e[3].valueType!==o.Number)throw a.productArgumentTypeError([o.prettyPrint(e[3].valueType)])},Integral:function(e){if(e[1].valueType!==o.Number)throw a.integralLowerBoundTypeError([o.prettyPrint(e[1].valueType)]);if(e[2].valueType!==o.Number)throw a.integralUpperBoundTypeError([o.prettyPrint(e[2].valueType)]);if(e[3].valueType!==o.Number)throw a.integralArgumentTypeError([o.prettyPrint(e[3].valueType)])},NativeFunction:function(e){for(var t=0;t<e.length;t++)if(e[t].valueType!==o.Number)throw a.functionTypeError(this._symbol,i(e))},ReducerFunction:function(e){if(e[0].valueType!==o.ListOfNumber)throw a.functionTypeError(this._symbol,i(e))},DoubleReducerFunction:function(e){if(!o.isList(e[0].valueType)||!o.isList(e[1].valueType))throw a.nonListDoubleReducer(this._symbol);if(e[0].valueType!==o.ListOfNumber||e[1].valueType!==o.ListOfNumber)throw a.functionTypeError(this._symbol,i(e))},ParametrizedReducerFunction:function(e){if(e[0].valueType!==o.ListOfNumber)throw a.nonListParametrizedReducer(this._symbol);if(e[1].valueType!==o.Number)throw a.functionTypeError(this._symbol,i(e))},TypedFunction:function(e){for(var t=0;t<e.length;t++)if(e[t].valueType!==this._inputTypes[t])throw a.functionTypeError(this._symbol,i(e))},Derivative:function(e){if(e[0].valueType!==o.Number&&e[0].valueType!==o.ListOfNumber)throw a.derivativeTypeError(i(e))},Regression:function(e){if(e[0].valueType!==o.Number&&e[0].valueType!==o.ListOfNumber||e[1].valueType!==o.Number&&e[1].valueType!==o.ListOfNumber)throw a.regressionTypeError(i(e))},Polygon:function(e){if(1===e.length&&e[0].valueType!==o.ListOfPoint)throw a.polygonListTypeError(i(e));if(2===e.length&&e[0].valueType===o.Number&&e[1].valueType===o.Number)throw a.polygonTwoNumbersError();if(2<e.length&&!e.every(function(e){return e.valueType===o.Point}))throw a.polygonPointArgsError()},Histogram:function(e){if(0===e.length)throw a.histogramRequiresArguments();if(3<e.length)throw a.histogramTooManyArguments();if(e[0].valueType!==o.ListOfNumber)throw a.histogramListTypeError(i(e)[0]);if(2<=e.length&&e[1].valueType!==o.Number)throw a.histogramBinWidthTypeError(i(e)[1]);if(3<=e.length&&e[2].valueType!==o.Number)throw a.histogramBinOffsetTypeError(i(e)[2])},DotPlot:function(e){if(0===e.length)throw a.dotplotRequiresArguments();if(3<e.length)throw a.dotplotTooManyArguments();if(e[0].valueType!==o.ListOfNumber)throw a.dotplotListTypeError(i(e)[0]);if(2<=e.length&&e[1].valueType!==o.Number)throw a.dotplotBinWidthTypeError(i(e)[1]);if(3<=e.length&&e[2].valueType!==o.Number)throw a.dotplotBinOffsetTypeError(i(e)[2])},BoxPlot:function(e){if(0===e.length)throw a.boxplotRequiresArguments();if(3<e.length)throw a.boxplotTooManyArguments();if(e[0].valueType!==o.ListOfNumber)throw a.boxplotListTypeError(i(e)[0]);if(2<=e.length&&e[1].valueType!==o.Number)throw a.boxplotOffsetTypeError(i(e)[1]);if(3<=e.length&&e[2].valueType!==o.Number)throw a.boxplotHeightTypeError(i(e)[2])}};for(var s in n)r[s].prototype.typeCheck=n[s]}),define("math/features/repr",["require","parsenodes"],function(e){var r=e("parsenodes"),n=function(e,t,r){r=r||0;var n=Array(r+1).join("  "),i=n+"  ";return"[\n"+i+e.map(function(e){return e.repr(t,r+1)}).join(",\n"+i)+"\n"+n+"]"},i=function(e,t){return""+(t=t||"")+e};r.Expression.prototype.repr=function(e,t){return i(this.type,e)+"("+n(this.args,e,t)+")"},r.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),n=r+"  ";return i(this.type,e)+"([\n"+n+this.args[0].repr(e,t+1)+",\n"+n+"'"+this.args[1]+"',\n"+n+this.args[2].repr(e,t+1)+",\n"+n+"'"+this.args[3]+"',\n"+n+this.args[4].repr(e,t+1)+"\n"+r+"])"},r.Identifier.prototype.repr=r.FreeVariable.prototype.repr=function(e){return i(this.type,e)+"('"+this._symbol+"')"},r.Constant.prototype.repr=function(e){return i(this.type,e)+"("+this.asValue()+")"},r.FunctionCall.prototype.repr=function(e,t){return i(this.type,e)+"('"+this._symbol+"', "+n(this.args,e,t)+")"},r.Assignment.prototype.repr=function(e,t){return i(this.type,e)+"("+r.Identifier(this._symbol).repr(e,t)+", "+this._expression.repr(e,t)+")"},r.Regression.prototype.repr=r.Equation.prototype.repr=function(e,t){return i(this.type,e)+"("+this._lhs.repr(e,t)+", "+this._rhs.repr(e,t)+")"},r.FunctionDefinition.prototype.repr=function(e,t){return i(this.type,e)+"("+r.Identifier(this._symbol).repr(e,t)+", "+n(this._argSymbols.map(function(e){return r.Identifier(e)}),e,t)+", "+this._expression.repr(e,t)+")"},r.Error.prototype.repr=function(e,t){return i(this.type,e)+"('"+this._msg+"')"},r.Derivative.prototype.repr=function(e,t){return i(this.type,e)+"('"+this._symbol+"', "+n(this.args,e,t)+")"},r.SolvedEquation.prototype.repr=function(e,t){return i(this.type,e)+"('"+this._symbol+"', "+this._expression.repr(e,t)+")"},r.OptimizedRegression.prototype.repr=function(e,t){return i(this.type,e)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(e,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode})+")"},r.Table.prototype.repr=function(e,t){return i(this.type,e)+"("+n(this.columns,e,t)+")"},r.TableColumn.prototype.repr=function(e,t){return i(this.type,e)+"("+this.header.repr(e,t)+", "+this.length+", "+n(this.values,e,t)+")"},r.Image.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return i(this.type,e)+"({\n"+n+"center: "+this.center.repr(e,t+1)+",\n"+n+"radianAngle: "+this.radianAngle.repr(e,t+1)+",\n"+n+"width: "+this.width.repr(e,t+1)+",\n"+n+"height: "+this.height.repr(e,t+1)+"},\n"+n+JSON.stringify(this.moveStrategy)+"\n"+r+")"},r.Slider.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return i(this.type,e)+"({\n"+n+"sliderAssignment: "+this.sliderAssignment.repr(e,t+1)+",\n"+n+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(e,t+1))+",\n"+n+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(e,t+1))+",\n"+n+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(e,t+1))+"},\n"+r+")"},r.Broadcast.prototype.repr=function(e,t){return i(this.type,e)+"(['"+this._replacedSymbols.join("', ")+"'], "+n(this.args,e,t)+")"}}),define("math/features/scalarEvalExpression",["require","parsenodes","math/functions"],function(e){var t=e("parsenodes"),r=e("math/functions"),n={Add:function(e){return"("+e.join("+")+")"},Multiply:function(e){return"("+e.join("*")+")"},Divide:function(e){return"("+e.join("/")+")"},Subtract:function(e){return"("+e.join("-")+")"},Exponent:function(e){return"BuiltIn.pow("+e.join(",")+")"},RawExponent:function(e){return"Math.pow("+e.join(",")+")"},Negative:function(e){return"(-"+e[0]+")"},And:function(e){return e.join("&&")},Piecewise:function(e){return"("+e[0]+"?"+e[1]+":"+e[2]+")"}},i={Add:2,Multiply:2,Divide:2,Subtract:2,Exponent:2,RawExponent:2,Negative:1,And:2,Piecewise:3};for(var o in n){var a=t[o].prototype;a.scalarEvalExpression=n[o],a.evaluate=r.createEvaluateFunction(a.scalarEvalExpression,i[o])}}),define("math/reconstitute-node",["require","parsenodes","math/types"],function(e){var a=e("parsenodes"),s=e("math/types");return function e(t,r){if(s.isList(t)){for(var n=[],i=0;i<r.length;i++)n.push(e(s.elementType(t),r[i]));var o=a.List(n);return o.valueType=t,o}switch(t){case s.Number:case s.Bool:return a.Constant(r);case s.Point:return a.OrderedPair([a.Constant(r[0]),a.Constant(r[1])]);default:throw new Error("Cannot reconstitute value of a "+s.prettyPrint(t)+".")}}}),define("math/features/constantcollapsedcopy",["require","parsenodes","math/reconstitute-node","math/maybe-rational"],function(e){var r=e("parsenodes"),s=r.Constant,l=r.Multiply,c=r.Subtract,n=r.RawExponent,i=r.BuiltInFunction,o=e("math/reconstitute-node"),a=e("math/maybe-rational"),t={Expression:function(e){return this.copyWithArgs(e)},FreeVariable:function(e){return this},ScalarExpression:function(e){for(var t=[],r=0;r<e.length;r++){if(!e[r].isConstant)return this.copyWithArgs(e);t.push(e[r].asValue())}return s(this.evaluate(t))},OrderedPair:function(e){return this.copyWithArgs(e)},Add:function(e){return e[0].isConstant&&e[1].isConstant?s(a.add(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):0===e[0].asValue()?e[1]:0===e[1].asValue()?e[0]:this.copyWithArgs(e)},Multiply:function(e){return e[0].isConstant&&e[1].isConstant?s(a.mul(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):1===e[0].asValue()?e[1]:1===e[1].asValue()?e[0]:this.copyWithArgs(e)},Subtract:function(e){return e[0].isConstant&&e[1].isConstant?s(a.sub(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):0===e[0].asValue()?r.Negative([e[1]]):0===e[1].asValue()?e[0]:this.copyWithArgs(e)},Divide:function(e){return e[0].isConstant&&e[1].isConstant?s(a.div(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):1===e[1].asValue()?e[0]:this.copyWithArgs(e)},Exponent:function(e){if(e[0].isConstant&&e[1].isConstant)return s(a.pow(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue()));if(e[0].isConstant){if(e[0].asValue()===Math.E)return i.exp([e[1]]);if(0<e[0].asValue())return n(e)}if(e[1].isConstant){var t=e[1].asValue();if(1===t)return e[0];if(t===Math.floor(t))return n(e);var r=e[1].asMaybeRationalValue();return a.isRational(r)?r.d%2==1?l([r.n%2==0?s(a.maybeRational(1,1)):i.sign([e[0]]),n([i.abs([e[0]]),e[1]])]):n(e):this.copyWithArgs(e)}return this.copyWithArgs(e)},RawExponent:function(e){return e[0].isConstant&&e[1].isConstant?s(a.pow(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},Negative:function(e){return e[0].isConstant?s(a.neg(e[0].asMaybeRationalValue())):e[0]instanceof r.Negative?e[0].args[0]:this.copyWithArgs(e)},And:function(e){return e[0].isConstant&&e[1].isConstant?s(e[0].asValue()&&e[1].asValue()):e[0].isConstant&&!0===e[0]?e[1]:e[0].isConstant&&!1===e[0]?s(!1):e[1].isConstant&&!0===e[1]?e[0]:e[1].isConstant&&!1===e[1]?s(!1):this.copyWithArgs(e)},Piecewise:function(e){return e[0].isConstant&&!0===e[0].asValue()?e[1]:e[0].isConstant&&!1===e[0].asValue()?e[2]:this.copyWithArgs(e)},Integral:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=i.getDependencies();if(r.isConstant&&n.isConstant){var a=n.asValue()-r.asValue();if(i.isConstant)return s(i.asValue()*a);if(!i.dependsOn(t._symbol))return l([i,s(a)]);if(1===o.length&&o[0]===t._symbol)return s(this.evaluate(r.asValue(),n.asValue(),i))}else if(!i.dependsOn(t._symbol))return l([i,c([n,r])]);return this.copyWithArgs(e)},ListAccess:function(e){return e[1].isConstant?e[0].elementAt(e[1].asValue()-1):this.copyWithArgs(e)},OrderedPairAccess:function(e){return e[1].isConstant&&e[0]instanceof r.OrderedPair?e[0].elementAt(e[1].asValue()-1):this.copyWithArgs(e)},Broadcast:function(e){var t=e[0].getDependencies();for(r=0;r<t.length;r++)if(-1===this._replacedSymbols.indexOf(t[r]))return this.copyWithArgs(e);for(var r=1;r<e.length;r++)if(0!==e[r].getDependencies().length)return this.copyWithArgs(e);return o(this.valueType,this.evaluate(e.slice(1).map(function(e){return e.asValue()})))},ReducerFunction:function(e){return 0===e[0].getDependencies().length?o(this.valueType,this.evaluate([e[0].asValue()])):this.copyWithArgs(e)},DoubleReducerFunction:function(e){if(0!==e[0].getDependencies().length||0!==e[1].getDependencies().length)return this.copyWithArgs(e);var t=Math.min(e[0].length,e[1].length);return o(this.valueType,this.evaluate([e[0].asValue().slice(0,t),e[1].asValue().slice(0,t)]))},ParametrizedReducerFunction:function(e){var t=e[0],r=e[1];return r.isConstant&&0===t.getDependencies().length?o(this.valueType,this.evaluate([t.asValue(),r.asValue()])):this.copyWithArgs(e)},RepeatedOperator:function(e){if(e[1].isConstant&&e[2].isConstant){var t=e[1].asValue(),r=e[2].asValue(),n=e[3];if(n.isConstant)return s(this.evaluateConstant([t,r,n.asValue()]));var i=n.getDependencies();if(0===i.length||1===i.length&&i[0]===e[0]._symbol)return s(this.evaluate(t,r,n))}return this.copyWithArgs(e)}};for(var u in t)r[u].prototype._constantCollapsedCopy=t[u];i.mod.prototype._constantCollapsedCopy=function(e){return e[0].isConstant&&e[1].isConstant?s(a.mod(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},i.sqrt.prototype._constantCollapsedCopy=function(e){return e[0].isConstant?s(a.sqrt(e[0].asMaybeRationalValue())):this.copyWithArgs(e)},i.nthroot.prototype._constantCollapsedCopy=function(e){return e[0].isConstant&&e[1].isConstant?s(a.nthroot(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},i.abs.prototype._constantCollapsedCopy=function(e){return e[0].isConstant?s(a.abs(e[0].asMaybeRationalValue())):this.copyWithArgs(e)},i.total.prototype._constantCollapsedCopy=function(e){if(!e[0].isList)return this.copyWithArgs(e);for(var t=e[0].args,r=0;r<t.length;r++)if(!t[r].isConstant)return this.copyWithArgs(e);return s(a.total(e[0].asMaybeRationalValue()))},i.distance.prototype._constantCollapsedCopy=function(e){return 0===e[0].getDependencies().length&&0===e[1].getDependencies().length?s(this.evaluate([e[0].asArray(),e[1].asArray()])):this.copyWithArgs(e)},i.midpoint.prototype._constantCollapsedCopy=function(e){if(0!==e[0].getDependencies().length||0!==e[1].getDependencies().length)return this.copyWithArgs(e);var t=this.evaluate([e[0].asArray(),e[1].asArray()]);return r.OrderedPair([s(t[0]),s(t[1])])}}),define("math/features/polynomialorder",["require","parsenodes"],function(e){var t,r=e("parsenodes"),n={Expression:"this.dependsOn(symbol) ? Infinity : 0",FreeVariable:"(symbol === this._symbol ? 1 : 0)",Constant:"0",Add:"Math.max(order0, order1)",Subtract:"Math.max(order0, order1)",Multiply:"order0 + order1",Negative:"order0",Divide:"order1 > 0 ? Infinity : order0"};for(var i in n){var o=n[i];r[i].prototype.polynomialOrder=(t=(t=(t=o).replace("order0","this.args[0].polynomialOrder(symbol)")).replace("order1","this.args[1].polynomialOrder(symbol)"),new Function(["symbol"],"return "+t))}r.Exponent.prototype.polynomialOrder=function(e){var t=this.args[0].polynomialOrder(e),r=this.args[1].polynomialOrder(e);if(0===t&&0===r)return 0;var n=this.args[1];return n.isConstant&&n.asValue()===Math.round(n.asValue())&&0<n.asValue()?t*n.asValue():1/0},r.Piecewise.prototype.polynomialOrder=function(e){return this.dependsOn(e)?this.args[2].isConstant&&this.args[2].isNaN()?this.args[1].polynomialOrder(e):1/0:0},r.List.prototype.polynomialOrder=function(e){return 1/0}}),define("math/features/polynomialcoefficients",["require","parsenodes","math/maybe-rational"],function(e){var u=e("parsenodes"),t=e("math/maybe-rational").maybeRational,i=u.Constant(t(0,1)),r=u.Constant(t(1,1));u.FreeVariable.prototype.getPolynomialCoefficients=function(e){return e===this._symbol?[i,r]:[this]},u.Constant.prototype.getPolynomialCoefficients=function(e){return[this]},u.Add.prototype.getPolynomialCoefficients=function(e){for(var t=this.args[0].getPolynomialCoefficients(e),r=this.args[1].getPolynomialCoefficients(e),n=t.length-1,i=r.length-1,o=[],a=0;a<=Math.max(n,i);a++)a<=n&&a<=i?o.push(u.Add([t[a],r[a]])):o.push(i<n?t[a]:r[a]);return o},u.Subtract.prototype.getPolynomialCoefficients=function(e){for(var t=this.args[0].getPolynomialCoefficients(e),r=this.args[1].getPolynomialCoefficients(e),n=t.length-1,i=r.length-1,o=[],a=0;a<=Math.max(n,i);a++)a<=n&&a<=i?o.push(u.Subtract([t[a],r[a]])):o.push(i<n?t[a]:u.Negative([r[a]]));return o},u.Negative.prototype.getPolynomialCoefficients=function(e){for(var t=this.args[0].getPolynomialCoefficients(e),r=[],n=0;n<t.length;n++)r.push(u.Negative([t[n]]));return r},u.Exponent.prototype.getPolynomialCoefficients=function(e){var t=this.args[0].getPolynomialCoefficients(e),r=this.args[1].getPolynomialCoefficients(e),n=t.length-1;if(0<r.length-1)throw"can't solve for variable in exponent";if(0===n)return[u.Exponent([t[0],r[0]])];if(this.args[1].isConstant)switch(this.args[1].asValue()){case 0:return[i];case 1:return t;case 2:return u.Multiply([this.args[0],this.args[0]]).getPolynomialCoefficients(e)}throw"Unable to compile polynomial representation"},u.Multiply.prototype.getPolynomialCoefficients=function(e){for(var t=this.args[0].getPolynomialCoefficients(e),r=this.args[1].getPolynomialCoefficients(e),n=t.length-1,i=r.length-1,o=[],a=0;a<=n;a++)for(var s=0;s<=i;s++){var l=u.Multiply([t[a],r[s]]),c=o[a+s];o[a+s]=void 0===c?l:u.Add([c,l])}return o},u.Divide.prototype.getPolynomialCoefficients=function(e){var t=this.args[0].getPolynomialCoefficients(e),r=this.args[1].getPolynomialCoefficients(e),n=[];if(0<r.length-1)throw"Can't solve for variable in denominator";for(var i=0;i<t.length;i++)n.push(u.Divide([t[i],r[0]]));return n},u.Expression.prototype.getPolynomialCoefficients=function(e){if(this.dependsOn(e))throw"Unimplemented polynomialCoefficient call";return[this]},u.Piecewise.prototype.getPolynomialCoefficients=function(e){return this.dependsOn(e)?this.args[1].getPolynomialCoefficients(e):[this]}}),define("math/features/extractconditions",["require","parsenodes"],function(e){var n=e("parsenodes");n.Expression.prototype.extractConditions=function(e,t){if(!this.dependsOn(e))return t;for(var r=0;r<this.args.length;r++){t=this.args[r].extractConditions(e,t)}return t},n.Piecewise.prototype.extractConditions=function(e,t){if(!this.dependsOn(e))return t;if(!this.args[0].dependsOn(e))return t=this.args[1].extractConditions(e,t),this.args[2].extractConditions(e,t);var r={};return r[e]=t,n.Piecewise([this.args[0].substitute(r),t,n.Constant(NaN)])}}),define("math/features/piecewiseDependsOn",["require","parsenodes"],function(e){var t=e("parsenodes");t.Expression.prototype.piecewiseDependsOn=function(e){if(!this.dependsOn(e))return!1;for(var t=0;t<this.args.length;t++){if(this.args[t].piecewiseDependsOn(e))return!0}return!1},t.Piecewise.prototype.piecewiseDependsOn=function(e){return this.dependsOn(e)}}),define("math/builtinconstants",["require","math/parsenode/constant","math/maybe-rational"],function(e){var t=e("math/parsenode/constant"),r=e("math/maybe-rational").maybeRational;return{pi:t(Math.PI),tau:t(2*Math.PI),e:t(Math.E),trigAngleMultiplier:t(r(1,1))}}),define("math/builtinframe",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){var t,r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i={};for(t in r)r.hasOwnProperty(t)&&(i[t]=r[t]);for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}),define("math/domaintypes",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.emptyDomain=function(){return{type:"empty"}},n.unknownDomain=function(){return{type:"unknown"}},n.knownDomain=function(e){return isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?n.emptyDomain():{type:"known",bounds:e}},n.allReals=function(){return n.knownDomain([-1/0,1/0])},n.intersectDomains=function(e,t){if("empty"===e.type||"empty"===t.type)return n.emptyDomain();if("unknown"===e.type||"unknown"===t.type)return n.unknownDomain();if(e.bounds&&t.bounds){var r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])];return n.knownDomain(r)}return n.emptyDomain()}}),define("math/features/bounddomain",["require","parsenodes","math/builtinframe","math/domaintypes","math/comparators","math/maybe-rational"],function(e){var t=e("parsenodes"),l=e("math/builtinframe"),c=e("math/domaintypes"),u=e("math/comparators").table,r=e("math/maybe-rational").maybeRational,p=t.Constant(r(0,1));t.Base.prototype.boundDomain=function(e){return c.unknownDomain()},t.List.prototype.boundDomain=function(e){return c.unknownDomain()},t.Expression.prototype.boundDomain=function(e){for(var t=c.allReals(),r=0;r<this.args.length;r++)t=c.intersectDomains(t,this.args[r].boundDomain(e));return t},t.Constant.prototype.boundDomain=function(e){return this.isNaN()?c.emptyDomain():c.allReals()},t.Piecewise.prototype.boundDomain=function(e){return this.args[2].isConstant&&isNaN(this.args[2].asValue())?c.intersectDomains(this.args[0].boundDomain(e),this.args[1].boundDomain(e)):c.unknownDomain()},t.OrderedPair.prototype.boundDomain=function(e){return c.intersectDomains(this.args[0].boundDomain(e),this.args[1].boundDomain(e))},t.BaseComparator.prototype.boundDomain=function(e){if("="===this.operator)return c.unknownDomain();var t=this._difference,r=this._difference.boundDomain(e);if(1<t.polynomialOrder(e))return c.unknownDomain();var n=t.getPolynomialCoefficients(e),i=n[1]?n[1].getConcreteTree(l):p,o=n[0]?n[0].getConcreteTree(l):p;if(!i.isConstant||!o.isConstant)return c.unknownDomain();if(isNaN(i.asValue())||isNaN(o.asValue()))return c.emptyDomain();if(0===i.asValue())return u[this.operator].inclusive?0<=o.asValue()?r:c.emptyDomain():0<o.asValue()?r:c.emptyDomain();var a=-o.asValue()/i.asValue(),s=i.asValue()<0?[-1/0,a]:[a,1/0];return c.intersectDomains(r,c.knownDomain(s))}}),define("math/features/derivative",["require","parsenodes","math/baseparser","math/builtinframe","math/parsenode/builtinfunction","math/maybe-rational"],function(e){var p=e("parsenodes"),t=e("math/baseparser"),d=e("math/builtinframe"),h=e("math/parsenode/builtinfunction"),r=e("math/maybe-rational").maybeRational,i=p.Constant(r(0,1)),f=p.Constant(r(1,1)),g=p.Constant(r(2,1)),n={FreeVariable:function(e){return e===this._symbol?f:i},Constant:function(e){return isFinite(this.asValue())?i:p.Constant(this.asValue())},Negative:function(e){return p.Negative([this.args[0].takeDerivative(e)])},Add:function(e){return p.Add([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},Subtract:function(e){return p.Subtract([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},Multiply:function(e){return p.Add([b(e,this.args[0],p.Multiply([this.args[0].takeDerivative(e),this.args[1]])),b(e,this.args[1],p.Multiply([this.args[0],this.args[1].takeDerivative(e)]))])},Divide:function(e){return p.Subtract([b(e,this.args[0],p.Divide([this.args[0].takeDerivative(e),this.args[1]])),b(e,this.args[1],p.Divide([p.Multiply([this.args[0],this.args[1].takeDerivative(e)]),p.Exponent([this.args[1],g])]))])},Exponent:function(e){return p.Add([b(e,this.args[0],p.Multiply([p.Multiply([this.args[1],p.Exponent([this.args[0],p.Subtract([this.args[1],f])])]),this.args[0].takeDerivative(e)])),b(e,this.args[1],p.Multiply([p.Piecewise([p.Comparator["="]([this.args[0],i]),p.Piecewise([p.Comparator[">"]([this.args[1],i]),i,p.Constant(NaN)]),p.Multiply([p.FunctionCall("\\ln",[this.args[0]]),p.Exponent([this.args[0],this.args[1]])])]),this.args[1].takeDerivative(e)]))]).getConcreteTree(d)},Sum:function(e){return this.copyWithArgs([this.args[0],this.args[1],this.args[2],this.args[3].takeDerivative(e)])},Product:function(e){var t=p.Sum([this.args[0],this.args[1],this.args[2],p.Piecewise([p.Comparator["="]([i,this.args[3]]),f,i])]),r=p.Multiply([p.Sum([this.args[0],this.args[1],this.args[2],p.Divide([this.args[3].takeDerivative(e),this.args[3]])]),p.Product(this.args)]),n=p.Product([this.args[0],this.args[1],this.args[2],p.Piecewise([p.Comparator["="]([i,this.args[3]]),this.args[3].takeDerivative(e),this.args[3]])]);return p.Piecewise([p.Comparator["="]([i,t]),r,p.Piecewise([p.Comparator["="]([f,t]),n,i])])},Piecewise:function(e){return 2===this.args.length?p.Piecewise([this.args[0],this.args[1].takeDerivative(e)]):3===this.args.length?p.Piecewise([this.args[0],this.args[1].takeDerivative(e),this.args[2].takeDerivative(e)]):void 0},List:function(t){return p.List(this.args.map(function(e){return e.takeDerivative(t)}))},ListAccess:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1]])},OrderedPair:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},OrderedPairAccess:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1]])},Integral:function(e){var t=this.args[0],r=this.args[1],n=this.args[2],i=this.args[3],o={};o[t._symbol]=n;var a={};return a[t._symbol]=r,p.Add([b(e,i,this.copyWithArgs([t,r,n,i.takeDerivative(e)])),p.Subtract([b(e,n,p.Multiply([i.substitute(o),n.takeDerivative(e)])),b(e,r,p.Multiply([i.substitute(a),r.takeDerivative(e)]))])])},SolvedEquation:function(e){return this._expression.takeDerivative(e)},OptimizedRegression:function(e){return this.model.takeDerivative(e)},Broadcast:function(e){for(var t=this._replacedSymbols.slice(),r=this.args.slice(1),n=this._expression.takeDerivative(e),i=0;i<this._replacedSymbols.length;i++){var o=this._replacedSymbols[i],a=this.args[i+1];if(a.dependsOn(e)){var s=this.tmpVar(),l=p.DummyIndex(s);t.push(s),r.push(a.takeDerivative(e)),n=p.Add([n,p.Multiply([this._expression.takeDerivative(o),l])])}}return p.Broadcast(t,[n].concat(r))}},o={exp:"\\exp(x)*x_1",ln:"\\{x >= 0: x_1/x \\}",log:"\\{ x >= 0: x_1/(x*\\ln(10)) \\}",sqrt:"x_1/(2*\\sqrt{x})",rtxsqpone:"x*x_1/\\rtxsqpone(x)",rtxsqmone:"x*x_1/\\rtxsqmone(x)",sin:"\\cos(x)*x_1",cos:"-\\sin(x)*x_1",tan:"\\sec(x)^2*x_1",arcsin:"x_1/\\sqrt{1 - x^2}",arccos:"-x_1/\\sqrt{1 - x^2}",sinh:"\\cosh(x)*x_1",cosh:"\\sinh(x)*x_1",tanh:"(\\sech(x))^2*x_1",arcsinh:"x_1/\\sqrt{x^2 + 1}",arccosh:"\\{ x > 0: x_1/\\rtxsqmone(x) \\}",arctanh:"\\{ \\abs(x) < 1: x_1/(1 - x^2) \\}",csc:"-\\cot(x)*\\csc(x)*x_1",sec:"\\tan(x)*\\sec(x)*x_1",cot:"-\\csc(x)^2*x_1",arccsc:"-x_1/(\\abs(x)*\\rtxsqmone(x))",arcsec:"x_1/(\\abs(x)*\\rtxsqmone(x))",arccot:"-x_1/(1+x^2)",csch:"-\\coth(x)*\\csch(x)*x_1",sech:"-\\tanh(x)*\\sech(x)*x_1",coth:"-(\\csch(x))^2*x_1",arccsch:"-x_1/(\\abs(x)*\\rtxsqpone(x))",arcsech:"\\{ x >= 0: -x_1/(x*\\sqrt{1 - x^2}) \\}",arccoth:"\\{ \\abs(x) > 1 : x_1/(1 - x^2) \\}",factorial:"(x)!*\\polyGamma(0, x + 1)*x_1",floor:"\\{ \\mod(x, 1) > 0: 0*x_1 \\}",ceil:"\\{ \\mod(x, 1) > 0: 0*x_1 \\}",abs:"\\{ \\abs(x) > 0: \\sign(x)*x_1 \\}",sign:"\\{ \\abs(x) > 0: 0*x_1 \\}",mean:"\\mean(x_1)",total:"\\total(x_1)",length:"0",var:"2*\\cov(x, x_1)",varp:"2*\\cov(x, x_1)*(\\length(x)-1)/\\length(x)",stdev:"\\cov(x, x_1)/\\stdev(x)",stdevp:"\\covp(x, x_1)/\\stdevp(x)",mad:"\\mean(\\sign(x-\\mean(x))*(x_1 - \\mean(x_1)))",min:"x_1[\\argmin(x)]",max:"x_1[\\argmax(x)]",median:"0.5*(x_1[\\lowerQuantileIndex(x, 0.5)] + x_1[\\upperQuantileIndex(x, 0.5)])",argmin:"0/0",argmax:"0/0",gcd:"0/0",lcm:"0/0",erf:"\\frac{2}{\\sqrt{\\pi }}e^{-x^2}",invNorm:"\\frac{1}{\\pdf(\\normdist,\\invNorm(x))}"},a={logbase:["\\{x > 0: \\frac{x_1}{x*\\ln(y)}\\}","\\frac{-\\log_{y}(x)*y_1}{y*\\ln(y)}"],nthroot:["x^{1/y - 1}/y*x_1","-\\frac{x^{1/y}*\\ln(x)*y_1}{y^2}"],polyGamma:["0/0","\\polyGamma(1 + x, y)*y_1"],mod:["\\{ \\abs(\\mod(x, y)) > 0: x_1 \\}","\\{ \\mod(x/y, 1) > 0: -\\floor(x/y)*y_1 \\}"],round:["\\{ \\abs(\\mod(x, 1) - 0.5) > 0: 0*x_1 \\}","0/0"],cov:["\\cov(x_1, y)","\\cov(x, y_1)"],covp:["\\covp(x_1, y)","\\covp(x, y_1)"],corr:["(\\cov(x_1, y) - (\\cov(x, y)*\\cov(x, x_1)/\\var(x)))/(\\stdevp(x)\\stdevp(y))","(\\cov(x, y_1) - (\\cov(x, y)*\\cov(y, y_1)/\\var(y)))/(\\stdevp(x)\\stdevp(y))"],quantile:["\\{ \\floor(y*(\\length(x)-1)) = y*(\\length(x)-1) :   x_1[\\upperQuantileIndex(x, y)],  (\\ceil(y*(\\length(x)-1)) - y*(\\length(x)-1))*x_1[\\lowerQuantileIndex(x, y)] +   (y*(\\length(x)-1) - \\floor(y*(\\length(x)-1)))*x_1[\\upperQuantileIndex(x, y)]\\}","\\{ \\floor(y*(\\length(x)-1)) < y*(\\length(x)-1) :   (x[\\upperQuantileIndex(x, y)] - x[\\lowerQuantileIndex(x, y)])*y_1\\}"],quartile:["0.5*(x_1[\\lowerQuartileIndex(x, y)] + x_1[\\upperQuartileIndex(x, y)])","0/0"],TScore:["\\frac{\\sqrt{\\length(x)}(\\stdev(x)*\\mean(x_1)-(\\mean(x)-y)*\\frac{\\cov(x,x_1)}{\\stdev(x)})}{\\stdev(x)^2}","-y_1*\\sqrt{\\length(x)}/\\stdev(x)"],TTest:["\\{y<0:1,y>0:-1,-2*\\sign(\\mean(x))\\}*\\pdf(\\tdist(\\length(x)-1),\\TScore(x, 0))\\frac{\\sqrt{\\length(x)}(\\stdev(x)*\\mean(x_1)-\\mean(x)*\\frac{\\cov(x,x_1)}{\\stdev(x)})}{\\stdev(x)^2}","0/0"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["0/0","0/0"],nPr:["0/0","0/0"],arctan:["x_1*y/(y^2+x^2)","-y_1*x/(y^2+x^2)"],poissonpdf:["0/0","y_1\\frac{e^{-y}(\\floor(x)-y)y^{(\\floor(x)-1)}}{\\floor(x)!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*\\pdf(\\tdist(y),x)*\\frac{-(y+1)*x}{y+x^2}","y_1*\\frac{1}{2}\\pdf(\\tdist(y),x)(  \\frac{x^2-1}{y + x^2} + \\ln(\\frac{y}{y + x^2}) +   \\polyGamma(0, \\frac{1+y}{2}) - \\polyGamma(0, y/2))"],invT:["x_1/\\pdf(\\tdist(y),\\invT(x, y))","0/0"]},s={tcdf:["-x_1*\\pdf(\\tdist(z),x)","y_1*\\pdf(\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","z_1\\sum _{n=\\max(0,\\floor(\\min(x,y)))}^{\\floor(\\max(x,y))}\\frac{e^{-z}(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\frac{x-y}{z^2} \\pdf(\\normdist(y,z),x)","y_1*\\frac{x-y}{z^2} \\pdf(\\normdist(y,z),x)","z_1*(\\frac{(x-y-z)*(x-y+z)}{z^3}) \\pdf(\\normdist(y,z),x)"],binompdf:["0/0","0/0","z_1*\\pdf(\\binomdist(y,z),x)*(\\frac{\\round(x)}{z}-\\frac{\\round(y)-\\round(x)}{1-z})"],invBinom:["0/0","0/0","0/0"],ZScore:["x_1*\\frac{1}{z}","0/0","0/0"]},l={normalcdf:["-x_1\\pdf(\\normdist(z,u), x)","y_1\\pdf(\\normdist(z,u), y)","-z_1*(\\pdf(\\normdist(z,u), y) - \\pdf(\\normdist(z,u), x))","u_1*(  \\{\\abs(y)=1/0:0,\\frac{z-y}{u}\\pdf(\\normdist(z,u),y)\\} -   \\{\\abs(x)=1/0:0,\\frac{z-x}{u}\\pdf(\\normdist(z,u),x)\\})"],binomcdf:["0/0","0/0","0/0","u_1*\\sum _{n=\\max(0,\\round(\\min(x,y)))}^{\\round(\\max(x,y))}(  \\pdf(\\binomdist(z,u),n)*(\\frac{n}{u}-\\frac{\\round(z)-n}{1-u}))"]},c=function(n){return function(e){var t=this.args,r={x:t[0],x_1:t[0].takeDerivative(e)};return b(e,t[0],n.substitute(r)).getConcreteTree(d)}},u=function(n,i){return function(e){var t=this.args,r={x:t[0],x_1:t[0].takeDerivative(e),y:t[1],y_1:t[1].takeDerivative(e)};return p.Add([b(e,t[0],n.substitute(r)),b(e,t[1],i.substitute(r))]).getConcreteTree(d)}},m=function(n,i,o){return function(e){var t=this.args,r={x:t[0],x_1:t[0].takeDerivative(e),y:t[1],y_1:t[1].takeDerivative(e),z:t[2],z_1:t[2].takeDerivative(e)};return p.Add([p.Add([b(e,t[0],n.substitute(r)),b(e,t[1],i.substitute(r))]),b(e,t[2],o.substitute(r))]).getConcreteTree(d)}},y=function(n,i,o,a){return function(e){var t=this.args,r={x:t[0],x_1:t[0].takeDerivative(e),y:t[1],y_1:t[1].takeDerivative(e),z:t[2],z_1:t[2].takeDerivative(e),u:t[3],u_1:t[3].takeDerivative(e)};return p.Add([p.Add([b(e,t[0],n.substitute(r)),b(e,t[1],i.substitute(r))]),p.Add([b(e,t[2],o.substitute(r)),b(e,t[3],a.substitute(r))])]).getConcreteTree(d)}};for(var v in o)h[v].prototype.takeDerivative=c(t.parse(o[v]));for(v in a)h[v].prototype.takeDerivative=u(t.parse(a[v][0]),t.parse(a[v][1]));for(v in s)h[v].prototype.takeDerivative=m(t.parse(s[v][0]),t.parse(s[v][1]),t.parse(s[v][2]));for(v in l)h[v].prototype.takeDerivative=y(t.parse(l[v][0]),t.parse(l[v][1]),t.parse(l[v][2]),t.parse(l[v][3]));h.distance.prototype.takeDerivative=function(e){var t=this.args[0],r=this.args[1],n=p.OrderedPairAccess([t,f]),i=p.OrderedPairAccess([t,g]),o=p.OrderedPairAccess([r,f]),a=p.OrderedPairAccess([r,g]),s=b(e,n,n.takeDerivative(e)),l=b(e,i,i.takeDerivative(e)),c=b(e,o,o.takeDerivative(e)),u=b(e,a,a.takeDerivative(e));return b(e,this,p.Divide([p.Add([p.Add([p.Subtract([p.Multiply([s,n]),p.Multiply([s,o])]),p.Subtract([p.Multiply([c,o]),p.Multiply([c,n])])]),p.Add([p.Subtract([p.Multiply([l,i]),p.Multiply([l,a])]),p.Subtract([p.Multiply([u,a]),p.Multiply([u,i])])])]),h.distance([this.args[0],this.args[1]])])).getConcreteTree(d)},h.midpoint.prototype.takeDerivative=function(e){var t=this.args[0],r=this.args[1],n=p.OrderedPairAccess([t,f]),i=p.OrderedPairAccess([t,g]),o=p.OrderedPairAccess([r,f]),a=p.OrderedPairAccess([r,g]),s=b(e,n,n.takeDerivative(e)),l=b(e,i,i.takeDerivative(e)),c=b(e,o,o.takeDerivative(e)),u=b(e,a,a.takeDerivative(e));return p.OrderedPair([h.mean([s,c]),h.mean([l,u])]).getConcreteTree(d)};var b=function(e,t,r){return t.dependsOn(e)?r:i};for(var x in n){var w=n[x];p[x].prototype.takeDerivative=w}}),define("math/features/substitute",["require","parsenodes"],function(e){var r=e("parsenodes"),t={Identifier:function(e){return e[this._symbol]?e[this._symbol]:this},FreeVariable:function(e){return e[this._symbol]?e[this._symbol]:this},Constant:function(e){return this},Expression:function(t){return this.copyWithArgs(this.args.map(function(e){return e.substitute(t)}))},List:function(t){return r.List(this.args.map(function(e){return e.substitute(t)}))},SolvedEquation:function(e){return new this.constructor(this._symbol,this._expression.substitute(e))},OptimizedRegression:function(e){return new this.constructor(this.model.substitute(e),this.parameters,this.residualVariables,this.residuals,this.statistics)}};for(var n in t)r[n].prototype.substitute=t[n]}),define("worker/workerconfig",[],function(){return{pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0}}),define("math/features/solve",["require","math/baseparser","parsenodes","math/errormsg","math/builtinframe","worker/workerconfig","math/maybe-rational"],function(e){function t(e){e.f=l.getConcreteTree(e),e.g=c.getConcreteTree(e),e.p=u.getConcreteTree(e),e.q=p.getConcreteTree(e),e.m=v(s(1e305,1))}var r=e("math/baseparser"),n=e("parsenodes"),i=n.Base,v=n.Constant,o=n.Equation,b=n.SolvedEquation,a=n.BaseComparator,x=n.List,w=e("math/errormsg"),_=e("math/builtinframe"),S=e("worker/workerconfig"),s=e("math/maybe-rational").maybeRational,E=v(s(0,1)),l=r.parse("b*b"),c=r.parse("4*a*c"),u=r.parse("(-b+\\sqrt{b*b-4*a*c})/(2*a)"),p=r.parse("(-b-\\sqrt{b*b-4*a*c})/(2*a)"),d=r.parse("[\\{\\abs(b)>0:-c/b\\}]"),h=r.parse("[\\{\\abs(a)>0:-b/(2*a)\\}]"),f=r.parse("[\\{a=0:\\{b<0:-c/b\\},q\\},\\{a=0:\\{b>0:-c/b\\},p\\}]"),g=r.parse("[\\{a=0:\\{b<0:-c/b\\},a>0:q\\},\\{a=0:\\{b=0:\\{c>0:-m\\}\\},a>0:\\{f<g:-m\\},p\\},\\{a=0:\\{b=0:\\{c>0:m\\}\\},a>0:\\{f<g:m\\},q\\},\\{a=0:\\{b>0:-c/b\\},a>0:p\\}]"),M={inequality:function(e){return t(e),g.getConcreteTree(e)},generalEquation:function(e){return t(e),e.a.isConstant&&0===e.a.asValue()?d.getConcreteTree(e):e.f.isConstant&&e.g.isConstant&&e.f.asValue()-e.g.asValue()==0?h.getConcreteTree(e):f.getConcreteTree(e)}};i.prototype.trySolve=function(e,t){try{return this.solve(e,t)}catch(e){if(e instanceof n.Error)return e;throw e}},o.prototype.solve=function(e,t){return this.asComparator().solve(e,t)},a.prototype.solve=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return r;if(r.isConstant)return r;var n="="!==this.getOperator(),i=this._difference.tryGetConcreteTree(t);i.isBroadcast&&(i=x(i.mapElements(function(e){return e})));var o=i.getDependencies();if(0===o.length)return i.isList?x(i.args.map(function(e){return v(0===e.asValue())})):v(0===i.asValue());if(1===o.length&&i.isList&&!n)return i;if(1===o.length&&!n&&!S.plotSingleVariableImplicitEquations)return w.singleVariableImplicitEquationsDisabled();var a=x.wrap(i);if(2<o.length)return w.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(o);if(n&&!e.validInequalityVariables(o))return w.invalidInequalityVariables().setDependencies(o);var s=function(e,t,r,n){for(var i,o,a=[],s=[],l=0;l<r.length;l++){var c=r[l],u=0;x.eachArgs([t],function(e){var t=e[0];u=Math.max(u,t.polynomialOrder(c))});var p=2<u,d=1<r.length&&!e.validSolvedVariable(c),h=n&&t.piecewiseDependsOn(c);p||d||h?(s[l]={},a[l]=1/0):(s[l]=[],a[l]=0,x.eachArgs([t],function(e){var t,r,n,i=e[0];r=i.getPolynomialCoefficients(c),(n=Object.create(_)).a=r[2]?r[2].tryGetConcreteTree(_):E,n.b=r[1]?r[1].tryGetConcreteTree(_):E,n.c=r[0]?r[0].tryGetConcreteTree(_):E,o=n,s[l].push(o),a[l]=Math.max(a[l],0===(t=o).a.asValue()?0===t.b.asValue()?0:1:2)}))}var f,g;return f=1===r.length?(o=s[0],i=r[0],a[0]):(g=0===a[0]?1:0===a[1]?0:a[0]<a[1]?0:1,o=s[g],i=r[g],a[g]),{localFrame:o,variableOfInterest:i,effectiveOrder:f}}(e,a,o,n),l=s.localFrame,c=s.effectiveOrder,u=s.variableOfInterest;if(e.complicatedPolarImplicit(u,c))return w.complicatedPolarImplicit().setDependencies(o);if(!e.validImplicitVariables(o))return w.invalidImplicitVariables();if(2<c)return i;for(var p=n?M.inequality:M.generalEquation,d=[],h=0;h<l.length;h++){var f=p(l[h]);if(f.isError)return f;if(f.isConstant)d.push(f);else for(var g=0;g<f.args.length;g++){var m=f.args[g],y=a.args[h].extractConditions(u,m).getConcreteTree(t);d.push(y)}}return b(u,x(d))}}),define("graphing/graphmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X=1,t.Y=2,t.XYPOINT=3,t.XYPOINT_MOVABLE=4,t.PARAMETRIC=5,t.POLAR=6,t.POLYGONFILL=7,t.IMPLICIT=8,t.NONE=10,t.VISUALIZATION=11}),define("math/evaluationstate",["require","graphing/graphmode","parsenodes","graphing/label"],function(e){function h(e){return e.isError?e.getError():void 0===e.asValue()?"":+e.asValue()}var f=e("graphing/graphmode"),g=e("parsenodes"),m=e("graphing/label"),t=function(){return{operator:"=",variables:[]}},r=function(e,t,r){if(t.isTable)return function(e,t,r){for(var n=[],i=0;i<t.columns.length;i++){var o=r.columns[i],a={dependent:!o.isIndependent,discrete:o.isIndependent};o.isError?(a.error=o.getError(),a.values=[]):a.values=o.values.map(h),n.push(a)}return{column_data:n}}(0,t,r);if(t.isImage)return n=e,i=t,a={variables:[],errorMap:{},dimensions:{}},(o=r).center.isError&&(a.errorMap.center=!0),o.radianAngle.isError&&(a.errorMap.angle=!0),o.width.isError&&(a.errorMap.width=!0),o.height.isError&&(a.errorMap.height=!0),o.center.isError||o.radianAngle.isError||o.width.isError||o.height.isError?a.variables=i.getSliderVariables(n,o):(a.dimensions.x=[],a.dimensions.y=[],a.dimensions.radianAngle=[],a.dimensions.width=[],a.dimensions.height=[],g.List.eachArgs([o.center,o.radianAngle,o.width,o.height],function(e){a.dimensions.x.push(+e[0].args[0].asValue()),a.dimensions.y.push(+e[0].args[1].asValue()),a.dimensions.radianAngle.push(+e[1].asValue()),a.dimensions.width.push(+e[2].asValue()),a.dimensions.height.push(+e[3].asValue())}),(n.graphingEnabled()?i.getGraphMode(n,o):f.NONE)!==f.NONE&&(a.is_graphable=!0),o.moveStrategy&&(a.move_strategy=o.moveStrategy)),a;var n,i,o,a,s={operator:"=",variables:[]};if(r.isError&&(!(t instanceof g.FunctionDefinition)||r.blocksExport))return s.error=r.getError(),s.variables=t.getSliderVariables(e,r),s.is_single_identifier=t instanceof g.Identifier,s;r.moveStrategy&&(s.move_strategy=r.moveStrategy,s.default_drag_mode=r.defaultDragMode),t.isInequality()&&(s.is_inequality=!0),s.operator=t.getOperator(),r instanceof g.SolvedEquation?!0!==r._expression.asValue()&&!1!==r._expression.asValue()&&(s.assignment=r._symbol):t instanceof g.Assignment&&(s.assignment=t._symbol);var l=e.graphingEnabled()?t.getGraphMode(e,r):f.NONE;if(l!==f.NONE){s.is_graphable=!0,s.expression_type=t.getExpressionType(l,r.valueType),r.isShadeBetween()&&(s.is_shade_between=!0);var c=t.tableInfo(e,r);c&&(s.is_tableable=!0,s.table_info=c)}s.variables=s.is_graphable?[]:t.getSliderVariables(e,r),s.is_single_identifier=t instanceof g.Identifier,r.isConstant&&(s.constant_value=r.asValue());var u=r.getEvaluationInfo();if(!u||"="!==s.operator||t.isConstant||t.isFunction||(s.is_evaluable=!0,s.zero_values=u),r instanceof g.OptimizedRegression){var p={};for(var d in r.parameters)r.parameters.hasOwnProperty(d)&&(p[m.identifierToLatex(d)]=+r.parameters[d].asValue());s.is_regression=!0,s.regression={parameters:p,residualVariable:m.identifierToLatex(r.residualVariable),residualSuggestionId:r.residualSuggestionId,shouldSuggestLogMode:r.shouldSuggestLogMode,statistics:r.statistics}}return s};return r.default=t,r}),define("math/statementanalysis",["require","math/evaluationstate","pjs","graphing/graphmode","worker/workerconfig"],function(e){var n=e("math/evaluationstate"),t=e("pjs"),r=e("graphing/graphmode"),i=e("worker/workerconfig");return t(function(e){e.init=function(e,t,r){this.policy=e,this.rawTree=t,this.concreteTree=r,this.evaluationState=n(e,t,r)},e.exportTo=function(e,t){this.rawTree.exportTo(e,this.concreteTree,t)},e.graph=function(e){return this.rawTree.graph(this.policy,this.concreteTree,e)},e.getGraphMode=function(){return this.rawTree.getGraphMode(this.policy,this.concreteTree)},e.getGraphInfo=function(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)},e.shouldIntersect=function(){if(!this.evaluationState.is_graphable)return!1;if(!this.rawTree.userData.shouldGraph)return!1;if(!i.pointsOfInterest)return!1;var e=this.getGraphMode();return e===r.X||e===r.Y}})}),define("math/features/analyze",["require","underscore","parsenodes","math/statementanalysis","math/builtinframe","math/parsenode/builtinfunction","math/errormsg","math/comparators","math/types","graphing/graphmode"],function(e){function a(e,t,r,n){var i=n.getDependencies();switch(n.valueType){case o.Distribution:case o.ListOfDistribution:return p(e,r,n);case o.Point:case o.ListOfPoint:return i.length?e.validParametricVariables(i)?p(e,r,n):p(e,r,h.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(i)):p(e,r,n);case o.Number:case o.ListOfNumber:switch(i.length){case 0:return p(e,r,n);case 1:return e.validExpressionVariable(i[0])?p(e,r,n):p(e,r,h.equationRequired(e.implicitDependency(i[0])).setDependencies(i));default:return e.validImplicitVariables(i)?p(e,r,h.equationRequired().setDependencies(i)):p(e,r,h.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(i))}}}function t(e,t){var r=this.tryGetConcreteTree(t),n=r.getDependencies();return n.length?p(e,this,h.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):p(e,this,this.tryGetConcreteTree(t))}function c(e,t){return e.filter(function(e){return!t[e]})}var l=e("underscore"),u=e("parsenodes"),p=e("math/statementanalysis"),d=e("math/builtinframe"),s=e("math/parsenode/builtinfunction"),h=e("math/errormsg"),i=e("math/comparators"),o=e("math/types"),f=e("graphing/graphmode");u.Base.prototype.analyze=function(e,t){return p(e,this,this.tryGetConcreteTree(t))},u.Expression.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(t),n=function(e){return s.pdf([e,u.Identifier("x")]).tryGetConcreteTree(t)};return r instanceof u.Distribution&&(r=n(r)),r instanceof u.List&&r.valueType===o.ListOfDistribution&&(r=u.List(r.args.map(n))),r.isError?p(e,this,r):a(e,0,this,r)},u.FunctionDefinition.prototype.analyze=function(e,t){if(d[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split("_")[0];if(s[r])return p(e,this,h.cannotRedefine(this._symbol,r));var n=this.tryGetConcreteTree(t);if(n.isError)return p(e,this,n);var i=this._argSymbols,o=n.getDependencies();if(-1!==o.indexOf(this._symbol))return p(e,this,h.selfReferentialFunction(this._symbol));var a=o.filter(function(e){return-1===i.indexOf(e)});return e.unplottablePolarFunction(this._symbol,o)?p(e,this,h.unplottablePolarFunction()):a.some(e.assignmentForbidden)?p(e,this,h.addArgumentsToDefinition(a,this._symbol,i).setDependencies(o)):a.length?p(e,this,h.tooManyVariables(this.getSliderVariables(e,n)).setDependencies(o)):p(e,this,n)},u.Assignment.prototype.analyze=function(e,t,r){var n=this._symbol;if(!e.validLHS(n))return p(e,this,h.invalidLHS(n));if(d[n])return this.asEquation().analyze(e,t);var i=this.tryGetConcreteTree(t);if(i.isError)return p(e,this,i);var o=i.getDependencies();if(this.isEquation(i))return this.asEquation().analyze(e,t);if(1<o.length){var a=this.getSliderVariables(e,i);return a.length?p(e,this,h.tooManyVariables(a).allowExport().setDependencies(o)):p(e,this,i)}var s=this.getMoveStrategy(t,i,r);if(s){var l=this.getDefaultDragMode(s);return p(e,this,u.MovablePoint(i.args,s,l))}return p(e,this,i)},u.Regression.prototype.analyze=function(e,t,r,n,i){return p(e,this,this.tryOptimize(e,t,r,n,i))},u.Polygon.prototype.analyze=t,u.Histogram.prototype.analyze=t,u.DotPlot.prototype.analyze=t,u.BoxPlot.prototype.analyze=t,u.Equation.prototype.analyze=u.BaseComparator.prototype.analyze=function(e,t){var r=this.trySolve(e,t);if(r.isError)return p(e,this,r);if(r instanceof u.SolvedEquation&&r.getDependencies().length){var n=r.getDependencies().concat(r._symbol);if(!e.validImplicitVariables(n))return p(e,this,h.invalidImplicitVariables().setDependencies(n))}return this.getGraphMode(e,r)!==f.IMPLICIT||e.validImplicitVariables(r.getDependencies())?p(e,this,r):p(e,this,h.invalidImplicitVariables().setDependencies(r.getDependencies()))},u.DoubleInequality.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return p(e,this,r);var n=r.getDependencies();return i.table[this._operators[0]].direction!==i.table[this._operators[1]].direction?p(e,this,h.mismatchedDoubleInequality()):e.validDoubleInequalitySymbol(r._symbol)&&e.validDoubleInequalityVariables(n)?2<n.length?p(e,this,h.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):-1!==r._expressions[0].getDependencies().indexOf(r._symbol)||-1!==r._expressions[1].getDependencies().indexOf(r._symbol)?p(e,this,h.complicatedDoubleInequality().setDependencies(n)):p(e,this,r):p(e,this,h.invalidDoubleInequalityVariables().setDependencies(n))},u.And.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return p(e,this,r);var n=r.getDependencies();return n.length?e.validDoubleInequalityVariables(n)?p(e,this,h.complicatedDoubleInequality().setDependencies(n)):p(e,this,h.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):p(e,this,r)},u.OrderedPair.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(t);if(n.isError)return p(e,this,n);var i=this.getMoveStrategy(t,n,r);if(i){var o=this.getDefaultDragMode(i);return p(e,this,u.MovablePoint(n.args,i,o))}return a(e,0,this,n)},u.Table.prototype.analyze=function(e,t){for(var r=Object.create(t),n=[],i=0;i<this.columns.length;i++){var o=this.columns[i].analyze(e,r,t);if(0===i&&(o.concreteTree.isIndependent?e.validFirstColumnVariable(o.concreteTree.header._symbol)?o.concreteTree.header._symbol:o=p(e,this.columns[i],h.invalidFirstTableColumn()):o=p(e,this.columns[i],h.invalidDependentFirstTableColumn())),o.concreteTree.isIndependent)o.rawTree.exportToLocal(o.concreteTree,r);else if(!o.concreteTree.isError){var a=c(o.concreteTree.header.getDependencies(),r);a.length&&(o=p(e,this.columns[i],h.tooManyVariables(a).setDependencies(a)))}n.push(o.concreteTree)}var s=u.Table(n),l=p(e,this,s);return l.evaluationState.is_graphable=!0,l},u.TableColumn.prototype.analyze=function(e,t,r){var n=this.header.tableError();if(n)return p(e,this,h.invalidTableHeader(n));var i=this.tryGetConcreteTree(t,r);if(i.isError)return p(e,this,i);if(i.header.isError)return p(e,this,i.header);if(i.values.isError)return p(e,this,i.values);for(var o=0;o<i.values.length;o++)if(!i.values[o].isError){var a=this.values[o]&&this.values[o].tableError();if(a)i.values[o]=h.invalidTableEntry(a);else{var s=i.values[o].getDependencies();s.length&&(i.values[o]=h.tooManyVariables(s).setDependencies(s))}}return p(e,this,i)},u.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError)return p(e,this,n);var i=n.center.getDependencies(),o=n.radianAngle.getDependencies(),a=n.width.getDependencies(),s=n.height.getDependencies();return"OrderedPair"!==this.center.type?p(e,this,u.Image({center:h.parseError(),radianAngle:n.radianAngle,width:n.width,height:n.height})):i.length||o.length||a.length||s.length?p(e,this,u.Image({center:i.length?h.tooManyVariables(o).setDependencies(i):n.center,radianAngle:o.length?h.tooManyVariables(o).setDependencies(o):n.radianAngle,width:a.length?h.tooManyVariables(a).setDependencies(a):n.width,height:s.length?h.tooManyVariables(s).setDependencies(s):n.height})):(n.moveStrategy=this.getMoveStrategy(t,n,r),p(e,this,n))},u.Slider.prototype.analyze=function(e,t){var r,n=this.tryGetConcreteTree(t),i=n.sliderInfo;if(i.missingVars.length){var o=l.unique(i.missingVars);r=p(e,this,h.tooManyVariables(e.sliderVariables(o)).setDependencies(o).allowExport())}else r=p(e,this,n);var a=r.evaluationState;a.assignment=i.exportedSymbol,a.slider_min_number=i.values.min,a.slider_max_number=i.values.max,a.slider_step_number=i.values.step,a.slider_min_valid=i.valids.min,a.slider_max_valid=i.valids.max,a.slider_step_valid=i.valids.step;var s=a.slider_min_valid&&a.slider_max_valid&&a.slider_step_valid;return a.is_slider=!0,a.raw_slider_latex=this.getInputString(),a.is_slidable=s,a.is_animatable=a.is_slidable&&!a.is_graphable,delete a.is_evaluable,delete a.zero_values,i.errMsg&&(a.error=i.errMsg.getError()),r}}),define("math/features/analyzeFourFunction",["require","parsenodes","math/statementanalysis","math/errormsg","math/parsenode/builtinfunction","math/builtinconstants"],function(e){function t(e,t){return a(e,this,s.inequalitiesUnsupported())}var r=e("parsenodes"),a=e("math/statementanalysis"),s=e("math/errormsg"),l=e("math/parsenode/builtinfunction"),c=e("math/builtinconstants");r.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?a(e,this,r):a(e,this,s.parseError())},r.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return a(e,this,r);var n=r.getDependencies();if(0<n.length){var i,o=n[0];return i=l.hasOwnProperty(o)?s.functionUnsupported(o):c.hasOwnProperty(o)?s.constantUnsupported(o):s.variablesUnsupported(o),a(e,this,i)}return a(e,this,r)},r.Assignment.prototype.analyzeFourFunction=function(e,t){return a(e,this,s.assignmentsUnsupported())},r.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return a(e,this,s.functionDefinitionsUnsupported())},r.Equation.prototype.analyzeFourFunction=function(e,t){return a(e,this,s.equationsUnsupported())},r.And.prototype.analyzeFourFunction=t,r.DoubleInequality.prototype.analyzeFourFunction=t,r.BaseComparator.prototype.analyzeFourFunction=t,r.Regression.prototype.analyzeFourFunction=function(e,t){return a(e,this,s.regressionsUnsupported())},r.OrderedPair.prototype.analyzeFourFunction=function(e,t){return a(e,this,s.pointsUnsupported())}}),define("math/features/analyzeScientific",["require","parsenodes","math/statementanalysis","math/errormsg","math/builtinframe"],function(e){function t(e,t){return a(e,this,s.inequalitiesUnsupported())}var r=e("parsenodes"),a=e("math/statementanalysis"),s=e("math/errormsg"),l=e("math/builtinframe");r.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?a(e,this,r):a(e,this,s.parseError())},r.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return a(e,this,r);var n=r.getDependencies();return 0<n.length?a(e,this,s.tooManyVariables(n)):a(e,this,r)},r.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(l[r])return a(e,this,s.cannotRedefine(r));var n=this.tryGetConcreteTree(t);if(n.isError)return a(e,this,n);var i=n.getDependencies();return this.isEquation(n)?a(e,this,s.equationsUnsupported()):0<i.length?a(e,this,s.tooManyVariables(i)):a(e,this,n)},r.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(l[this._symbol])return a(e,this,s.cannotRedefine(this._symbol));var r=this.tryGetConcreteTree(t);if(r.isError)return a(e,this,r);var n=this._argSymbols,i=r.getDependencies();if(-1!==i.indexOf(this._symbol))return a(e,this,s.selfReferentialFunction(this._symbol));var o=i.filter(function(e){return-1===n.indexOf(e)});return o.length?a(e,this,s.addArgumentsToDefinition(o,this._symbol,n)):a(e,this,r)},r.Equation.prototype.analyzeScientific=function(e,t){return a(e,this,s.equationsUnsupported())},r.And.prototype.analyzeScientific=t,r.DoubleInequality.prototype.analyzeScientific=t,r.BaseComparator.prototype.analyzeScientific=t,r.Regression.prototype.analyzeScientific=function(e,t){return a(e,this,s.regressionsUnsupported())},r.OrderedPair.prototype.analyzeScientific=function(e,t){return a(e,this,s.pointsUnsupported())}}),define("math/features/analyzeSingleExpressionScientific",["require","parsenodes","math/statementanalysis","math/errormsg","math/parsenode/builtinfunction","math/builtinconstants"],function(e){function t(e,t){return a(e,this,s.inequalitiesUnsupported())}var r=e("parsenodes"),a=e("math/statementanalysis"),s=e("math/errormsg"),l=e("math/parsenode/builtinfunction"),c=e("math/builtinconstants");r.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?a(e,this,r):a(e,this,s.parseError())},r.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return a(e,this,r);var n=r.getDependencies();if(0<n.length){var i,o=n[0];return i=l.hasOwnProperty(o)?s.functionUnsupported(o):c.hasOwnProperty(o)?s.constantUnsupported(o):s.variablesUnsupported(o),a(e,this,i)}return a(e,this,r)},r.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return a(e,this,s.assignmentsUnsupported())},r.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return a(e,this,s.functionDefinitionsUnsupported())},r.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return a(e,this,s.equationsUnsupported())},r.And.prototype.analyzeSingleExpressionScientific=t,r.DoubleInequality.prototype.analyzeSingleExpressionScientific=t,r.BaseComparator.prototype.analyzeSingleExpressionScientific=t,r.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return a(e,this,s.regressionsUnsupported())},r.OrderedPair.prototype.analyzeSingleExpressionScientific=function(e,t){return a(e,this,s.pointsUnsupported())}}),define("graphing/dragmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NONE="NONE",t.X="X",t.Y="Y",t.XY="XY",t.AUTO="AUTO"}),define("graphing/reconcileDragMode",["require","exports","graphing/dragmode"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,n=(r=t)?"none"===r[0].type&&"none"===r[1].type?i.NONE:"none"===r[1].type?i.X:"none"===r[0].type?i.Y:i.XY:i.NONE;switch(e){case i.NONE:return i.NONE;case i.AUTO:case i.XY:return n;case i.X:return n===i.X||n===i.XY?i.X:i.NONE;case i.Y:return n===i.Y||n===i.XY?i.Y:i.NONE;default:return i.NONE}}}),define("math/features/getgraphmode",["require","parsenodes","graphing/graphmode","graphing/reconcileDragMode","graphing/dragmode","math/types"],function(e){function n(e,t){var r,n,i,o=t.getDependencies();switch(t.valueType){case c.Point:case c.ListOfPoint:return t.isMovablePoint&&(r=this.userData,n=t,i=r&&r.hasOwnProperty("dragMode")?r.dragMode===l.AUTO?n.defaultDragMode:r.dragMode:n.defaultDragMode,s(i,n.moveStrategy)!==l.NONE)?a.XYPOINT_MOVABLE:0===o.length?a.XYPOINT:e.validParametricVariables(o)?a.PARAMETRIC:a.NONE;case c.Number:case c.ListOfNumber:return 1===o.length?a.Y:a.NONE;default:return a.NONE}}function i(e,t){var r=t._expression.getDependencies();if(1<r.length)return a.NONE;if(t._expression.valueType!==c.Number&&t._expression.valueType!==c.ListOfNumber)return a.NONE;var n=t._symbol,i=r[0];return e.graphMode(n,i)}function t(e,t){return t.isError?a.NONE:a.VISUALIZATION}var o=e("parsenodes"),a=e("graphing/graphmode"),s=e("graphing/reconcileDragMode").default,l=e("graphing/dragmode"),c=e("math/types");o.Base.prototype.getGraphMode=function(e,t){return a.NONE},o.Expression.prototype.getGraphMode=n,o.Equation.prototype.getGraphMode=o.BaseComparator.prototype.getGraphMode=function(e,t){var r=t.getDependencies();return t.isConstant?a.NONE:t instanceof o.SolvedEquation?0===r.length?e.graphableAsConstant(t._symbol)?e.constantGraphMode(t._symbol):a.NONE:i(e,t):r.length<=2?a.IMPLICIT:a.NONE},o.DoubleInequality.prototype.getGraphMode=function(e,t){return e.constantGraphMode(t._symbol)},o.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof o.SolvedEquation)return i(e,t);if(this.isEquation(t))return this.asEquation().getGraphMode(e,t);var r=t.getDependencies();switch(t.valueType){case c.Number:case c.ListOfNumber:switch(r.length){case 0:return e.graphableAsConstant(this._symbol)?e.constantGraphMode(this._symbol):a.NONE;case 1:return t.valueType!==c.ListOfNumber||e.graphableListVariables(this._symbol,r[0])?this.isSlider?a.NONE:e.graphMode(this._symbol,r[0]):a.NONE;default:return a.NONE}break;default:return n.call(this,e,t)}},o.FunctionDefinition.prototype.getGraphMode=function(e,t){if(1!==this._argSymbols.length)return a.NONE;var r=e.graphMode(this._symbol,this._argSymbols[0]),n=t.getDependencies();switch(t.valueType){case c.Number:case c.ListOfNumber:switch(n.length){case 0:return r;case 1:return n[0]!==this._argSymbols[0]?a.NONE:r;default:return a.NONE}break;default:return a.NONE}},o.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple&&t.isModelValid?1!==t.model.getDependencies().length?a.NONE:a.Y:a.NONE},o.Polygon.prototype.getGraphMode=function(e,t){return t.isError?a.NONE:a.POLYGONFILL},o.Histogram.prototype.getGraphMode=t,o.DotPlot.prototype.getGraphMode=t,o.BoxPlot.prototype.getGraphMode=t,o.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError?a.NONE:a.XYPOINT:a.NONE}}),define("math/features/getgraphinfo",["require","parsenodes","math/builtinframe","math/domaintypes"],function(e){var t=e("parsenodes"),r=e("math/builtinframe"),o=e("math/domaintypes");t.Base.prototype.getGraphInfo=function(e,t){var r,n,i=t.getDependencies();switch(i.length){case 0:r=!0,n=t.boundDomain("x");break;case 1:r="known"===(n=t.boundDomain(i[0])).type&&t.isLinear(i[0]);break;case 2:r=!1,n=o.unknownDomain()}return{graphMode:this.getGraphMode(e,t),color:this.userData.color,pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,operator:this.getOperator(),isLinear:r,linearCoefficients:r?t.getLinearCoefficients():void 0,domainBound:n}},t.Base.prototype.getLinearCoefficients=function(){var e=this.getDependencies();switch(e.length){case 0:return[+this.asValue(),0];case 1:var t=this.getPolynomialCoefficients(e[0]);return[t[0]?+t[0].getConcreteTree(r).asValue():0,t[1]?+t[1].getConcreteTree(r).asValue():0];default:return[NaN,NaN]}},t.OrderedPair.prototype.getLinearCoefficients=function(){return[this.args[0].getLinearCoefficients(),this.args[1].getLinearCoefficients()]}}),define("math/features/getMoveStrategy",["require","parsenodes","math/types","math/maybe-rational"],function(e){function d(e){return{type:"none",inputString:e}}function h(e){return{type:"updateCoordinate",inputString:e}}function f(e,t,r){return{type:"updateSlider",inputString:e,id:t,coefficients:r}}function g(e,t){for(var r in t)if(t[r].evaluationState.assignment===e&&t[r].evaluationState.is_slidable)return r}function m(e,t,r,n){for(var i=e.getDependencies(),o=0;o<i.length;o++)if(n[i[o]])return!1;for(var a=i.length-1;0<=a;a--){var s=i[a],l=g(s,r);if(void 0!==l){var c=Object.create(t);c[s]=y.FreeVariable(s);var u=e.tryGetConcreteTree(c);if(!u.isError)if(1===u.polynomialOrder(s)){var p=u.getPolynomialCoefficients(s),d=p[1]?p[1].getConcreteTree(c):v,h=p[0]?p[0].getConcreteTree(c):v;if(h.isConstant&&d.isConstant&&isFinite(h.asValue())&&isFinite(d.asValue())&&0!==d.asValue())return{symbol:s,id:l,coefficients:[-h.asValue()/d.asValue(),1/d.asValue()]}}}}return!1}var y=e("parsenodes"),c=e("math/types"),t=e("math/maybe-rational").maybeRational,v=y.Constant(t(0,1));y.Base.prototype.getMoveStrategy=function(){},y.Assignment.prototype.getMoveStrategy=function(e,t,r){if(this._expression instanceof y.OrderedPair)return this._expression.getMoveStrategy(e,t,r)},y.OrderedPair.prototype.getMoveStrategy=function(e,t,r){if(t.valueType===c.Point&&0===t.getDependencies().length){for(var n=[],i={},o=0;o<2;o++){var a=this.args[o],s=a.getInputString();if(a.isConstant)n[o]=h(s);else{var l=m(a,e,r,i);l&&(n[o]=f(s,l.id,l.coefficients),i[l.symbol]=!0),n[o]||(n[o]=d(s))}}if("none"!==n[0].type||"none"!==n[1].type)return n}},y.Image.prototype.getMoveStrategy=function(e,t,r){if((!this.userData||!1!==this.userData.shouldGraph)&&"OrderedPair"===t.center.type&&t.center.args[0].isConstant&&t.center.args[1].isConstant&&t.width.isConstant&&t.height.isConstant&&t.radianAngle.isConstant){for(var n=[this.width,this.height,this.center.args[0],this.center.args[1]],i=[],o={},a=[2,3,0,1],s=0;s<a.length;s++){var l=a[s],c=n[l];if(c){var u=c.getInputString();if(c.isConstant)i[l]=h(u);else{var p=m(c,e,r,o);p&&(i[l]=f(u,p.id,p.coefficients),o[p.symbol]=!0),i[l]||(i[l]=d(u))}}else i[l]=d("")}if("none"!==i[0].type||"none"!==i[1].type||"none"!==i[2].type||"none"!==i[3].type)return i}}}),define("math/features/getDefaultDragMode",["require","parsenodes","graphing/dragmode"],function(e){var t=e("parsenodes"),r=e("graphing/dragmode");t.Base.prototype.getMoveStrategy=function(){return r.NONE},t.Assignment.prototype.getDefaultDragMode=function(e){return"none"!==e[0].type&&"none"!==e[1].type?r.XY:"none"!==e[0].type?r.X:"none"!==e[1].type?r.Y:r.NONE},t.OrderedPair.prototype.getDefaultDragMode=function(e){return"updateSlider"===e[0].type&&"updateSlider"===e[1].type?r.XY:"updateSlider"===e[0].type?r.X:"updateSlider"===e[1].type?r.Y:r.NONE}}),define("math/features/tableinfo",["require","parsenodes","math/types","graphing/label"],function(e){var i=e("parsenodes"),o=i.List,a=e("math/types"),s=e("graphing/label");i.Base.prototype.tableInfo=function(e,t){return!1},i.Identifier.prototype.tableInfo=function(e,t){return!!e.validFirstColumnVariable(this._symbol)&&{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}},i.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();switch(t.valueType){case a.Point:case a.ListOfPoint:return 0===r.length&&((!t.isMovablePoint||"updateSlider"!==t.moveStrategy[0].type&&"updateSlider"!==t.moveStrategy[1].type)&&{independent_variable:"x",dependent_column:"y",by_reference:!1,values:o.wrap(t).mapElements(function(e){return e.asArray()})});case a.Number:if(1!==r.length)return!1;var n=r[0];return!!e.validFirstColumnVariable(n)&&{independent_variable:n,dependent_column:this.getInputString(),by_reference:!1};default:return!1}},i.Assignment.prototype.tableInfo=function(e,t){if(t instanceof i.SolvedEquation)return!1;if(!this.getInputString().length)return!1;var r,n=t.getDependencies();if(1<n.length)return!1;if(0===n.length){if(!e.tableableAsConstant(this._symbol))return!1;r=e.implicitIndependent(this._symbol)}else r=n[0];return!!e.validFirstColumnVariable(r)&&{independent_variable:r,dependent_column:e.assignmentForbidden(this._symbol)?s.trimLatex(this.getInputString().replace(/[^=]*=/,"")):s.trimLatex(this.getInputString().split("=")[0]),by_reference:!e.assignmentForbidden(this._symbol)}},i.FunctionDefinition.prototype.tableInfo=function(e,t){if(1!==this._argSymbols.length)return!1;if(!this.getInputString().length)return!1;if(1<t.getDependencies().length)return!1;var r=this._argSymbols[0];if(!e.validFirstColumnVariable(r))return!1;var n=e.assignmentForbidden(this._symbol);return{independent_variable:r,dependent_column:n?s.trimLatex(this.getInputString().replace(/[^=]*=/,"")):s.trimLatex(this.getInputString().split("=")[0]),by_reference:!n}},i.BaseComparator.prototype.tableInfo=function(e,t){return!1},i.DoubleInequality.prototype.tableInfo=function(e,t){return!1},i.Equation.prototype.tableInfo=function(e,t){return!1}}),define("math/features/tableerror",["require","parsenodes","lib/worker-i18n"],function(e){var t=e("parsenodes"),r=e("lib/worker-i18n");t.Base.prototype.tableError=function(){return this.isInequality()?r.t("Inequalities are not allowed."):!(this instanceof t.Expression)&&r.t("This type of expression is not allowed.")},t.List.prototype.tableError=function(){return r.t("Lists are not allowed.")},t.Equation.prototype.tableError=t.Assignment.prototype.tableError=function(){return r.t("Equations are not allowed.")},t.FunctionDefinition.prototype.tableError=function(){return r.t("Function definitions are not allowed.")},t.Regression.prototype.tableError=function(){return r.t("Regressions are not allowed.")}}),define("math/features/islinear",["require","parsenodes"],function(e){var a=e("parsenodes");a.Base.prototype.isLinear=function(e){return!1},a.Expression.prototype.isLinear=function(e){return this.polynomialOrder(e)<=1},a.SolvedEquation.prototype.isLinear=function(e){return this._expression.isLinear(e)},a.OptimizedRegression.prototype.isLinear=function(e){return this.model.isLinear(e)},a.OrderedPair.prototype.isLinear=function(e){return this.args[0].isLinear(e)&&this.args[1].isLinear(e)},a.List.prototype.isLinear=function(t){return this.args.every(function(e){return e.isLinear(t)})},a.Broadcast.prototype.isLinear=function(e){for(var t=this._replacedSymbols,r=this._expression,n=this._lists,i={},o=0;o<n.length;o++)if(n[o].dependsOn(e)){if(!n[o].isLinear(e))return!1;i[t[o]]=a.FreeVariable(e)}return r.substitute(i).isLinear(e)}}),define("math/curve-accumulator",["require","exports","./distance"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){e?(this.xtolerance=e.xtolerance||e.tolerance||0,this.ytolerance=e.ytolerance||e.tolerance||0,this.map=e.map):this.xtolerance=this.ytolerance=0,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}return e.prototype.colinear=function(e,t,r){this.map&&(e=this.map(e),t=this.map(t),r=this.map(r));var n=o.pointToSegmentParameter(r[0],r[1],e[0],e[1],t[0],t[1]);if(n<1)return!1;var i=[e[0]+n*(t[0]-e[0]),e[1]+n*(t[1]-e[1])];return Math.abs(r[0]-i[0])<=this.xtolerance&&Math.abs(r[1]-i[1])<=this.ytolerance},e.prototype.addPoint=function(e){if(this.xtolerance<0&&this.ytolerance<0)this.segment.push(e[0],e[1]);else if(this.segment.length){var t=[this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(e[0]!==t[0]||e[1]!==t[1]){if(!this.pivotPoint||!this.pendingPoint)return this.pivotPoint=e,void(this.pendingPoint=e);(!this.colinear(t,this.pivotPoint,e)||o.hypot(t[0]-e[0],t[1]-e[1])<o.hypot(t[0]-this.pendingPoint[0],t[1]-this.pendingPoint[1]))&&(this.flushPending(),this.pivotPoint=e),this.pendingPoint=e}}else this.segment.push(e[0],e[1])},e.prototype.flushPending=function(){this.pendingPoint&&(this.segment.push(this.pendingPoint[0],this.pendingPoint[1]),this.pivotPoint=void 0,this.pendingPoint=void 0)},e.prototype.breakSegment=function(){this.flushPending(),2<this.segment.length&&this.segments.push(this.segment),this.segment=[]},e.prototype.getSegments=function(){return this.breakSegment(),this.segments},e.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0}},e}();t.default=r}),define("math/implicit-plotter",["require","exports","./distance","./curve-accumulator"],function(e,t,p,a){"use strict";function n(e,t){var r=Math.pow(2,-O),n=s(t,r),i=s(t,2*r),o=l(e,n,i),a=c(o.root,e,n);return{paddedDomain:n,rootDomain:i,quadTree:o,triangles:a,contours:I(a,e,n)}}function v(e,t,r){return{x:e,y:t,z:r}}function b(e,t,r){return{x:e,y:t,isZero:r}}function o(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function s(e,t){var r=(1+t)*e.xmin-t*e.xmax,n=(1+t)*e.xmax-t*e.xmin;return{xmin:r,ymin:(1+t)*e.ymin-t*e.ymax,xmax:n,ymax:(1+t)*e.ymax-t*e.ymin,xtolerance:e.xtolerance,ytolerance:e.ytolerance}}function k(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function P(e,t,r){e.center=_(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function l(e,t,r){var n,i,o,a,s,l,c=(n=e,o=(i=r).xmin,a=i.xmax,s=i.ymin,l=i.ymax,k(0,[A(o,l,n),A(a,l,n),A(a,s,n),A(o,s,n)])),u=[],p=[];p.push(c);var d,h,f,g,m,y,v,b,x,w,_,S,E=1,M=!0;e:for(;p.length;){var I=u;u=p,p=I;for(var T=void 0;T=u.pop();)if(D(T,e,t)){if(h=e,void 0,f=(d=T).depth+1,g=d.vertices[0],m=d.vertices[1],y=d.vertices[2],v=d.vertices[3],b=L(g,m,h),x=L(m,y,h),w=L(y,v,h),_=L(v,g,h),S=L(g,y,h),d.children=[k(f,[g,b,S,_]),k(f,[b,m,x,S]),k(f,[S,x,y,w]),k(f,[_,S,w,v])],!T.children){M=!1;break e}if(p.push(T.children[0]),p.push(T.children[1]),p.push(T.children[2]),p.push(T.children[3]),q<=(E+=3)){M=!1;break e}}else P(T,e,t)}for(var C=0;C<u.length;C++)P(u[C],e,t);for(C=0;C<p.length;C++)P(p[C],e,t);return{root:c,resolved:M}}function D(e,t,r){if(e.depth<O)return!0;if(i=r,(n=e).vertices[0].x<i.xmin||n.vertices[0].y>i.ymax||n.vertices[2].x>i.xmax||n.vertices[2].y<i.ymin)return!1;var n,i,o,a;if(a=r,(o=e).vertices[1].x-o.vertices[0].x<10*a.xtolerance||o.vertices[0].y-o.vertices[3].y<10*a.ytolerance)return!1;var s=e.vertices[0],l=e.vertices[1],c=e.vertices[2],u=e.vertices[3];if(isNaN(s.z)&&isNaN(l.z)&&isNaN(c.z)&&isNaN(u.z))return!1;if(isNaN(s.z)||isNaN(l.z)||isNaN(c.z)||isNaN(u.z))return!0;var p=_(s,l,c,u,t,r),d=w(s,l,t,r),h=w(l,c,t,r),f=w(c,u,t,r),g=w(u,s,t,r);return y(s,d,t)||y(l,d,t)||y(l,h,t)||y(c,h,t)||y(c,f,t)||y(u,f,t)||y(u,g,t)||y(s,g,t)||m(s,d,p,t,r)||m(d,l,p,t,r)||m(l,h,p,t,r)||m(h,c,p,t,r)||m(c,f,p,t,r)||m(f,u,p,t,r)||m(u,g,p,t,r)||m(g,s,p,t,r)}function m(e,t,r,n,i){if(0<e.z==0<t.z&&0<t.z==0<r.z)return!1;var o,a,s,l;if(0<e.z==0<t.z){if(0<(o=L(e,t,n)).z!=0<e.z)return!0;a=d(e,r,n,i),s=d(t,r,n,i),l=d(o,r,n,i)}else if(0<t.z==0<r.z){if(0<(o=L(t,r,n)).z!=0<t.z)return!0;a=d(t,e,n,i),s=d(r,e,n,i),l=d(o,e,n,i)}else{if(0<(o=L(r,e,n)).z!=0<r.z)return!0;a=d(r,t,n,i),s=d(e,t,n,i),l=d(o,t,n,i)}var c=i.xtolerance,u=i.ytolerance;return c*u<p.pointToSegment(u*l.x,c*l.y,u*a.x,c*a.y,u*s.x,c*s.y)}function y(e,t,r){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return 0<e.z||0<t.z;var n=4*L(e,t,r).z-t.z-3*e.z,i=(r(.9999*e.x+1e-4*t.x,.9999*e.y+1e-4*t.y)-e.z)/1e-4,o=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(n-i)>.125*o}function x(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function A(e,t,r){return v(e,t,r(e,t))}function L(e,t,r){return A(.5*(e.x+t.x),.5*(e.y+t.y),r)}function w(e,t,r,n){if(x(e,n)||x(t,n))return L(e,t,r);if(isNaN(e.z)||isNaN(t.z))return function(e,t,r,n){if(isNaN(e.z)===isNaN(t.z))return L(e,t,r);if(isNaN(e.z)){var i=e;e=t,t=i}for(var o=e.x,a=t.x,s=e.y,l=t.y,c=e.z,u=n.xtolerance,p=n.ytolerance;Math.abs(o-a)>u||Math.abs(s-l)>p;){var d=.5*(o+a),h=.5*(s+l),f=r(d,h);isNaN(f)===isNaN(c)?(o=d,s=h,c=f):(a=d,l=h)}return v(o,s,c)}(e,t,r,n);if(0<e.z!=0<t.z)return L(e,t,r);var i=r(.99*e.x+.01*t.x,.99*e.y+.01*t.y)-e.z,o=t.z-r(.01*e.x+.99*t.x,.01*e.y+.99*t.y);return isNaN(i)||isNaN(o)?L(e,t,r):0<i==0<o?L(e,t,r):S(v(e.x,e.y,i),v(t.x,t.y,o),r)}function _(e,t,r,n,i,o){var a=w(e,r,i,o);return 0<e.z==0<r.z&&0<a.z!=0<e.z?a:(a=w(t,n,i,o),0<t.z==0<n.z&&0<a.z!=0<t.z?a:L(e,r,i))}function S(e,t,r){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(isFinite(e.z)||isFinite(t.z)){if(isFinite(e.z)){if(isFinite(t.z)){var n=1-e.z/t.z,i=1-t.z/e.z;return A(e.x/n+t.x/i,e.y/n+t.y/i,r)}return e}return t}return L(e,t,r)}function d(e,t,r,n){var i=e.x,o=t.x,a=e.y,s=t.y,l=e.z,c=t.z,u=n.xtolerance,p=n.ytolerance;if(x(e,n)||x(t,n)){var d=L(e,t,r);return b(d.x,d.y,!1)}for(;Math.abs(i-o)>u||Math.abs(a-s)>p;){var h=.5*(i+o),f=.5*(a+s),g=r(h,f);0<g==0<l?(i=h,a=f,l=g):(o=h,s=f,c=g)}if(isNaN(l))return b(o,s,!1);if(isNaN(c))return b(i,a,!1);var m=S(v(i,a,l),v(o,s,c),r),y=0===l||0===c||0===m.z||m.z>=l==c>=m.z&&Math.abs(m.z)<1e250;return b(m.x,m.y,y)}function c(e,t,r){var n={triangles:[],edgeCache:{},domain:r,fn:t};return function e(t,r){t.children&&(e(t.children[0],r),e(t.children[1],r),e(t.children[2],r),e(t.children[3],r),i(t.children[0],t.children[1],r),i(t.children[3],t.children[2],r),u(t.children[1],t.children[2],r),u(t.children[0],t.children[3],r))}(e,n),n.triangles}function i(e,t,r){e.children&&t.children?(i(e.children[1],t.children[0],r),i(e.children[2],t.children[3],r)):e.children?(i(e.children[1],t,r),i(e.children[2],t,r)):t.children?(i(e,t.children[0],r),i(e,t.children[3],r)):function(e,t,r){if(e.center&&t.center){var n,i;E(i=e.depth>=t.depth?(n=w(e.vertices[1],e.vertices[2],r.fn,r.domain),h(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=w(t.vertices[0],t.vertices[3],r.fn,r.domain),h(t.vertices[0],t.center,t.vertices[3],e.center,n)),r.edgeCache,r.domain);for(var o=0;o<4;o++)r.triangles.push(i[o])}}(e,t,r)}function u(e,t,r){e.children&&t.children?(u(e.children[2],t.children[1],r),u(e.children[3],t.children[0],r)):e.children?(u(e.children[2],t,r),u(e.children[3],t,r)):t.children?(u(e,t.children[1],r),u(e,t.children[0],r)):function(e,t,r){if(e.center&&t.center){var n,i;E(i=e.depth>=t.depth?(n=w(e.vertices[3],e.vertices[2],r.fn,r.domain),h(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=w(t.vertices[1],t.vertices[0],r.fn,r.domain),h(t.vertices[1],t.center,t.vertices[0],e.center,n)),r.edgeCache,r.domain);for(var o=0;o<4;o++)r.triangles.push(i[o])}}(e,t,r)}function h(e,t,r,n,i){return[o(e,i,t),o(t,i,r),o(r,i,n),o(n,i,e)]}function g(e,t,r){return 0<e.z&&!x(e,r)&&(!(0<t.z)||x(t,r))}function f(e,t){return e.x+","+e.y+","+t.x+","+t.y}function E(e,t,r){M(e[0],e[1],e[2],f(e[1].vertices[2],e[1].vertices[0]),t,r),M(e[1],e[2],e[3],f(e[2].vertices[0],e[2].vertices[2]),t,r),M(e[2],e[3],e[0],f(e[3].vertices[2],e[3].vertices[0]),t,r),M(e[3],e[0],e[1],f(e[0].vertices[0],e[0].vertices[2]),t,r)}function M(e,t,r,n,i,o){var a,s,l,c,u,p,d=t.vertices[0],h=t.vertices[1],f=t.vertices[2];g(h,f,o)&&(t.next=r),g(d,h,o)&&(t.next=e),g(f,d,o)&&(c=t,(p=i)[u=n]?c.next=p[u]:p[u]=c),g(d,f,o)&&(a=t,(l=i)[s=n]?l[s].next=a:l[s]=a)}function I(e,t,r){for(var n={fillAccumulator:new a.default(r),strokeAccumulator:new a.default(r),fn:t,domain:r},i=0;i<e.length;i++){var o=e[i];o.next&&!o.visited&&T(o,n)}return{strokeSegments:n.strokeAccumulator.finish().segments,fillSegments:n.fillAccumulator.finish().segments}}function T(e,t){for(;;){var r=e.vertices[0],n=e.vertices[1],i=e.vertices[2];if(C(r,n,t),C(n,i,t),C(i,r,t),e.visited)break;if(!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function C(e,t,r){if(g(e,t,r.domain)){var n=d(e,t,r.fn,r.domain);r.fillAccumulator.addPoint([n.x,n.y]),n.isZero?r.strokeAccumulator.addPoint([n.x,n.y]):r.strokeAccumulator.breakSegment()}}Object.defineProperty(t,"__esModule",{value:!0});var O=5,q=Math.pow(2,14);t.sampleImplicit=function(e,t){var r=n(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}},t.sampleImplicitDiagnostic=n,t.buildQuadTree=l,t.triangulate=c,t.traceContours=I,t.displayTriangles=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push([n.vertices[0].x,n.vertices[0].y,n.vertices[1].x,n.vertices[1].y,n.vertices[2].x,n.vertices[2].y,n.vertices[0].x,n.vertices[0].y])}return t}}),define("math/poi-finding-accumulator",["require","exports","worker/workerconfig","tslib","./curve-accumulator","./poi"],function(e,t,r,n,i,u){"use strict";function o(e){return Math.abs(e)<5e-8}Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){function e(e,t,r){var n=i.call(this,e)||this;return n.domain=e,n.fn=t,n.derivative=r,n.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},n.zeroBuffer=[],n.extremumBuffer=[],n}return n.__extends(e,i),e.prototype.getPOI=function(){return r.pointsOfInterest?(void 0!==this.fn&&(this.poiData.intercept=this.findIntercept(this.fn)),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}},e.prototype.addLinearZero=function(e){var t=-e[0]/e[1];this.isOutsideDomain(t)||(this.poiData.zeros={x:[t],y:[0]})},e.prototype.addLinearIntercept=function(e){this.isOutsideDomain(0)||(this.poiData.intercept={x:[0],y:[e[0]]})},e.prototype.isOutsideDomain=function(e){return!this.domain||void 0===this.domain.min||void 0===this.domain.max||e<this.domain.min||e>this.domain.max||isNaN(e)},e.prototype.addPoint=function(e){0===this.segment.length&&o(e[1])&&(this.poiData.zeros.x.push(e[0]),this.poiData.zeros.y.push(e[1])),this.updateZeroBuffer(e),this.updateExtremumBuffer(e),i.prototype.addPoint.call(this,e)},e.prototype.updateZeroBuffer=function(e){if(this.fn){if(!isFinite(e[0])||!isFinite(e[1]))return void(this.zeroBuffer.length=0);switch(this.zeroBuffer.length){case 0:if(o(e[1]))return;return void this.zeroBuffer.push(e);case 1:return 0===e[1]||(0<e[1]==0<this.zeroBuffer[0][1]||(t=u.default.bisectZero(this.zeroBuffer[0][0],this.zeroBuffer[0][1],e[0],e[1],this.fn))&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0),void this.zeroBuffer.push(e);case 2:if(0===e[1])return;return 0<e[1]==0<this.zeroBuffer[0][1]?this.zeroBuffer.length=0:((t=u.default.flatCenter(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],e[0],e[1],this.fn))&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0),void this.zeroBuffer.push(e);var t}}},e.prototype.updateExtremumBuffer=function(e){if(this.fn){if(!isFinite(e[0])||!isFinite(e[1]))return void(this.zeroBuffer.length=0);switch(this.extremumBuffer.length){case 0:return void this.extremumBuffer.push(e);case 1:return e[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),void this.extremumBuffer.push(e);case 2:if(e[1]===this.extremumBuffer[1][1])return void this.extremumBuffer.push(e);if(e[1]>this.extremumBuffer[1][1]==this.extremumBuffer[1][1]>this.extremumBuffer[0][1])return this.extremumBuffer.shift(),void this.extremumBuffer.push(e);if(t=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1]))this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1]),!!!u.default.bisectJump(this.extremumBuffer[0][0],this.extremumBuffer[0][1],t[0],t[1],e[0],e[1],this.fn,this.ytolerance)&&t[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=t);return this.extremumBuffer.shift(),void this.extremumBuffer.push(e);case 3:if(e[1]===this.extremumBuffer[1][1])return;return e[1]>this.extremumBuffer[1][1]==this.extremumBuffer[1][1]>this.extremumBuffer[0][1]?(this.extremumBuffer.shift(),this.extremumBuffer.shift()):((t=u.default.flatCenter(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1],this.fn))&&(this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift()),void this.extremumBuffer.push(e);var t}}},e.prototype.bisectExtremumUsingDerivative=function(e,t,r,n,i,o){if(this.fn){var a;if(this.derivative){var s=this.derivative(e),l=this.derivative(i);if(!isNaN(s)&&!isNaN(l)&&s<0!=l<0){var c=u.default.bisectZero(e,s,i,l,this.derivative);c&&(a=[c[0],this.fn(c[0])])}}return a||(a=u.default.bisectExtremum(e,t,r,n,i,o,this.fn)),a}},e.prototype.breakSegment=function(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),2<this.segment.length&&(this.segments.push(this.segment),o(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]},e.prototype.findIntercept=function(e){if(!e)return{x:[],y:[]};var t=e(0);return isFinite(t)?{x:[0],y:[e(0)]}:{x:[],y:[]}},e.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}},e}(i.default);t.default=a}),define("math/plotter",["require","exports","./distance","./poi","./implicit-plotter","./curve-accumulator","./poi-finding-accumulator","graphing/graphmode","./domaintypes"],function(e,t,b,m,E,a,o,M,v){"use strict";function I(e,t){var r=new o.default(t),n=e[0]+t.min*e[1],i=e[0]+t.max*e[1];return isFinite(n)&&isFinite(i)&&(r.addPoint([t.min,n]),r.addPoint([t.max,i]),r.addLinearZero(e),r.addLinearIntercept(e)),r.finish()}function y(e,t,r){var n=r.fn,i=r.jumpTolerance,o=e[0],a=e[1],s=t[0],l=t[1],c=b.mean(o,s),u=n(c);return m.default.bisectJump(o,a,c,u,s,l,n,i)}function x(e,t,r){var n=t,i=e(n);return isFinite(i)||(i=e(n=t+r)),isFinite(i)||(i=e(n=t-r)),[n,i]}function T(e,t,r){var n,i,o,a,s,l,c,u=new D(e,t,r),p=t.step/10,d=t.min,h=[c=(n=x(e,d,p))[0],l=n[1]];isFinite(l)&&u.accumulator.addPoint([c,l]);for(var f=Math.ceil((t.max-t.min)/t.step),g=1;g<=f;g++)c=(i=x(e,d=(f-g)/f*t.min+g/f*t.max,p))[0],l=i[1],isFinite(l)&&isFinite(h[1])?(c=(o=S(h,[c,l],u))[0],l=o[1],u.accumulator.addPoint([c,l])):isFinite(l)&&!isFinite(h[1])?(s=m.default.bisectFinite(h[0],h[1],c,l,e))&&(s[0]!==c&&u.accumulator.addPoint(s),c=(a=S(s,[c,l],u))[0],l=a[1],u.accumulator.addPoint([c,l])):!isFinite(l)&&isFinite(h[1])&&((s=m.default.bisectFinite(h[0],h[1],c,l,e))&&((s=S(h,s,u))[0]!==h[0]&&u.accumulator.addPoint(s),u.accumulator.breakSegment())),h=[c,l];return u.accumulator.finish()}function w(e,t,u,p){function r(e,t){var r=t%2==0?1:-1;if(!p&&-1===r)return!1;for(var n=t*(Math.PI/u),i=[d,d+1,d+2,d+3],o=!1,a=0,s=i.length;a<s;a++){var l=e(i[a]),c=e(i[a]+n);if(isFinite(l)&&isFinite(c)&&(o=!0),isFinite(l)!==isFinite(c)||Math.abs(l-r*c)>h)return!1}return!!o}var n,i,o,d=t.min,a=t.max-t.min,h=t.xtolerance&&t.ytolerance?Math.min(t.xtolerance,t.ytolerance):t.tolerance?t.tolerance:0,s=Math.floor(a/(Math.PI/u));for(n=1;n<=s;n++)if(r(e,n)){for(o=n,i=2;i*n<=s;i++)r(e,i*n)||(o=void 0);if(o)break}return o?o*(Math.PI/u):null}function c(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function C(e,t){return t.map=c,T(e,t)}function k(t,e){if(e.max<e.min)return{segments:[],resolved:!0};var r,n=new a.default(e),i=e.min,o=t(i);return isFinite(o[0])&&isFinite(o[1])&&n.addPoint(o),function(e,t){for(var r=e.min,n=e.max,i=e.step,o=n-r,a=Math.ceil(o/i),s=o/a,l=0;l<a;l++)t(r+l*s);t(n)}(e,function(e){r=t(e),_(t,i,o,e,r,10,n),i=e,o=r}),n.finish()}function _(e,t,r,n,i,o,a){if(n!==t){var s=a.xtolerance,l=a.ytolerance,c=b.mean(t,n),u=e(c),p=isFinite(r[0])&&isFinite(r[1]),d=isFinite(i[0])&&isFinite(i[1]),h=isFinite(u[0])&&isFinite(u[1]);if(0===o||c===t||c===n)return a.breakSegment(),void(d&&a.addPoint(i));if(p||d){if(p!==d){for(var f=t,g=n,m=r,y=i;t!==c&&c!==n;)h==p?(t=c,r=u,p=h):(n=c,i=u,d=h),u=e(c=t+(n-t)/2),h=isFinite(u[0])&&isFinite(u[1]);return void(p?(_(e,f,m,t,r,o-1,a),a.breakSegment()):(a.breakSegment(),a.addPoint(i),_(e,n,i,g,y,o-1,a)))}if(p&&h&&d){var v=b.pointToSegmentParameter(u[0],u[1],r[0],r[1],i[0],i[1]);if(.2<v&&v<.8&&Math.abs(u[0]-(r[0]+v*(i[0]-r[0])))<=s&&Math.abs(u[1]-(r[1]+v*(i[1]-r[1])))<=l)return void a.addPoint(i)}r[0]===u[0]&&r[1]===u[1]||_(e,t,r,c,u,o-1,a),i[0]===u[0]&&i[1]===u[1]||_(e,c,u,n,i,o-1,a)}}}function P(e,t,r){var n,i,o=e.viewport.xmin,a=e.viewport.xmax,s=e.viewport.ymin,l=e.viewport.ymax,c=e.trigAngleMultiplier||1,u=e.oversample||4,p=1/u*(a-o)/e.screen.width,d=1/u*(l-s)/e.screen.height,h=t.domainBound;switch(t.graphMode){case M.X:switch((n=v.intersectDomains(v.knownDomain([s,l]),h)).type){case"empty":return!1;case"known":s=n.bounds[0],l=n.bounds[1]}i={min:s,max:l,xtolerance:d,ytolerance:p,step:d};break;case M.Y:switch((n=v.intersectDomains(v.knownDomain([o,a]),h)).type){case"empty":return!1;case"known":o=n.bounds[0],a=n.bounds[1]}i={min:o,max:a,xtolerance:p,ytolerance:d,step:p};break;case M.POLAR:if(!t.domain)throw new Error("Expected polar graph to have domain");if(i={min:t.domain.min,max:t.domain.max,step:2*Math.PI/c/1e3,tolerance:Math.min(p,d)},!t.domain.isExplicit){var f=w(r,i,c,"="===t.operator);f&&(i.max=i.min+f)}i.step=Math.max(i.step,(i.max-i.min)/11999);break;case M.PARAMETRIC:var g=t.domain?t.domain.min:0,m=t.domain?t.domain.max:1,y=t.domain?t.domain.step:.01;switch((n=v.intersectDomains(v.knownDomain([g,m]),h)).type){case"empty":return!1;case"known":g=n.bounds[0],m=n.bounds[1]}i={min:g,max:m,step:y,xtolerance:p,ytolerance:d};break;case M.IMPLICIT:i={xmin:o,xmax:a,ymin:s,ymax:l,xtolerance:p,ytolerance:d};break;default:return!1}return i}function d(e,t,r){var n,i,o,a,s=[],l=null;switch(r){case M.POLAR:l=c;break;case M.X:l=function(e){return[e[1],e[0]]}}for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i+=2)o=[a[i],a[i+1]],l&&(o=l(o)),s.push(o[0],o[1]);for(n=t.length-1;0<=n;n--)for(i=(a=t[n]).length-2;0<=i;i-=2)o=[a[i],a[i+1]],l&&(o=l(o)),s.push(o[0],o[1]);return s}Object.defineProperty(t,"__esModule",{value:!0});var S=function(e,t,r){var n=r.fn,i=r.jumpTolerance,o=r.accumulator;if(!isFinite(i)||i<=0)return t;var a=y(e,t,r);if(!a)return t;for(var s=(t[0]-e[0])/10,l=[-s,s],c=t,u=0;u<l.length;u++){var p=e[0]+l[u],d=n(p);isFinite(d)||(p=e[0],d=e[1],p=e[0],d=e[1]);var h=t[0]+l[u],f=n(h);if(isFinite(f)?c=[h,f]:(h=t[0],f=t[1]),y([p,d],[h,f],r)){var g=a[0],m=a[1];return o.addPoint(g),o.breakSegment(),o.addPoint(m),t}}return c},D=function(e,t,r){this.derivative=r,this.accumulator=new o.default(t,e,r),this.fn=e,this.jumpTolerance=t.ytolerance||t.tolerance||0};t.default={sampleXYNaive:function(e,t){for(var r,n=new o.default(t,e),i=t.min;i<=t.max+t.step/2;i+=t.step)r=e(i),isFinite(r)?n.addPoint([i,r]):n.breakSegment();return n.finish()},sampleLinear:I,sampleXY:T,findPiPeriod:w,samplePolar:C,sampleParametricRecursive:k,subsampleParametricRecursive:_,validateViewState:function(e){if(!e)return!1;var t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t||!isFinite(n)||!isFinite(i)||i<=n||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)},computeDomain:P,computeGraphData:function(e,t,r,n){var i,o,a,s,l,c,u,p,d,h,f,g,m=r.fn,y=P(e,t,m),v=t.graphMode;if(y){switch(v){case M.X:case M.Y:var b=n?n.fn:void 0;i=t.isLinear?I(t.linearCoefficients,y):T(m,y,b);break;case M.POLAR:i=C(m,y);break;case M.IMPLICIT:i=E.sampleImplicit(m,y);break;case M.PARAMETRIC:y.step||(y.step=(y.max-y.min)/1e3),i=y.max===y.min?(p=m,d=y.min,h=p(d),f=h[0],g=h[1],{segments:[[f,g,f,g]],resolved:!0}):t.isLinear?(s=t.linearCoefficients,l=y,c=I(s[0],l),u=I(s[1],l),c.segments.length&&u.segments.length&&4===c.segments[0].length&&4===u.segments[0].length?{segments:[[c.segments[0][1],u.segments[0][1],c.segments[0][3],u.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}):k(m,y);break;default:throw new Error("Programming Error: unexpected graphmode "+v)}a=i.poi}else i={segments:[],resolved:!0};if((!a||250<a.zeros.x.length+a.extrema.x.length+a.intercept.x.length)&&(a={zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}),v===M.X)for(var x in a)if(a.hasOwnProperty(x)){var w=x;o=a[w].y,a[w].y=a[w].x,a[w].x=o}var _={segments:i.segments,resolved:i.resolved,graphMode:v,color:t.color,style:t.lineStyle,operator:t.operator,poi:a,compiled:r};if(v===M.POLAR){var S=y;_.sampledDomain={min:S.min,max:S.max,step:S.step}}return i.fillSegments&&(_.fillSegments=i.fillSegments),_},polygonsFromSegments:function(e,t,r){for(var n=function(e){var t=e[e.length-1];return t[t.length-2]},i=[],o=0,a=0,s=[],l=[],c=-1/0,u=-1/0;;){if(c<=u){if(o>=t.length)break;l.push(t[o++])}if(u<=c){if(a>=e.length)break;s.push(e[a++])}if(c=n(l),u=n(s),b.approx(c,u,4)){i.push(d(s,l,r)),l=[],s=[];var p=Math.max(c,u);u=c=p}}return i}}}),define("math/expression-types",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.X_OR_Y="X_OR_Y",n.SINGLE_POINT="SINGLE_POINT",n.POINT_LIST="POINT_LIST",n.PARAMETRIC="PARAMETRIC",n.POLAR="POLAR",n.IMPLICIT="IMPLICIT",n.POLYGON="POLYGON",n.HISTOGRAM="HISTOGRAM",n.DOTPLOT="DOTPLOT",n.BOXPLOT="BOXPLOT",n.EXPRESSION_PROP_DEFAULTS={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!1,fill:!1},DOTPLOT:{points:!1,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!1,fill:!1}},n.getReconciledExpressionProps=function(e,t){if(void 0===e)return{points:!1,lines:!1,fill:!1};switch(e){case n.X_OR_Y:case n.SINGLE_POINT:case n.POINT_LIST:case n.PARAMETRIC:case n.POLAR:case n.IMPLICIT:case n.POLYGON:case n.HISTOGRAM:case n.DOTPLOT:case n.BOXPLOT:var r=n.EXPRESSION_PROP_DEFAULTS[e];return{points:void 0===t.points?r.points:t.points,lines:void 0===t.lines?r.lines:t.lines,fill:void 0===t.fill?r.fill:t.fill};default:return e}}}),define("math/features/graph",["require","underscore","parsenodes","math/plotter","graphing/graphmode","math/comparators","graphing/dragmode","math/expression-types","lib/deepCopy","math/domaintypes","math/builtin"],function(e){function k(e){for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}}function m(e){for(var t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s+=2){var l=a[s],c=a[s+1];l<t&&(t=l),r<l&&(r=l),c<n&&(n=c),i<c&&(i=c)}if(isFinite(t)&&isFinite(n)){if(t===r&&(t=Math.min(0,t),r=Math.max(0,r)),n===i&&(n=Math.min(0,n),i=Math.max(0,i)),t===r||n===i)return;return{xmin:t,ymin:n,xmax:r,ymax:i}}}function P(e){return Array.prototype.concat.apply([],e)}var b=e("underscore"),x=e("parsenodes"),w=e("math/plotter").default,D=e("graphing/graphmode"),y=e("math/comparators"),A=e("graphing/dragmode"),c=e("math/expression-types"),h=x.List,_=e("lib/deepCopy").default,S=e("math/domaintypes"),v=e("math/builtin");x.Base.prototype._graph=function(f,e,g,m){if(e instanceof x.SolvedEquation)return this._graph(f,e._expression,g,m);var n,y,t,r,i,v=this,o=e.getExpressionType(m.graphMode,e.valueType),a=c.getReconciledExpressionProps(o,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill});switch(m.graphMode){case D.XYPOINT_MOVABLE:return n=[e.asArray()],t=this.userData.shouldGraph&&a.points,i=this.userData.showLabel&&!t,t?[{segments:[n],graphMode:m.graphMode,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,labels:this.computedLabels||[],poi:k(n)}]:i?[{segments:[n],graphMode:D.XYPOINT,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,labels:this.computedLabels||[],poi:k(n)}]:[];case D.XYPOINT:return y=[],n=h.wrap(e).mapElements(function(e){return e.asArray()}),t=this.userData.shouldGraph&&a.points,r=this.userData.shouldGraph&&a.lines,i=this.userData.showLabel&&!t&&!r,(this.userData.showLabel||t)&&y.push({segments:[n],graphMode:m.graphMode,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:t,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,nakedLabel:i,labels:this.computedLabels||[],poi:k(n)}),r&&y.push({segments:[n].map(P),graphMode:D.PARAMETRIC,color:this.userData.color,style:this.userData.lineStyle,poi:[]}),y;case D.PARAMETRIC:var s=this.userData,l=[];if(y=h.wrap(e).mapElements(function(e){if(0===e.getDependencies().length)return{segments:[n=[e.asArray()]],graphMode:D.XYPOINT,color:s.color,style:s.lineStyle,poi:k(n)};var t=e.getCompiledFunction(),r=v.getGraphInfo(f,e);return r.graphMode=m.graphMode,r.domain={min:v.metaData.evaluatedDomainMin,max:v.metaData.evaluatedDomainMax},r.style=v.userData.lineStyle,w.computeGraphData(g,r,t)}),a.fill){if(y.forEach(function(e){l.push({segments:e.segments,color:s.color,fillOpacity:s.fillOpacity,graphMode:D.POLYGONFILL,poi:[]})}),!a.lines)return l;y=y.concat(l)}return y;case D.X:case D.Y:case D.IMPLICIT:case D.POLAR:return y=[],h.wrap(e).eachElement(function(e){var t,r=m.graphMode===D.IMPLICIT?e.getCompiledFunction(["x","y"]):e.getCompiledFunction();try{t=e.getCompiledDerivative()}catch(e){}var n=v.getGraphInfo(f,e);n.graphMode=m.graphMode,n.style=v.userData.lineStyle,m.graphMode===D.POLAR&&(n.domain={min:v.metaData.evaluatedDomainMin,max:v.metaData.evaluatedDomainMax,isExplicit:v.metaData.isExplicitDomain});var i=w.computeGraphData(g,n,r,t);i.fillSegments?y.push(b.omit(i,"fillSegments")):y.push(i),n.graphMode===D.IMPLICIT&&"="!==n.operator&&y.push({graphMode:D.POLYGONFILL,segments:i.fillSegments,poi:{}});var o=v.metaData.evaluatedCDFMin,a=v.metaData.evaluatedCDFMax;if(!isNaN(o)&&!isNaN(a)){var s=_(n);if(s.domainBound=S.intersectDomains(n.domainBound,S.knownDomain([o,a])),"known"===s.domainBound.type){var l=w.computeGraphData(g,s,r,t);if(l.segments.length){var c,u,p,d;for(c=0;c<l.segments.length;c++)if(4<=(u=l.segments[c]).length){p=u[0];break}for(c=l.segments.length-1;0<=c;c--)if(4<=(u=l.segments[c]).length){d=u[u.length-2];break}if(isFinite(p)&&isFinite(d)){var h=w.polygonsFromSegments(l.segments,[[p,0,d,0]],l.graphMode);y.push({graphMode:D.POLYGONFILL,segments:h,poi:{}})}}}}}),y;default:return!1}},x.Base.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t);return this._graph(e,t,r,n)},x.BaseComparator.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t),i=n.graphMode;if(i===D.IMPLICIT||i===D.POLAR)return this._graph(e,t,r,n);if(i===D.NONE)return!1;if(!(t instanceof x.SolvedEquation))return!1;var o=this.getOperator(),a=[],s=[],l=!0;t._expression.eachElement(function(e){a.push(e.getCompiledFunction());try{s.push(e.getCompiledDerivative())}catch(e){l=!1}}),l||(s=void 0);var c,u,p=[],d=[-1,0,0,1],h=a.length;for(u=0;u<h;u++){var f=this.getGraphInfo(e,t._expression.args[u]);f.graphMode=i,f.style=this.userData.lineStyle,(c=w.computeGraphData(r,f,a[u],s?s[u]:void 0)).operator=y.get(y.table[o].inclusive,d[u%4]),p.push(c)}for(u=0;u<h;u+=4){var g=w.polygonsFromSegments(p[u+1].segments,p[u+2].segments,i);p.push({graphMode:D.POLYGONFILL,segments:g,poi:{}})}return p},x.DoubleInequality.prototype.graph=function(i,e,o){var a=this.getGraphInfo(i,e);if(a.graphMode===D.NONE)return!1;var s=[],l=y.get(y.table[this._operators[0]].inclusive,0),c=y.get(y.table[this._operators[1]].inclusive,0),u=this.userData,p=this.metaData,d=this;return h.eachArgs(e._expressions,function(e){var t,r;e[0].userData=e[1].userData=u,e[0].metaData=e[1].metaData=p,(t=d._graph(i,e[0],o,a)[0]).operator=l,s.push(t),(r=d._graph(i,e[1],o,a)[0]).operator=c,s.push(r);var n=w.polygonsFromSegments(t.segments,r.segments,t.graphMode);s.push({graphMode:D.POLYGONFILL,segments:n,poi:{}})}),s},x.Regression.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)},x.Polygon.prototype.graph=function(e,t,r){for(var n=this.getGraphInfo(e,t),i=t.args[0].asValue(),o=[],a=void 0===this.userData.lines||this.userData.lines,s=void 0===this.userData.fill||this.userData.fill,l=[],c=[],u=0;u<i.length;u++){var p=i[u][0],d=i[u][1];isFinite(p)&&isFinite(d)?(a||s)&&c.push([p,d]):(a||s)&&(1<c.length&&l.push(c),c=[])}if(l.length||c.length){c.push([i[0][0],i[0][1]]),l.push(c);var h=l.map(P);s&&o.push({segments:h,graphMode:D.POLYGONFILL,poi:[],color:n.color,fillOpacity:this.userData.fillOpacity,style:n.style}),a&&o.push({segments:h,graphMode:D.PARAMETRIC,poi:[],color:n.color,style:this.userData.lineStyle})}return o},x.Histogram.prototype.graph=function(e,t,r){for(var n,i=this.getGraphInfo(e,t),o={},a=t.args[1]?t.args[1].asValue():1,s=t.args[2]?t.args[2].asValue():0,l=t.args[0].asValue(),c=l.length-1;0<=c;c--){var u=l[c];o[n=Math.floor((u-s)/a)]?o[n].count+=1:o[n]={id:n,count:1,min:n*a+s,max:n*a+s+a}}var p=[],d=[];for(n in o){var h=o[n];d.push([h.min,0,h.min,h.count,h.max,h.count,h.max,0]);var f=0;o[h.id+1]&&(f=o[h.id+1].count),p.push([h.min,0,h.min,h.count,h.max,h.count,h.max,f])}return[{segments:d,graphMode:D.POLYGONFILL,boundingBox:m(d),poi:[],color:i.color,fillOpacity:.4},{segments:p,graphMode:D.Y,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:i.color}]},x.DotPlot.prototype.graph=function(e,t,r){var n,i,o=this.getGraphInfo(e,t),a={},s=t.args[1]?t.args[1].asValue():1,l=t.args[2]?t.args[2].asValue():0,c=t.args[0].asValue(),u=[];for(n=0;n<c.length;n++){var p=c[n];a[i=Math.floor((p-l)/s)]?a[i].push(p):a[i]=[p]}for(i in a){var d=a[i];for(d.sort(),n=0;n<d.length;n++)u.push([d[n],n+1])}return[{segments:[u],graphMode:D.XYPOINT,boundingBox:m(u),poi:k(u),color:o.color,showPoint:!0}]},x.BoxPlot.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t),i=t.args[1]?t.args[1].asValue():3,o=t.args[2]?t.args[2].asValue():4,a=t.args[0].asValue(),s=Math.min.apply(null,a),l=Math.max.apply(null,a),c=v.quartile(a,1),u=v.quartile(a,2),p=v.quartile(a,3),d=i-o/2,h=i+o/2,f=o/10,g=[[c,d,p,d,p,h,c,h,c,d],[u,d,u,h],[c,i,s,i],[p,i,l,i],[s,i-f,s,i+f],[l,i-f,l,i+f]];return[{segments:g,graphMode:D.PARAMETRIC,boundingBox:m(g),poi:[],color:n.color}]},x.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;var n=this.columns[t].values,i=n&&n[r];return!(!i||!isFinite(i.asValue())||0!==i._dependencies.length)},x.Table.prototype.graph=function(e,t,r){var n=[];if(t.columns[0].isError)return n;for(var i=t.columns[0],o=i.values,a=1;a<this.columns.length;a++){var s=t.columns[a];if(!s.isError){var l=this.columns[a].header.userData;if(!l.hidden){for(var c=l.dragMode,u=c===A.X||c===A.XY,p=c===A.Y||c===A.XY,d=!!l.points,h=!!l.lines,f=s.isDiscrete(i),g=h&&f,m=h&&!f,y=[],v=[],b=[],x=[],w=[],_=[],S=0;S<o.length;S++){var E=o[S],M=s.values[S];if(E&&M&&isFinite(E.asValue())&&isFinite(M.asValue())){if(d){var I=u&&this.isValueDraggable(t,0,S),T=p&&this.isValueDraggable(t,a,S);I||T?(b.push([E.asValue(),M.asValue()]),x.push({index:S,dragX:I,dragY:T})):v.push([E.asValue(),M.asValue()])}g&&_.push([E.asValue(),M.asValue()])}else g&&(1<_.length&&w.push(_),_=[])}if(b.length&&y.push({graphMode:D.XYPOINT_MOVABLE,segments:[b],color:l.color,tableId:l.tableId,poi:k(b),movablePointInfo:x}),v.length&&y.push({segments:[v],graphMode:D.XYPOINT,showPoint:!0,poi:k(v),color:l.color,style:l.pointStyle}),(w.length||_.length)&&(w.push(_),y.push({segments:w.map(P),graphMode:D.PARAMETRIC,poi:[],color:l.color,style:l.lineStyle})),m){var C=this.columns[a].header.graph(e,t.columns[a].header,r);C.length&&Array.prototype.push.apply(y,C)}y.length&&(n[l.id]=y)}}}return n},x.Image.prototype.graph=function(e,t,r){var n,i,o,a=[];if(!("OrderedPair"===t.center.type&&t.center.args[0].isConstant&&t.center.args[1].isConstant&&t.radianAngle.isConstant&&t.width.isConstant&&t.height.isConstant))return a;for(var s=[],l=[],c=t.width.asValue()/2,u=t.height.asValue()/2,p=t.radianAngle.asValue(),d=-1;d<=1;d++)for(var h=-1;h<=1;h++){var f=[t.center.args[0].asValue()+d*c*Math.cos(p)+h*u*Math.sin(p),t.center.args[1].asValue()-d*c*Math.sin(p)+h*u*Math.cos(p)];(n=t.moveStrategy,i=d,o=h,!!n&&(0===i&&0===o?"none"!==n[2].type||"none"!==n[3].type:0!==i&&0!==o?"none"!==n[0].type&&"none"!==n[1].type:0!==i?"none"!==n[0].type:0!==o&&"none"!==n[1].type))&&(s.push(f),l.push([d,h]))}return a.push({segments:[s],scaleFactors:[l],graphMode:D.XYPOINT_MOVABLE,color:this.userData.color,style:this.userData.style,poi:k(s)}),a}}),define("math/features/elementAt",["require","parsenodes","math/builtinframe"],function(e){function t(e){for(var t=0;t<this.length;t++)e(this.elementAt(t))}function r(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r)));return t}var n=e("parsenodes"),i=e("math/builtinframe");n.List.prototype.elementAt=function(e){return 0<=(e=Math.floor(e))&&e<this.args.length?this.args[e]:n.Constant(NaN)},n.Broadcast.prototype.elementAt=function(e){if((e=Math.floor(e))<0||e>=this.length)return n.Constant(NaN);for(var t={},r=0;r<this._replacedSymbols.length;r++)t[this._replacedSymbols[r]]=this._lists[r].elementAt(e);return this._expression.substitute(t).getConcreteTree(i)},n.List.prototype.eachElement=t,n.Broadcast.prototype.eachElement=t,n.List.prototype.mapElements=r,n.Broadcast.prototype.mapElements=r,n.OrderedPair.prototype.elementAt=function(e){switch(e){case 0:return this.args[0];case 1:return this.args[1];default:return n.Constant(NaN)}}}),define("math/features/printLatex",["require","parsenodes","graphing/label","lib/number-to-latex"],function(e){function t(){return s.identifierToLatex(this._symbol)+" "}function r(e){switch(e){case">":return"\\gt ";case"<":return"\\lt ";case">=":return"\\ge ";case"<=":return"\\le ";case"=":return"="}}function n(e){return e.printLatex()}function i(){switch(this._symbol){case"sqrt":return"\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\log_{"+this.args[1].printLatex()+"}\\left("+this.args[0].printLatex()+"\\right)";default:return s.identifierToLatex(this._symbol)+"\\left("+this.args.map(n).join(", ")+"\\right)"}}function o(e){return e.isConstant&&!0===e.asValue()}var a=e("parsenodes"),s=e("graphing/label"),l=e("lib/number-to-latex").default;a.Identifier.prototype.printLatex=t,a.FreeVariable.prototype.printLatex=t,a.Constant.prototype.printLatex=function(){return l(this.asValue())},a.Negative.prototype.printLatex=function(){return"-\\left("+this.args[0].printLatex()+"\\right)"},a.Add.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)+\\left("+this.args[1].printLatex()+"\\right)"},a.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\% \\operatorname{of} "+this.args[1].printLatex()},a.Subtract.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)-\\left("+this.args[1].printLatex()+"\\right)"},a.Multiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)*\\left("+this.args[1].printLatex()+"\\right)"},a.Divide.prototype.printLatex=function(){return"\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"},a.Exponent.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)^{"+this.args[1].printLatex()+"}"},a.Assignment.prototype.printLatex=function(){return s.identifierToLatex(this._symbol)+"="+this._expression.printLatex()},a.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()},a.BaseComparator.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+r(this.operator)+"\\left("+this.args[1].printLatex()+"\\right)"},a.DoubleInequality.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+r(this.args[1])+this.args[2].printLatex()+r(this.args[3])+"\\left("+this.args[4].printLatex()+"\\right)"},a.And.prototype.printLatex=function(){if(!(this.args[0]instanceof a.BaseComparator&&this.args[1]instanceof a.BaseComparator))throw new Error("Not implemented");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error("Not implemented");return"\\left("+this.args[0].args[0].printLatex()+"\\right)"+r(this.args[0].operator)+"\\left("+this.args[0].args[1].printLatex()+"\\right)"+r(this.args[1].operator)+"\\left("+this.args[1].args[1].printLatex()+"\\right)"},a.NativeFunction.prototype.printLatex=i,a.TypedFunction.prototype.printLatex=i,a.ReducerFunction.prototype.printLatex=i,a.ParametrizedReducerFunction.prototype.printLatex=i,a.DoubleReducerFunction.prototype.printLatex=i,a.FunctionCall.prototype.printLatex=i,a.Distribution.prototype.printLatex=i,a.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("'")+"\\left("+this.args[0].args[0].printLatex()+"\\right)";default:return s.identifierToLatex(this.args[0]._symbol)+Array(this.order+1).join("'")+"\\left("+this.args[0].args.map(n).join(", ")+"\\right)"}},a.List.prototype.printLatex=function(){return"\\left["+this.args.map(n).join(", ")+"\\right]"},a.Range.prototype.printLatex=function(){return"\\left["+this.args[0].args.map(n).join(", ")+" ... "+this.args[1].args.map(n).join(", ")+"\\right]"},a.ListAccess.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\left["+this.args[1].printLatex()+"\\right]"},a.OrderedPair.prototype.printLatex=function(){return"\\left("+this.args.map(n).join(", ")+"\\right)"},a.Sum.prototype.printLatex=function(){return"\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"},a.Product.prototype.printLatex=function(){return"\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"},a.Integral.prototype.printLatex=function(){return"\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)d"+this.args[0].printLatex()},a.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)^{"+this.args[2].printLatex()+"}"},a.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)!"},a.Piecewise.prototype.printLatex=function(){var e,t=this;if(o(t.args[0]))return t.args[1].printLatex();for(var r=["\\left\\{"];;){if(o(t.args[0])){r.push(t.args[1].printLatex());break}if(r.push(t.args[0].printLatex(),": "),(e=t.args[2]).isConstant&&e.isNaN()){r.push(t.args[1].printLatex());break}if(r.push(t.args[1].printLatex(),", "),!(t.args[2]instanceof a.Piecewise)){r.push(t.args[2].printLatex());break}t=t.args[2]}return r.push("\\right\\}"),r.join("")},a.FunctionDefinition.prototype.printLatex=function(){return s.identifierToLatex(this._symbol)+"\\left("+this._argSymbols.map(s.identifierToLatex).join(", ")+"\\right) = "+this._expression.printLatex()},a.Derivative.prototype.printLatex=function(){return"\\frac{d}{d"+s.identifierToLatex(this._symbol)+"}\\left("+this.args[0].printLatex()+"\\right)"},a.Regression.prototype.printLatex=function(){return"\\left("+this._lhs.printLatex()+"\\right)\\sim\\left("+this._rhs.printLatex()+"\\right)"},a.Polygon.prototype.printLatex=function(){return"\\polygon\\left("+this.args.map(n).join(", ")+"\\right)"},a.Histogram.prototype.printLatex=function(){return"\\histogram\\left("+this.args.map(n).join(", ")+"\\right)"},a.DotPlot.prototype.printLatex=function(){return"\\dotplot\\left("+this.args.map(n).join(", ")+"\\right)"},a.BoxPlot.prototype.printLatex=function(){return"\\boxplot\\left("+this.args.map(n).join(", ")+"\\right)"}}),define("math/features/statistics",["require","parsenodes","math/maybe-rational"],function(e){var r=e("parsenodes"),n=r.BuiltInFunction,t=e("math/maybe-rational").maybeRational,i=r.Constant(t(0,1)),o=r.Constant(t(1,1)),a=r.Constant(t(2,1)),s=r.Constant(-1/0);n.normdist.prototype.pdf=function(e){return n.normalpdf([e[0],this.args[0],this.args[1]])},n.normdist.prototype.cdf=function(e){var t,r;return r=1===e.length?(t=s,e[0]):(t=e[0],e[1]),n.normalcdf([t,r,this.args[0],this.args[1]])},n.normdist.prototype.mean=function(){return this.args[0]},n.normdist.prototype.median=function(){return this.args[0]},n.normdist.prototype.stdev=function(){return n.abs([this.args[1]])},n.normdist.prototype.var=function(){return r.Exponent([this.args[1],a])},n.normdist.prototype.quantile=function(e){return r.Divide([r.Add([n.invNorm(e),this.args[0]]),this.args[1]])},n.tdist.prototype.pdf=function(e){return n.tpdf([e[0],this.args[0]])},n.tdist.prototype.cdf=function(e){var t,r;return r=1===e.length?(t=s,e[0]):(t=e[0],e[1]),n.tcdf([t,r,this.args[0]])},n.tdist.prototype.mean=function(){return i},n.tdist.prototype.median=function(){return i},n.tdist.prototype.quantile=function(e){return n.invT([e[0],this.args[0]])},n.tdist.prototype.stdev=function(){return n.sqrt([this.var()])},n.tdist.prototype.var=function(){var e=this.args[0];return r.Piecewise([r.Comparator[">="]([e,a]),r.Divide([e,r.Subtract([e,a])]),r.Constant(NaN)])},n.poissondist.prototype.pdf=function(e){return n.poissonpdf([e[0],this.args[0]])},n.poissondist.prototype.cdf=function(e){var t,r;return r=1===e.length?(t=s,e[0]):(t=e[0],e[1]),n.poissoncdf([t,r,this.args[0]])},n.poissondist.prototype.mean=function(){return this.args[0]},n.poissondist.prototype.stdev=function(){return n.sqrt([this.args[0]])},n.poissondist.prototype.var=function(){return this.args[0]},n.poissondist.prototype.quantile=function(e){return n.invPoisson([e[0],this.args[0]])},n.binomdist.prototype.pdf=function(e){return n.binompdf([e[0],this.args[0],this.args[1]])},n.binomdist.prototype.cdf=function(e){var t,r;return r=1===e.length?(t=s,e[0]):(t=e[0],e[1]),n.binomcdf([t,r,this.args[0],this.args[1]])},n.binomdist.prototype.mean=function(){return r.Multiply([this.args[0],this.args[1]])},n.binomdist.prototype.stdev=function(){return n.sqrt([this.var()])},n.binomdist.prototype.var=function(){var e=this.args[0],t=this.args[1];return r.Multiply([e,r.Multiply([t,r.Subtract([o,t])])])},n.binomdist.prototype.quantile=function(e){return n.invBinom([e[0],this.args[0],this.args[1]])}}),define("math/features/getExpressionType",["require","parsenodes","graphing/graphmode","math/expression-types","math/types"],function(e){var t=e("parsenodes"),r=e("graphing/graphmode"),n=e("math/expression-types"),i=e("math/types");t.Base.prototype.getExpressionType=function(e,t){return e===r.X||e===r.Y?n.X_OR_Y:e===r.XYPOINT||e===r.XYPOINT_MOVABLE?t===i.Point?n.SINGLE_POINT:n.POINT_LIST:e===r.PARAMETRIC?n.PARAMETRIC:e===r.POLAR?n.POLAR:e===r.IMPLICIT?n.IMPLICIT:n.X_OR_Y},t.Polygon.prototype.getExpressionType=function(e,t){return n.POLYGON},t.Histogram.prototype.getExpressionType=function(e,t){return n.HISTOGRAM},t.DotPlot.prototype.getExpressionType=function(e,t){return n.DOTPLOT},t.BoxPlot.prototype.getExpressionType=function(e,t){return n.BOXPLOT}}),define("parser",["require","math/baseparser","math/features/getConcreteTree","math/features/getValueType","math/features/typeCheck","math/features/repr","math/features/scalarEvalExpression","math/features/constantcollapsedcopy","math/features/polynomialorder","math/features/polynomialcoefficients","math/features/extractconditions","math/features/piecewiseDependsOn","math/features/bounddomain","math/features/derivative","math/features/substitute","math/features/solve","math/features/analyze","math/features/analyzeFourFunction","math/features/analyzeScientific","math/features/analyzeSingleExpressionScientific","math/features/getgraphmode","math/features/getgraphinfo","math/features/getMoveStrategy","math/features/getDefaultDragMode","math/features/tableinfo","math/features/tableerror","math/features/islinear","math/features/graph","math/features/elementAt","math/features/printLatex","math/features/statistics","math/features/getExpressionType"],function(e){var t=e("math/baseparser");return e("math/features/getConcreteTree"),e("math/features/getValueType"),e("math/features/typeCheck"),e("math/features/repr"),e("math/features/scalarEvalExpression"),e("math/features/constantcollapsedcopy"),e("math/features/polynomialorder"),e("math/features/polynomialcoefficients"),e("math/features/extractconditions"),e("math/features/piecewiseDependsOn"),e("math/features/bounddomain"),e("math/features/derivative"),e("math/features/substitute"),e("math/features/solve"),e("math/features/analyze"),e("math/features/analyzeFourFunction"),e("math/features/analyzeScientific"),e("math/features/analyzeSingleExpressionScientific"),e("math/features/getgraphmode"),e("math/features/getgraphinfo"),e("math/features/getMoveStrategy"),e("math/features/getDefaultDragMode"),e("math/features/tableinfo"),e("math/features/tableerror"),e("math/features/islinear"),e("math/features/graph"),e("math/features/elementAt"),e("math/features/printLatex"),e("math/features/statistics"),e("math/features/getExpressionType"),t}),define("lib/evaluate-single-expression",["require","exports","parser","math/builtinframe","math/parsenode/constant"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/.test(e))return parseFloat(e);var r=Object.create(i);return r.trigAngleMultiplier=o(t?Math.PI/180:1),+n.parse(e).tryGetConcreteTree(r).asValue()}}),define("migrations/6",["require","lib/deepCopy","graphing/columnmode","expressions/styles","expressions/opacity","main/label-sizes","main/label-orientations","./legacy-interpolated-label-parser","underscore","math/sliders","lib/evaluate-single-expression"],function(e){function c(e){var t={};for(var r in e)if(e.hasOwnProperty(r)&&"style"!==r)if("values"===r&&(t[r]=e[r].map(function(e){return e?""+e:""})),"columnMode"!==r||e.hasOwnProperty("points")||e.hasOwnProperty("lines"))t[r]=e[r];else switch(e[r]){case n.LINES:t.points=!1,t.lines=!0;break;case n.POINTS_AND_LINES:t.points=!0,t.lines=!0;break;default:t.points=!0,t.lines=!1}return t.hasOwnProperty("pointStyle")||(t.pointStyle=d.POINT),t.hasOwnProperty("lineStyle")||(t.lineStyle=d.SOLID),t.id=""+t.id,t}function u(e){var t=i.parse(e),r="";return m.each(t.parts,function(e){r+="object"==typeof e&&e.str?"$"+e.str:e}),r}function l(e,t,r,n){var i,o=e.type,a={};switch(o){case"folder":for(i in e)e.hasOwnProperty(i)&&("memberIds"===i||(a[i]=e[i]));break;case"expression":for(i in e)if(e.hasOwnProperty(i))if("style"!==i||e.hasOwnProperty("pointStyle")||e.hasOwnProperty("lineStyle"))b.hasOwnProperty(i)?(a.slider=a.slider||{},a.slider[b[i]]=e[i]):a[i]=e[i],e.label&&(a.label=u(e.label));else{var s=e[i];m.contains([d.POINT,d.OPEN,d.CROSS],s)?(a.pointStyle=s,a.lineStyle=d.SOLID):m.contains([d.SOLID,d.DASHED,d.DOTTED],s)?(a.pointStyle=d.POINT,a.lineStyle=s):(a.pointStyle=d.POINT,a.lineStyle=d.SOLID)}a.latex&&a.slider&&!a.slider.isPlaying&&function(e,t){var r=e.latex.split("=");if(2===r.length){var n=v(r[1]);if(isFinite(n)){var i=e.slider.hardMin?v(e.slider.min||"-10",t):void 0,o=e.slider.hardMax?v(e.slider.max||"10",t):void 0,a=e.slider.step?v(e.slider.step,t):void 0,s=y.determineWhichLimitsAreCompatibleWithValue({target:n,step:a,hardMin:i,hardMax:o});s.min||(delete e.slider.hardMin,delete e.slider.min),s.max||(delete e.slider.hardMax,delete e.slider.max),s.step||delete e.slider.step}}}(a,n),a.hasOwnProperty("fillOpacity")||(a.fillOpacity=h.DEFAULT),!1===a.label&&(a.label=""),a.labelSize||(a.labelSize=f.MEDIUM),a.labelOrientation||(a.labelOrientation=g.DEFAULT),a.verticalLabel||(a.verticalLabel=!1);break;case"image":for(i in e)e.hasOwnProperty(i)&&"x"!==i&&"y"!==i&&(a[i]=e[i]);a.center="\\left("+(e.x||"0")+","+(e.y||"0")+"\\right)",a.angle=e.angle||"0",a.foreground=!!a.foreground;break;case"text":for(i in e)e.hasOwnProperty(i)&&(a[i]=e[i]);break;case"table":for(i in e)e.hasOwnProperty(i)&&(a[i]="columns"===i?e[i].map(c):e[i]);break;default:throw new Error("Unexpected expression type: "+o)}if(a.id=""+a.id,"folder"===e.type)t.folderId=a.id,t.memberIds=e.memberIds,a.folderId="";else{var l=r[a.id];t.memberIds&&t.memberIds[l]?a.folderId=t.folderId:(a.folderId="",t.folderId=void 0,t.memberIds=void 0)}return a}var p=e("lib/deepCopy").default,n=e("graphing/columnmode"),d=e("expressions/styles"),h=e("expressions/opacity"),f=e("main/label-sizes"),g=e("main/label-orientations"),i=e("./legacy-interpolated-label-parser"),m=e("underscore"),y=e("math/sliders"),v=e("lib/evaluate-single-expression").default,b={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};return function(e){if(5!==e.version)throw new Error("Unexpected version: "+e.version);var t=!(!e.graph||!e.graph.degreeMode),r=e.expressions.list,n=-1,i={},o={},a={},s={};return s.graph=e.graph,s.expressions={list:r.map(function(e){return i[e.id]?(-1===n&&(n=function(e){for(var t=0,r=/^[0-9]+$/,n=e.length-1;0<=n;n--){var i,o=e[n],a=o.id;if(r.test(a)&&t<(i=parseInt(a,10))&&(t=i),"table"===o.type&&o.columns)for(var s=o.columns.length-1;0<=s;s--)a=o.columns[s].id,r.test(a)&&t<(i=parseInt(a,10))&&(t=i)}return t+1}(r)),o[n]=e.id,(e=p(e)).id=n+"",n+=1):o[e.id]=e.id,i[e.id]=!0,l(e,a,o,t)})},s.version=6,s}}),define("migrations/7",["require","exports","tslib"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(6!==e.version)throw new Error("Unexpected version: "+e.version);var t=e.expressions.list.map(function(e){if("expression"===e.type&&e.domain){var t=r.__assign({},e,{parametricDomain:{min:e.domain.min,max:e.domain.max}});return delete t.domain,t}return e});return{version:7,graph:e.graph,expressions:{list:t}}}}),define("main/migrate_state",["require","console","main/validate-state","migrations/0","migrations/1","migrations/2","migrations/3","migrations/4","migrations/5","migrations/6","migrations/7"],function(e){var t=e("console"),r=e("main/validate-state").validateState,n=[e("migrations/0"),e("migrations/1"),e("migrations/2"),e("migrations/3"),e("migrations/4"),e("migrations/5"),e("migrations/6"),e("migrations/7").default];return{migrations:n,currentVersion:7,migrateToLatest:function(e){if(7<e.version)return t.warn("Loading saved state with version "+e.version+" but last known version is 7. States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),r(e);if(e.hasOwnProperty("version")&&!n[e.version])return t.warn("State has invalid version "+e.version+". If a version is present, it should be a non-negative integer less than or equal to 7."),r(e);for(e.hasOwnProperty("version")||(e=n[0](e));e.version<7;)e=n[e.version+1](e);return r(e)}}}),define("lib/named-colors",["require"],function(e){return{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}}),define("lib/color-distance",["require","underscore","lib/named-colors"],function(e){function x(e){var t,r=[],n=e.toLowerCase();if("rgb"===n.slice(0,3))try{r=n.replace(/[^\d,]/g,"").split(",").slice(0,3),r=s.map(r,function(e){return parseInt(e,10)})}catch(r){i(e)}else if("#"===n[0]){n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/,function(e,t,r,n){return t+t+r+r+n+n});try{r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(n).slice(1),r=s.map(r,function(e){return parseInt(e,16)})}catch(r){i(e)}}else r=l[n];return t=r,!!s.isArray(t)&&3===t.length&&s.every(t,function(e){return Number.isInteger(e)&&0<=e&&e<=255})||i(e),{R:r[0],G:r[1],B:r[2]}}function i(e){throw new Error("Invalid color string: "+e)}function w(e){var t=e.R,r=e.G,n=e.B,i=[];return i[0]=.49*t+.31*r+.2*n,i[1]=.17697*t+.8124*r+.01063*n,i[2]=.01*r+.99*n,{X:(i=s.map(i,function(e){return e/.17697}))[0],Y:i[1],Z:i[2]}}function _(e){var t=e.X,r=e.Y,n=e.Z,i=[];return i[0]=116*o(r/100)-16,i[1]=500*(o(t/95.047)-o(r/100)),i[2]=200*(o(r/100)-o(n/108.883)),{L:i[0],a:i[1],b:i[2]}}function o(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):e/(6/29*3*(6/29))+4/29}function a(e,t){var r,n,i,o,a,s,l,c,u,p,d,h,f,g,m,y,v=_(w(x(e))),b=_(w(x(t)));return n=b,i=(r=v).L,o=r.a,a=r.b,s=n.L,l=n.a,c=n.b,u=i-s,p=Math.sqrt(o*o+a*a),d=p-Math.sqrt(l*l+c*c),h=o-l,f=a-c,g=u/1,m=d/(1*(1+.045*p)),y=Math.sqrt(h*h+f*f-d*d)/(1*(1+.015*p)),Math.sqrt(g*g+m*m+y*y)}var s=e("underscore"),l=e("lib/named-colors");return{str2rgb:x,difference:a,closestColor:function(t,e){var r=s.map(e,function(e){return a(t,e)}),n=s.min(r);return e[r.indexOf(n)]}}}),define("math/policyGraphing",["require","graphing/graphmode","math/builtinframe"],function(e){var r=e("graphing/graphmode"),t=e("math/builtinframe"),n={assignmentForbidden:function(e){return"x"===e||"y"===e||"theta"===e||"tmp"===e.slice(0,3)||t.hasOwnProperty(e)},isValidSlider:function(e){return"x"===e||"y"===e||"ans"!==e.slice(0,3)&&!n.assignmentForbidden(e)},sliderVariables:function(e){return-1!==e.indexOf("theta")&&(e=e.filter(function(e){return"r"!==e})),e.filter(function(e){return!n.assignmentForbidden(e)&&"ans"!==e.slice(0,3)})},graphingEnabled:function(){return!0},ansEnabled:function(){return!1},validRegressionParameter:function(e){return"x"!==e&&"y"!==e},validLHS:function(e){return"theta"!==e},unplottablePolarFunction:function(e,t){return"theta"===e&&-1!==t.indexOf("r")},validDoubleInequalitySymbol:function(e){return"x"===e||"y"===e},validDoubleInequalityVariables:function(e){return!(2<e.length)&&e.every(n.validDoubleInequalitySymbol)},validExpressionVariable:function(e){return"x"===e},validSolvedVariable:function(e){return"x"===e||"y"===e||"r"===e},validImplicitVariables:function(e){switch(e.length){case 1:return"x"===e[0]||"y"===e[0]||"r"===e[0];case 2:return"x"===e[0]&&"y"===e[1]||"y"===e[0]&&"x"===e[1]||"r"===e[0]&&"theta"===e[1]||"theta"===e[0]&&"r"===e[1];default:return!1}},graphableListVariables:function(e,t){return"x"===e||"y"===e||"r"===e||"x"===t||"y"===t},validParametricVariable:function(e){return"t"===e},validParametricVariables:function(e){return 1===e.length&&n.validParametricVariable(e[0])},validInequalityVariables:function(e){switch(e.length){case 1:return"x"===e[0]||"y"===e[0]||"r"===e[0];case 2:return n.validImplicitVariables(e);default:return!1}},validFirstColumnVariable:function(e){return"y"!==e&&"r"!==e&&"theta"!==e&&!e.match(/y_(\d+)/)},complicatedPolarImplicit:function(e,t){return"theta"===e||"r"===e&&1!==t},constantGraphMode:function(e){return"x"===e?r.X:"r"===e?r.POLAR:r.Y},graphMode:function(e,t){return"y"===t?r.X:"x"===e?r.X:"r"===e&&"theta"===t?r.POLAR:r.Y},tableableAsConstant:function(e){return"x"!==e&&"r"!==e&&"theta"!==e},implicitIndependent:function(e){return"x"},implicitDependency:function(e){return"y"===e?"x":"theta"===e?"r":"y"},graphableAsConstant:function(e){return"y"===e||"x"===e||"r"===e},disabledFeatures:function(){return[]}};return n}),define("expressions/slider_loop_modes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOOP_FORWARD_REVERSE="LOOP_FORWARD_REVERSE",t.LOOP_FORWARD="LOOP_FORWARD"}),define("lib/rounding",["require","exports","math/distance"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shortestDecimalBetween=function(e,t){var r=d.mean(e,t);if(0<e!=0<t)return 0;if(0===e||0===t)return 0;var n=0<e?1:-1,i=Math.abs(e).toExponential().split("e"),o=Math.abs(t).toExponential().split("e"),a=i[0],s=o[0],l=i[1],c=o[1];if(c!==l)return n*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(a[0]!==s[0])return parseFloat(r.toPrecision(1));for(var u=1,p=2;p<Math.min(a.length,s.length)&&(u++,a[p]===s[p]);p++);return parseFloat(r.toPrecision(u))}}),define("lib/copy-properties",["require","exports","lib/deepCopy"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyProperties=function(e){var t=e.from,r=e.to,n=e.props;for(var i in n)n[i]&&t.hasOwnProperty(i)&&(r[i]=o.default(t[i]))}}),define("lib/default-spec",["require","exports","underscore","lib/deepCopy"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stripDefaults=function(e,t){var r={};for(var n in t)t.hasOwnProperty(n)&&(o.isEqual(e[n],t[n])||(r[n]=t[n]));return r},t.stripDefaultsAndMaybeReturnUndefined=function(e,t){var r=void 0,n={};for(var i in t)t.hasOwnProperty(i)&&(o.isEqual(e[i],t[i])||(n[i]=t[i],r=n));return r},t.populateDefaults=function(e,t){t||(t={});var r={};for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(r[n]=i.default(e[n]));for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}}),define("graphing-calc/json/expression",["require","exports","tslib","expressions/opacity","graphing/dragmode","expressions/styles","main/label-sizes","main/label-orientations","expressions/slider_loop_modes","lib/default-spec"],function(e,n,i,t,r,o,a,s,l,c){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CDF_DEFAULTS={show:!1,min:"",max:""},n.DEFAULT_SLIDER_PERIOD=4e3,n.DEFAULTS={folderId:"",latex:"",color:"",showLabel:!1,label:"",cdf:n.CDF_DEFAULTS,hidden:!1,secret:!1,dragMode:r.AUTO,labelSize:a.MEDIUM,labelOrientation:s.DEFAULT,verticalLabel:!1,residualVariable:"",isLogModeRegression:!1,pointStyle:o.POINT,lineStyle:o.SOLID,fillOpacity:t.DEFAULT,regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},polarDomain:{min:"",max:""},parametricDomain:{min:"",max:""},points:void 0,lines:void 0,fill:void 0},n.SLIDER_DEFAULTS={hardMin:!1,hardMax:!1,animationPeriod:n.DEFAULT_SLIDER_PERIOD,loopMode:l.LOOP_FORWARD_REVERSE,playDirection:1,isPlaying:!1,min:"-10",max:"10",step:""},n.inflateDefaults=function(e){return i.__assign({},n.DEFAULTS,e,{slider:i.__assign({},n.SLIDER_DEFAULTS,e.slider),cdf:i.__assign({},n.CDF_DEFAULTS,e.cdf)})},n.stripDefaults=function(e){var t=c.stripDefaults(n.DEFAULTS,i.__assign({},e,{slider:c.stripDefaults(n.SLIDER_DEFAULTS,e.slider)})),r=c.stripDefaultsAndMaybeReturnUndefined(n.CDF_DEFAULTS,e.cdf);return void 0===r?delete t.cdf:t.cdf=r,t},n.computeParsableState=function(e){return{type:"statement",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,fillOpacity:e.fillOpacity,points:e.points,lines:e.lines,pointStyle:e.pointStyle,lineStyle:e.lineStyle,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,verticalLabel:e.verticalLabel,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:"",max:e.slider.hardMax?e.slider.max:"",step:e.slider.step},parametricDomain:e.parametricDomain,polarDomain:e.polarDomain,cdf:e.cdf}}}),define("math/distribution-spec",["require","exports","parser","tslib"],function(e,t,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={normdist:{type:"distribution",symbol:"normdist",params:["mean","stdev"],defaults:["0","1"]},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0]},binomdist:{type:"distribution",symbol:"binomdist",params:["trials","prob success"],defaults:[void 0,"0.5"]},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0]}},p={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth","binoffset"],defaults:[void 0,"1","0"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth","binoffset"],defaults:[void 0,"1","0"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data","offset","height"],defaults:[void 0,"3","4"]}};t.parseToplevelFunction=function(e){var t=l.parse(e),r=p[t.type];if(!r)switch("Assignment"===t.type&&(t=t._expression),t.type){case"Identifier":case"FunctionCall":r=u[t._symbol];break;default:return}if(r){for(var n={},i=r.params,o=t.args,a=0;a<i.length;a++){var s=o[a];n[i[a]]=s&&s.getInputString()||""}return c.__assign({},r,{span:t.getInputSpan(),values:n})}}}),define("graphing-calc/models/expression",["require","exports","parser","math/builtinframe","math/policyGraphing","tslib","graphing/dragmode","expressions/styles","main/label-sizes","main/label-orientations","expressions/slider_loop_modes","graphing/reconcileDragMode","lib/evaluate-single-expression","lib/rounding","lib/deepCopy","lib/copy-properties","./abstract-item","./list","underscore","math/expression-types","graphing/label","lib/number-to-latex","math/sliders","../json/expression","math/distribution-spec"],function(e,r,n,i,o,a,s,l,t,c,u,p,d,h,f,g,m,y,v,b,x,w,_,S,E){"use strict";function M(e){var t=e.formula;return!!t&&e.controller.isDecimalToFractionConversionEnabled()&&t.hasOwnProperty("constant_value")&&x.canDisplayAsFraction(t.constant_value,r.EvaluationLabelOptions.denominatorCutoff)}function I(e){var t=e.formula;if(!t)return!1;var r=t.is_evaluable&&t.zero_values&&0<t.zero_values.length&&"boolean"!=typeof t.zero_values[0].val,n=M(e)&&G(e);return r||n}function T(e,t){if(!isFinite(t))return e;var r=/=(.*?)([-\.0-9]+)/,n=e.match(r);if(!n)return e;if(parseFloat(n[2])===t)return e;var i=function(e){var t=e+"";if(/\d+\.?\d*e[\+\-]*\d+/i.test(t)){var r=String(t).toLowerCase().split("e"),n=parseFloat(r[0]),i=parseInt(r[1],10),o=Math.abs(i),a=Math.abs(n).toString().split(".");if(i<0)t="0."+new Array(o).join("0")+a.join("");else{var s=a[1];s&&(o-=s.length),t=a.join("")+new Array(o+1).join("0")}n<0&&(t="-"+t)}return t}(t);return e.replace(r,"=$1"+i)}function C(e){var t=e.dragMode===s.AUTO?e.formula.default_drag_mode:e.dragMode;e.reconciledDragMode=p.default(t,e.formula.move_strategy)}function k(e,t,r){if(!e.sliderExists)return NaN;var n=L(e),i=O(e),o=q(e);if(r&&void 0!==r.overwriteStep&&(o=r.overwriteStep),t=_.constrainSliderValueLikeEvaluator({target:t,hardMin:e.slider.hardMin?n:void 0,hardMax:e.slider.hardMax?i:void 0,step:o}),!r||!r.ignoreSoftLimits){if(!e.slider.hardMin&&t<n)return n;if(!e.slider.hardMax&&i<t)return i}return t}function P(e){var t=y.getParentFolderModel(e);t&&t.hidden?e.shouldGraph=!1:e.shouldGraph=!e.hidden}function D(e){if(e.sliderExists&&e.latex===e.__workerSliderLatex){var t=e.latex;if(e.cachedDisplayLatex.storedLatex===t){if(isFinite(e.__workerSliderValue)){var r=e.controller.getFocusLocation();r&&"expression"===r.type&&r.id===e.id||(e.cachedDisplayLatex.valueLatex=T(e.latex,e.__workerSliderValue))}}else e.cachedDisplayLatex={storedLatex:e.latex,valueLatex:e.latex}}else e.cachedDisplayLatex={storedLatex:e.latex,valueLatex:e.latex}}function A(e){var t=x.value(e);return t.superscript&&t.mantissa?t.mantissa+"^{"+t.superscript+"}":t.string}function L(e){if(e.slider.hardMin)return isFinite(e.__workerSliderMin)?e.__workerSliderMin:NaN;var t=e.controller.isDegreeMode(),r=d.default(e.slider.min,t),n=F(e),i=q(e),o=e.slider.hardMax?e.__workerSliderMax:void 0,a=-10;if(r<a&&(a=r),n<a&&(a=n),o<a&&(a=o),i){var s=_.constrainSliderValueLikeEvaluator({target:a,hardMin:void 0,hardMax:o,step:i});a=s<=a?s:s-i}return a}function O(e){if(e.slider.hardMax)return isFinite(e.__workerSliderMax)?e.__workerSliderMax:NaN;var t=e.controller.isDegreeMode(),r=d.default(e.slider.max,t),n=F(e),i=q(e),o=e.slider.hardMin?e.__workerSliderMin:void 0,a=10;if(a<r&&(a=r),a<n&&(a=n),a<o&&(a=o),i){var s=_.constrainSliderValueLikeEvaluator({target:a,hardMin:o,hardMax:void 0,step:i});a=a<=s?s:s+i}return a}function q(e){return e.__workerSliderStep}function F(e){return e.latex!==e.__workerSliderLatex?z(e.latex):isFinite(e.__workerSliderValue)?e.__workerSliderValue:NaN}function N(e){var t=e.cachedViewState;t&&t.folderId===e.folderId&&t.color===e.color&&t.latex===e.latex&&t.parametricDomain===e.parametricDomain&&t.polarDomain===e.polarDomain&&t.showLabel===e.showLabel&&t.cdf===e.cdf&&t.label===e.label&&t.hidden===e.hidden&&t.secret===e.secret&&t.fill===e.fill&&t.fillOpacity===e.fillOpacity&&t.points===e.points&&t.lines===e.lines&&t.lineStyle===e.lineStyle&&t.pointStyle===e.pointStyle&&t.dragMode===e.dragMode&&t.labelSize===e.labelSize&&t.labelOrientation===e.labelOrientation&&t.verticalLabel===e.verticalLabel&&t.residualVariable===e.residualVariable&&t.regressionParameters===e.regressionParameters&&t.isLogModeRegression===e.isLogModeRegression&&t.displayEvaluationAsFraction===e.displayEvaluationAsFraction&&t.slider===e.slider||(e.cachedViewState={type:e.type,id:e.id,folderId:e.folderId,color:e.color,latex:e.latex,parametricDomain:e.parametricDomain,polarDomain:e.polarDomain,showLabel:e.showLabel,cdf:e.cdf,label:e.label,hidden:e.hidden,secret:e.secret,points:e.points,lines:e.lines,lineStyle:e.lineStyle,pointStyle:e.pointStyle,fill:e.fill,fillOpacity:e.fillOpacity,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,verticalLabel:e.verticalLabel,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,displayEvaluationAsFraction:e.displayEvaluationAsFraction,slider:e.slider})}function R(e){var t,r=e.memoizedUndoRedoStateParams,n=e.cachedViewState,i=e.preTransientState;r&&r.viewState===n&&r.preTransientState===i||(e.memoizedUndoRedoStateParams={viewState:n,preTransientState:i},delete(t=i?a.__assign({},n,{latex:i.latex,slider:a.__assign({},n.slider,i.slider)}):a.__assign({},n)).regressionParameters,delete t.residualVariable,e.cachedUndoRedoState=t)}function B(e){var t=y.getParentFolderModel(e),r=!(!t||!t.hidden),n=e.cachedViewState,i=e.index,o=e.showLabel&&!r,a=e.shouldGraph,s=e.slider.hardMin?e.slider.min:"",l=e.slider.hardMax?e.slider.max:"",c=e.slider.step,u=e.memoizedParsableStateParams;if(!u||u.viewState!==n||u.index!==i||u.showLabel!==o||u.shouldGraph!==a||u.polarDomainMin!==e.polarDomain.min||u.polarDomainMax!==e.polarDomain.max||u.parametricDomainMin!==e.parametricDomain.min||u.parametricDomainMax!==e.parametricDomain.max||u.sliderMin!==s||u.sliderMax!==l||u.sliderStep!==c){e.memoizedParsableStateParams={viewState:n,index:i,polarDomainMin:e.polarDomain.min,polarDomainMax:e.polarDomain.max,parametricDomainMin:e.parametricDomain.min,parametricDomainMax:e.parametricDomain.max,sliderMin:s,sliderMax:l,sliderStep:c,showLabel:o,shouldGraph:a};var p=S.computeParsableState(n);p.index=i,p.showLabel=o,p.shouldGraph=a,e.cachedParsableState=p}}function j(e,t){e.slider=a.__assign({},e.slider,t)}function V(e,t){e&&e.sliderExists&&(e.slider.isPlaying!==t&&(j(e,{isPlaying:t}),t&&(U(e),e.sliderAnimationTargetValue=F(e))))}function U(e){if(!e.slider.hardMin){var t=w.default(L(e));t!==e.slider.min&&j(e,{min:t})}if(!e.slider.hardMax){var r=w.default(O(e));r!==e.slider.max&&j(e,{max:r})}}function z(e){var t=n.parse(e);if("Assignment"!==t.type)return NaN;if("Constant"!==t._expression.type)return NaN;if(!o.validLHS(t._symbol))return NaN;if(i[t._symbol])return NaN;var r=t._expression.asValue();return"number"==typeof r?r:NaN}function G(e){return e.displayEvaluationAsFraction}function H(e){return e.formula.expression_type===b.PARAMETRIC}function W(e){return e.formula.expression_type===b.POLAR}function K(e){var t=Y(e);return!(!t||"distribution"!==t.type)}function Y(e){if(e.controller.areDistributionsEnabled()&&e.latex)return E.parseToplevelFunction(e.latex)}function X(e){return K(e)}function $(e){var t=(e.xmax-e.xmin)/10,r=(e.ymax-e.ymin)/10;return{xmin:e.xmin-t,xmax:e.xmax+t,ymin:e.ymin-r,ymax:e.ymax+r}}Object.defineProperty(r,"__esModule",{value:!0}),r.EvaluationLabelOptions={smallCutoff:1e-6,bigCutoff:1e9,digits:12,denominatorCutoff:1e6},r.isRationalizableConstant=M,r.hasPlottableDependency=function(e){var t=e.dependent;return"x"===t||"y"===t||"r"===t},r.shouldShowEvaluation=I,r.getEvaluationValue=function(e){var t=e.formula;return I(e)?t.zero_values&&t.zero_values.length?t.zero_values[0].val:t.constant_value:M(e)?e.formula.constant_value:NaN},r.computeNewSliderLatex=T,r.isEmpty=function(e){return""===((e.latex||"")+(e.label||"")).split(" ").join("")},r.updateReconciledDragMode=C,r.adjustSliderByMovablePoint=function(e,t){if(e.sliderExists){e.slider.isPlaying&&V(e,!1);var r=k(e,t,{ignoreSoftLimits:!0});e.latex=T(e.latex,r)}},r.adjustSliderByKeyboard=function(e,t){if(e.sliderExists){e.slider.isPlaying&&V(e,!1),U(e);var r=function(e,t){if(!e.sliderExists)return NaN;var r=F(e),n=L(e),i=O(e),o=q(e),a=o||(i-n)/20,s=0;switch(t){case"min":return k(e,n);case"max":return k(e,i);case"up":s=1;break;case"down":s=-1;break;case"bigup":s=5;break;case"bigdown":s=-5;break;default:return t}for(var l=r,c=0;c<20;c++){var u=c/3*a,p=r;if(0<s)p<(r=k(e,l+u,{overwriteStep:a}))&&(s-=1);else{if(!(s<0))break;(r=k(e,l-u,{overwriteStep:a}))<p&&(s+=1)}}return r}(e,t);e.latex=T(e.latex,r)}},r.adjustSliderByDraggingThumb=function(e,t){if(e.sliderExists){e.slider.isPlaying&&V(e,!1);var r=k(e,t);e.latex=T(e.latex,r)}},r.tickSliderStep=function(e,t){if(e.sliderExists){var r=L(e),n=O(e),i=q(e),o=e.slider.animationPeriod,a=e.slider.loopMode,s=i?i/2:0;if(a===u.LOOP_FORWARD_REVERSE)e.sliderAnimationTargetValue>=n?j(e,{playDirection:-1}):e.sliderAnimationTargetValue<=r&&j(e,{playDirection:1});else{if(a!==u.LOOP_FORWARD)throw new Error("Unexpected slider loop mode: "+a);j(e,{playDirection:1}),e.sliderAnimationTargetValue>=n+s&&(e.sliderAnimationTargetValue=r-s)}isFinite(t)||(t=0);var l=(n-r)*(t=Math.min(t,o/10))/o;e.sliderAnimationTargetValue+=l*e.slider.playDirection,e.sliderAnimationTargetValue=Math.max(r-s,Math.min(n+s,e.sliderAnimationTargetValue));var c=e.sliderAnimationTargetValue;i||(c=h.shortestDecimalBetween(c-.1*l,c+.1*l)),c=k(e,c),e.latex=T(e.latex,c)}},r.onFormulaUpdate=function(e,t){e.formula=t,e.loading=!1,e.error=t.error?t.error:"",e.isGraphable=t.is_graphable,e.dependent=t.assignment,e.isTableable=t.is_tableable,e.unresolved=!1,t.is_single_identifier?e.missingVariables=[]:e.missingVariables=t.variables||[],e.__workerSliderLatex=t.raw_slider_latex,t.is_slider?(e.__workerSliderValue=t.constant_value,e.__workerSliderMin=t.slider_min_number,e.__workerSliderMax=t.slider_max_number,e.__workerSliderStep=t.slider_step_number,e.__workerSliderMinValid=t.slider_min_valid,e.__workerSliderMaxValid=t.slider_max_valid,e.__workerSliderStepValid=t.slider_step_valid,e.sliderExists||(e.sliderAnimationTargetValue=F(e),e.sliderDragging=!1,e.sliderExists=!0)):e.sliderExists=!1,e.__workerDomainMin=t.domain_min_number,e.__workerDomainMax=t.domain_max_number,e.__workerDomainMinValid=t.domain_min_valid,e.__workerDomainMaxValid=t.domain_max_valid,e.__workerCDFMinValid=t.cdf_min_valid,e.__workerCDFMaxValid=t.cdf_max_valid,e.__workerCDFEvaluation=t.cdf_evaluation;var r={};t.is_regression&&(r=t.regression.parameters,e.residualVariable=t.regression.residualVariable),v.isEqual(e.regressionParameters,r)||(e.regressionParameters=r)},r.computeShouldGraph=P,r.updateDisplayLatex=D,r.getDisplayLatex=function(e){return e.cachedDisplayLatex.valueLatex},r.getDisplaySliderMin=function(e){return e.slider.hardMin?e.slider.min:A(L(e))},r.getDisplaySliderMax=function(e){return e.slider.hardMax?e.slider.max:A(O(e))},r.getSliderMin=L,r.getSliderMax=O,r.getSliderStep=q,r.getSliderValue=F,r.isSliderMinValid=function(e){return!!e.__workerSliderMinValid},r.isSliderMaxValid=function(e){return!!e.__workerSliderMaxValid},r.isSliderStepValid=function(e){return!!e.__workerSliderStepValid},r.getDomainMin=function(e){return isFinite(e.__workerSampledDomainMin)?e.__workerSampledDomainMin:isFinite(e.__workerDomainMin)?e.__workerDomainMin:NaN},r.getDomainMax=function(e){return isFinite(e.__workerSampledDomainMax)?e.__workerSampledDomainMax:isFinite(e.__workerDomainMax)?e.__workerDomainMax:NaN},r.isDomainMinValid=function(e){return!!e.__workerDomainMinValid},r.isDomainMaxValid=function(e){return!!e.__workerDomainMaxValid},r.getState=function(e,t){var r=e.cachedViewState;if(t.stripDefaults&&""===e.parametricDomain.min&&""===e.parametricDomain.max||(r=a.__assign({},r,{domain:{min:""===e.parametricDomain.min?"0":e.parametricDomain.min,max:""===e.parametricDomain.max?"1":e.parametricDomain.max}})),t.stripDefaults)return S.stripDefaults(r);if(void 0!==r.points&&void 0!==r.lines&&void 0!==r.fill)return r;var n=f.default(r);return void 0===n.points&&delete n.points,void 0===n.lines&&delete n.lines,void 0===n.fill&&delete n.fill,n},r.updateCachedViewState=N,r.setIsDraggingOnGrapher=function(e,t){t&&U(e),e.draggingOnGraphpaper=t},r.updateCachedUndoRedoState=R,r.initModel=function(e,t){var r=f.default(S.inflateDefaults(e));return a.__assign({},r,m.DEFAULTS(t),{loading:!0,labelDropdownOpen:!1,formula:{error:void 0},missingVariables:[],error:void 0,unresolved:!1,color:r.color||t.getNextColor(),fill:r.fill,points:r.points,lines:r.lines,pointStyle:r.pointStyle,lineStyle:r.lineStyle,displayEvaluationAsFraction:r.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,draggingOnGraphpaper:!1,cachedUndoRedoState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}})},r.updateCachedParsableState=B,r.eachLatex=function(e,t){t(e.latex),e.residualVariable&&t(e.residualVariable)},r.onControllerUpdate=function(e){var t=e.sliderExists&&(e.slider.isPlaying||e.sliderDragging);e.draggingOnGraphpaper||t?e.preTransientState||(e.preTransientState={latex:e.latex,slider:{min:e.slider.min,max:e.slider.max,playDirection:e.slider.playDirection}}):delete e.preTransientState,m.updateIsHiddenFromUI(e),P(e),C(e),N(e),R(e),B(e),D(e)},r.restoreState=function(e,t){g.copyProperties({from:t,to:e,props:{id:!1,type:!1,color:!0,folderId:!0,latex:!0,polarDomain:!0,parametricDomain:!0,showLabel:!0,label:!0,cdf:!0,hidden:!0,secret:!0,points:!0,lines:!0,lineStyle:!0,pointStyle:!0,fill:!0,fillOpacity:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,verticalLabel:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0}})},r.setSliderMin=function(e,t){j(e,t?{hardMin:!0,min:t}:{hardMin:!1,min:"-10"})},r.setSliderMax=function(e,t){j(e,t?{hardMax:!0,max:t}:{hardMax:!1,max:"10"})},r.setSliderIsPlaying=V,r.commitSliderSoftLimits=U,r.extractSliderValueFromLatex=z,r.setLatex=function(e,t){var r=z(t);if(isFinite(r)){var n=_.determineWhichLimitsAreCompatibleWithValue({target:r,step:q(e),hardMin:e.slider.hardMin?L(e):void 0,hardMax:e.slider.hardMax?O(e):void 0});n.min||j(e,{hardMin:!1,min:"-10"}),n.max||j(e,{hardMax:!1,max:"10"}),n.step||j(e,{step:""})}e.latex=t},r.setSliderLoopMode=function(e,t){j(e,{loopMode:t,playDirection:1}),e.sliderAnimationTargetValue=L(e)},r.setSliderDragging=function(e,t){t&&U(e),e.sliderDragging=t},r.setSliderStep=function(e,t){j(e,{step:t})},r.setSliderAnimationPeriod=function(e,t){j(e,{animationPeriod:t})},r.shouldEvaluationDisplayAsFraction=G,r.setEvaluationAsFraction=function(e,t){e.displayEvaluationAsFraction=t},r.setLabel=function(e,t){e.label=t},r.setShowLabel=function(e,t){e.showLabel=t},r.setPolarDomainMin=function(e,t){e.polarDomain=a.__assign({},e.polarDomain,{min:t})},r.setParametricDomainMin=function(e,t){e.parametricDomain=a.__assign({},e.parametricDomain,{min:t})},r.setPolarDomainMax=function(e,t){e.polarDomain=a.__assign({},e.polarDomain,{max:t})},r.setParametricDomainMax=function(e,t){e.parametricDomain=a.__assign({},e.parametricDomain,{max:t})},r.setLogMode=function(e,t){e.isLogModeRegression=t},r.setColor=function(e,t){e.color=t},r.setFill=function(e,t){e.fill=t},r.setFillOpacity=function(e,t){e.fillOpacity!==t&&(e.fillOpacity=t)},r.setLabelDropdownOpen=function(e,t){e.labelDropdownOpen=t},r.setDragMode=function(e,t){e.dragMode!==t&&(e.dragMode=t)!==s.NONE&&(e.pointStyle=l.POINT)},r.setPoints=function(e,t){e.points=t},r.setPointStyle=function(e,t){e.pointStyle!==t&&(e.pointStyle=t)!==l.POINT&&(e.dragMode=s.NONE)},r.setLines=function(e,t){e.lines=t},r.setLineStyle=function(e,t){e.lineStyle!==t&&(e.lineStyle=t)},r.setLabelSize=function(e,t){e.labelSize=t},r.setLabelOrientation=function(e,t){e.labelOrientation=t},r.setVerticalLabel=function(e,t){e.verticalLabel=t},r.setHidden=function(e,t){if(e.hidden=t,e.formula&&e.formula.expression_type){var r=e.points,n=e.lines,i=e.fill,o=b.getReconciledExpressionProps(e.formula.expression_type,{points:r,lines:n,fill:i});if(!(t||o.points||o.lines||o.fill)){var a=b.EXPRESSION_PROP_DEFAULTS[e.formula.expression_type];e.points=a.points,e.lines=a.lines,e.fill=a.fill}}},r.shouldHide=function(e){var t=e.points,r=e.lines,n=e.fill,i=b.getReconciledExpressionProps(e.formula.expression_type,{points:t,lines:r,fill:n});return!i.points&&!i.lines&&!i.fill},r.hasDomain=function(e){return H(e)||W(e)},r.getPolarDomainMin=function(e){return e.polarDomain.min},r.getPolarDomainMax=function(e){return e.polarDomain.max},r.getParametricDomainMin=function(e){return e.parametricDomain.min},r.getParametricDomainMax=function(e){return e.parametricDomain.max},r.hasSlider=function(e){return!!e.sliderExists},r.isPolygon=function(e){return e.formula.expression_type===b.POLYGON},r.isParametric=H,r.isPolar=W,r.isSinglePoint=function(e){return e.formula.expression_type===b.SINGLE_POINT},r.isPointList=function(e){return e.formula.expression_type===b.POINT_LIST},r.isPointOrPointList=function(e){return e.formula.expression_type===b.POINT_LIST||e.formula.expression_type===b.SINGLE_POINT},r.isToplevelFunction=function(e){return!!Y(e)},r.isToplevelDistribution=K,r.parseToplevelFunction=Y,r.shouldShowCDFCheckbox=X,r.shouldShowCDFFooter=function(e){return!!X(e)&&e.cdf.show},r.getCDFMin=function(e){return e.cdf.min},r.getCDFMax=function(e){return e.cdf.max},r.setShowCDF=function(e,t){e.cdf=a.__assign({},e.cdf,{show:t})},r.setCDFMin=function(e,t){e.cdf=a.__assign({},e.cdf,{min:t})},r.setCDFMax=function(e,t){e.cdf=a.__assign({},e.cdf,{max:t})},r.isCDFMinValid=function(e){return!1!==e.__workerCDFMinValid},r.isCDFMaxValid=function(e){return!1!==e.__workerCDFMaxValid},r.getCDFEvaluation=function(e){return isFinite(e.__workerCDFEvaluation)?e.__workerCDFEvaluation:0},r.computeFittedViewport=$,r.shouldShowZoomFitOption=function(e){return!!e.boundingBox},r.shouldDisableZoomFitOption=function(e){if(!e.boundingBox)return!0;var t=e.controller.getState().graph.viewport,r=$(e.boundingBox);return v.isEqual(r,t)},r.blankOutExpressionAfterClearingLatex=function(e){e.showLabel=S.DEFAULTS.showLabel,e.label=S.DEFAULTS.label,e.hidden=S.DEFAULTS.hidden,e.dragMode=S.DEFAULTS.dragMode,e.fill=S.DEFAULTS.fill,e.fillOpacity=S.DEFAULTS.fillOpacity,e.points=S.DEFAULTS.points,e.pointStyle=S.DEFAULTS.pointStyle,e.lines=S.DEFAULTS.lines,e.lineStyle=S.DEFAULTS.lineStyle,e.polarDomain=S.DEFAULTS.polarDomain,e.parametricDomain=S.DEFAULTS.parametricDomain,e.slider=S.SLIDER_DEFAULTS,e.latex="",e.labelSize=t.MEDIUM,e.labelOrientation=c.DEFAULT,e.displayEvaluationAsFraction=S.DEFAULTS.displayEvaluationAsFraction,e.verticalLabel=!1}}),define("graphing-calc/json/folder",["require","exports","tslib","lib/default-spec"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS={folderId:"",collapsed:!1,hidden:!1,secret:!1,title:""},t.inflateDefaults=function(e){return r.__assign({},t.DEFAULTS,e)},t.stripDefaults=function(e){return n.stripDefaults(t.DEFAULTS,e)}}),define("graphing-calc/models/folder",["require","exports","tslib","lib/deepCopy","lib/copy-properties","./abstract-item","./list","../json/folder"],function(e,t,n,i,r,o,a,s){"use strict";function l(e){e.cachedViewState={type:e.type,id:e.id,folderId:e.folderId,title:e.title,hidden:e.hidden,collapsed:e.collapsed,secret:e.secret}}function c(e){e.cachedUndoRedoState=e.cachedViewState}function u(e){var t=e.controller,r=t.getSelectedItem();e.collapsed?r&&r.folderId===e.id?(e.selectedHiddenChild=r,a.setSelected(t.getListModel(),e)):r!==e&&(e.selectedHiddenChild=void 0):(r===e&&e.selectedHiddenChild&&a.setSelected(t.getListModel(),e.selectedHiddenChild),e.selectedHiddenChild=void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.getState=function(e,t){var r=e.cachedViewState;return t.stripDefaults?s.stripDefaults(r):r},t.updateCachedViewState=l,t.updateCachedUndoRedoState=c,t.initModel=function(e,t){var r=i.default(s.inflateDefaults(e));return n.__assign({},r,o.DEFAULTS(t),{cachedUndoRedoState:{},cachedViewState:{}})},t.onControllerUpdate=function(e){u(e),o.updateIsHiddenFromUI(e),l(e),c(e)},t.restoreState=function(e,t){r.copyProperties({from:t,to:e,props:{id:!1,type:!1,folderId:!0,hidden:!0,secret:!0,collapsed:!0,title:!0}})},t.updateSelectedHiddenChild=u,t.setCollapsed=function(e,t){e.collapsed=t},t.setTitle=function(e,t){e.title=t},t.setHidden=function(e,t){e.hidden=t}}),define("graphing-calc/json/text",["require","exports","tslib","lib/default-spec"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS={folderId:"",text:"",secret:!1},t.inflateDefaults=function(e){return r.__assign({},t.DEFAULTS,e)},t.stripDefaults=function(e){return n.stripDefaults(t.DEFAULTS,e)}}),define("graphing-calc/models/text",["require","exports","tslib","./abstract-item","lib/deepCopy","lib/copy-properties","../json/text"],function(e,t,n,i,o,r,a){"use strict";function s(e){e.cachedViewState={type:e.type,id:e.id,folderId:e.folderId,text:e.text,secret:e.secret}}function l(e){e.cachedUndoRedoState=e.cachedViewState}Object.defineProperty(t,"__esModule",{value:!0}),t.setText=function(e,t){e.text=t},t.initModel=function(e,t){var r=o.default(a.inflateDefaults(e));return n.__assign({},r,i.DEFAULTS(t),{cachedUndoRedoState:{},cachedViewState:{}})},t.onControllerUpdate=function(e){i.updateIsHiddenFromUI(e),s(e),l(e)},t.restoreState=function(e,t){r.copyProperties({from:t,to:e,props:{id:!1,type:!1,folderId:!0,text:!0,secret:!0}})},t.getState=function(e,t){var r=e.cachedViewState;return t.stripDefaults?a.stripDefaults(r):r},t.updateCachedViewState=s,t.updateCachedUndoRedoState=l}),define("graphing-calc/models/helper-expression",["require","exports","math/evaluationstate","tslib","underscore"],function(e,t,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){return n.__assign({},e,{formula:r.default(),cachedParsableState:{type:"statement",id:e.id,latex:e.latex,shouldGraph:!1}})},t.onFormulaUpdate=function(e,t,r){t.formula=r;var n,i=t.proxy,o={numericValue:i.numericValue,listValue:i.listValue};r.zero_values&&1===r.zero_values.length&&(n=r.zero_values[0].val),i.numericValue=a.isNumber(n)?n:NaN,i.listValue=a.isArray(n)?n.slice(0):void 0,a.isEqual(i.numericValue,o.numericValue)||e.runAfterDispatch(function(){i.notifyPropertyChange("numericValue")}),a.isEqual(i.listValue,o.listValue)||e.runAfterDispatch(function(){i.notifyPropertyChange("listValue")})}}),define("graphing-calc/json/image",["require","exports","tslib","lib/default-spec"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS={folderId:"",hidden:!1,secret:!1,center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:1,foreground:!1,name:""},t.inflateDefaults=function(e){return r.__assign({},t.DEFAULTS,e)},t.stripDefaults=function(e){return n.stripDefaults(t.DEFAULTS,e)},t.computeParsableState=function(e){return{type:"image",id:e.id,center:e.center,angle:e.angle,width:e.width,height:e.height,guid:"",index:0,color:"",shouldGraph:e.hidden,showPoints:!1}}}),define("graphing-calc/models/image",["require","exports","tslib","lib/color-helpers","./abstract-item","lib/deepCopy","lib/copy-properties","./list","jquery","../json/image"],function(e,t,i,o,a,s,r,n,l,c){"use strict";function u(e){var t=c.computeParsableState(e);t.color=e.color,t.index=e.index,t.guid=e.guid,t.shouldGraph=e.shouldGraph,t.showPoints=e.showPoints,e.cachedParsableState=t}function p(e){e.cachedViewState={type:e.type,id:e.id,folderId:e.folderId,image_url:e.image_url,name:e.name,hidden:e.hidden,height:e.height,width:e.width,center:e.center,angle:e.angle,opacity:e.opacity,foreground:e.foreground,secret:e.secret}}function d(e){var t=e.cachedViewState;e.preTransientState&&(t=i.__assign({},t,e.preTransientState)),e.cachedUndoRedoState=t}function h(e,t,r,n){l(e).on("load",r).on("error",n),/^data:/.test(t)||(e.crossOrigin="anonymous"),e.src=t}function f(o,a){var s=""+m++;return o.getGraphSettings().config.imageUploadCallback(a,function(e,i){setTimeout(function(){if(e)o.dispatch({type:"image-upload-error",token:s,error:e});else{var n=new Image;h(n,i,function(){var e=n.width,t=n.height,r=Math.max(e,t)/Math.min(e,t);e<t?(t=10,e=Math.round(10*t/r)/10):(e=10,t=Math.round(10*e/r)/10),o.dispatch({type:"image-upload-success",token:s,url:i,width:e+"",height:t+"",name:a.name})},function(){o.dispatch({type:"image-upload-error",token:s,error:""})})}})}),s}function g(e,t){"loaded"===(e.loadStatus=t)&&(e.failures=0),"failed"===t&&(e.failures+=1)}Object.defineProperty(t,"__esModule",{value:!0}),t.setHidden=function(e,t){e.hidden=t},t.setSecret=function(e,t){e.secret=t},t.setMQAttribute=function(e,t,r){e[t]=r},t.getMQAttribute=function(e,t){return e[t]},t.setName=function(e,t){e.name=t},t.setOpacity=function(e,t){e.opacity=t},t.setForeground=function(e,t){e.foreground=t},t.setImageURL=function(e,t){e.image_url=t},t.updateCachedParsableState=u,t.onControllerUpdate=function(e){e.draggingOnGraphpaper?e.preTransientState||(e.preTransientState={center:e.center,angle:e.angle,width:e.width,height:e.height}):delete e.preTransientState,a.updateIsHiddenFromUI(e);var t=n.getParentFolderModel(e);e.shouldGraph=!(t&&t.hidden||e.hidden),e.showPoints=e.shouldGraph&&n.isItemSelected(e)&&"loaded"===e.loadStatus,p(e),d(e),u(e)},t.onFormulaUpdate=function(e,t){e.formula=t,e.missingVariables=e.formula.variables||[],e.computed_x=e.formula.dimensions.x,e.computed_y=e.formula.dimensions.y,e.computed_radian_angle=e.formula.dimensions.radianAngle,e.computed_height=e.formula.dimensions.height,e.computed_width=e.formula.dimensions.width;var r={center:e.controller.t("Invalid center. Try, for example, (0,0)."),angle:e.controller.t("Invalid angle. Try using any number."),width:e.controller.t("Invalid width. Try using any number."),height:e.controller.t("Invalid height. Try using any number.")},n=[];for(var i in e.formula.errorMap)e.formula.errorMap[i]&&n.push(r[i]);e.error=n[0],e.inputErrors={center:!!e.formula.errorMap.center,width:!!e.formula.errorMap.width,height:!!e.formula.errorMap.height,angle:!!e.formula.errorMap.angle}},t.hasInputError=function(e,t){return!!e.inputErrors&&e.inputErrors[t]},t.getState=function(e,t){var r=e.cachedViewState;return t.stripDefaults?c.stripDefaults(r):r},t.updateCachedViewState=p,t.setIsDraggingOnGrapher=function(e,t){e.draggingOnGraphpaper=t},t.updateCachedUndoRedoState=d,t.initModel=function(e,t){var r=s.default(c.inflateDefaults(e)),n=i.__assign({},r,a.DEFAULTS(t),{color:o.colors.BLUE,loadStatus:"loading",failures:0,imageObj:new Image,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,missingVariables:[],computed_x:void 0,computed_y:void 0,computed_width:void 0,computed_height:void 0,computed_radian_angle:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoState:{}});return h(n.imageObj,n.image_url,function(){n.controller.dispatch({type:"image-load-success",id:n.id})},function(){n.controller.dispatch({type:"image-load-error",id:n.id})}),n},t.restoreState=function(e,t){r.copyProperties({from:t,to:e,props:{id:!1,type:!1,image_url:!1,name:!0,folderId:!0,hidden:!0,secret:!0,center:!0,angle:!0,width:!0,height:!0,opacity:!0,foreground:!0}})},t.uploadImages=function(e,t){for(var r={errors:[],tokens:[]},n=0;n<t.length;n++){var i=t[n];i.type.match("image/*")?r.tokens.push(f(e,i)):r.errors.push(e.t('The file "__file__" is not an image',{file:i.name}))}return r};var m=0;t.uploadImageAndGenerateToken=f,t.setLoadStatus=g,t.retryLoading=function(e){e.imageObj.src=e.imageObj.src,g(e,"loading")}}),define("graphing/viewport",["require","exports"],function(e,t){"use strict";function r(e,t){return e<e*(1-1e-8)+1e-8*t&&1e-300<t-e&&t-e<1e300}Object.defineProperty(t,"__esModule",{value:!0}),t.UnionViewports=function(e,t){return{xmin:Math.min(e.xmin,t.xmin),ymin:Math.min(e.ymin,t.ymin),xmax:Math.max(e.xmax,t.xmax),ymax:Math.max(e.ymax,t.ymax)}};var n=function(){function o(e,t,r,n){void 0===e&&(e=-10),void 0===t&&(t=10),void 0===r&&(r=-10),void 0===n&&(n=10),this.xmin=e,this.xmax=t,this.ymin=r,this.ymax=n}return o.fromObject=function(e){return new o(e.xmin,e.xmax,e.ymin,e.ymax)},o.prototype.toObject=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},o.prototype.equals=function(e){return this.xmin===e.xmin&&this.ymin===e.ymin&&this.xmax===e.xmax&&this.ymax===e.ymax},o.prototype.isXValid=function(){return r(this.xmin,this.xmax)},o.prototype.isYValid=function(){return r(this.ymin,this.ymax)},o.prototype.isValid=function(){return this.isXValid()&&this.isYValid()},o.prototype.isSquare=function(e){return Math.abs(e.height-e.width*this.aspectRatio())<1},o.prototype.aspectRatio=function(){return(this.ymax-this.ymin)/(this.xmax-this.xmin)},o.prototype.squareXAxis=function(e){var t=this.xmax-this.xmin,r=this.ymax-this.ymin,n=this.xmin+t/2,i=r/e.height*e.width;return new o(n-i/2,n+i/2,this.ymin,this.ymax)},o.prototype.squareYAxis=function(e){var t=this.xmax-this.xmin,r=this.ymax-this.ymin,n=this.ymin+r/2,i=t/e.width*e.height;return new o(this.xmin,this.xmax,n-i/2,n+i/2)},o.prototype.squareCrop=function(e){return this.aspectRatio()>e.height/e.width?this.squareYAxis(e):this.squareXAxis(e)},o.prototype.polarDiameter=function(){var e=Math.abs(this.xmax),t=Math.abs(this.xmin),r=Math.abs(this.ymax),n=Math.abs(this.ymin);return 1.5*Math.max(e,t,r,n)},o.prototype.largestR=function(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))},o.prototype.smallestR=function(){return this.xmin<=0&&0<=this.xmax&&this.ymin<=0&&0<=this.ymax?0:this.xmin<=0&&0<=this.xmax?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&0<=this.ymax?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))},o}();t.Viewport=n}),define("graphing-calc/models/list",["require","exports","lib/color-distance","./abstract-item","./expression","./folder","./table","./text","./helper-expression","./image","graphing/graphmode","lib/color-helpers","graphing/viewport","underscore","lib/deepCopy"],function(e,t,a,o,c,s,u,l,p,d,f,n,g,h,m){"use strict";function i(e,t){return e.__itemModelArray[t]}function y(e,t){var r;do{if(-1===--t)return;r=i(e,t)}while(r&&!x(r));return r}function v(e,t){var r,n=T(e);do{if(++t===n)return;r=i(e,t)}while(r&&!x(r));return r}function r(e){if(e.folderId){var t=S(e.controller.getListModel(),e.folderId);if(t&&"folder"===t.type)return t}}function b(e){if(!e)return!1;if(e.secret)return!0;var t=r(e);return!(!t||!t.secret)}function x(e){return!w(e)}function w(e){if(!e)return!0;if(e.controller.isItemBeingDragged(e.id))return!1;if(!e.controller.canAdministerSecretFolders()&&b(e))return!0;var t=r(e);return!(!t||!t.collapsed)}function _(e,t){for(var r=0;r<e.__itemModelArray.length;r++){var n=e.__itemModelArray[r];switch(n.type){case"expression":c.eachLatex(n,t);break;case"table":u.eachLatex(n,t);break;case"image":case"folder":case"text":break;default:return n}}}function S(e,t){return e.__itemIdToModel[t]}function E(e,t){return e.__helperIdToModel[t]}function M(e){for(var t=!e.controller.canAdministerSecretFolders(),r=1,n=1,i=0;i<e.__itemModelArray.length;i++){var o=e.__itemModelArray[i];o.index=i,o.displayIndex=r,b(o)&&(o.secretIndex=n,n+=1),t&&b(o)||(r+=1)}e.nextDisplayIndex=r}function I(e){e.__itemModelArray=[],e.__itemIdToModel={},e.__helperIdToModel={}}function T(e){return e.__itemModelArray.length}function C(e){return e.selectedItem}function k(e,t){switch(t.type){case"expression":return c.initModel(t,e.controller);case"table":return u.initModel(t,e.controller);case"image":return d.initModel(t,e.controller);case"folder":return s.initModel(t,e.controller);case"text":return l.initModel(t,e.controller);default:return t}}function P(e,t){e.selectedItem=t}function D(e,t,r){var n=String(t.id);if(e.__itemIdToModel.hasOwnProperty(n))throw Error("Item with id '"+n+"' is already in list");e.__itemIdToModel[n]=t,e.__itemModelArray.splice(r,0,t),M(e)}function A(e,t){var r=e.__itemModelArray[t];if("folder"===r.type){for(var n=0,i=r.index+1;i<e.__itemModelArray.length;i++){var o=e.__itemModelArray[i];if(o.folderId!==r.id)break;n+=1,L(o)&&P(e,void 0),delete e.__itemIdToModel[o.id]}e.__itemModelArray.splice(t,1+n)}else e.__itemModelArray.splice(t,1);L(r)&&P(e,void 0),delete e.__itemIdToModel[r.id],delete e.expressionAnalysis[r.id],M(e)}function L(e){return e.controller.getListModel().selectedItem===e}Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){return{controller:e,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},drawOrder:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:1}},t.areAnyImagesLoading=function(e){for(var t=0;t<e.__itemModelArray.length;t++){var r=e.__itemModelArray[t];if("image"===r.type&&"loading"===r.loadStatus)return!0}return!1},t.getNextColor=function(e){var t=h.filter(h.values(e.controller.getColors()),function(e){return e!=n.colors.ORANGE}),r=t[e.colorIdx];return e.colorIdx=(e.colorIdx+1)%t.length,r},t.getItemByIndex=i,t.getFirstSelectableItem=function(e){for(var t=0;t<e.__itemModelArray.length;t++){var r=e.__itemModelArray[t];if(x(r))return r}},t.getLastSelectableItem=function(e){for(var t=e.__itemModelArray.length-1;0<=t;t--){var r=e.__itemModelArray[t];if(x(r))return r}},t.findPrevSelectableItem=y,t.findNextSelectableItem=v,t.getParentFolderModel=r,t.getNumberOfItemsInFolder=function(e,t){var r=S(e,t);if(!r||"folder"!==r.type)return 0;for(var n=0,i=e.__itemModelArray.length,o=r.index+1;o<i&&e.__itemModelArray[o].folderId===t;o++)n+=1;return n},t.isItemSecret=b,t.isItemSelectable=x,t.isItemHiddenFromUI=w,t.getAllItemModels=function(e){return e.__itemModelArray},t.getAllHelperItemModels=function(e){return h.values(e.__helperIdToModel)},t.eachLatex=_,t.findAvailableColumnSubscript=function(e){var n=[];_(e,function(e){if(-1===e.indexOf("~")&&-1===e.indexOf("\\sim"))for(var t=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var r=t.exec(e);if(!r)break;n.push(parseInt(r[1]||r[2],10))}}),n.sort(function(e,t){return e-t});for(var t=1,r=0;r<n.length;r++)n[r]===t&&t++;return t},t.updateDrawOrder=function(e){var t=[];h.each(e.__itemModelArray,function(e){"table"===e.type?h.each(e.columnModels,function(e){t.push(e.id)}):t.push(e.id)}),e.drawOrder=t},t.getItemById=S,t.getHelperExpressionById=E,t.addHelperExpression=function(e,t){var r=p.init(t);e.__helperIdToModel[r.id]=r},t.reindex=M,t.removeAllItems=I,t.getItemCount=T,t.hasNoVisibleExpressions=function(e){return 1===e.nextDisplayIndex},t.getAllModelsWithSliders=function(e){for(var t=[],r=0;r<e.__itemModelArray.length;r++){var n=e.__itemModelArray[r];"expression"===n.type&&n.sliderExists&&t.push(n)}return t},t.getSelected=C,t.getUndoRedoState=function(e){return{list:e.__itemModelArray.map(function(e){return e.cachedUndoRedoState})}},t.getState=function(e,t){return{list:e.__itemModelArray.map(function(e){switch(e.type){case"expression":return c.getState(e,t);case"image":return d.getState(e,t);case"table":return u.getState(e,t);case"folder":return s.getState(e,t);case"text":return l.getState(e,t);default:return e}})}},t.getLargestIntegerId=function(e){for(var t=0,r=/^[0-9]+$/,n=e.list.length-1;0<=n;n--){var i=e.list[n],o=i.id;if(r.test(o)&&t<(s=parseInt(o,10))&&(t=s),"table"===i.type&&i.columns)for(var a=i.columns.length-1;0<=a;a--)if(o=i.columns[a].id,r.test(o)){var s;t<(s=parseInt(o,10))&&(t=s)}}return t},t.setListState=function(e,t,r){var n,i;for(r||(r={}),e.colorIdx=0,I(e),e.expressionAnalysis={},n=0;n<t.list.length;n++){if(i=k(e,t.list[n]),r.remapColors&&"color"in i&&i.color){var o=h.values(e.controller.getColors());h.contains(o,i.color)||(i.color=a.closestColor(i.color,o))}e.__itemModelArray.push(i),e.__itemIdToModel[i.id]=i}M(e),1===e.nextDisplayIndex&&D(e,k(e,{type:"expression",id:e.controller.generateId(),color:e.controller.getNextColor()}),e.__itemModelArray.length)},t.modelFromSpec=k,t.restoreListState=function(e,t){var r,n,i=e.__itemIdToModel;for(e.__itemModelArray=[],e.__itemIdToModel={},r=0;r<t.list.length;r++){var o=t.list[r];if((n=i[o.id])&&n.type===o.type)switch(n.type){case"expression":if(o.type!==n.type)throw new Error("invalid restoration");c.restoreState(n,o);break;case"table":if(o.type!==n.type)throw new Error("invalid restoration");u.restoreState(n,o);break;case"image":if(o.type!==n.type)throw new Error("invalid restoration");d.restoreState(n,o);break;case"folder":if(o.type!==n.type)throw new Error("invalid restoration");s.restoreState(n,o);break;case"text":if(o.type!==n.type)throw new Error("invalid restoration");l.restoreState(n,o);break;default:return n}else n=k(e,o);e.__itemModelArray.push(n),e.__itemIdToModel[n.id]=n}M(e)},t.onGraphComputed=function(e,t,r){var n=S(e,t);if(n&&"expression"===n.type){for(var i,o=!1,a=0;a<r.length;a++){var s=r[a];"resolved"in s&&!s.resolved&&(o=!0),s.boundingBox&&(i=i?g.UnionViewports(s.boundingBox,i):s.boundingBox)}n.unresolved=o,n.boundingBox=i;for(var l=1/0,c=-1/0,u=0,p=r;u<p.length;u++){var d=p[u];if(d.graphMode===f.POLAR){var h=d.sampledDomain;h&&(l=Math.min(l,h.min),c=Math.max(c,h.max))}}isFinite(l)&&(n.__workerSampledDomainMin=l),isFinite(c)&&(n.__workerSampledDomainMax=c)}},t.onEvaluatorFormulaUpdates=function(e,t){var r,n,i,o=m.default(e.expressionAnalysis);for(r in t)if(t.hasOwnProperty(r)){i=t[r],n=S(e,r);var a={isGraphable:!!i.is_graphable,isError:!!i.error,errorMessage:i.error?e.controller.unpack(i.error):void 0};if(n)switch(n.type){case"expression":if(c.onFormulaUpdate(n,i),i.zero_values&&1===i.zero_values.length){var s=i.zero_values[0].val;h.isNumber(s)&&(a.evaluation={type:"Number",value:s},a.evaluationDisplayed=!0),h.isArray(s)&&s.every(h.isNumber)&&(a.evaluation={type:"ListOfNumber",value:s.slice()},a.evaluationDisplayed=!0)}else i.hasOwnProperty("constant_value")&&h.isNumber(i.constant_value)&&(a.evaluation={type:"Number",value:i.constant_value},a.evaluationDisplayed=!1);break;case"image":d.onFormulaUpdate(n,i);break;case"table":u.onFormulaUpdate(n,i);break;case"folder":case"text":break;default:return n}else{var l=E(e,r);if(!l)continue;p.onFormulaUpdate(e.controller,l,i)}o[r]=a}e.expressionAnalysis=o},t.setSelected=P,t.verifyFolderIntegrity=function(e){for(var t="",r=0,n=e.__itemModelArray;r<n.length;r++){var i=n[r];"folder"===i.type?(t=i.id,""!==i.folderId&&o.setFolderId(i,"")):""===i.folderId?t="":i.folderId!==t&&(o.setFolderId(i,""),t="")}},t.moveItemsTo=function(e,t,r,n){if(t!==r){var i=e.__itemModelArray.splice(t,n);t<r&&(r=r-n+1),e.__itemModelArray.splice.apply(e.__itemModelArray,[r,0].concat(i)),M(e)}},t.insertItemAtIndex=D,t.insertItemAtEnd=function(e,t){D(e,t,T(e))},t.removeItemAtIndex=A,t.removeItemById=function(e,t){var r=S(e,t);r&&A(e,r.index)},t.selectPrevItem=function(e){var t=C(e);if(!t)return!1;var r=y(e,t.index);return!!r&&(P(e,r),r.index===T(e)-1&&"expression"===t.type&&c.isEmpty(t)&&A(e,r.index),!0)},t.selectNextItem=function(e){var t=C(e);if(!t)return!1;var r=v(e,t.index);return!!r&&(P(e,r),!0)},t.isItemSelected=L,t.setDragState=function(e,t){e.dragState=t}}),define("graphing-calc/models/abstract-item",["require","exports","./list"],function(e,t,r){"use strict";function n(){return"abstract_item_"+i++}Object.defineProperty(t,"__esModule",{value:!0});var i=0;t.getGUID=n,t.DEFAULTS=function(e){return{guid:n(),controller:e,index:-1,displayIndex:-1,secretIndex:-1,isHiddenFromUI:!0,renderShell:!0}},t.setSecret=function(e,t){e.secret=t},t.setFolderId=function(e,t){e.folderId=t},t.updateIsHiddenFromUI=function(e){e.isHiddenFromUI=r.isItemHiddenFromUI(e)},t.getDisplayState=function(e){return e.isHiddenFromUI?"none":e.renderShell?"shell":"render"}}),define("graphing-calc/json/table",["require","exports","tslib","lib/default-spec","graphing/dragmode","expressions/styles"],function(e,r,n,t,i,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULTS={folderId:"",secret:!1,columns:[]},r.COLUMN_DEFAULTS={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:i.NONE,pointStyle:o.POINT,lineStyle:o.SOLID},r.inflateDefaults=function(e){var t=n.__assign({},r.DEFAULTS,e);return t.columns=t.columns.map(function(e){return n.__assign({},r.COLUMN_DEFAULTS,e)}),t},r.stripDefaults=function(e){return e=n.__assign({},e,{columns:e.columns.map(function(e){return t.stripDefaults(r.COLUMN_DEFAULTS,e)})}),t.stripDefaults(r.DEFAULTS,e)},r.computeParsableState=function(t){return{type:"table",id:t.id,columns:t.columns.map(function(e){return n.__assign({},e,{tableId:t.id})})}}}),define("graphing-calc/models/table",["require","exports","math/rational-arithmetic-sequence","tslib","graphing/dragmode","expressions/styles","./abstract-item","underscore","graphing/label","lib/evaluate-single-expression","math/distance","lib/deepCopy","lib/copy-properties","graphing-calc/models/list","../json/table","../json/table","../json/table"],function(e,t,h,s,a,l,c,n,u,f,g,p,o,i,d,m,y){"use strict";function v(e,t,r,n){n.row=e.rowModels[t],n.row.cells.splice(r,0,n)}function b(e,t,r){e.rowModels[t].cells.splice(r,1)}function x(e){return isFinite(e)?u.truncatedLatexLabel(e,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function w(e,t,r){var n=e.columnModels[t];n.error=r.error,n.discrete=r.discrete,n.disabled=r.dependent,n.draggable=!r.error&&!r.dependent,n.packedErrors=[],n.computedValues=[];for(var i=r.values,o=i.length-1;0<=o;o--){var a=i[o];n.computedValues[o]="number"==typeof a?x(a):"",n.packedErrors[o]=a&&a.msg?a:void 0}}function _(e,t){var r=e.columnModels[t];return{values:e.columns[t].values.slice(),dragMode:r.dragMode,hidden:r.hidden,id:r.id,color:r.color,points:r.points,lines:r.lines,pointStyle:r.pointStyle,lineStyle:r.lineStyle,latex:r.latex}}function S(){return"table_guid_"+r++}function E(){return{guid:S(),type:"cell",row:void 0,column:void 0}}function M(e){return{index:e,guid:S(),cells:[]}}function I(e,t,r,n){var i=e.columnModels[t];i.cells.splice(r,0,n),n.column=i,e.columns[i.index].values.splice(r,0,"")}function T(e,t,r){var n=e.columnModels[t];n.cells.splice(r,1),e.columns[n.index].values.splice(r,1)}function C(e,t,r){var n=s.__assign({},r,{type:"header",guid:S(),index:t,error:void 0,table:e,color:r.color||e.controller.getNextColor(),packedErrors:[],computedValues:[],cells:void 0,row:void 0,discrete:void 0,shouldGraph:void 0,disabled:void 0,draggable:void 0});return n.cells=n.values.map(function(){var e=E();return e.column=n,e}),delete n.values,0===t&&(n.hidden=!0),n}function k(e,t){var r=M(t+1);e.rowModels.splice(t+1,0,r);for(var n=t+1;n<e.rowModels.length;n++)e.rowModels[n].index=n;for(n=0;n<e.columnModels.length;n++){var i=E();I(e,n,t,i),v(e,t+1,n,i)}}function P(e,t,r){var n=s.__assign({},d.COLUMN_DEFAULTS,r,{values:e.columns[0].values.map(function(){return""})}),i=C(e,t,n);e.columnModels.splice(t,0,i),e.columns.splice(t,0,n);for(var o=t+1;o<e.columnModels.length;o++)e.columnModels[o].index=o;for(v(e,0,t,i),o=1;o<e.rowModels.length;o++)v(e,o,t,i.cells[o-1])}function D(t){for(var e=y.computeParsableState({type:"table",id:t.id,secret:t.secret,folderId:t.folderId,columns:t.columnModels.map(function(e){return _(t,e.index)})}),r=0;r<e.columns.length;r++)e.columns[r].hidden=!t.columnModels[r].shouldGraph;t.cachedParsableState=e}function A(e,t){return(e=p.default(e)).push(s.__assign({},d.COLUMN_DEFAULTS,{id:t,values:e[0].values.map(function(){return""})})),e.forEach(function(e){e.values.push("")}),e}function L(e){return(e=p.default(e)).pop(),e.forEach(function(e){e.values.pop()}),e}function O(e,t){var r=s.__assign({},e.cachedViewState,{columns:L(e.cachedViewState.columns)});return t.stripDefaults?m.stripDefaults(r):r}function q(r){var e=r.columnModels.map(function(e,t){return _(r,t)});r.cachedViewState={id:r.id,type:r.type,folderId:r.folderId,columns:e,secret:r.secret}}function F(e){var t=s.__assign({},e.cachedViewState,{columns:L(e.cachedViewState.columns)});e.preTransientState&&(t=s.__assign({},t,e.preTransientState)),e.cachedUndoRedoState=t}function N(e,t){if(e.columnModels.length-1!==t.length)return{type:"start-fresh"};if(e.columnModels[0].cells.length-1!==t[0].values.length)return{type:"start-fresh"};for(var r=-1,n=t.length-1;0<=n;n--){var i=e.columns[n],o=t[n];if(i.id!==o.id)return{type:"start-fresh"};for(var a=i.values,s=o.values,l=s.length-1;0<=l;l--)if(a[l]!==s[l]&&(-1===r&&(r=l),r!==l))return{type:"start-fresh"}}return-1===r?{type:"none"}:{type:"edit-row",rowIndex:r}}function R(r){r.columnModels=r.columns.map(function(e,t){return C(r,t,e)}),r.rowModels=[M(0)];for(var e=0;e<r.columnModels.length;e++)v(r,0,e,r.columnModels[e]);for(e=0;e<r.columnModels[0].cells.length;e++){var t=M(e+1);r.rowModels.push(t);for(var n=0;n<r.columnModels.length;n++)v(r,e+1,n,r.columnModels[n].cells[e])}}function B(e,t){for(var r=0;r<e.columnModels.length;r++){var n=e.columnModels[r];if(n.id===t)return n}throw new Error("could not find ColumnModel with id: "+t)}function j(e,t,r){if(0===t.row)return B(e,e.columnModels[t.column].id).latex=r,void(t.column>=e.columnModels.length-1&&P(e,t.column+1,{id:e.controller.generateId(),latex:"",color:e.controller.getNextColor()}));var n=e.columnModels[t.column];""!==(e.columns[n.index].values[t.row-1]=r)&&t.row>=e.columnModels[0].cells.length&&k(e,t.row)}Object.defineProperty(t,"__esModule",{value:!0}),t.insertCellToRow=v,t.removeCellFromRow=b,t.formatValueForDisplay=x,t.setColumnComputedValues=w,t.getColumnState=_;var r=0;t.getGUID=S,t.makeCell=E,t.makeRow=M,t.insertCellToColumn=I,t.removeCellFromColumn=T,t.makeColumn=C,t.onControllerUpdate=function(e){e.draggingOnGraphpaper?e.preTransientState||(e.preTransientState={columns:O(e,{stripDefaults:!1}).columns}):delete e.preTransientState,c.updateIsHiddenFromUI(e);var t=i.getParentFolderModel(e),r=t&&t.hidden;n.each(e.columnModels,function(e){e.shouldGraph=!r&&!e.hidden}),q(e),F(e),D(e)},t.onFormulaUpdate=function(e,t){e.formula=t;var r,n=e.formula.column_data,i=e.columnModels[0].cells.length,o=0;for(r=0;r<n.length;r++){var a=n[r].values.length;o<a&&(o=a)}for(r=o-i;0<r;r--)k(e,i),i++;for(r=0;r<n.length;r++)w(e,r,n[r]);var s=e.columnModels[e.columnModels.length-1];s.disabled=!0,s.error=void 0},t.insertBlankRow=k,t.removeRow=function(e,t){for(var r=0;r<e.columnModels.length;r++)T(e,r,t);for(e.rowModels.splice(t+1,1),r=t+1;r<e.rowModels.length;r++)e.rowModels[r].index=r},t.insertBlankColumn=P,t.removeColumn=function(e,t){e.columnModels.splice(t,1);for(var r=t;r<e.columnModels.length;r++)e.columnModels[r].index=r;for(r=0;r<e.rowModels.length;r++)b(e,r,t)},t.getRowAutoFillValues=function(e,t){var r,n=e.columnModels.length,i=[];for(r=0;r<n;r++)i.push("");var o=e.columns[0].values;if(1<t){var a=e.controller.isDegreeMode(),s=f.default(o[0],a),l=f.default(o[1],a);if(isFinite(s)&&isFinite(l)){var c=h(s,l);if(c){var u=c.nstart,p=u/c.lcm;for(r=0;r<t;r++){var d=f.default(o[r],a);if(!g.approx(d,p))return i;p=(u+=c.nstep)/c.lcm}i[0]=(""+s).length<8&&(""+l).length<8?""+p:"\\frac{"+u+"}{"+c.lcm+"}"}}}return i},t.eachLatex=function(e,t){for(var r=0;r<e.columnModels.length;r++){t(e.columnModels[r].latex);for(var n=e.columns[r],i=0;i<n.values.length;i++)n.values[i]&&t(n.values[i])}},t.updateCachedParsableState=D,t.addBlankRowAndColumn=A,t.stripBlankRowAndColumn=L,t.getState=O,t.updateCachedViewState=q,t.setIsDraggingOnGrapher=function(e,t){e.draggingOnGraphpaper=t},t.updateCachedUndoRedoState=F,t.computeTableStructureMutation=N,t.restoreState=function(e,t){var r=N(e,t.columns);if(o.copyProperties({from:t,to:e,props:{id:!1,type:!1,columns:!1,folderId:!0,secret:!0}}),"start-fresh"===r.type)e.columns=A(t.columns,e.controller.generateId()),R(e);else{switch(r.type){case"none":break;case"edit-row":for(var n=t.columns.length-1;0<=n;n--)j(e,{column:n,row:r.rowIndex+1},t.columns[n].values[r.rowIndex]);break;default:return r}for(var i=0;i<t.columns.length;i++)o.copyProperties({from:t.columns[i],to:e.columnModels[i],props:{id:!1,values:!1,color:!0,latex:!0,hidden:!0,points:!0,lines:!0,dragMode:!0,lineStyle:!0,pointStyle:!0}})}},t.initModel=function(e,t){var r=p.default(m.inflateDefaults(e)),n=s.__assign({},r,c.DEFAULTS(t),{columnModels:void 0,rowModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoState:{}});n.columns=A(n.columns,t.generateId());var i,o=0;for(i=0;i<n.columns.length;i++)n.columns[i].values||(n.columns[i].values=[]),n.columns[i].values.length>o&&(o=n.columns[i].values.length);for(i=0;i<n.columns.length;i++)for(var a=o-n.columns[i].values.length;0<a;a--)n.columns[i].values.push("");return R(n),n},t.buildEntireColumnStructure=R;var V=["x","y","z","u","v","w"];t.makeTableState=function(e,t,r){for(var n=[],i=Math.min(t.length,V.length),o=0;o<i;o++)n.push({id:r.generateId(),latex:u.identifierToLatex(V[o]+"_"+e),values:t[o],color:r.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:a.NONE,pointStyle:l.POINT,lineStyle:l.SOLID});return{id:r.generateId(),type:"table",folderId:"",secret:!1,columns:n}},t.cloneTableAndExtendWithProperties=function(e,t){var r=O(e,{stripDefaults:!1});if(!r.columns||!t.columns)return t;for(var n=0;n<t.columns.length;n++){var i=r.columns[n],o=t.columns[n];if(i)for(var a in i)i.hasOwnProperty(a)&&(o.hasOwnProperty(a)||(o[a]=i[a]))}return t},t.getSelectedCell=function(e){var t=e.controller.getFocusLocation();return t&&"table"===t.type&&t.id===e.id?t.location:void 0},t.getColumnModel=B,t.setColumnPoints=function(e,t,r){var n=B(e,t);(n.points=r)||(n.dragMode=a.NONE)},t.setColumnPointStyle=function(e,t,r){B(e,t).pointStyle=r},t.setColumnLines=function(e,t,r){B(e,t).lines=r},t.setColumnLineStyle=function(e,t,r){B(e,t).lineStyle=r},t.setColumnDragMode=function(e,t,r){var n=B(e,t);(n.dragMode=r)===a.NONE||n.points||(n.points=!0)},t.setColumnColor=function(e,t,r){B(e,t).color=r},t.setColumnHidden=function(e,t,r){B(e,t).hidden=r},t.shouldHideColumn=function(e,t){var r=B(e,t);return!r.points&&!r.lines},t.setCellLatex=j,t.doesCellExist=function(e,t){return t.row<e.rowModels.length&&t.column<e.columnModels.length},t.isColumnEmpty=function(e){if(e.values)for(var t=0,r=e.values;t<r.length;t++)if(""!==r[t])return!1;if(e.computedValues)for(var n=0,i=e.computedValues;n<i.length;n++)if(""!==i[n])return!1;return!0}}),define("main/propagate_selection",["require","graphing-calc/models/table"],function(e){function a(e){var t=e&&e.id;if(e&&"table"===e.type){var r=o.getSelectedCell(e);if(r){var n=e.columnModels[r.column];t=n?n.id:void 0}else t=void 0}if(e&&"folder"===e.type){var i=e.selectedHiddenChild;t=i?i.id:void 0}return t}var o=e("graphing-calc/models/table");return{getSelectedId:a,propagateSelection:function(e,t,r,n){var i=a(e.getSelectedItem());if(i!==n){t.select(i);var o={};void 0!==i&&(o[i]=!0),r.setIntersectIds(o),r.updateIntersections(i)}return i}}}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("flux",[],t):"object"==typeof exports?exports.Flux=t():e.Flux=t()}(this,function(){return function(r){function n(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var i={};return n.m=r,n.c=i,n.p="",n(0)}([function(e,t,r){"use strict";e.exports.Dispatcher=r(1)},function(e,t,r){"use strict";t.__esModule=!0;var n=r(2),i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||n(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||n(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var r=e[t];this._isPending[r]?this._isHandled[r]||n(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",r):(this._callbacks[r]||n(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",r),this._invokeCallback(r))}},e.prototype.dispatch=function(e){this._isDispatching&&n(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=i},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i,o,a,s){if(void 0===t)throw new Error("invariant requires an error message argument");if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,i,o,a,s],u=0;(l=new Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}}])}),define("lib/conditional_blur",["require","exports","touchtracking","jquery"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=n(document.activeElement);r.elIsFocusable(e)&&n(document.activeElement).blur()}}),define("lib/state-stack",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=100),this.clear(),this._sizeLimit=e}return e.prototype.clear=function(){this._stack=[],this._stackPointer=-1},e.prototype.getState=function(){return this._stack[this._stackPointer]},e.prototype.serializeForBugsnag=function(){function e(e){try{return JSON.stringify(e,null,2)}catch(e){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}},e.prototype.addState=function(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1},e.prototype.replaceState=function(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),0===this._stack.length?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e},e.prototype.canUndo=function(){return 0<this._stackPointer},e.prototype.canRedo=function(){return this._stackPointer<this._stack.length-1},e.prototype.undo=function(){this.canUndo()&&(this._stackPointer-=1)},e.prototype.redo=function(){this.canRedo()&&(this._stackPointer+=1)},e}();t.default=r}),define("vendor/papaparse",["require","jquery"],function(e){"use strict";function n(o){(o=o||{}).chunkSize||(o.chunkSize=A.RemoteChunkSize);var a,s,l=0,c="",u="",p=new h(m(o));this.stream=function(t){function r(){if(4==a.readyState){if(a.status<200||400<=a.status)return void i();c+=u+a.responseText,u="";var e=!o.step||l>(n=a.getResponseHeader("Content-Range"),parseInt(n.substr(n.lastIndexOf("/")+1)));if(!e){var t=c.lastIndexOf("\n");if(t<0&&(t=c.lastIndexOf("\r")),!(-1<t))return void s();u=c.substring(t+1),c=c.substring(0,t)}var r=p.parse(c);c="",D(o.chunk)&&(o.chunk(r),r=void 0),e||r.meta.paused||s()}var n}function i(){D(o.error)&&o.error(a.statusText)}(s=function(){!function(){if((a=new XMLHttpRequest).onload=r,a.onerror=i,a.open("GET",t,!0),o.step){var e=l+o.chunkSize-1;a.setRequestHeader("Range","bytes="+l+"-"+e)}a.send(),l+=o.chunkSize}()})()}}function i(a){(a=a||{}).chunkSize||(a.chunkSize=A.LocalChunkSize);var s,l=0,c="",u="",p=new h(m(a)),d="function"==typeof FileReader;this.stream=function(i){function o(){var e,t;l<i.size&&(e=Math.min(l+a.chunkSize,i.size),t=s.readAsText(n.call(i,l,e),a.encoding),d||r({target:{result:t}}))}function r(e){l+=a.chunkSize,c+=u+e.target.result,u="";var t=l>=i.size;if(!t){var r=c.lastIndexOf("\n");if(r<0&&(r=c.lastIndexOf("\r")),!(-1<r))return void o();u=c.substring(r+1),c=c.substring(0,r)}var n=p.parse(c);c="",D(a.chunk)&&(a.chunk(n,i),n=void 0),t||n.meta.paused||o()}var n=i.slice||i.webkitSlice||i.mozSlice;d?((s=new FileReader).onload=r,s.onerror=function(){D(a.error)&&a.error(s.error,i)}):s=new FileReaderSync,o()}}function h(d){function n(){return f&&l&&(o("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+A.DefaultDelimiter+"'"),l=!1),i()&&function(){if(f){for(var e=0;i()&&e<f.data.length;e++)for(var t=0;t<f.data[e].length;t++)h.push(f.data[e][t]);f.data.splice(0,1)}}(),function(){if(!f||!d.header&&!d.dynamicTyping)return f;for(var e=0;e<f.data.length;e++){for(var t={},r=0;r<f.data[e].length;r++){if(d.dynamicTyping){var n=f.data[e][r];f.data[e][r]="true"==n||"false"!=n&&(i=n,void 0,c.test(i)?parseFloat(i):i)}d.header&&(r>=h.length?(t.__parsed_extra||(t.__parsed_extra=[]),t.__parsed_extra.push(f.data[e][r])):t[h[r]]=f.data[e][r])}d.header&&(f.data[e]=t,r>h.length?o("FieldMismatch","TooManyFields","Too many fields: expected "+h.length+" fields but parsed "+r,e):r<h.length&&o("FieldMismatch","TooFewFields","Too few fields: expected "+h.length+" fields but parsed "+r,e))}var i;return d.header&&f.meta&&(f.meta.fields=h),f}()}function i(){return d.header&&0==h.length}function o(e,t,r,n){f.errors.push({type:e,code:t,message:r,row:n})}var a,s,l,c=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,u=this,p=!1,h=[],f={data:[],errors:[],meta:{}};d=m(d),this.parse=function(e){if(l=!1,!d.delimiter){var t=function(e){for(var t,r,n,i=[",","\t","|",";",A.RECORD_SEP,A.UNIT_SEP],o=0;o<i.length;o++){var a=i[o],s=0,l=0;n=void 0;for(var c=new g({delimiter:a,preview:10}).parse(e),u=0;u<c.data.length;u++){var p=c.data[u].length;l+=p,void 0!==n?1<p&&(s+=Math.abs(p-n),n=p):n=p}l/=c.data.length,(void 0===r||s<r)&&1.99<l&&(r=s,t=a)}return{successful:!!(d.delimiter=t),bestDelimiter:t}}(e);t.successful?d.delimiter=t.bestDelimiter:(l=!0,d.delimiter=A.DefaultDelimiter),f.meta.delimiter=d.delimiter}if(D(d.step)){var r=d.step;d.step=function(e){f=e,i()?n():r(n(),u)}}return d.preview&&d.header&&d.preview++,a=e,s=new g(d),f=s.parse(a),n(),D(d.complete)&&!p&&d.complete(f),p?{meta:{paused:!0}}:f},this.pause=function(){p=!0,s.abort(),a=a.substr(s.getCharIndex())},this.resume=function(){p=!1,(s=new g(d)).parse(a),D(d.complete)&&!p&&d.complete(f)},this.abort=function(){s.abort(),D(d.complete)&&d.complete(f),a=""}}function g(e){function t(){for(;w<g.length&&!P&&!(0<b&&b<=C);)'"'==x?u()&&!c()?_=!_:(n(),_&&c()?w++:d("Quotes","UnexpectedQuotes","Unexpected quotes")):_?((s(w)||l(w))&&S++,n()):x==m?i():s(w)?(o(),r()):l(w)?o():y&&(0==w||l(w-1)||s(w-2))&&g[w]===y?function(){for(;!s(w)&&!l(w)&&w<g.length;)r()}():n(),r();return function(){if(P&&d("Abort","ParseAbort","Parsing was aborted by the user's step function"),_&&d("Quotes","MissingQuotes","Unescaped or mismatched quotes"),a(),!D(v))return f()}()}function r(){x=g[++w]}function n(){E[I][T]+=x}function i(){E[I].push(""),T=E[I].length-1}function o(){a(),S++,C++,E.push([]),I=E.length-1,i()}function a(){1==E[I].length&&k.test(E[I][0])&&(e.keepEmptyRows?E[I].splice(0,1):E.splice(I,1),I=E.length-1),D(v)&&(E[I]&&v(f()),h())}function s(e){return e<g.length-1&&("\r"==g[e]&&"\n"==g[e+1]||"\n"==g[e]&&"\r"==g[e+1])}function l(e){return"\r"==g[e]||"\n"==g[e]}function c(){return!u()&&w<g.length-1&&'"'==g[w+1]}function u(){return!_&&p(w-1)||p(w+1)}function p(e){"number"!=typeof e&&(e=w);var t=g[e];return e<=-1||e>=g.length||t==m||"\r"==t||"\n"==t}function d(e,t,r){M.push({type:e,code:t,message:r,line:S,row:I,index:w})}function h(){E=[],M=[],T=I=0}function f(){return{data:E,errors:M,meta:{lines:S,delimiter:m,aborted:P,truncated:0<b&&w<g.length}}}var g,m,y,v,b,x,w,_,S,E,M,I,T,C,k=/^\s*$/,P=!1;m=(e=e||{}).delimiter,y=e.comments,v=e.step,b=e.preview,("string"!=typeof m||1!=m.length||-1<A.BAD_DELIMITERS.indexOf(m))&&(m=","),!0===y?y="#":("string"!=typeof y||1!=y.length||-1<A.BAD_DELIMITERS.indexOf(y)||y==m)&&(y=!1),this.parse=function(e){if("string"!=typeof e)throw"Input must be a string";return g=e,_=!1,C=w=0,S=1,h(),E=[[""]],x=g[w],t()},this.abort=function(){P=!0},this.getCharIndex=function(){return w}}function m(e){if("object"!=typeof e)return e;var t=e instanceof Array?[]:{};for(var r in e)t[r]=m(e[r]);return t}function D(e){return"function"==typeof e}var u=e("jquery"),o={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},A={};return A.parse=function(e,t){var r=function(e){"object"!=typeof e&&(e={});var t=m(e);return("string"!=typeof t.delimiter||1!=t.delimiter.length||-1<A.BAD_DELIMITERS.indexOf(t.delimiter))&&(t.delimiter=o.delimiter),"boolean"!=typeof t.header&&(t.header=o.header),"boolean"!=typeof t.dynamicTyping&&(t.dynamicTyping=o.dynamicTyping),"number"!=typeof t.preview&&(t.preview=o.preview),"function"!=typeof t.step&&(t.step=o.step),"function"!=typeof t.complete&&(t.complete=o.complete),"function"!=typeof t.error&&(t.error=o.error),"string"!=typeof t.encoding&&(t.encoding=o.encoding),"boolean"!=typeof t.download&&(t.download=o.download),"boolean"!=typeof t.keepEmptyRows&&(t.keepEmptyRows=o.keepEmptyRows),t}(t);if("string"==typeof e){if(!r.download)return new h(r).parse(e);new n(r).stream(e)}else e instanceof File&&(r.step||r.chunk?new i(r).stream(e):(new h(r),reader=new FileReader,reader.onload=function(e){new h(r).parse(e.target.result)},reader.onerror=function(){D(r.error)&&r.error(reader.error,e)},reader.readAsText(e,r.encoding)))},A.unparse=function(e,t){function r(e){if("object"!=typeof e)return[];var t=[];for(var r in e)t.push(r);return t}function n(e,t){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=e instanceof Array&&0<e.length,i=!(t[0]instanceof Array);if(n){for(var o=0;o<e.length;o++)0<o&&(r+=p),r+=u(e[o],o);0<t.length&&(r+=d)}for(var a=0;a<t.length;a++){for(var s=n?e.length:t[a].length,l=0;l<s;l++){0<l&&(r+=p);var c=n&&i?e[l]:l;r+=u(t[a][c],l)}a<t.length-1&&(r+=d)}return r}function u(e,t){return null==e?"":(e=e.toString().replace(/"/g,'""'),"boolean"==typeof i&&i||i instanceof Array&&i[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(e,A.BAD_DELIMITERS)||-1<e.indexOf(p)||" "==e.charAt(0)||" "==e.charAt(e.length-1)?'"'+e+'"':e)}var i=!1,p=",",d="\r\n";if("object"==typeof t&&("string"==typeof t.delimiter&&1==t.delimiter.length&&-1==A.BAD_DELIMITERS.indexOf(t.delimiter)&&(p=t.delimiter),("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(i=t.quotes),"string"==typeof t.newline&&(d=t.newline)),"string"==typeof e&&(e=JSON.parse(e)),e instanceof Array){if(!e.length||e[0]instanceof Array)return n(null,e);if("object"==typeof e[0])return n(r(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.data[0]instanceof Array?e.fields:r(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),n(e.fields||[],e.data||[]);throw"exception: Unable to serialize unrecognized input"},A.RECORD_SEP=String.fromCharCode(30),A.UNIT_SEP=String.fromCharCode(31),A.BYTE_ORDER_MARK="\ufeff",A.BAD_DELIMITERS=["\r","\n",'"',A.BYTE_ORDER_MARK],A.LocalChunkSize=10485760,A.RemoteChunkSize=5242880,A.DefaultDelimiter=",",A.Parser=g,A.ParserHandle=h,A.NetworkStreamer=n,A.FileStreamer=i,u.fn.parse=function(s){function e(){if(0!=c.length){var t=c[0];if(D(s.before)){var e=s.before(t.file,t.inputElem);if("object"==typeof e){if("abort"==e.action)return n="AbortError",i=t.file,o=t.inputElem,a=e.reason,void(D(s.error)&&s.error({name:n},i,o,a));if("skip"==e.action)return void l();"object"==typeof e.config&&(t.instanceConfig=u.extend(t.instanceConfig,e.config))}else if("skip"==e)return void l()}var r=t.instanceConfig.complete;t.instanceConfig.complete=function(e){D(r)&&r(e,t.file,t.inputElem),l()},A.parse(t.file,t.instanceConfig)}var n,i,o,a}function l(){c.splice(0,1),e()}var r=s.config||{},c=[];return this.each(function(e){if(!("INPUT"==u(this).prop("tagName").toUpperCase()&&"file"==u(this).attr("type").toLowerCase()&&window.FileReader)||!this.files||0==this.files.length)return!0;for(var t=0;t<this.files.length;t++)c.push({file:this.files[t],inputElem:this,instanceConfig:u.extend({},r)})}),e(),this},A}),define("bugsnag",["require","exports","tslib"],function(e,t,o){"use strict";var a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){a||(a=e({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,maxEvents:1,consoleBreadcrumbsEnabled:!1,beforeSend:function(e){r&&r(e)}}))},t.notify=function(e,t){a&&a.notify(e,t)},t.leaveBreadcrumb=function(e,t,r,n){if(t)for(var i in t=o.__assign({},t))try{t[i]=JSON.stringify(t[i],null,2)}catch(e){t[i]="[[could not stringify]]"}a&&a.leaveBreadcrumb(e,t,r,n)},t.setBeforeSendCB=function(e){r=e}}),define("classifier/classify",["require","exports","tslib","math/parser/latex-lexer"],function(e,t,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={Letter:2.156219035621851,Symbol:-1.3955973111865143,Digit:-2.0187663223829224,Left:-7.301023550701673,EscapedSymbol:-9.275703878032967,Right:-7.301023825347384,"^":-3.702774744662061,Frac:-8.235766712671952,"{":-5.193756353978961,"}":-5.2091412728184405,Cmd:-7.50431522952453,Sqrt:-8.586560878205761,"[":.03831036387053607,"]":.05570210658240527,_:-1.7156133278555172,Primes:4.903727028603438,"Letter Symbol":-.587455596598396,"Symbol Digit":-2.342805435433473,"Digit Digit":-1.9386043709163656,"Digit Left":-10.697650284847587,"Left EscapedSymbol":-10.98041713966381,"EscapedSymbol Symbol":-8.5117449230521,"Digit Symbol":-1.8779763152981215,"Symbol Letter":-.1405240762419908,"Symbol Symbol":-.6475366838293403,"Digit Right":-8.311491735655617,"Right EscapedSymbol":-10.980416619794807,"EscapedSymbol Letter":-9.735492625122268,"EscapedSymbol Digit":-10.243800974521639,"Digit Letter":.269772262816565,"EscapedSymbol Left":-9.119999761194801,"Left Symbol":-6.561757865357271,"Letter ^":-2.278642569351918,"^ Digit":-4.132434723614744,"Right Symbol":-6.561759031337466,"Symbol ^":-5.036021881596493,"Symbol Left":-6.967910898703368,"Symbol Frac":-8.166757548038712,"Frac {":-8.235766712671952,"{ Left":-8.991807634715721,"Symbol }":-4.596921941829504,"} {":-6.754162171747737,"{ Digit":-6.048251708685925,"Digit }":-5.6813597584647075,"} Right":-7.12081343692023,"Digit Cmd":-8.720476643659573,"Cmd Letter":-7.0146829549360925,"Letter Cmd":-7.420424080237284,"Cmd Digit":-8.876029742533563,"{ Symbol":-4.582909223105274,"{ Letter":-3.5921906493779776,"Letter }":-3.609737593111089,"Cmd Symbol":-6.761368546579928,"Cmd Left":-8.80721391308075,"} Letter":-3.432792087414758,"} Sqrt":-5.74145896772395,"Sqrt {":-8.558004096883055,"} Symbol":-5.316686511513064,"Cmd Frac":-6.712095356064388,"Digit ^":-3.442002974722137,"Letter Left":-4.421537036182191,"Letter Right":-5.36130523753825,"Symbol Cmd":-5.960388282212457,"EscapedSymbol Frac":-7.562569839199085,"Cmd Cmd":-6.475569226325829,"Cmd Sqrt":-5.091083672473911,"} }":-7.218479057816111,"} Cmd":-6.318841943492862,"^ {":-5.444688757128561,"} Left":-6.467851007802071,"Symbol Right":-6.529432241317352,"Digit Frac":-7.173524841449775,"} Digit":-4.832392713235034,"Symbol Sqrt":-7.925378801801921,"Letter Letter":5.573955833488698,"^ Letter":-.34821475407072777,"Letter Digit":3.715128234020657,"Cmd ^":-4.893017335051469,"{ Cmd":-6.590644689725278,"Cmd }":-7.207298467808705,"Digit Sqrt":-7.325131774172862,"EscapedSymbol Right":-6.7683521840218885,"{ Frac":-6.166651132780269,"} Frac":-5.081272273013265,"EscapedSymbol Cmd":-7.28561342161958,"Cmd Right":-6.477941149516706,"EscapedSymbol Sqrt":-5.5587846150187685,"Sqrt [":-5.01665790523756,"[ Digit":-1.1565164295080437,"Digit ]":-.27253982970500096,"] {":-5.01665790523756,"Letter _":-2.169853996499765,"_ Letter":-.8680926855845452,"_ {":-5.321268907503729,"_ Digit":-2.475564458334699,"{ Sqrt":-5.698311290953599,"} ^":-5.814103144043405,"Cmd _":-4.441413614112532,"Letter Frac":-4.096008984739159,"Letter Sqrt":-3.7535258288937885,"EscapedSymbol ^":-.9689436791314612,"EscapedSymbol }":-4.330364208467625,"{ ^":1.1866870009059214,"Letter Primes":6.061019060617993,"Primes Letter":5.698810630211005,"{ }":.2624280993825892,"Letter EscapedSymbol":1.0043654441119667,"Symbol Primes":2.713433197494908,"Digit Primes":2.7784253362406206,"Cmd Primes":-.8545333279537168,"Left [":-4.20694054544644,"[ Left":-.22429997280434075,"Right ]":-4.20694054544644,"] Symbol":2.1951677852481577,"[ Frac":-3.4323860902511614,"] ^":-3.6998956445203555,"[ Letter":2.5281673462360192,"Letter ]":3.9298285218194016,"] Left":-.9051770607724716,"] }":-1.4233827918360848,"[ Symbol":2.7444529027957008,"] Letter":3.4186545266860136,"Primes Cmd":-2.3657998283024604,"] Right":-1.7147345931768285,"Digit [":3.3557407012754443,"[ Cmd":.7812218927977569,"Symbol ]":3.62280348652449,"] [":3.322218009236801,"} ]":2.390659805231857,"} _":2.3906598052318575,"Symbol [":5.41108469137622,"Primes Symbol":6.172004487017887,"^ Symbol":3.9412572176430243,"} Primes":-.4227509115281791,"] Cmd":-.5360795968351822,"Primes Frac":2.1029777327800763,"Cmd [":1.8798341814658668,"Digit _":4.941524422811655,"Cmd EscapedSymbol":-.8414612463863641,"EscapedSymbol Primes":-1.1928591332242529,"Letter [":5.800907022413931,"Primes Left":.3112182635520215,"Symbol EscapedSymbol":3.6434227737272256,"Digit EscapedSymbol":.39822964054165105,"EscapedSymbol [":2.3906598052318575,"Cmd ]":2.1029777327800763,"Primes Digit":3.489272093899967,"Symbol _":5.43518224295528,"{ _":-.2949175400182943,"EscapedSymbol EscapedSymbol":1.2920475165637477,"_ Symbol":5.7918571868940125,"[ Sqrt":1.8798341814658668,"] Digit":3.740586522180873,"Cmd {":2.1029777327800763,"} EscapedSymbol":1.697512624671912,"{ EscapedSymbol":1.0043654441119667,"Primes }":2.3906598052318575,"Letter {":8.152711188012034,"Symbol {":8.114244907184238,"^ ^":7.532323361734517,"Primes Primes":4.875566455019857,"_ _":9.309355024252328,"Digit {":6.054221451361504,"[ [":5.098710006334067,"] ]":5.098710006334067,"[ _":5.686496671236187,"_ ]":5.686496671236187,"{ [":4.587884382568077,"} [":6.197322295002177},u=r.__assign({},n,{"_ {":-10*n["Letter Letter"]});t.classify=function(e){for(var t=function(e){for(var t=[],r=c.lex(e);!c.isDone(r);)t.push(c.peek(r).type),r=c.advance(r);return t}(e),r=-50,n=0,i=[1,2];n<i.length;n++)for(var o=i[n],a=0;a<t.length-(o-1);a++)r+=(s=t.slice(a,a+o),l=s.join(" "),u[l]||0);var s,l;return 0<r?"text":"latex"}}),define("geometry/math/isNumber",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNumber=function(e){return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}}),define("main/data_helpers",["require","exports","vendor/papaparse","underscore","bugsnag","classifier/classify","geometry/math/isNumber"],function(e,t,s,c,l,u,p){"use strict";function i(e,t,r){var n=c.map(e,function(e){return parseFloat(e)});(n=c.filter(n,function(e){return isFinite(e)})).push(0);var i=c.max(n),o=c.min(n),a=Math.max(i,r)-Math.min(o,t),s=r,l=t;return r<i+.1*a&&(s=i+.2*a),o-.1*a<t&&(l=o-.2*a),[l,s]}Object.defineProperty(t,"__esModule",{value:!0}),t.getExpressions=function(e){var t=e.split(/\r?\n/),r=[],n=!1;if(!(t.length<2)){for(var i=0;i<t.length;i++){var o=t[i];if(o.trim()){var a=u.classify(t[i]);"text"!==a&&p.isNumber(o)||(n=!0),"text"===a&&0<r.length&&"text"===r[r.length-1].type?r[r.length-1].content+="\n"+o:r.push({type:a,content:o})}}return n?r:[{content:"\\left["+c.pluck(r,"content").join(",")+"\\right]",type:"latex"}]}if(30<e.length&&"text"===u.classify(e))return[{type:"text",content:e}]},t.parse=function(e){if(!/^\s*$/.test(e)){var t=s.parse(e,{preview:50}),r=[];if(t.errors.length&&!t.data.length)return void l.notify("PapaParse.parse returned errors.",{metaData:{input:e,output:t.errors}});if(t.data.length&&!(t.data.length<2)){for(var n=t.data[0].length,i=0;i<n;i++)r.push([]);for(var o=0;o<t.data.length;o++)if(0!==o||!isNaN(parseFloat(t.data[o][0]))){if(t.data[o].length<2)return;if(t.data[o][0]||t.data[o][1])for(i=0;i<n;i++){var a=(t.data[o][i]||"").replace(/,/g,"");if(a&&isNaN(parseFloat(a)))return;r[i].push(a)}}if(!(r[0].length<2))return r}}},t.computeNewViewport=function(e,t){var r=i(t[0],e.xmin,e.xmax),n=i(t[1],e.ymin,e.ymax);return{xmin:r[0],xmax:r[1],ymin:n[0],ymax:n[1]}}}),define("graphing-calc/models/focus",["require","exports","./expression","./list"],function(e,t,n,i){"use strict";function o(e,t,r){a(e,s(e,t,r))}function a(e,t){if((e.focusLocation=t)&&"settings"!==t.type){var r=e.getItemModel(t.id);i.setSelected(e.getListModel(),r),r&&"expression"===r.type&&n.setSliderIsPlaying(r,!1)}}function s(e,t,r){var n=e.getItemModel(t);if(n)switch(n.type){case"expression":case"folder":case"text":return{type:n.type,id:t};case"table":var i={row:1,column:0};return r&&("cell"===r.location?i={row:r.row,column:r.column}:"end"===r?i={row:n.columnModels[0].cells.length,column:0}:"start"===r&&(i={row:0,column:0})),{type:n.type,id:t,location:i};case"image":return{type:n.type,id:t,location:"name"};default:return n}}Object.defineProperty(t,"__esModule",{value:!0}),t.moveFocusToItem=o,t.setFocusLocation=a,t.computeFocusLocationForItem=s,t.addFocusForKeypad=function(e){var t=e.getSelectedItem();if(t&&"expression"===t.type)o(e,t.id);else if(!t||"table"!==t.type||!e.focusLocation){for(var r=e.getFirstFullyVisibleItem();r&&"expression"!==r.type;)r=e.getItemModelByIndex(r.index+1);if(r)return void o(e,r.id);var n=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()});i.insertItemAtEnd(e.getListModel(),n),o(e,n.id)}},t.getFocusedItem=function(e){var t=e.focusLocation;if(t&&"settings"!==t.type)return e.getItemModel(t.id)},t.focusTableCell=function(e,t,r){a(e,{type:"table",id:t,location:r})}}),define("graphing-calc/actions/keyboard",["require","exports","browser","lib/conditional_blur","../models/table","../models/focus","../models/list","../models/abstract-item"],function(e,t,o,i,m,y,a,s){"use strict";function v(e){var t=e.getSelectedItem();t&&(e.inAudioTraceMode()||0!==t.index&&(a.selectPrevItem(e.getListModel()),(t=e.getSelectedItem())&&y.moveFocusToItem(e,t.id,"end")))}function b(e){if(!e.inAudioTraceMode()){if(!a.selectNextItem(e.getListModel())){var t=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()});a.insertItemAtEnd(e.getListModel(),t),a.setSelected(e.getListModel(),t)}var r=e.getSelectedItem();r&&y.moveFocusToItem(e,r.id,"start")}}function x(e){var t=e.getSelectedItem();if(t&&(1!==e.getItemCount()||"expression"!==t.type)){var r="text"===t.type,n=a.getParentFolderModel(t);if(n){var i=e.getNumberOfItemsInFolder(n.id);if(t.index===n.index+i)return void s.setFolderId(t,"")}if(l(e),r&&o.IS_IPAD&&o.IS_IN_IFRAME)return void a.setSelected(e.getListModel(),void 0);(t=e.getSelectedItem())&&y.moveFocusToItem(e,t.id,"end")}}function w(e){var t=e.getSelectedItem();t&&(1===e.getItemCount()&&"expression"===t.type||(r(e),(t=e.getSelectedItem())&&y.moveFocusToItem(e,t.id,"start")))}function _(e){var t=e.getSelectedItem();if(t){if("text"===t.type&&o.IS_IPAD&&o.IS_IN_IFRAME)return i.default(),void a.setSelected(e.getListModel(),void 0);if("expression"===t.type&&t.missingVariables.length)return e.createSlidersForItem(t.id,t.missingVariables.concat(""));var r=e.createItemModel({type:"expression",id:e.generateId(),color:e.getNextColor()}),n=t.index+1;"folder"===t.type&&t.collapsed&&(n+=e.getNumberOfItemsInFolder(t.id)),a.insertItemAtIndex(e.getListModel(),r,n),a.setSelected(e.getListModel(),r),"folder"!==t.type||t.collapsed?t.folderId&&s.setFolderId(r,t.folderId):s.setFolderId(r,t.id),(t=e.getSelectedItem())&&y.moveFocusToItem(e,t.id)}}function l(e){var t=e.getSelectedItem(),r=e.getListModel();if(t){var n=a.findPrevSelectableItem(r,t.index);if(e._removeExpressionSynchronously(t),!n){var i=a.getFirstSelectableItem(r);i&&(n=i)}a.setSelected(r,n)}}function r(e){var t=e.getSelectedItem(),r=e.getListModel();if(t){var n=a.findNextSelectableItem(r,t.index);if(e._removeExpressionSynchronously(t),!n){var i=a.getLastSelectableItem(r);i&&(n=i)}a.setSelected(r,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.navigateTableByKey=function(r,n,e){var t=r.getItemModel(n);if(t&&"table"===t.type){var i=t,o=m.getSelectedCell(i),a=o?o.row:-1,s=o?o.column:-1,l=i.columnModels,c=l[0].cells.length,u=l.length,p=function(e,t){-1===e?v(r):c<e?b(r):(-1===t?(t=u-1,e--):t===u&&(e++,t=0),y.focusTableCell(r,n,{row:e,column:t}))},d=function(e){2<c&&m.removeRow(i,a-1),y.focusTableCell(r,n,{row:e,column:s})},h=function(e){0===s||u<=2||(m.removeColumn(i,s),y.focusTableCell(r,n,{row:a,column:e}))};switch(e){case"Left":p(a,s-1);break;case"Right":p(a,s+1);break;case"Up":p(a-1,s);break;case"Down":p(a+1,s);break;case"Enter":if(c<=a)return _(r);if(0<s)return p(a+1,s);if(a===c-1){var f=m.getRowAutoFillValues(i,a);m.insertBlankRow(i,a);for(var g=0;g<f.length;g++)m.setCellLatex(i,{row:a+1,column:g},f[g]);return void y.focusTableCell(r,n,{row:a+1,column:s})}m.insertBlankRow(i,a),y.focusTableCell(r,n,{row:a+1,column:s});break;case"Backspace":0===a?0===s?x(r):s===u-1||1===s&&3===u?p(0,s-1):h(s-1):0!==s?p(a,s-1):a===c?p(a-1,s):d(a-1);break;case"Delete":0===a?0===s?w(r):s<u-1&&h(s):c<=a||d(a)}}},t.onUpPressed=v,t.onDownPressed=b,t.onBackspacePressed=x,t.onDeletePressed=w,t.onEnterPressed=_,t.upwardDeleteSelectedExpression=l,t.downwardDeleteSelectedExpression=r}),define("main/layout-model",["require","exports","browser"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLayoutModel=function(e){return{keypadMinimized:!r.IS_TOUCH_DEVICE,keypadLayout:"mainNumbers",keypadFunctionsTab:"trig",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!e.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}}),define("main/settings-view-model",["require","exports","tslib","graphing/label"],function(e,t,i,o){"use strict";function r(e,t){var r=o.value(e,t),n="";if(r.mantissa)n=r.mantissa.split("").join("\\cdot")+"^{"+r.superscript+"}";else{var i=r.string.split("/");n=2===i.length?"-"===i[0][0]?"-\\frac{"+i[0].slice(1)+"}{"+i[1]+"}":"\\frac{"+i[0]+"}{"+i[1]+"}":r.string}return n.replace(//,"\\pi")}function a(e){return{xmin:r(e.xmin,e.xmax-e.xmin),xmax:r(e.xmax,e.xmax-e.xmin),ymin:r(e.ymin,e.ymax-e.ymin),ymax:r(e.ymax,e.ymax-e.ymin)}}function s(e,t){return 0===e?"":r(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.formatLatex=r,t.formatViewport=a,t.formatStep=s,t.limitLatex=function(e,t,r){var n=a(e);return i.__assign({},n,{xstep:s(t,e.xmax-e.xmin),ystep:s(r,e.ymax-e.ymin)})},t.defaultSettingsViewModel=function(){return{limitLatex:{xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:""},focusOnOpen:!1}}}),define("expressions/list_move_controller",["require","exports","graphing/dragmode","lib/number-to-latex","graphing/label","lib/rounding","graphing-calc/models/expression","graphing-calc/models/table","graphing-calc/models/list","graphing-calc/models/image"],function(e,t,c,L,b,O,q,f,u,F){"use strict";function N(e,t){return{left:e.x-t,right:e.x+t,top:e.y+t,bottom:e.y-t}}function x(e,t){switch(t){case c.X:return 0===e;case c.Y:return 1===e;case c.XY:return!0;default:return!1}}function R(e,t,r){if(0===r[0]&&0===r[1])return{x:t.x,y:t.y,width:e.width,height:e.height};var n=Math.cos(e.radianAngle),i=Math.sin(e.radianAngle),o=t.x-e.x,a=t.y-e.y;if(0===r[0])return{x:e.x,y:e.y,width:e.width,height:2*r[1]*(n*a+i*o)};if(0===r[1])return{x:e.x,y:e.y,width:2*r[0]*(n*o-i*a),height:e.height};var s=2*(e.width*r[0]*(n*o-i*a)+e.height*r[1]*(i*o+n*a))/(e.width*e.width+e.height*e.height);return{x:e.x,y:e.y,width:s*e.width,height:s*e.height}}function a(e,t,r,n,i){var o=t.formula;if(!o||!o.move_strategy)return!1;var a=o.dimensions,s=r.scaleFactor,l=0!==s[0]&&0!==s[1],c=i.closestPointOnScreen(n),u=function(e,t,r){for(var n=["x","y","width","height"],i={x:1/0,y:1/0,width:1/0,height:1/0},o={x:-1/0,y:-1/0,width:-1/0,height:-1/0},a=0,s=[{x:t.left,y:t.bottom},{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom}];a<s.length;a++)for(var l=R(e,s[a],r),c=0,u=n;c<u.length;c++){var p=u[c];i[p]=Math.min(i[p],l[p]),o[p]=Math.max(o[p],l[p])}return{min:i,max:o}}(a,i.pixelsToMath.mapRect(N(c,l?.05:.5)),s),p=i.mathToPixels.mapRect({left:a.x-.5*a.width,right:a.x+.5*a.width,top:a.y-.5*a.height,bottom:a.y+.5*a.height}),d=Math.abs(p.right-p.left),h=Math.abs(p.bottom-p.top),f=i.mathToPixels.mapRect({left:u.min.x-.5*u.min.width,right:u.min.x+.5*u.min.width,top:u.min.y-.5*u.min.height,bottom:u.min.y+.5*u.min.height}),g=Math.abs(f.right-f.left),m=Math.abs(f.bottom-f.top);if(g<d&&g<1||m<h&&m<1)return!1;for(var y=["width","height","x","y"],v=!1,b=0;b<y.length;b++){var x=y[b],w=o.move_strategy[b];switch(w.type){case"updateCoordinate":var _=O.shortestDecimalBetween(u.min[x],u.max[x]),S=L.default(_);switch(x){case"width":case"height":F.setMQAttribute(t,x,S);break;case"x":if("updateCoordinate"===o.move_strategy[3].type){var E=O.shortestDecimalBetween(u.min.y,u.max.y),M="\\left("+S+","+L.default(E)+"\\right)";F.setMQAttribute(t,"center",M)}else{M="\\left("+S+","+o.move_strategy[3].inputString+"\\right)";F.setMQAttribute(t,"center",M)}break;case"y":if("updateCoordinate"!==o.move_strategy[2].type){M="\\left("+o.move_strategy[2].inputString+","+S+"\\right)";F.setMQAttribute(t,"center",M)}break;default:return x}v=!0;break;case"updateSlider":var I=e.getItemModel(w.id);if(!I||"expression"!==I.type)continue;var T=w.coefficients[0],C=w.coefficients[1],k=C*u.min[x]+T,P=C*u.max[x]+T,D=O.shortestDecimalBetween(k,P),A=I.latex;q.adjustSliderByMovablePoint(I,D),I.latex!==A&&(v=!0)}}return v}function s(e,t,r,n,i){var o=t.formula;if(!o||!o.move_strategy)return!1;var a=t.reconciledDragMode,s=!1,l=n.closestPointOnScreen(r),c=n.pixelsToMath.mapRect(N(l,.5)),u=[{min:c.left,max:c.right},{min:c.top,max:c.bottom}];"updateCoordinate"!==o.move_strategy[0].type&&"updateCoordinate"!==o.move_strategy[1].type||(q.setLatex(t,function(e,t,r){var n;n=e.assignment?b.identifierToLatex(e.assignment)+"=":"";var i=O.shortestDecimalBetween(t[0].min,t[0].max),o=O.shortestDecimalBetween(t[1].min,t[1].max),a="updateCoordinate"===e.move_strategy[0].type&&x(0,r),s="updateCoordinate"===e.move_strategy[1].type&&x(1,r);return n+"\\left("+(a?L.default(i):e.move_strategy[0].inputString)+","+(s?L.default(o):e.move_strategy[1].inputString)+"\\right)"}(o,u,a)),s=!0);for(var p=0;p<2;p++){var d=o.move_strategy[p];if("updateSlider"===d.type&&x(p,a)){var h=e.getItemModel(d.id);if(h&&"expression"===h.type){var f=d.coefficients[0],g=d.coefficients[1],m=h.latex,y=i&&i[p];if(y)q.adjustSliderByKeyboard(h,y);else{var v=O.shortestDecimalBetween(g*u[p].min+f,g*u[p].max+f);q.adjustSliderByMovablePoint(h,v)}h.latex!==m&&(s=!0)}}}return s}Object.defineProperty(t,"__esModule",{value:!0}),t.onStartMovingPoint=function(e,t,r){if(r.tableInfo){u.setSelected(t,void 0);var n=e.getItemModel(r.tableInfo.tableId);if(!n||"table"!==n.type)return;f.setIsDraggingOnGrapher(n,!0)}else{var i=e.getItemModel(r.sketch.id);if(!i||"expression"!==i.type&&"image"!==i.type)return;if("image"!==i.type&&u.setSelected(t,void 0),!i.formula||!i.formula.move_strategy)return;for(var o=i.formula.move_strategy,a=0;a<o.length;a++)if("updateCoordinate"===o[a].type)"image"===i.type?F.setIsDraggingOnGrapher(i,!0):"expression"===i.type&&q.setIsDraggingOnGrapher(i,!0);else if("updateSlider"===o[a].type){var s,l=e.getItemModel(o[a].id);if(!l||"expression"!==l.type)continue;if((s="expression"===i.type?i.reconciledDragMode:void 0)===c.NONE||0===a&&s===c.Y||1===a&&s===c.X)continue;q.setSliderDragging(l,!0)}}},t.onStopMovingPoint=function(e,t){if(t.tableInfo){var r=e.getItemModel(t.tableInfo.tableId);if(!r||"table"!==r.type)return;f.setIsDraggingOnGrapher(r,!1)}else{var n=e.getItemModel(t.sketch.id);if(n&&("expression"===n.type||"image"===n.type)&&n.formula&&n.formula.move_strategy)for(var i=n.formula.move_strategy,o=0;o<i.length;o++)if("image"===n.type?F.setIsDraggingOnGrapher(n,!1):"expression"===n.type&&q.setIsDraggingOnGrapher(n,!1),"updateSlider"===i[o].type){var a=e.getItemModel(i[o].id);a&&"expression"===a.type&&q.setSliderDragging(a,!1)}}},t.onMovePoint=function(e,t,r,n,i){if(t.tableInfo)return function(e,t,r,n){var i=t.tableInfo.tableId,o=t.tableInfo.rowIndex,a=t.tableInfo.columnId,s=t.tableInfo.dragX,l=t.tableInfo.dragY,c=e.getItemModel(i);if(c&&"table"===c.type&&f.getColumnModel(c,a)){var u=n.closestPointOnScreen(r),p=n.pixelsToMath.mapRect(N(u,.5)),d={x:L.default(O.shortestDecimalBetween(p.left,p.right)),y:L.default(O.shortestDecimalBetween(p.top,p.bottom))};if(s&&f.setCellLatex(c,{row:o+1,column:0},d.x),l){var h=f.getColumnModel(c,a).index;f.setCellLatex(c,{row:o+1,column:h},d.y)}}}(e,t,r,n),!0;var o=e.getItemModel(t.sketch.id);return!!o&&("image"===o.type?a(e,o,t,r,n):"expression"===o.type&&s(e,o,r,n,i))}}),define("main/blank_state",["require","exports","main/migrate_state"],function(e,t,r){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.BLANK_STATE={version:7,graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},t.BLANK_STATE.version!==r.currentVersion)throw new Error("Blank state version is "+t.BLANK_STATE.version+", but latest migration version is "+r.currentVersion+". The blank state should be migrated to the latest version.");t.default=t.BLANK_STATE}),define("submodules/dcgview/src/attr-event-handler",[],function(){return function(t,r){if(null!=r){if("string"!=typeof t)throw new Error("Must pass a string for an EventHandler name");if("function"!=typeof r)throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount:function(e){e[t.toLowerCase()]=r}}}}}}),define("submodules/dcgview/src/const",["require"],function(e){return{isConst:function(e){return!("function"!=typeof e||!e.isDCGViewConst)},makeConst:function(e){var t=function(){return e};return t.isDCGViewConst=!0,t}}}),define("submodules/dcgview/src/attr",["require"],function(e){return{update:function(e,t,r){void 0===r?e.removeAttribute(t):e.setAttribute(t,r+"")}}}),define("submodules/dcgview/src/attr-generic",["require","./const","./attr"],function(e){var t=e("./const"),o=e("./attr");return function(r,n){var e,i=n();return t.isConst(n)||(e={onUpdate:function(e){var t=n();t!==i&&(i=t,o.update(e,r,t))}}),{value:i,bindings:e}}}),define("submodules/dcgview/src/is-event-handler",[],function(){return function(e){return"o"===e[0]&&"n"===e[1]&&e[2].toUpperCase()===e[2]}}),define("submodules/dcgview/src/custom-attributes",["require"],function(e){var r={};return{isCustomAttribute:function(e){return r.hasOwnProperty(e)},add:function(e,t){r[e]=t},parse:function(e,t){return(0,r[e])(t)}}}),define("submodules/dcgview/src/bindings",["require"],function(e){return{add:function(e,t,r){var n=e._bindings[t];n?n.push(r):e._bindings[t]=[r]},invoke:function(e,t){var r=e._bindings[t];if(r)for(var n=r.length,i=0;i<n;i++)r[i]()}}}),define("submodules/dcgview/src/bind-attrs",["require","./attr-event-handler","./attr-generic","./is-event-handler","./custom-attributes","./bindings"],function(e){function a(e,t,r){var n=r.bindings;if(n)for(var i in n){var o=n[i];i in c&&(o=o.bind(null,t)),l.add(e,i,o)}}function s(e,t){if("function"!=typeof t)throw new Error('The "'+e+'" attr must be a function. It is: '+JSON.stringify(t));return o.isCustomAttribute(e)?o.parse(e,t):i(e)?r(e,t):n(e,t)}var r=e("./attr-event-handler"),n=e("./attr-generic"),i=e("./is-event-handler"),o=e("./custom-attributes"),l=e("./bindings"),c={onMount:!0,didMount:!0,willUnmount:!0,willUpdate:!0,onUpdate:!0,didUpdate:!0};return function(e,t,r){if(t)for(var n in t){var i=s(n,t[n]);if(i){var o=i.value;void 0!==o&&r.setAttribute(n,o),i.bindings&&a(e,r,i)}}}}),define("submodules/dcgview/src/bind-text",["require","./bindings"],function(e){var a=e("./bindings"),s=!1;return{bindText:function(e,t,r){if("function"!=typeof r)throw new Error("bindText expects a function");var n=r();null!=n||(n="");var i=document.createTextNode(n);if(s){var o=document.createElement("span");o.appendChild(i),t.appendChild(o)}else t.appendChild(i);a.add(e,"onUpdate",function(){var e=r();null!=e||(e=""),n!==e&&(i.nodeValue=e,n=e)})},enableSpanWrapping:function(){s=!0}}}),define("submodules/dcgview/src/warnings",["require"],function(e){var i=[];return{warn:function(e){try{throw new Error(e)}catch(e){console.warn(e);for(var t=0;t<i.length;t++)i[t](e)}},addWarningHandler:function(e){i.push(e)},removeWarningHandler:function(e){var t=i;i=[];for(var r=0;r<t.length;r++){var n=t[r];n!==e&&i.push(n)}}}}),define("submodules/dcgview/src/dcg-element",["require","./bind-attrs","./bind-text","./const","./warnings"],function(e){function s(e,t){var r=document.createTextNode(t);e.appendChild(r)}function t(e,t,r){this.tagName=e,this.attrs=t,this.children=r}var l=e("./bind-attrs"),c=e("./bind-text").bindText,u=e("./const"),p=e("./warnings");return t.prototype._isDCGElement=!0,t.prototype.renderToDocFrag=function(e,t){if(this._domNode)throw new Error("Cannot remount a DCGElement");var r=this.children,n=document.createElement(this.tagName);this._domNode=n,l(t,this.attrs,n),e.appendChild(n);for(var i=r.length,o=0;o<i;o++){var a=r[o];a._isDCGElement?a.renderToDocFrag(n,t):u.isConst(a)?s(n,a()):"function"==typeof a?c(t,n,a):(p.warn("Text should be a const or a getter: "+JSON.stringify(a)),s(n,a))}},t}),define("submodules/dcgview/src/create-element",["require","./dcg-element"],function(e){function o(e,t){if(null!=e)if(Array.isArray(e))for(var r=0;r<e.length;r++)o(e[r],t);else t.push(e)}var a=e("./dcg-element");return function(e,t){for(var r=[],n=arguments.length-1,i=2;i<=n;i++)o(arguments[i],r);if("string"==typeof e)return new a(e,t,r);if(e&&e._isDCGViewClass)return new e(t,r);throw new Error("createElement expects a String or DCGViewClass")}}),define("submodules/dcgview/src/mounting",["require","./bindings"],function(e){function o(e){e.willMount&&e.willMount(),t.invoke(e,"willMount"),e._childViews.forEach(o)}function a(e){e._isMounted=!0,e.onMount&&e.onMount(),t.invoke(e,"onMount"),e._childViews.forEach(a)}function s(e){e.didMount&&e.didMount(),t.invoke(e,"didMount"),e._childViews.forEach(s)}function r(e){e.willUnmount&&e.willUnmount(),t.invoke(e,"willUnmount"),e._childViews.forEach(r)}function n(e){e._isMounted=!1,e._childViews.forEach(n),t.invoke(e,"onUnmount"),e.onUnmount&&e.onUnmount()}function i(e){e._childViews.forEach(i),t.invoke(e,"didUnmount"),e.didUnmount&&e.didUnmount()}var t=e("./bindings");return{renderToDocFrag:function(e,t){if(t&&t._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");this.__generatedHTMLBefore=!0,this._element.renderToDocFrag(e,this)},findRootNode:function(){for(var e=this._element;e._isDCGView;)e=e._element;return e._domNode},createNodeForView:function(e,t){var r=document.createDocumentFragment();return e.renderToDocFrag(r,t),r.firstChild},willMount:o,onMount:a,didMount:s,willUnmount:r,onUnmount:n,didUnmount:i,mountToNode:function(e,t,r){if(!e||!e._isDCGViewClass)throw new Error("Must pass a DCGView class to be mounted");if(!t||1!==t.nodeType)throw new Error("Must pass an HTMLElement for the node");if(t._mountedDCGView)throw new Error("This node is already mounted by a view");var n=new e(r),i=document.createDocumentFragment();return n.renderToDocFrag(i),t.innerHTML="",o(n),t._mountedDCGView=n,t.appendChild(i),a(n),s(n),n},unmountFromNode:function(e){var t=e._mountedDCGView;if(!t)throw new Error("This node is not mounted by a DCGView");r(t),e.innerHTML="",delete e._mountedDCGView,n(t),i(t)}}}),define("submodules/dcgview/src/update",["require","./bindings","./warnings"],function(e){var n=e("./bindings"),i=e("./warnings");return{update:function(){if(!this._isMounted)return i.warn("Trying to update view that is not mounted. Ignoring update.");if(!this.shouldUpdate||this.shouldUpdate()){if(this.willUpdate&&this.willUpdate(),n.invoke(this,"willUpdate"),n.invoke(this,"onUpdate"),this.onUpdate&&this.onUpdate(),this.overrideChildUpdates)this.overrideChildUpdates();else for(var e=this._childViews,t=e.length,r=0;r<t;r++)e[r].update();n.invoke(this,"didUpdate"),this.didUpdate&&this.didUpdate()}}}}),define("submodules/dcgview/src/spread",["require"],function(e){return function(e){var t=arguments.length;if(t<2)return e;for(var r=1;r<t;r++)for(var n=arguments[r],i=Object.keys(n),o=i.length,a=0;a<o;a++){var s=i[a];e[s]=n[s]}return e}}),define("submodules/dcgview/src/create-class",["require","./create-element","./mounting","./update","./const","./spread"],function(e){var n=e("./create-element"),i=e("./mounting"),o=e("./update"),a=e("./const"),s=e("./spread");return function(e){if(!e)throw new Error("must pass a spec to DCGView.createClass");if("function"!=typeof e.template)throw new Error("must pass a template function to DCGView.createClass");var t=function(e,t){this._setupProps(e,t),this.init&&this.init(),this._callTemplate()};for(var r in t.prototype._setupProps=function(e,t){if(this.p={},e){for(var r in e){var n=e[r];if("function"!=typeof n)throw new Error('The "'+r+'" prop must be a function. It is: '+JSON.stringify(n));Object.defineProperty(this.p,r,{get:n})}this.props=e}else this.props={};this.children=t,this._childViews=[],this._bindings={}},t.prototype._callTemplate=function(){if(this._element=this.template(),!this._element||!this._element._isDCGElement)throw new Error("template() must return a DCGElement")},t.prototype.bindFn=function(e){return e.bind(this)},t.prototype.findRootNode=i.findRootNode,t.prototype.renderToDocFrag=i.renderToDocFrag,t.prototype.const=a.makeConst,t.prototype.spread=s,t.prototype.createElement=n,t.prototype.update=o.update,e)if(e.hasOwnProperty(r)){if(t.prototype.hasOwnProperty(r))throw new Error("Cannot override the "+r+"() method");t.prototype[r]=e[r]}return t._isDCGViewClass=!0,t.prototype._isDCGView=!0,t.prototype._isDCGElement=!0,t}}),define("submodules/dcgview/src/attr-style",["require","./const","./attr"],function(e){function i(e){var t=e(),r=typeof t;if("string"===r)return t;if(!r||"object"!==r)throw new Error("Unsupported type returned from style getter: "+r);var n="";for(var i in t){var o=t[i];t.hasOwnProperty(i)&&null!=o&&(n?n+=";"+i+":"+o:n=i+":"+o)}return n}var t=e("./const"),o=e("./attr");return function(r){var e,n=i(r);return t.isConst(r)||(e={onUpdate:function(e){var t=i(r);n!==t&&(o.update(e,"style",t),n=t)}}),{value:n,bindings:e}}}),define("submodules/dcgview/src/attr-class",["require","./const"],function(e){function i(e){var t=e(),r=typeof t;if("string"===r)return t;if(!r||"object"!==r)throw new Error("Unsupported type returned from class getter: "+r);var n="";for(var i in t)if(t.hasOwnProperty(i)){t[i]&&(n?n+=" "+i:n=i)}return n}var t=e("./const"),u=/^\s+|\s+$/g,p=/\s+/;return function(r){var e,n=i(r);return t.isConst(r)||(e={onUpdate:function(e){var t=i(r);n!==t&&(e.className===n?e.className=t:e.className=function(e,t,r){for(var n=[],i=e.className.replace(u,"").split(p),o=t.replace(u,"").split(p),a={},s=o.length-1;0<=s;s--)a[o[s]]=!0;var l=i.length;for(s=0;s<l;s++){var c=i[s];a.hasOwnProperty(c)||n.push(c)}return r?n.length?r+" "+n.join(" "):r:n.join(" ")}(e,n,t),n=t)}}),{value:n,bindings:e}}}),define("submodules/dcgview/src/attr-lifecycle",["require","./const"],function(e){var n=e("./const");return function(r){return function(e){if("function"!=typeof e)throw new Error("The "+r+" attribute expects a function for the value");if(n.isConst(e))throw new Error("The "+r+" attribute does not expect a const for the value");var t={bindings:{}};return t.bindings[r]=e,t}}}),define("submodules/dcgview/src/longest-subsequence",["require"],function(e){return function(e){var t,r,n=e.length,i=new Array(n),o=new Array(n+1),a=0;for(r=0;r<n;r++){if(e[o[a]]<e[r])t=a+1;else{for(var s=1,l=a-1;s<=l;){var c=Math.ceil((s+l)/2);e[o[c]]<e[r]?s=c+1:l=c-1}t=s}i[r]=o[t-1],o[t]=r,a<t&&(a=t)}var u=new Array(a),p=o[a];for(r=a-1;0<=r;r--)u[r]=e[p],p=i[p];return u}}),define("submodules/dcgview/src/compute-key-mutations",["require","./longest-subsequence"],function(e){var p=e("./longest-subsequence");return function(e,t){var r,n,i={},o=[],a=[];for(r=0;r<t.length;r++)i[n=t[r]]=r;for(r=0;r<e.length;r++)void 0===i[n=e[r]]&&o.push(n);var s=[];for(r=0;r<e.length;r++){var l=i[n=e[r]];void 0!==l&&s.push(l)}var c=p(s),u={};for(r=0;r<c.length;r++)u[n=t[c[r]]]=!0;for(r=t.length-1;0<=r;r--)u[n=t[r]]||a.push({key:n,beforeKey:t[r+1]});return{removes:o,inserts:a}}}),define("submodules/dcgview/src/for",["require","./create-class","./compute-key-mutations","./const","./mounting"],function(e){var t=e("./create-class"),f=e("./compute-key-mutations"),o=e("./const"),g=e("./mounting"),i=t({template:function(){return this.children[0]}});return t({_isDCGFor:!0,getKeys:function(){this._keyToItem={};var e=this.props.each();if(!Array.isArray(e))throw new Error("<For each={}> must return an array");var t=this.props.key?e.map(this.props.key):e.slice(0);if(!this._chosenKeyType&&t.length&&(this._chosenKeyType=typeof t[0],"string"!==this._chosenKeyType&&"number"!==this._chosenKeyType))throw new Error("The key: "+JSON.stringify(t[0])+" is not a string or number");for(var r=0;r<t.length;r++){var n=t[r];if(typeof n!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(n)+" is not a "+this._chosenKeyType);if(n in this._keyToItem)throw new Error("The key: "+JSON.stringify(n)+" is not unique");this._keyToItem[n]=e[r]}return t},createViewForKey:function(e){var t=this._keyToItem[e],r=this._viewFunction.call(this,t,e),n=r;return n._isDCGView||(n=this.createElement(i,null,r)),this._keyToView[e]=n},template:function(){if(this._keyToView={},"function"!=typeof this.props.each)throw new Error("<For each={}> must be a function");if(1!==this.children.length)throw new Error("<For> expects a single child. You passed "+this.children.length);var e=this.children[0];if(!e||!e._isDCGElement)throw new Error("<For> expects the root node to be a DCGElement. You passed "+JSON.stringify(e));if(e._isDCGView)throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>");if(1!==e.children.length)throw new Error("<For> expects a root node with a single child. You passed "+e.children.length);if(this._viewFunction=e.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if("function"!=typeof this._viewFunction){var t=JSON.stringify(this._viewFunction);throw new Error("<For> expects a function that constructs a DCGElement. You passed "+t)}if(o.isConst(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");this._keys=this.getKeys();for(var r=[],n=0;n<this._keys.length;n++){var i=this._keys[n];r.push(this.createViewForKey(i))}return e.children=r,e},detachAllRemovedViews:function(){for(var e,t=this._childViews,r=0,n=t.length,i=0;i<n;i++)(e=t[i])._will_be_unmounted_?r++:t[i-r]=e;t.splice(n-r,r)},overrideChildUpdates:function(){var e=this._keys,t=this.getKeys();this._keys=t;var r,n,i,o,a,s,l=this.findRootNode(),c=f(e,t),u=[];for(r=c.removes.length-1;0<=r;r--)s=c.removes[r],u.push(this._keyToView[s]);for(u.forEach(g.willUnmount),r=0;r<c.removes.length;r++)s=c.removes[r],n=this._keyToView[s],delete this._keyToView[s],n._will_be_unmounted_=!0,l.removeChild(n.findRootNode());0<u.length&&this.detachAllRemovedViews(),u.forEach(g.onUnmount),u.forEach(g.didUnmount);var p=[];for(r=c.inserts.length-1;0<=r;r--)(s=c.inserts[r].key)in this._keyToView||(n=this.createViewForKey(s),p.push(n),g.createNodeForView(n,this));for(p.forEach(g.willMount),r=0;r<c.inserts.length;r++)a=c.inserts[r],i=this._keyToView[a.key].findRootNode(),o=void 0!==a.beforeKey?this._keyToView[a.beforeKey].findRootNode():null,l.insertBefore(i,o);p.forEach(g.onMount),p.forEach(g.didMount);var d=this._childViews,h=d.length-p.length;for(r=0;r<h;r++)d[r].update()}})}),define("submodules/dcgview/src/switch",["require","./create-class","./const","./mounting"],function(e){var t=e("./create-class"),r=e("./const"),i=e("./mounting"),n=t({template:function(){return this.children[0]}});return t({_isDCGSwitch:!0,updateKey:function(){this._key=this.props.key()},createView:function(){var e=this._viewFunction(this._key);return null!=e||(e=this.createElement("div",{style:this.const("display: none")})),this.createElement(n,null,e)},template:function(){if(this._key=void 0,"function"!=typeof this.props.key)throw new Error("<Switch key={}> must be a function");if(1!==this.children.length)throw new Error("<Switch> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if("function"!=typeof this._viewFunction){var e=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+e)}if(r.isConst(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()},overrideChildUpdates:function(){var e=this._key;if(this.updateKey(),e===this._key)this._element.update();else{var t=this.findRootNode(),r=document.createTextNode("");t.parentNode.insertBefore(r,t),i.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),i.onUnmount(this._element),i.didUnmount(this._element),this._element=this.createView();var n=i.createNodeForView(this._element,this);i.willMount(this._element),r.parentNode.insertBefore(n,r),r.parentNode.removeChild(r),i.onMount(this._element),i.didMount(this._element)}}})}),define("submodules/dcgview/src/if",["require","./create-class","./const","./switch"],function(e){var t=e("./create-class"),n=e("./const"),i=e("./switch");return t({_isDCGIf:!0,template:function(){if("function"!=typeof this.props.predicate)throw new Error("<If predicate={}> must be a function");if(1!==this.children.length)throw new Error("<If> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if("function"!=typeof this._viewFunction){var e=JSON.stringify(this._viewFunction);throw new Error("<If> expects a function that constructs a DCGElement. You passed "+e)}if(n.isConst(this._viewFunction))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");var t=function(){return!!this.props.predicate()}.bind(this),r=function(e){if(e)return this._viewFunction()}.bind(this);return this.createElement(i,{key:t},r)}})}),define("submodules/dcgview/src/textarea",["require","./create-class","./spread"],function(e){var t=e("./create-class"),r=e("./spread");return t({computeValue:function(){var e=this.props.value();return null==e?"":e+""},template:function(){if(!this.props.value)throw new Error('<Textarea> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Textarea> expects an "onInput={}" prop');var e=r({},this.props,{onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.disabled&&(e.disabled=function(){return!!this.props.disabled()||void 0}.bind(this)),delete e.value,this.createElement("textarea",e,this.const(this.computeValue()))},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}})}),define("submodules/dcgview/src/input",["require","./create-class","./spread"],function(e){var t=e("./create-class"),r=e("./spread");return t({computeValue:function(){var e=this.props.value();return null==e?"":e+""},template:function(){if(!this.props.value)throw new Error('<Input> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Input> expects an "onInput={}" prop');var e=r({},this.props,{value:this.const(this.computeValue()),onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.disabled&&(e.disabled=function(){return!!this.props.disabled()||void 0}.bind(this)),this.createElement("input",e)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var e=this.computeValue();this.rootDOM.value!==e&&(this.rootDOM.value=e)}})}),define("submodules/dcgview/src/checkbox",["require","./create-class","./spread"],function(e){var t=e("./create-class"),r=e("./spread");return t({computeChecked:function(){return!!this.props.checked()},template:function(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');var e=r({},this.props,{type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:function(e){this.props.onChange(e.target.checked),this._isMounted&&this.update()}.bind(this)});return this.createElement("input",e)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var e=this.computeChecked();this.rootDOM.checked!==e&&(this.rootDOM.checked=e)}})}),define("submodules/dcgview/src/components",["require","./for","./switch","./if","./textarea","./input","./checkbox"],function(e){return{For:e("./for"),Switch:e("./switch"),If:e("./if"),Textarea:e("./textarea"),Input:e("./input"),Checkbox:e("./checkbox")}}),define("submodules/dcgview/src/class",["require","./create-class"],function(e){return e("./create-class")({template:function(){}})}),define("submodules/dcgview/src/dcg-view",["require","./create-element","./create-class","./mounting","./spread","./const","./custom-attributes","./attr-style","./attr-class","./attr-lifecycle","./components","./warnings","./bind-text","./class"],function(e){var t=e("./create-element"),r=e("./create-class"),n=e("./mounting"),i=e("./spread"),o=e("./const"),a=e("./custom-attributes"),s=e("./attr-style"),l=e("./attr-class"),c=e("./attr-lifecycle"),u=e("./components"),p=e("./warnings"),d=e("./bind-text").enableSpanWrapping,h=e("./class"),f={createElement:t,createClass:r,mountToNode:n.mountToNode,unmountFromNode:n.unmountFromNode,spread:i,const:o.makeConst,addCustomAttribute:a.add,Components:u,addWarningHandler:p.addWarningHandler,removeWarningHandler:p.removeWarningHandler,enableSpanWrapping:d,Class:h};return f.addCustomAttribute("style",s),f.addCustomAttribute("class",l),f.addCustomAttribute("willMount",c("willMount")),f.addCustomAttribute("onMount",c("onMount")),f.addCustomAttribute("didMount",c("didMount")),f.addCustomAttribute("willUnmount",c("willUnmount")),f.addCustomAttribute("onUnmount",c("onUnmount")),f.addCustomAttribute("didUnmount",c("didUnmount")),f.addCustomAttribute("willUpdate",c("willUpdate")),f.addCustomAttribute("onUpdate",c("onUpdate")),f.addCustomAttribute("didUpdate",c("didUpdate")),f}),define("submodules/dcgview/dcgview",["require","./src/dcg-view"],function(e){return e("./src/dcg-view")}),define("loadcss!dcgview-shim",function(){}),function(){define("dcgview",["require","jquery","underscore","submodules/dcgview/dcgview","submodules/dcgview/src/const","bugsnag","loadcss!dcgview-shim"],function(e){var r,t,n,i,o,a;return r=e("jquery"),o=e("underscore"),i=e("submodules/dcgview/dcgview"),n=e("submodules/dcgview/src/const"),t=e("bugsnag"),e("loadcss!dcgview-shim"),i.addWarningHandler(function(e){return t.notify(e)}),a=[],i.onUrlChange=function(e){return a.push(e)},i.addCustomAttribute("href",function(i){var e;return e={value:""+i(),bindings:{onMount:function(e){var n;if(!r(e).is("a")&&!r(e).is("use"))throw new Error("Cannot have an href on a non-link element.");return n=!1,r(e).on("dcg-tap",function(t){var r;if(!t.metaKey&&(n=!1,r=i(),o.any(a.map(function(e){return e(r,t)}))))return n=!0}),r(e).on("click",function(e){if(n)return n=!1,e.preventDefault()})}}},n.isConst(i)||(e.bindings.onUpdate=function(e){return e.setAttribute("href",i())}),e}),i.addCustomAttribute("onTap",function(t){return{value:"",bindings:{onMount:function(e){return r(e).on("dcg-tap",t)}}}}),i.addCustomAttribute("ignoreRealClick",function(t){return{bindings:{onMount:function(e){return r(e).on("click",function(e){if(t())return e.preventDefault()})}}}}),i.addCustomAttribute("onTapStart",function(t){return{bindings:{onMount:function(e){return r(e).on("dcg-tapstart",t)}}}}),i.addCustomAttribute("onTapMove",function(t){return{bindings:{onMount:function(e){return r(e).on("dcg-tapmove",t)}}}}),i.addCustomAttribute("onTapEnd",function(t){return{bindings:{onMount:function(e){return r(e).on("dcg-tapend",t)}}}}),i.addCustomAttribute("onLongHold",function(t){return{bindings:{onMount:function(e){return r(e).on("dcg-longhold",t)}}}}),i.addCustomAttribute("manageFocus",function(n){return void 0===n()?{}:{bindings:{onMount:function(e){return n().shouldBeFocused()&&e.focus(),e.onfocus=function(){if(!n().shouldBeFocused())return n().onFocusedChanged(!0)},e.onblur=function(){if(n().shouldBeFocused())return n().onFocusedChanged(!1)}},onUpdate:function(e){var t,r;return r=n().shouldBeFocused(),t=document.activeElement===e,r&&!t?e.focus():t&&!r?e.blur():void 0},willUnmount:function(e){return delete e.onfocus,delete e.onblur}}}}),i})}.call(this),define("vendor/mathquill",["require","exports","toplevel/mathquill","mathquill"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MQ=r.getInterface(1).config(n)}),define("loadcss!dcgview-helpers/static-mathquill-view",function(){}),define("dcgview-helpers/static-mathquill-view",["require","exports","tslib","dcgview","vendor/mathquill","jquery","lib/conditional_blur","loadcss!./static-mathquill-view"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return 1===this.children.length?this.children[0]:n.createElement("div",{didMount:function(e){return t.didMountMathquill(e)}})},t.prototype.didMount=function(){1===this.children.length&&this.didMountMathquill(this.findRootNode())},t.prototype.didMountMathquill=function(e){this.staticMath=i.MQ.StaticMath(e),o(e).off(".mathquill").addClass("dcg-static-mathquill-view").on("dcg-tapstart",function(){a.default()}),this.updateMathquill()},t.prototype.didUpdate=function(){this.updateMathquill()},t.prototype.updateMathquill=function(){this.updateMathquillAria(),this.updateMathquillLatex()},t.prototype.updateMathquillLatex=function(){if(this.staticMath){var e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}},t.prototype.updateMathquillAria=function(){if(this.staticMath&&this.props.getAriaLabel){var e=this.props.getAriaLabel();e!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(e)}},t}(n.Class);t.default=s}),define("loadcss!dcgview-helpers/mathquill-view",function(){}),define("dcgview-helpers/mathquill-view",["require","exports","tslib","keys","browser","dcgview","vendor/mathquill","jquery","./static-mathquill-view","loadcss!./mathquill-view"],function(e,t,r,o,a,i,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.Components.If,n=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastLatexProp="",e.wasFocusedLastUpdate=!1,e}return r.__extends(n,t),n.prototype.template=function(){var t=this;return 1===this.children.length?this.children[0]:i.createElement("div",{class:i.const("dcg-mq-container")},i.createElement(u,{predicate:function(){return 0<t.getPlaceholder().trim().length}},function(){return i.createElement("span",{class:i.const("dcg-mq-placeholder")},i.createElement(c.default,{latex:function(){return t.getPlaceholder()}}))}),i.createElement("div",{class:function(){return{"dcg-math-field":!0,"dcg-invalid":t.props.hasError(),"dcg-focus":t.props.isFocused()}},didMount:function(e){return t.didMountMathquill(e)},"data-dcg-label":function(){return t.props.dataLabelAttributeValue?t.props.dataLabelAttributeValue():void 0}}))},n.prototype.didMount=function(){1===this.children.length&&this.didMountMathquill(this.findRootNode())},n.prototype.willUnmount=function(){this.$mathField.off(".view"),this.mathField=void 0},n.prototype.getPlaceholder=function(){return this.props.placeholder?this.props.isFocused()?"":this.props.latex()?"":this.props.placeholder():""},n.prototype.didMountMathquill=function(e){var i=this,t=r.__assign({},this.props.config(),{handlers:{reflow:function(e){i.props.onReflow&&i.mathField&&i.props.onReflow(e)}},onCut:function(){i.mathField&&i.props.onUserChangedLatex(i.mathField.latex())},onPaste:function(){i.mathField&&i.props.onUserChangedLatex(i.mathField.latex())},overrideTypedText:function(e){i.mathField&&i.viewCanAcceptText(e)&&(i.props.onUserTypedText?i.props.onUserTypedText(e):(i.mathField.typedText(e),i.props.onUserChangedLatex(i.mathField.latex())))},overrideKeystroke:function(e,t){if("Backspace"===e&&t.preventDefault(),i.mathField){if("Spacebar"===e&&i.props.disableSpace&&i.props.disableSpace())return t.preventDefault();if(t.originalEvent){var r=o.lookup(t.originalEvent);if("Up"===r||"Down"===r||"Left"===r||"Right"===r||"Esc"===r){var n=[];t.ctrlKey&&n.push("Ctrl"),t.metaKey&&n.push("Meta"),t.altKey&&n.push("Alt"),t.shiftKey&&n.push("Shift"),e=n.length?(n.push(r),n.join("-")):r}}i.props.onUserPressedKey?i.props.onUserPressedKey(e,t):(i.mathField.keystroke(e,t),i.props.onUserChangedLatex(i.mathField.latex()))}}});this.$mathField=l(e),this.mathField=s.MQ.MathField(e,t),e._mqMathFieldInstance=this.mathField,(e._mqViewInstance=this).$mathField.on("focusin.view focusout.view",function(){return i.onFocusEvent()}).on("paste.view",function(e){return i.onPasteEvent(e)}),(a.IS_IOS||a.IS_ANDROID)&&this.$mathField.on("keypress.view",function(e){return i.onKeypressEvent(e)}),this.hookupMQTapTouch(),this.updateMathquill()},n.prototype.didUpdate=function(){this.updateMathquill()},n.prototype.updateMathquill=function(){this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel()},n.prototype.onFocusEvent=function(){var e=this.isFocused();e!==this.shouldBeFocused()&&this.props.onFocusedChanged(e)},n.prototype.onPasteEvent=function(e){var t="",r=window.clipboardData,n=e.originalEvent;return r&&r.getData?t=r.getData("Text"):n&&n.clipboardData&&n.clipboardData.getData&&(t=n.clipboardData.getData("text/plain")),this.viewCanAcceptText(t)},n.prototype.viewCanAcceptText=function(e){return n.canAcceptText(this.mathField,this.props.capExpressionSize(),e)},n.canAcceptText=function(e,t,r){return!!e&&(!t||e.latex().length+r.length<=100)},n.prototype.onKeypressEvent=function(e){if(e.stopPropagation(),e.preventDefault(),this.mathField){var t=o.lookupChar(e.originalEvent);t&&this.viewCanAcceptText(t)&&(this.props.onUserTypedText?this.props.onUserTypedText(t):(this.mathField.typedText(t),this.props.onUserChangedLatex(this.mathField.latex())))}},n.prototype.hookupMQTapTouch=function(){var n=this;this.$mathField.on("dcg-tap.view",function(e){if("touch"===e.device&&n.mathField){var t=e.originalEvent.changedTouches[0];n.mathField.clickAt(t.clientX,t.clientY,t.target),n.mathField.focus();var r=void 0;setTimeout(function(){r=Date.now()},0),n.mathField.ignoreNextMousedown(function(){return void 0===r||Date.now()-r<500})}})},n.prototype.updateMathquillAria=function(){if(this.mathField){var e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}},n.prototype.updateMathquillPostLabel=function(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)},n.prototype.updateMathquillLatex=function(){var e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&100<e.length||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))},n.prototype.updateMathquillFocused=function(){if(this.mathField){var e=this.isFocused(),t=this.shouldBeFocused();t&&t!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),e!==(this.wasFocusedLastUpdate=t)&&(t?this.mathField.focus():this.mathField.blur())}},n.prototype.isFocused=function(){return!!l(document.activeElement).closest(this.$mathField).length},n.prototype.shouldBeFocused=function(){return this.props.isFocused()},n.getFocusedMathquill=function(){var e=l(document.activeElement).closest(".dcg-mq-editable-field")[0];return e?e._mqMathFieldInstance:void 0},n.getMQViewInstance=function(e){var t=e.el();return t?t._mqViewInstance:void 0},n.applyArrowKeyAndReturnIfWasAtBounds=function(e,t,r){var n=l(e.el()),i=n.find(".dcg-mq-selection"),o=1===i.length&&i.parent().parent()[0]===n[0]&&1===i.parent().children().length;if(("Up"===t||"Down"===t)&&o)return e.keystroke(t,r),!0;var a=n.find(".dcg-mq-cursor")[0];if(!a)return e.keystroke(t,r),!1;var s=a.previousSibling||a.parentElement;return e.keystroke(t,r),s===(a.previousSibling||a.parentElement)},n.simulateKeypress=function(e,t){var r=n.getMQViewInstance(e);r&&(r.props.onUserPressedKey?r.props.onUserPressedKey(t):(e.keystroke(t),r.props.onUserChangedLatex(e.latex())))},n.simulateUserChangedLatex=function(e){var t=n.getMQViewInstance(e);t&&t.mathField&&t.props.onUserChangedLatex(t.mathField.latex())},n.handleKeystrokeAndDecideIfSpecialEvent=function(e,t,r){return"Enter"===t||"Delete"===t&&""===e.latex()||"Backspace"===t&&""===e.latex()||("Up"===t?n.applyArrowKeyAndReturnIfWasAtBounds(e,t,r):"Down"===t?n.applyArrowKeyAndReturnIfWasAtBounds(e,t,r):"Left"===t?n.applyArrowKeyAndReturnIfWasAtBounds(e,t,r):"Right"===t?n.applyArrowKeyAndReturnIfWasAtBounds(e,t,r):(e.keystroke(t,r),!1))},n}(i.Class);t.default=n}),define("expressions/measure-expressions",["require","exports","jquery"],function(e,t,s){"use strict";function l(e){for(var t=[],r=0,n=e.getAllItemModels();r<n.length;r++){var i=n[r],o=e.getItemRootNodeById(i.id);o&&t.push(o)}return t}function c(e,t){for(var r=l(e),n=0,i=r.length-1;n<=i;){var o=n+Math.floor((i-n)/2),a=r[o],s=a.getBoundingClientRect();if(s.top>t)i=o-1;else{if(!(s.bottom<t))return a;n=o+1}}}function i(e){return e.find$(".dcg-exppanel")[0]}function r(e){var t=i(e);if(t)return s(t)}function u(e){var t=i(e);if(t)return t.getBoundingClientRect()}Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstPartiallyVisibleItemId=function(e,t){var r=u(e);if(r){if(t){var n=e.getItemRootNodeById(t);if(n){var i=n.getBoundingClientRect();if(0<i.height&&i.top<=r.top&&i.bottom>=r.top)return t}}var o=c(e,r.top);if(o)return s(o).attr("expr-id")}},t.getLastPartiallyVisibleItemId=function(e,t){var r=u(e);if(r){var n=function(e){for(var t=e.getAllItemModels(),r=t.length-1;0<=r;r--){var n=t[r];if(n.dcgView)return n.id}}(e);if(n){if(t){var i=e.getItemRootNodeById(t);if(i){var o=i.getBoundingClientRect();if(0<o.height&&o.top<=r.bottom&&o.bottom>=r.bottom)return t;if(t===n&&o.bottom<=r.bottom)return t}}var a=c(e,r.bottom);return a&&s(a).attr("expr-id")||n}}},t.getFirstFullyVisibleItemId=function(e){var t=u(e);if(t){var r=function(e,t){for(var r,n=l(e),i=0,o=n.length-1;i<=o;){var a=i+Math.floor((o-i)/2),s=n[a];s.getBoundingClientRect().top>t?(o=a-1,r=s):i=a+1}return r}(e,t.top-2);if(r)return s(r).attr("expr-id")}},t.isItemPartiallyVisible=function(e,t){var r=u(e);if(!r)return!1;var n=e.getItemRootNodeById(t);if(!n)return!1;var i=n.getBoundingClientRect();return i.bottom>r.top&&i.top<r.bottom},t.getExppanelElt=i,t.getExppanelSelector=r,t.getOuterExppanelRect=function(e){var t=e.find$(".dcg-exppanel-outer")[0];if(t)return t.getBoundingClientRect()},t.getExppanelRect=u,t.getExppanelScrolledTop=function(e){var t=i(e);if(t){var r=t.getBoundingClientRect(),n=t.scrollTop;return r.top-n}},t.getExpListHeight=function(e){var t=e.find$(".dcg-expressionlist");if(1===t.length)return t.height()},t.getDragContainerHeight=function(e){var t=r(e);return t?t.find(".dcg-drag-container").height():0}}),define("animation-frame-src",["require"],function(e){var o=0;return window.requestAnimationFrame&&window.cancelAnimationFrame?{requestAnimationFrame:window.requestAnimationFrame.bind(window),cancelAnimationFrame:window.cancelAnimationFrame.bind(window)}:{requestAnimationFrame:function(e,t){var r=(new Date).getTime(),n=Math.max(0,16-(r-o)),i=window.setTimeout(function(){e(r+n)},n);return o=r+n,i},cancelAnimationFrame:window.clearTimeout.bind(window)}}),define("lib/animation-frame",["require","exports","animation-frame-src"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requestAnimationFrame=r.requestAnimationFrame,t.cancelAnimationFrame=r.cancelAnimationFrame}),define("jquery.handleevent",["require","jquery"],function(e){var i=e("jquery");i.Event.prototype.wasHandled=function(e){e=e||"_*_";var t=this.originalEvent,r=t&&t.handledBy;if(r&&r[e])return!0;if("_*_"!==e)return!1;var n=i(this.target).closest("[handleEvent]");return!(!n.length||n[0]===this.currentTarget)&&"false"!==n.attr("handleEvent")},i.Event.prototype.handle=function(e){e=e||"_*_";var t=this.originalEvent;if(t){var r=t.handledBy;r||(r=t.handledBy={}),r[e]=!0}}}),define("expressions/dragdrop_expressions",["require","exports","tslib","jquery","expressions/measure-expressions","lib/animation-frame","jquery.handleevent"],function(e,t,v,r,f,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.active=!1,this.controller=e;var t=f.getExppanelSelector(e);t&&(this.$exppanel=t)}return e.prototype.startDragging=function(e){this.active=!0,this.mouseY=e,this.setupEventListeners()},e.prototype.applyDrag=function(){var e=this.controller.getListModel().dragState;if(e){this.scheduleUpdateScroll();var t=this.measureDOM(e);if(t){var r=t.floatingPreviewRect,n=this.controller.getItemModel(e.firstItemId);if(n){for(var i=n.index,o=0,a=t.visibleRects;o<a.length;o++){var s=a[o],l=s.id,c=s.rect;if(l!==n.id){var u=this.controller.getItemModel(l);if(!u)return;if(u.index<n.index){if(r.top<c.top+c.height/2){i=u.index;break}}else r.bottom>c.top+c.height/2&&(i=u.index,"folder"===u.type&&u.collapsed&&(i+=this.controller.getNumberOfItemsInFolder(u.id)))}}var p,d;d=i>n.index?(p=i)+1:i<n.index?(p=i-1,i):(p=i-1,i+1);var h=this.controller.getItemModelByIndex(p),f=this.controller.getItemModelByIndex(d),g="",m="";h&&(g="folder"===h.type?h.id:h.folderId),f&&(m="folder"===f.type?f.id:f.folderId);var y="";return g&&(m===g?"folder"===n.type?i=n.index:y=g:"folder"!==n.type&&this.isPreviewTopContainedInFolder(t,g)&&(y=g)),{dragState:v.__assign({},t.dragState),newIndex:i,folderId:y}}}}},e.prototype.measureDOM=function(e){var t=f.getExppanelScrolledTop(this.controller),r=f.getExpListHeight(this.controller);if(void 0!==t&&void 0!==r){var n=f.getDragContainerHeight(this.controller),i=e.mouseY-e.grabOffset+2,o=i-t;o=Math.max(o,-n/2),o=Math.min(o,r-n);var a={top:i,bottom:i+n,height:n},s=this.controller.findFirstPartiallyVisibleItem(),l=this.controller.findLastPartiallyVisibleItem();if(s&&l){for(var c=[],u=s.index;u<=l.index;u++){var p=this.controller.getItemModelByIndex(u);if(p){var d=this.controller.getItemRootNodeById(p.id);if(d&&p.id!==e.firstItemId){var h=d.getBoundingClientRect();c.push({id:p.id,rect:h})}}}if(0!==c.length)return{dragState:v.__assign({},e,{itemTop:o}),floatingPreviewRect:a,visibleRects:c}}}},e.prototype.isPreviewTopContainedInFolder=function(e,t){for(var r=e.visibleRects,n=e.floatingPreviewRect,i=0,o=r;i<o.length;i++){var a=o[i],s=a.id,l=a.rect;if(l.top<=n.top&&l.bottom>=n.top){var c=this.controller.getItemModel(s);if(!c)return!1;if("folder"===c.type&&c.id===t)return!0;if(c.folderId===t)return!0}}return!1},e.prototype.scheduleUpdateScroll=function(){var e=this;this.updateScrollScheduled||(this.updateScrollScheduled=!0,n.requestAnimationFrame(function(){e.updateScroll(),e.updateScrollScheduled=!1}))},e.prototype.stop=function(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})},e.prototype.setupEventListeners=function(){var t=this;r(document).on("dcg-tapmove.dragdrop",function(e){t.mouseY=e.changedTouches[0].clientY,t.controller.dispatch({type:"update-dragdrop",mouseY:t.mouseY})}),r(document).on("dcg-tapend.dragdrop",function(e){t.stop(),e.handle("dragdrop")})},e.prototype.tearDownEventListeners=function(){r(document).off(".dragdrop")},e.prototype.updateScroll=function(){if(this.active){var e=this.$exppanel[0].getBoundingClientRect(),t=0;t=Math.min(t,this.mouseY-e.top),(t=(t=Math.max(t,this.mouseY-e.bottom+30))*e.height/900)&&this.$exppanel.scrollTop(this.$exppanel.scrollTop()+t)}},e}();t.default=i}),define("keypad/mq-commands",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={loga:function(e){e.write("\\log_{}"),e.typedText("("),e.keystroke("Left"),e.keystroke("Down")},nthroot:function(e){e.write("\\sqrt[]{}"),e.keystroke("Left"),e.keystroke("Left")},ddx:function(e){e.write("\\frac{d}{dx}")},arcsin:function(e){e.write("sin^{-1}"),e.typedText("(")},arccos:function(e){e.write("cos^{-1}"),e.typedText("(")},arctan:function(e){e.write("tan^{-1}"),e.typedText("(")},arcsec:function(e){e.write("sec^{-1}"),e.typedText("(")},arccsc:function(e){e.write("csc^{-1}"),e.typedText("(")},arccot:function(e){e.write("cot^{-1}"),e.typedText("(")},"A^T":function(e){e.typedText("^T"),e.keystroke("Right")},"A^-1":function(e){e.typedText("^-1"),e.keystroke("Right")},"A^2":function(e){e.typedText("^2"),e.keystroke("Right")},"a^2":function(e){e.typedText("^2"),e.keystroke("Right")},"a^3":function(e){e.typedText("^3"),e.keystroke("Right")}};t.execute=function(e,t){r[t](e)}}),define("main/controller",["require","exports","main/migrate_state","main/propagate_selection","tslib","scroll_helpers","browser","graphing/label","underscore","i18n","flux","graphing/dragmode","expressions/styles","expressions/opacity","lib/conditional_blur","lib/deepCopy","lib/number-to-latex","lib/state-stack","./data_helpers","graphing/viewport","lib/color-helpers","graphing-calc/models/expression","graphing-calc/models/expression","graphing-calc/models/table","graphing-calc/models/image","graphing-calc/models/folder","graphing-calc/models/text","graphing-calc/models/list","graphing-calc/models/abstract-item","graphing-calc/models/focus","graphing-calc/actions/keyboard","lib/evaluate-single-expression","./layout-model","./settings-view-model","jquery","bugsnag","expressions/list_move_controller","./blank_state","dcgview-helpers/mathquill-view","expressions/measure-expressions","expressions/dragdrop_expressions","keypad/mq-commands"],function(e,t,n,r,L,i,o,O,g,a,s,q,l,c,u,p,d,h,f,m,y,v,F,N,R,B,j,V,U,z,G,b,x,w,_,S,H,E,W,M,I,K){"use strict";function T(e){return e?L.__assign({},e,{wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0}):e}Object.defineProperty(t,"__esModule",{value:!0});var C=function(){function e(e){var n=this;this.__nextItemId=0,this.__pendingImageUploads={},this.nextSubscription=0,this.subscriptions={},this._queuedCallbacks=[],this._hasUnsavedChanges=!1,this.shouldScrollSelectedItemIntoViewAfterDispatch=!1,this.lastParsableObjects={},this.toastData={},this.t=function(e,t){var r=n.graphSettings.config.language;return a.t(e,t,r)},this.unpack=function(e){var t=n.graphSettings.config.language;return a.unpack(e,t)},this.dispatch=function(e){if("blur-focus-location"===e.type&&n.dispatcher.isDispatching())n.runAfterDispatch(function(){n.dispatch(e)});else{"tick"===e.type?S.leaveBreadcrumb("dispatch::"+n.bugsnagContext,e):"process-graph-data"===e.type?S.leaveBreadcrumb("dispatch::"+n.bugsnagContext,{type:e.type}):S.leaveBreadcrumb("dispatch::"+n.bugsnagContext,e),n.dispatcher.isDispatching()&&S.leaveBreadcrumb("dispatch-in-dispatch::"+n.bugsnagContext,{type:e.type}),n.dispatcher.dispatch(e),S.leaveBreadcrumb("dispatch-over::"+n.bugsnagContext,{type:e.type}),n.onEventsEmitted&&n.onEventsEmitted(n.enqueuedEvents);for(var t;t=n._queuedCallbacks.shift();)t()}},this.emitUpdateRequests=function(){for(var e in n.subscriptions)n.subscriptions[e]()},this.bugsnagContext="",this.inPrintMode=!1,this.stateStack=new h.default,this.isCurrentlyDoingSetState=!1,this.graphSettings=e,this.listModel=V.init(this),this.layoutModel=x.defaultLayoutModel(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=w.defaultSettingsViewModel(),this.addExpressionViewModel={focusOnOpen:!1},this.imageRetryState={lastAttemptTime:0,attempts:0},this.setupDispatcher()}return e.prototype.hasUnsavedChanges=function(){return this._hasUnsavedChanges},e.prototype.hasVisibleAndUndoableToast=function(){return"function"==typeof this.toastData.undoCallback},e.prototype.getToastData=function(){return this.toastData},e.prototype.toastUndo=function(){"function"==typeof this.toastData.undoCallback&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))},e.prototype.runAfterDispatch=function(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()},e.prototype.enqueueEvent=function(e){this.enqueuedEvents[e]=!0},e.prototype.setupDispatcher=function(){var o=this;this.dispatcher=new s.Dispatcher,this.dispatcher.register(function(e){var t=o.getSelectedItem(),r=o.getFocusLocation();o.shouldScrollSelectedItemIntoViewAfterDispatch=!1,o.enqueuedEvents={change:!1,graphReset:!1,clearUnsavedChanges:!1,openDrawer:!1,userMovedPoint:!1},o.isCurrentlyDoingSetState=!1,o.handleDispatchedAction(e),o.updateTheComputedWorld(),o.updateRenderShellsBeforePaint(),o.retryLoadingFailedImage(),"undo"===e.type||"redo"===e.type||o.isDragDropActive()||o.commitUndoRedoSynchronously(e.type),o.requestParseForAllItems(),o.isCurrentlyDoingSetState=!1,o.emitUpdateRequests(),o.enqueuedEvents.change&&o.grapher&&o.grapher.markLabelsDirty(),o.enqueuedEvents.clearUnsavedChanges?o._hasUnsavedChanges=!1:o.enqueuedEvents.change&&(o._hasUnsavedChanges=!0);var n=o.getSelectedItem();n?t&&t.guid===n.guid||(o.shouldScrollSelectedItemIntoViewAfterDispatch=!0):o.shouldScrollSelectedItemIntoViewAfterDispatch=!1;var i=o.getFocusLocation();i&&!g.isEqual(i,r)&&(o.getFocusedItem()==n&&(o.shouldScrollSelectedItemIntoViewAfterDispatch=!0));o.shouldScrollSelectedItemIntoViewAfterDispatch&&o.scrollSelectedItemIntoView(),o.updateRenderShellsAfterPaint(),o.updateDragDrop()})},e.prototype.handleDispatchedAction=function(t){var r=this;switch(t.type){case"api-method-called":break;case"undo":this.undo();break;case"redo":this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":"Enter"===t.key?G.onEnterPressed(this):"Up"===t.key?G.onUpPressed(this):"Down"===t.key?G.onDownPressed(this):"Backspace"===t.key?G.onBackspacePressed(this):"Delete"===t.key&&G.onDeletePressed(this);break;case"select-previous-expression":V.selectPrevItem(this.listModel);break;case"select-next-expression":V.selectNextItem(this.listModel);break;case"upward-delete-selected-expression":G.upwardDeleteSelectedExpression(this);break;case"downward-delete-selected-expression":G.downwardDeleteSelectedExpression(this);break;case"navigate-table-by-key":G.navigateTableByKey(this,t.id,t.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(t.id);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(t.id);break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(t.id,t.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(t.state));break;case"duplicate-expression":var e=this.getItemModel(t.id);if(!e||"expression"!==e.type)return;var n=F.getState(e,{stripDefaults:!1}),i=this.createItemModel(L.__assign({},n,{id:this.generateId()}));this._toplevelInsertItemAt(e.index+1,i,!1,e.folderId);break;case"insert-item-at-index":var o=this.createItemModel(t.state);this._toplevelInsertItemAt(t.index,o,t.focus,t.folderId);break;case"new-expression-at-end":o=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),V.insertItemAtEnd(this.listModel,o),z.moveFocusToItem(this,o.id);break;case"new-expression":o=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(o,{shouldFocus:!0}),this._closeAddExpression();break;case"new-text":o=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(o,{shouldFocus:!0}),this._closeAddExpression();break;case"new-folder":o=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(o,{shouldFocus:!0}),this._closeAddExpression();break;case"new-images":this._uploadImagesAndWaitForThemToLoad(t.files),this._closeAddExpression();break;case"new-table":var a=V.findAvailableColumnSubscript(this.listModel),s=N.makeTableState(a,[[""],[""]],this);o=this.createItemModel(s);this._toplevelNewItemAtSelection(o,{shouldFocus:!0}),this._closeAddExpression();break;case"paste-table":this._pasteTable(t.data);break;case"paste-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._pasteExpressions(t.expressions);break;case"remove-item-by-id":V.removeItemById(this.listModel,t.id);break;case"replace-item-at-index":o=this.createItemModel(t.state);this._toplevelReplaceItemAt(t.index,o,t.focus);break;case"create-sliders-for-item":this.createSlidersForItem(t.id,t.variables);break;case"start-dragdrop":if(!(k=this.getItemModel(t.id)))return;var l=this.getItemRootNodeById(k.id);if(!l)return;var c=l.getBoundingClientRect();V.setSelected(this.listModel,void 0);var u=t.grabY-c.top,p=!1,d=1;"folder"===k.type&&(d+=this.getNumberOfItemsInFolder(k.id),k.collapsed||(p=!0,B.setCollapsed(k,!0))),V.setDragState(this.listModel,{firstItemId:k.id,numberOfItems:d,expandFolder:p,grabOffset:u,mouseY:t.mouseY,itemTop:0}),this.dragdrop_expressions.startDragging(t.mouseY);break;case"update-dragdrop":if(!(h=this.listModel.dragState))return;V.setDragState(this.listModel,L.__assign({},h,{mouseY:t.mouseY}));break;case"stop-dragdrop":var h;if(!(h=this.listModel.dragState))return;if(!(M=this.getItemModel(h.firstItemId)))return;V.setSelected(this.listModel,M),"folder"===M.type&&h.expandFolder&&B.setCollapsed(M,!1),V.setDragState(this.listModel,void 0);break;case"set-selected-id":o=this.getItemModel(t.id);V.setSelected(this.listModel,o);break;case"set-selected-index":o=this.getItemModelByIndex(t.index);V.setSelected(this.listModel,o);break;case"set-none-selected":V.setSelected(this.listModel,void 0);break;case"set-focus-location":var f=t.location?t.location.type:"";"expression"!==f&&"text"!==f&&"folder"!==f&&"table"!==f||(this.layoutModel=L.__assign({},this.layoutModel,{inEditListMode:!1})),z.setFocusLocation(this,t.location);break;case"move-focus-to-item":z.moveFocusToItem(this,t.id,t.where);break;case"blur-focus-location":this.isFocusLocationFocused(t.location)&&z.setFocusLocation(this,void 0);break;case"set-folder-collapsed":if(!(k=this.getItemModel(t.id))||"folder"!==k.type)return;B.setCollapsed(k,t.isCollapsed);break;case"set-item-secret":if(!(o=this.getItemModel(t.id)))return;U.setSecret(o,t.isSecret);break;case"set-tablecolumn-color":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnColor(k,t.columnId,t.color);break;case"set-show-cdf":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setShowCDF(k,t.showCDF);break;case"set-cdf-min":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setCDFMin(k,t.latex);break;case"set-cdf-max":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setCDFMax(k,t.latex);break;case"toggle-item-hidden":this._toggleItemHidden(t.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(t.tableId,t.columnId);break;case"toggle-fraction-evaluation":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;var g=F.shouldEvaluationDisplayAsFraction(k);F.setEvaluationAsFraction(k,!g);break;case"set-item-label":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLabel(k,t.label);break;case"set-item-showlabel":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setShowLabel(k,t.showLabel);break;case"set-item-color":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setColor(k,t.color);break;case"set-item-fill":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setFill(k,t.fill),this._setItemHidden(k.id,F.shouldHide(k));break;case"set-image-opacity":if(!(k=this.getItemModel(t.id))||"image"!==k.type)return;R.setOpacity(k,t.opacity),this._setItemHidden(k.id,!1);break;case"set-image-in-foreground":if(!(k=this.getItemModel(t.id))||"image"!==k.type)return;R.setForeground(k,t.foreground);break;case"image-upload-error":this.__pendingImageUploads[t.token]&&(delete this.__pendingImageUploads[t.token],this._showToast({message:this.t("Image upload failed.")}));break;case"image-upload-success":if(this.__pendingImageUploads[t.token]){delete this.__pendingImageUploads[t.token];var m=this.createItemModel({type:"image",id:this.generateId(),width:t.width,height:t.height,image_url:t.url,name:t.name});this._toplevelNewItemAtSelection(m,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={});break;case"image-load-success":if(!(m=this.getItemModel(t.id))||"image"!==m.type)return;R.setLoadStatus(m,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0};break;case"image-load-error":if(!(m=this.getItemModel(t.id))||"image"!==m.type)return;R.setLoadStatus(m,"failed");break;case"image-retry-loading":if(!(m=this.getItemModel(t.id))||"image"!==m.type)return;R.retryLoading(m);break;case"set-item-dragmode":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setDragMode(k,t.dragMode),t.dragMode!==q.NONE&&this._setItemHidden(t.id,!1);break;case"set-tablecolumn-dragmode":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnDragMode(k,t.columnId,t.dragMode),t.dragMode!==q.NONE&&this._setTableColumnHidden(t.tableId,t.columnId,!1);break;case"set-tablecolumn-points":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnPoints(k,t.columnId,t.bool),this._setTableColumnHidden(t.tableId,t.columnId,N.shouldHideColumn(k,t.columnId));break;case"set-tablecolumn-lines":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnLines(k,t.columnId,t.bool),this._setTableColumnHidden(t.tableId,t.columnId,N.shouldHideColumn(k,t.columnId));break;case"set-tablecolumn-linestyle":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnLineStyle(k,t.columnId,t.lineStyle),this._setTableColumnHidden(t.tableId,t.columnId,!1);break;case"set-tablecolumn-pointstyle":if(!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setColumnPointStyle(k,t.columnId,t.pointStyle),this._setTableColumnHidden(t.tableId,t.columnId,!1);break;case"set-item-points":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setPoints(k,t.points),this._setItemHidden(t.id,F.shouldHide(k)),t.points||k.dragMode===q.NONE||F.setDragMode(k,q.NONE);break;case"set-item-pointstyle":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setPointStyle(k,t.pointStyle),this._setItemHidden(t.id,!1);break;case"set-item-lines":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLines(k,t.lines),this._setItemHidden(t.id,F.shouldHide(k));break;case"set-item-linestyle":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLineStyle(k,t.lineStyle),this._setItemHidden(t.id,!1);break;case"set-item-label-dropdown-open":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLabelDropdownOpen(k,t.open);break;case"set-item-fillopacity":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setFillOpacity(k,t.fillOpacity),this._setItemHidden(t.id,!1);break;case"set-item-labelSize":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLabelSize(k,t.labelSize);break;case"set-item-label-orientation":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setLabelOrientation(k,t.labelOrientation);break;case"set-item-vertical-label":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setVerticalLabel(k,t.verticalLabel);break;case"plot-residuals":if(!(o=this.getItemModel(t.id))||"expression"!==o.type)return;var y=o.formula.regression,v=y.residualSuggestionId;if(!v)return;var b=this.getItemModel(v);if(!b)return;N.insertBlankColumn(b,b.columnModels.length-1,{id:this.generateId(),latex:O.identifierToLatex(y.residualVariable),color:this.getNextColor()});break;case"toggle-logmode":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;var x=k.isLogModeRegression;F.setLogMode(k,!x);break;case"set-item-latex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(o=this.getItemModel(t.id))||"expression"!==o.type)return;var w=t.latex;if('"'===w&&this.areNotesEnabled()){var _=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(o.index,_,!0)}else""===w?F.blankOutExpressionAfterClearingLatex(o):"betchacant"===w?this.runAfterDispatch(function(){r.triggerBetchacant&&r.triggerBetchacant()}):F.setLatex(o,w);break;case"set-folder-title":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"folder"!==k.type)return;B.setTitle(k,t.title);break;case"set-image-mq-attribute":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"image"!==k.type)return;R.setMQAttribute(k,t.attribute,t.latex);break;case"set-image-name":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"image"!==k.type)return;R.setName(k,t.name);break;case"set-graph-settings":for(var S in t)"type"!==S&&this.graphSettings.setProperty(S,t[S]);break;case"set-polar-domain-minlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setPolarDomainMin(k,t.latex);break;case"set-polar-domain-maxlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setPolarDomainMax(k,t.latex);break;case"set-parametric-domain-minlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setParametricDomainMin(k,t.latex);break;case"set-parametric-domain-maxlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setParametricDomainMax(k,t.latex);break;case"set-note-text":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"text"!==k.type)return;j.setText(k,t.text);break;case"set-edit-list-mode":this.setEditListMode(t.isEditListMode),V.setSelected(this.listModel,void 0);break;case"set-tablecell-latex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.tableId))||"table"!==k.type)return;N.setCellLatex(k,t.cell,t.latex);break;case"set-state":this.externalSetState(t.state,t.opts);break;case"set-blank":this.externalSetState(this.getBlankState(),t.opts);break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges");break;case"reset-graph":var E=this.getState();this.externalSetState(this.graphSettings.defaultState,{}),this._showToast({message:this.t("Graph reset."),undoCallback:function(){return r.dispatch({type:"set-state",state:E,opts:{}})}}),this.enqueueEvent("graphReset");break;case"clear-graph":if(this.triggerClearGraph)return void this.runAfterDispatch(function(){return r.triggerClearGraph()});var M,I=this.getState();this.externalSetState(this.getBlankState(),{}),(M=this.getItemModelByIndex(0))&&z.moveFocusToItem(this,M.id,"end"),this._showToast({message:this.t("Graph cleared."),undoCallback:function(){return r.dispatch({type:"set-state",state:I,opts:{}})}}),this.enqueueEvent("graphReset");break;case"on-evaluator-changes":V.onEvaluatorFormulaUpdates(this.listModel,t.changes);break;case"process-graph-data":var T;for(T in t.graphData.addedGraphs){var C=t.graphData.addedGraphs[T];this.grapher&&this.grapher.updateSketch(T,C),V.onGraphComputed(this.listModel,T,C)}for(T in t.graphData.removedGraphs)this.grapher&&this.grapher.hide(T);for(T in t.graphData.intersections)this.grapher&&this.grapher.updateIntersections(T,t.graphData.intersections[T]);this.grapher&&this.grapher.poiController.handleTraceUpdate();break;case"add-helper-expression":V.addHelperExpression(this.listModel,t.state);break;case"tick":this._tick(t.time);break;case"adjust-slider-by-keyboard":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.adjustSliderByKeyboard(k,t.adjustment);break;case"adjust-slider-by-dragging-thumb":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.adjustSliderByDraggingThumb(k,t.target);break;case"set-slider-minlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderMin(k,t.latex);break;case"set-slider-maxlatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderMax(k,t.latex);break;case"set-slider-steplatex":if(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderStep(k,t.latex);break;case"set-slider-dragging":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderDragging(k,t.dragging);break;case"set-slider-isplaying":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderIsPlaying(k,t.isPlaying);break;case"set-slider-loopmode":if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderLoopMode(k,t.loopMode);break;case"set-slider-animationperiod":var k;if(!(k=this.getItemModel(t.id))||"expression"!==k.type)return;F.setSliderAnimationPeriod(k,t.animationPeriod);break;case"show-expressions-list":this._showExpressions();break;case"hide-expressions-list":this._hideExpressions();break;case"open-drawer":this.enqueueEvent("openDrawer");break;case"resize-exp-list":this._setExpListWidth(t.expListWidth);break;case"toast/show":this._showToast(t.toast);break;case"toast/close":var P=this.toastData.onHide;P&&this.runAfterDispatch(P),this.toastData={};break;case"toast/undo":var D=this.toastData.undoCallback;D&&this.runAfterDispatch(D),this.toastData={};break;case"toast/learn-more":var A=this.toastData.undoCallback;A&&this.runAfterDispatch(A),this.toastData={};break;case"start-moving-point":H.onStartMovingPoint(this,this.listModel,t.pointInfo);break;case"stop-moving-point":H.onStopMovingPoint(this,t.pointInfo);break;case"on-move-point":H.onMovePoint(this,t.pointInfo,t.screenPt,t.projection,t.keyboardDirection)&&this.enqueueEvent("userMovedPoint");break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(t.viewport);break;case"set-viewport":this._setAxisLimitLatex("xmin",t.viewport.xmin+""),this._setAxisLimitLatex("xmax",t.viewport.xmax+""),this._setAxisLimitLatex("ymin",t.viewport.ymin+""),this._setAxisLimitLatex("ymax",t.viewport.ymax+"");break;case"set-axis-limit-latex":this._setAxisLimitLatex(t.limit,t.latex);break;case"toggle-graph-settings":this.layoutModel=L.__assign({},this.layoutModel,{graphSettingsOpen:!this.layoutModel.graphSettingsOpen}),this.settingsViewModel=L.__assign({},this.settingsViewModel,{focusOnOpen:t.focusOnOpen}),t.focusOnOpen&&z.setFocusLocation(this,void 0);break;case"close-graph-settings":this.layoutModel=L.__assign({},this.layoutModel,{graphSettingsOpen:!1});break;case"toggle-add-expression":this.layoutModel=L.__assign({},this.layoutModel,{addExpressionOpen:!this.layoutModel.addExpressionOpen}),this.addExpressionViewModel=L.__assign({},this.addExpressionViewModel,{focusOnOpen:t.focusOnOpen}),t.focusOnOpen&&z.setFocusLocation(this,void 0);break;case"close-add-expression":this._closeAddExpression();break;case"ui/container-resized":this.layoutMeasurements={width:t.size.width,height:t.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"keypad/set-layout":this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:t.layout,keypadFunctionsOpen:!1});break;case"keypad/set-functions-tab":this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsTab:t.tab});break;case"keypad/set-minimized":this.layoutModel=L.__assign({},this.layoutModel,{keypadMinimized:t.minimized,keypadLayout:"mainNumbers"}),this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||z.addFocusForKeypad(this);break;case"keypad/type-text":this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsOpen:!1}),this.runAfterDispatch(function(){var e=W.default.getFocusedMathquill();e&&W.default.canAcceptText(e,!!r.getGraphSettings().config.capExpressionSize,t.text)&&(e.typedText(t.text),W.default.simulateUserChangedLatex(e))});break;case"keypad/press-key":this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsOpen:!1}),this.runAfterDispatch(function(){var e=W.default.getFocusedMathquill();e&&W.default.simulateKeypress(e,t.key)});break;case"keypad/custom-command":this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsOpen:!1}),this.runAfterDispatch(function(){var e=W.default.getFocusedMathquill();e&&(K.execute(e,t.command),W.default.simulateUserChangedLatex(e))});break;case"keypad/shift":"capitalLetters"===this.getKeypadLayout()?this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:"capitalLetters",keypadFunctionsOpen:!1});break;case"keypad/123":this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:"mainNumbers",keypadFunctionsOpen:!1});break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=L.__assign({},this.layoutModel,{keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1});break;case"keypad/functions":this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()});break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.layoutModel=L.__assign({},this.layoutModel,{isFileDraggedOver:!0});break;case"file-is-not-dragged-over":this.layoutModel=L.__assign({},this.layoutModel,{isFileDraggedOver:!1});break;case"zoom":this.grapher.viewportController.zoom(t.direction);break;default:return t}},e.prototype.setEditListMode=function(e){this.layoutModel=L.__assign({},this.layoutModel,{inEditListMode:e})},e.prototype._populateSettingsViewLimitLatex=function(){this.grapher&&(this.settingsViewModel=L.__assign({},this.settingsViewModel,{limitLatex:w.limitLatex(this.grapher.getCurrentViewport(),this.getGraphSettings().xAxisStep,this.getGraphSettings().yAxisStep)}))},e.prototype.getSettingsViewModel=function(){return this.settingsViewModel},e.prototype.getListModel=function(){return this.listModel},e.prototype.hasBackgroundColor=function(){return"#ffffff"!==this.getBackgroundColor()},e.prototype.getBackgroundColor=function(){return this.getGraphSettings().getBackgroundColor()},e.prototype.getTextColor=function(){return this.getGraphSettings().getTextColor()},e.prototype.getPillboxBackgroundColor=function(){return y.shadeColor(this.getBackgroundColor(),-.07)},e.prototype.getAddExpressionViewModel=function(){return this.addExpressionViewModel},e.prototype.subToChanges=function(e){var t=this,r=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[r]=e,function(){delete t.subscriptions[r]}},e.prototype.updateTheComputedWorld=function(){var e=this;V.reindex(this.listModel),V.updateDrawOrder(this.listModel),this.grapher&&this.grapher.setSketchOrder(this.listModel.drawOrder);for(var t=0,r=this.getAllItemModels();t<r.length;t++){var n=r[t];switch(n.type){case"expression":F.onControllerUpdate(n);break;case"image":R.onControllerUpdate(n);break;case"table":N.onControllerUpdate(n);break;case"folder":B.onControllerUpdate(n);break;case"text":j.onControllerUpdate(n);break;default:return n}}this.isCurrentFocusLocationValid()||z.setFocusLocation(this,void 0);var i=this.getSelectedItem();this.layoutModel.graphSettingsOpen||this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.isKeypadOpen()||(this.layoutModel=L.__assign({},this.layoutModel,{keypadFunctionsOpen:!1})),this.runAfterDispatch(function(){e.grapher&&e.grapher.audioGraph.checkIfSelectedItemChanged(i?i.id:void 0),e.grapher&&e.focusLocation&&e.grapher.audioGraph.exitAudioTrace()})},e.prototype.propagateSelection=function(){this.grapher&&this.evaluator&&(this.__lastSelectedId=r.propagateSelection(this,this.grapher,this.evaluator,this.__lastSelectedId))},e.prototype.areParsableObjectsEqual=function(e,t){return e===t||g.isEqual(L.__assign({},e,{regressionParameters:void 0}),L.__assign({},t,{regressionParameters:void 0}))},e.prototype.requestParseForAllItems=function(){this.isCurrentlyDoingSetState&&this.evaluator.clearStatementsAndStartCompleteState();for(var e={},t=this.lastParsableObjects,r=0,n=this.getAllItemModels();r<n.length;r++){switch((s=n[r]).type){case"expression":case"image":case"table":e[s.id]=s.cachedParsableState;break;case"folder":case"text":break;default:return s}}for(var i=0,o=V.getAllHelperItemModels(this.listModel);i<o.length;i++){e[(s=o[i]).id]=s.cachedParsableState}for(var a in e){var s,l=e[a],c=t[a];if("image"===l.type&&(!c||l.type!==c.type||l.guid!==c.guid)&&this.grapher)(s=this.getItemModel(a))&&"image"===s.type&&this.grapher.addGraphImage(s);this.areParsableObjectsEqual(l,c)||(this.grapher&&"statement"===l.type&&""===l.latex&&this.grapher.removeGraphSketch(l.id),this.evaluator.addStatement(l))}for(var a in t){c=t[a],l=e[a];if("image"!==c.type||l&&l.type===c.type&&l.guid===c.guid||this.grapher&&this.grapher.removeGraphImage(a),!l&&(this.evaluator.removeStatement(a),"table"===c.type))for(var u=0,p=c.columns;u<p.length;u++){var d=p[u];this.evaluator.removeStatement(d.id)}}if(this.grapher){var h=this.grapher.getProjection(),f={viewport:h.viewport.toObject(),screen:h.screen};g.isEqual(f,this.lastViewState)||(this.evaluator.setViewState(f),this.lastViewState=f)}this.evaluator.tick(),this.lastParsableObjects=e},e.prototype.setEvaluator=function(e){this.evaluator=e},e.prototype.setGrapher=function(e){this.grapher=e},e.prototype.setBugsnagContext=function(e){this.bugsnagContext=e},e.prototype.getItemRootNodeById=function(e){var t=this.getItemModel(e);return t&&t.dcgView?t.dcgView.findRootNode():void 0},e.prototype.getItemSelectorById=function(e){var t=this.getItemRootNodeById(e);return t?_(t):void 0},e.prototype.generateId=function(){var e=this.__nextItemId;return this.__nextItemId+=1,e+""},e.prototype.getNextColor=function(){return V.getNextColor(this.listModel)},e.prototype.getNextDisplayIndex=function(){return this.listModel.nextDisplayIndex},e.prototype._clearPendingImageUploads=function(){this.__pendingImageUploads={}},e.prototype.isUploadingImages=function(){return 0<Object.keys(this.__pendingImageUploads).length},e.prototype.getExpressionAnalysis=function(){return this.listModel.expressionAnalysis},e.prototype.createItemModel=function(e){return V.modelFromSpec(this.listModel,e)},e.prototype.getItemModel=function(e){return V.getItemById(this.listModel,e)},e.prototype.getItemModelByIndex=function(e){return V.getItemByIndex(this.listModel,e)},e.prototype.getItemCount=function(){return V.getItemCount(this.listModel)},e.prototype.isItemSecret=function(e){var t=this.getItemModel(e);return!!t&&V.isItemSecret(t)},e.prototype.isItemSelected=function(e){var t=this.getItemModel(e);return!!t&&V.isItemSelected(t)},e.prototype.isItemSelectable=function(e){var t=this.getItemModel(e);return!!t&&V.isItemSelectable(t)},e.prototype.getAllItemModels=function(){return V.getAllItemModels(this.listModel)},e.prototype.getAllModelsWithSliders=function(){return V.getAllModelsWithSliders(this.listModel)},e.prototype.getGraphSettings=function(){return this.graphSettings},e.prototype.inAudioTraceMode=function(){return!(!this.grapher||!this.grapher.audioGraph.audioTraceActive)},e.prototype.expressionsAreFullWidth=function(){return this.isNarrow()||!1===this.graphSettings.config.graphpaper},e.prototype.getExpListWidthString=function(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"},e.prototype.getExpListWidth=function(){return this.rootElt?this._getExpListWidth():0},e.prototype.findFirstPartiallyVisibleItem=function(){var e=M.getFirstPartiallyVisibleItemId(this,this._previousFirstPartiallyVisibleId);return(this._previousFirstPartiallyVisibleId=e)?this.getItemModel(e):void 0},e.prototype.findLastPartiallyVisibleItem=function(){var e=M.getLastPartiallyVisibleItemId(this,this._previousLastPartiallyVisibleId);return(this._previousLastPartiallyVisibleId=e)?this.getItemModel(e):void 0},e.prototype.updateRenderShellsBeforePaint=function(){if(this.inPrintMode)for(var e=0,t=this.getAllItemModels();e<t.length;e++){(i=t[e]).renderShell=!1}else{for(var r=0,n=this.getAllItemModels();r<n.length;r++){var i;(i=n[r]).isHiddenFromUI&&(i.renderShell=!0)}var o=this.getSelectedItem();o&&(o.renderShell=!1)}},e.prototype.updateRenderShellsAfterPaint=function(){if(this.inPrintMode)for(var e=0,t=this.getAllItemModels();e<t.length;e++){(a=t[e]).renderShell=!1}else if(this.rootElt&&this.isListVisible()){for(var r=void 0,n=void 0,i=0,o=this.getAllItemModels();i<o.length;i++){var a;(a=o[i]).renderShell||(r||(r=a),n=a)}var s=this.findFirstPartiallyVisibleItem(),l=this.findLastPartiallyVisibleItem();if(s&&l)for(var c=s.index;c<=l.index;c++){(u=this.getItemModelByIndex(c))&&!u.isHiddenFromUI&&u.renderShell&&(u.renderShell=!1)}if(s&&l&&r&&n)for(c=r.index;c<=n.index;c++)if(c<s.index||c>l.index){var u;if((u=this.getItemModelByIndex(c))&&!u.isHiddenFromUI&&!u.renderShell){u.renderShell=!0;var p=this.getItemRootNodeById(u.id);if(p){var d=p.getBoundingClientRect().height;0<d&&(u.cachedRenderHeight=d)}}}var h=this.getSelectedItem();h&&(h.renderShell=!1)}},e.prototype.updateDragDrop=function(){var e=this.listModel.dragState;if(e){var t=this.getItemModel(e.firstItemId);if(t){var r=this.dragdrop_expressions.applyDrag();r&&(V.setDragState(this.listModel,r.dragState),U.setFolderId(t,r.folderId),t.index!==r.newIndex&&V.moveItemsTo(this.listModel,t.index,r.newIndex,e.numberOfItems),V.verifyFolderIntegrity(this.listModel))}}},e.prototype.isSelectedItemPartiallyVisible=function(){var e=this.getSelectedItem();return!(!e||!M.isItemPartiallyVisible(this,e.id))},e.prototype._tick=function(e){var t=this;if(void 0!==this._lastTickTime){var r=e-this._lastTickTime;this.getAllItemModels().forEach(function(e){"expression"===e.type&&e.sliderExists&&e.slider.isPlaying&&F.tickSliderStep(e,r)})}this.runAfterDispatch(function(){t.grapher&&t.grapher.tick(e)}),this._lastTickTime=e},e.prototype.areAnyImagesLoading=function(){return V.areAnyImagesLoading(this.listModel)},e.prototype._commitUserRequestedViewport=function(e){this.grapher&&this.grapher.setUserRequestedViewport(e)},e.prototype._setAxisLimitLatex=function(e,t){var r,n;this.settingsViewModel=L.__assign({},this.settingsViewModel,{limitLatex:L.__assign({},this.settingsViewModel.limitLatex,(r={},r[e]=t,r))});var i=""===t&&("xstep"===e||"ystep"===e)?0:b.default(t,this.graphSettings.degreeMode);switch(e){case"xstep":if(i<0||!isFinite(i))return;this.graphSettings.setProperty("xAxisStep",i);break;case"ystep":if(i<0||!isFinite(i))return;this.graphSettings.setProperty("yAxisStep",i);break;case"xmin":case"xmax":case"ymin":case"ymax":if(!this.grapher)return;var o=this.grapher.viewportController.getViewport(),a="xmin";"xmin"===e&&(a="xmax"),"ymax"===e&&(a="ymin"),"ymin"===e&&(a="ymax");var s=b.default(this.settingsViewModel.limitLatex[a],this.graphSettings.degreeMode),l=m.Viewport.fromObject(L.__assign({},o.toObject(),((n={})[e]=i,n[a]=s,n)));if(!l.isValid())return;this.grapher.viewportController.setViewport(l);var c="xmin"===e||"xmax"===e?"x":"y";this.graphSettings.setProperty("lastChangedAxis",c);var u=l.isSquare(this.grapher.getProjection().screen);this.graphSettings.setProperty("squareAxes",u)}var p=this.grapher.viewportController.getViewport().toObject();this._commitUserRequestedViewport(p)},e.prototype.canUserAddExpressions=function(){return!!this.graphSettings.config.expressions},e.prototype.areNotesEnabled=function(){return!!this.graphSettings.config.notes},e.prototype.areLinksEnabled=function(){return!!this.graphSettings.config.links},e.prototype.areImagesEnabled=function(){var e=window.FileReader,t=o.IS_IPAD&&o.IOS_VERSION&&8===o.IOS_VERSION[0]&&0===o.IOS_VERSION[1]&&0===o.IOS_VERSION[2];return!(!this.graphSettings.config.images||!e||t)},e.prototype.areFoldersEnabled=function(){return!!this.graphSettings.config.folders},e.prototype.isDecimalToFractionConversionEnabled=function(){return!!this.graphSettings.config.decimalToFractionConversion},e.prototype.areFunctionsRestricted=function(){return!!this.graphSettings.config.restrictedFunctions},e.prototype.isQwertyKeyboardEnabled=function(){return!!this.graphSettings.config.qwertyKeyboard},e.prototype.canEditOnWeb=function(){return!!this.graphSettings.config.editOnWeb},e.prototype.shouldAudioTraceReverseExpressions=function(){return!!this.graphSettings.config.audioTraceReverseExpressions},e.prototype.hasDefaultState=function(){return!!this.graphSettings.defaultState},e.prototype.getDefaultStateViewport=function(){var e=this.graphSettings.defaultState;if(e&&e.graph)return e.graph.viewport},e.prototype.getColors=function(){return this.graphSettings.config.colors},e.prototype.getImageOpacities=function(){return[.2,.4,.6,.8,1]},e.prototype.getUIDragModes=function(){return[q.X,q.Y,q.XY]},e.prototype.getUIDragModesForItem=function(e){var t=this.getItemModel(e);return t&&"expression"===t.type&&t.formula.move_strategy?[q.X,q.Y,q.XY]:[]},e.prototype.getNumberOfItemsInFolder=function(e){return V.getNumberOfItemsInFolder(this.listModel,e)},e.prototype.getEnabledDragModesForItem=function(e){var t=this.getItemModel(e);if(!t||"expression"!==t.type)return[];var r=t.formula,n=[];if(!r.move_strategy)return n;var i="none"!==r.move_strategy[0].type,o="none"!==r.move_strategy[1].type,a=i&&o;return i&&n.push(q.X),o&&n.push(q.Y),a&&n.push(q.XY),n},e.prototype.shouldShowEvaluationForItem=function(e){var t=this.getItemModel(e);return!!t&&"expression"===t.type&&F.shouldShowEvaluation(t)},e.prototype.getEvaluationValueForItem=function(e){var t=this.getItemModel(e);return t?"expression"!==t.type?NaN:F.getEvaluationValue(t):NaN},e.prototype.canDisplayEvaluationForItemAsFraction=function(e){if(!this.isDecimalToFractionConversionEnabled())return!1;var t=this.getItemModel(e);if(!t)return!1;if("expression"!==t.type)return!1;if(F.hasPlottableDependency(t))return!1;var r=this.getEvaluationValueForItem(e);return!Array.isArray(r)&&O.canDisplayAsFraction(r,v.EvaluationLabelOptions.denominatorCutoff)},e.prototype.shouldEvaluationForItemDisplayAsFraction=function(e){if(!this.isDecimalToFractionConversionEnabled())return!1;var t=this.getItemModel(e);return!!t&&"expression"===t.type&&F.shouldEvaluationDisplayAsFraction(t)},e.prototype.getEvaluationLabelOptionsForItem=function(e){return L.__assign({},v.EvaluationLabelOptions,{displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)})},e.prototype.getPointStyles=function(){return[l.POINT,l.OPEN,l.CROSS]},e.prototype.getLineStyles=function(){return[l.SOLID,l.DASHED,l.DOTTED]},e.prototype.getValidPointStylesForItem=function(e){var t=this.getItemModel(e);return t&&"expression"===t.type&&F.isPointOrPointList(t)?[l.POINT,l.OPEN,l.CROSS]:[]},e.prototype.getValidLineStylesForItem=function(e){var t=this.getItemModel(e);return t&&"expression"===t.type&&!t.formula.is_inequality&&!F.isSinglePoint(t)?[l.SOLID,l.DASHED,l.DOTTED]:[]},e.prototype.getOpacities=function(){return[c.LOW,c.DEFAULT,c.HIGH]},e.prototype.isInEditListMode=function(){return this.layoutModel.inEditListMode},e.prototype.canAdministerSecretFolders=function(){return this.graphSettings.config.administerSecretFolders},e.prototype.canUseAdvancedStyling=function(){return this.graphSettings.config.advancedStyling},e.prototype.isDegreeMode=function(){return this.graphSettings.degreeMode},e.prototype.isGraphSettingsOpen=function(){return this.layoutModel.graphSettingsOpen},e.prototype.isAddExpressionOpen=function(){return this.layoutModel.addExpressionOpen},e.prototype.shouldRenderList=function(){if(this.layoutModel.expressionsVisible)return!0;var e=this.layoutModel.expressionsHiddenTime;return void 0!==e&&Date.now()-e<=500},e.prototype.isListVisible=function(){return this.layoutModel.expressionsVisible},e.prototype.isGrapherEnabled=function(){return!1!==this.graphSettings.config.graphpaper},e.prototype.isListEnabled=function(){return!1!==this.graphSettings.config.expressions},e.prototype.areDistributionsEnabled=function(){return!0===this.graphSettings.config.distributions},e.prototype.needsFakeKeypad=function(){var e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":return!0;case"table":var t=e.location;if(0===t.row)return!0;var r=this.getItemModel(e.id);if(!r||"table"!==r.type)return!1;var n=r.columnModels[t.column];return!!n&&!n.disabled;case"image":return"name"!==e.location;case"text":case"folder":case"slider-thumb":return!1;default:return e}},e.prototype.getBrandingMode=function(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"},e.prototype.getEditLink=function(){return window.iframeEmbedBrandingLink},e.prototype._deleteItemAndAnimateOut=function(e){var t=this,r=this.getItemSelectorById(e);r&&(r.css({transition:"0.2s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(function(){t.dispatch({type:"finish-deleting-item-after-animation",id:e})},200))},e.prototype._finishDeletingItemAfterAnimation=function(e){var t=this.getItemModel(e);if(t){var r=this.getItemSelectorById(e),n=r&&0<_(document.activeElement).closest(r).length,i=V.findPrevSelectableItem(this.listModel,t.index);if(this._removeExpressionSynchronously(t),n){if(!i){var o=V.getFirstSelectableItem(this.listModel);o&&(i=o)}i&&z.moveFocusToItem(this,i.id,"end")}}},e.prototype._removeExpressionSynchronously=function(e){if(V.removeItemAtIndex(this.listModel,e.index),V.hasNoVisibleExpressions(this.listModel)){var t=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});V.insertItemAtEnd(this.listModel,t)}},e.prototype.setRootElt=function(e){this.rootElt=e,this.dragdrop_expressions=new I.default(this)},e.prototype._hideExpressions=function(){this.graphSettings.config.expressions&&(V.setSelected(this.listModel,void 0),this.layoutModel=L.__assign({},this.layoutModel,{expressionsVisible:!1,expressionsHiddenTime:Date.now()}),u.default())},e.prototype._showExpressions=function(){this.graphSettings.config.expressions&&(this.layoutModel=L.__assign({},this.layoutModel,{expressionsVisible:!0}),u.default())},e.prototype._showToast=function(e){var t=this;if(this.toastData=e,this.toastData.hasOwnProperty("undoCallback")&&!o.IS_MOBILE){var r=o.IS_APPLE?" Press CMD+Z to undo.":" Press CTRL+Z to undo.";this.toastData.message+=r}clearTimeout(this._hideToastTimeout);var n="number"==typeof e.hideAfter?e.hideAfter:6e3;0<n&&(this._hideToastTimeout=setTimeout(function(){t.dispatch({type:"toast/close",onHide:t.toastData.onHide})},n))},e.prototype._setExpressionPropertiesFromAPI=function(e,t){var r=this.getItemModel(e);if(r)if("table"===r.type&&t.columns){t=p.default(t);var n=N.cloneTableAndExtendWithProperties(r,t),i=V.modelFromSpec(this.listModel,n);this._toplevelReplaceItemAt(r.index,i,!1)}else{var o=this.getItemModel(e);if(!o)return;for(var a in t)if(t.hasOwnProperty(a))switch(a){case"slider":if("expression"!==o.type)continue;var s=t[a];s.hasOwnProperty("min")&&F.setSliderMin(o,s.min),s.hasOwnProperty("max")&&F.setSliderMax(o,s.max),s.hasOwnProperty("step")&&F.setSliderStep(o,s.step);break;case"polarDomain":if("expression"!==o.type)continue;F.setPolarDomainMin(o,d.default(t.polarDomain.min)),F.setPolarDomainMax(o,d.default(t.polarDomain.max));break;case"parametricDomain":if("expression"!==o.type)continue;F.setParametricDomainMin(o,d.default(t.parametricDomain.min)),F.setParametricDomainMax(o,d.default(t.parametricDomain.max));break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":U.setSecret(o,t.secret);break;case"color":if("expression"!==o.type)continue;F.setColor(o,t.color);break;case"dragMode":if("expression"!==o.type)continue;F.setDragMode(o,t.dragMode);break;case"label":if("expression"!==o.type)continue;F.setLabel(o,t.label);break;case"showLabel":if("expression"!==o.type)continue;F.setShowLabel(o,t.showLabel);break;case"labelSize":if("expression"!==o.type)continue;F.setLabelSize(o,t.labelSize);break;case"labelOrientation":if("expression"!==o.type)continue;F.setLabelOrientation(o,t.labelOrientation);break;case"verticalLabel":if("expression"!==o.type)continue;F.setVerticalLabel(o,t.verticalLabel);break;case"latex":if("expression"!==o.type)continue;F.setLatex(o,t.latex);break;case"points":if("expression"!==o.type)continue;F.setPoints(o,!!t.points);break;case"lines":if("expression"!==o.type)continue;F.setLines(o,!!t.lines);break;case"pointStyle":if("expression"!==o.type)continue;F.setPointStyle(o,t.pointStyle);break;case"lineStyle":if("expression"!==o.type)continue;F.setLineStyle(o,t.lineStyle);break;case"fill":if("expression"!==o.type)continue;F.setFill(o,t.fill);break;case"fillOpacity":if("expression"!==o.type)continue;F.setFillOpacity(o,t.fillOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+a)}}},e.prototype._isParentFolderHidden=function(e){var t=this.getItemModel(e);if(!t)return!1;var r=V.getParentFolderModel(t);return!!r&&r.hidden},e.prototype._toggleItemHidden=function(e){if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{var t=this.getItemModel(e);if(!t)return;switch(t.type){case"expression":case"image":case"folder":this._setItemHidden(e,!t.hidden);break;case"table":case"text":break;default:return t}}},e.prototype._toggleTableColumnHidden=function(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{var r=this.getItemModel(e);if(!r||"table"!==r.type)return;var n=N.getColumnModel(r,t);this._setTableColumnHidden(e,t,!n.hidden)}},e.prototype._setTableColumnHidden=function(e,t,r){var n=this.getItemModel(e);if(n&&"table"===n.type){var i=N.shouldHideColumn(n,t);!r&&this._isParentFolderHidden(e)&&this._setItemHidden(n.folderId,!1),N.setColumnHidden(n,t,r),!r&&i&&N.setColumnPoints(n,t,!0)}},e.prototype._setItemHidden=function(e,t){var r=this.getItemModel(e);if(r)switch(!t&&this._isParentFolderHidden(r.id)&&this._setItemHidden(r.folderId,!1),r.type){case"expression":F.setHidden(r,t);break;case"folder":B.setHidden(r,t);break;case"image":R.setHidden(r,t);break;case"table":case"text":break;default:return r}},e.prototype._addItemToEndFromAPI=function(e){var t=V.getLastSelectableItem(this.listModel);!e.secret&&t&&"expression"===t.type&&""===t.latex&&V.removeItemAtIndex(this.listModel,t.index),V.insertItemAtEnd(this.listModel,e)},e.prototype._toplevelInsertItemAt=function(e,t,r,n){var i=t;V.insertItemAtIndex(this.listModel,i,e),n&&U.setFolderId(i,n),r&&z.moveFocusToItem(this,i.id)},e.prototype._toplevelNewItemAtSelection=function(e,t){var r=this.getSelectedItem();if(r){var n="expression"===r.type&&!r.latex;if(n&&!r.folderId&&("expression"!==e.type||e.latex))return this._toplevelReplaceItemAt(r.index,e,t.shouldFocus);if(n&&r.folderId&&"expression"!==e.type&&"folder"!==e.type)return this._toplevelReplaceItemAt(r.index,e,t.shouldFocus);if(!r.folderId&&"folder"!==r.type){return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,void 0)}if(r.folderId&&"folder"!==e.type)return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,r.folderId);if("folder"===r.type&&!r.collapsed&&"folder"!==e.type)return this._toplevelInsertItemAt(r.index+1,e,t.shouldFocus,r.id)}var i=this.getFirstFullyVisibleItem();for(i&&"folder"===i.type&&(i=this.getItemModelByIndex(i.index+1));i&&i.folderId;)i=this.getItemModelByIndex(i.index+1);var o=i?i.index:this.getItemCount();return this._toplevelInsertItemAt(o,e,t.shouldFocus,void 0)},e.prototype.getFirstFullyVisibleItem=function(){var e=M.getFirstFullyVisibleItemId(this);if(e)return V.getItemById(this.listModel,e)},e.prototype.find$=function(e){return _(this.rootElt).find(e)},e.prototype.getExppanelSelectorOrThrow=function(){var e=M.getExppanelElt(this);if(e)return _(e);throw new Error("expected to find $exppanel but could not")},e.prototype.scrollSelectedItemIntoView=function(){if(this.rootElt&&this.isListVisible()){var e=this.getSelectedItem();if(e){var t=this.getItemSelectorById(e.id),r=M.getExppanelSelector(this);if(t&&r){if("table"===e.type){var n=t.find(".dcg-row .dcg-selected");if(1===n.length)return void i.scrollVisible(n,r,60)}i.scrollVisible(t,r,90)}}}},e.prototype._pasteTable=function(e){var t=this,r=V.findAvailableColumnSubscript(this.listModel),n=N.makeTableState(r,e,this),i=this.createItemModel(n);this._toplevelNewItemAtSelection(i,{shouldFocus:!1}),this._closeAddExpression();var o=this.grapher.viewportController.getViewport(),a=f.computeNewViewport(o,e);(a.xmax>o.xmax||a.xmin<o.xmin||a.ymax>o.ymax||a.ymin<o.ymin)&&(this.grapher.viewportController.setViewport(new m.Viewport(a.xmin,a.xmax,a.ymin,a.ymax)),this._showToast({message:this.t("We zoomed to fit your data."),undoCallback:function(){t.dispatch({type:"undo"})}}))},e.prototype._pasteExpressions=function(e){for(var t=0;t<e.length;t++){var r;r="latex"===e[t].type?this.createItemModel({id:this.generateId(),type:"expression",latex:e[t].content}):this.createItemModel({id:this.generateId(),type:"text",text:e[t].content}),this._toplevelNewItemAtSelection(r,{shouldFocus:!0})}},e.prototype._openOnWeb=function(){var a=this;this.runAfterDispatch(function(){var e=JSON.stringify(a.getState()),t=a.grapher.screenshot({width:100,height:100}),r=(a.getGraphSettings().config.crossOriginSaveTest?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",n=_('<input type="text" name="calc_state" />').val(e),i=_('<input type="text" name="thumb_data" />').val(t),o=_('<form target="_blank" method="POST" style="display:none;"></form>').attr("action",r).append(_('<input type="text" name="is_open_on_web" value="true" />')).append(_('<input type="text" name="my_graphs" value="false" />')).append(_('<input type="text" name="is_update" value="false" />')).append(n).append(i);_(a.rootElt).append(o),o.submit().remove()})},e.prototype._toplevelReplaceItemAt=function(e,t,r){var n=t,i=this.getItemModelByIndex(e).folderId;V.removeItemAtIndex(this.listModel,e),V.insertItemAtIndex(this.listModel,n,e),i&&U.setFolderId(n,i),r&&z.moveFocusToItem(this,n.id)},e.prototype.createSlidersForItem=function(e,t){var r=this,n=this.getItemModel(e);if(n){for(var i=n.folderId,o=n.index+1,a=t.map(function(e){var t=e?O.identifierToLatex(e)+"=1":"";return{type:"expression",id:r.generateId(),latex:t,color:r.getNextColor(),hidden:!!t}}),s=a.length-1;0<=s;s--){var l=this.createItemModel(a[s]);V.insertItemAtIndex(this.listModel,l,o),i&&U.setFolderId(l,i)}var c=a[a.length-1];""===c.latex?z.moveFocusToItem(this,c.id):z.setFocusLocation(this,void 0)}},e.prototype._uploadImagesAndWaitForThemToLoad=function(e){var t=this;if(e&&0!==e.length){var r=R.uploadImages(this,e),n=r.errors[0];n&&this._showToast({message:n});for(var i=0,o=r.tokens;i<o.length;i++){var a=o[i];this.__pendingImageUploads[a]=!0}this.isUploadingImages()&&this._showToast({message:this.t("Uploading images..."),onHide:function(){t._clearPendingImageUploads()}})}else this._showToast({message:this.t("You did not select a file")})},e.prototype.getImageToRetry=function(){for(var e,t=0,r=this.getAllItemModels();t<r.length;t++){var n=r[t];"image"===n.type&&"failed"===n.loadStatus&&(!e||e.failures>n.failures)&&(e=n)}return e},e.prototype.retryLoadingFailedImage=function(){var e=Date.now(),t=e-this.imageRetryState.lastAttemptTime,r=1e3*Math.pow(2,this.imageRetryState.attempts);if(!(0<this.imageRetryState.attempts&&t<r)){var n=this.getImageToRetry();n&&(R.retryLoading(n),this.imageRetryState={lastAttemptTime:e,attempts:this.imageRetryState.attempts+1})}},e.prototype.getSelectedItem=function(){return V.getSelected(this.listModel)},e.prototype.getFocusedItem=function(){return z.getFocusedItem(this)},e.prototype.getFocusLocation=function(){return this.focusLocation},e.prototype.isFocusLocationFocused=function(e){var t=this.focusLocation,r=e;return!(!t||!r)&&g.isEqual(t,r)},e.prototype.isCurrentFocusLocationValid=function(){var e=this.focusLocation;if(!e)return!0;if("settings"===e.type)return this.isGraphSettingsOpen();var t=this.getItemModel(e.id);if(!t)return!1;if(!this.isItemSelected(e.id))return!1;switch(e.type){case"domain-limit":return"expression"===t.type&&!!F.hasDomain(t);case"slider-thumb":case"slider-limit":return"expression"===t.type&&!!F.hasSlider(t);case"distribution-param":if("expression"!==t.type)return!1;var r=F.parseToplevelFunction(t);return!!r&&e.location in r.values;case"cdf-limit":return"expression"===t.type&&F.shouldShowCDFFooter(t);case"image":return"image"===t.type;case"folder":return"folder"===t.type;case"text":return"text"===t.type;case"expression":return"expression"===t.type;case"table":return"table"===t.type&&!!N.doesCellExist(t,e.location);default:return e}},e.prototype.isDragDropActive=function(){return!!this.listModel.dragState},e.prototype.isItemBeingDragged=function(e){var t=this.listModel.dragState;return!(!t||t.firstItemId!==e)},e.prototype.getDraggedItemId=function(){var e=this.listModel.dragState;return e&&e.firstItemId},e.prototype.getRawDragState=function(){return this.listModel.dragState},e.prototype.initStateStack=function(){this.stateStack=new h.default,this.stateStack.addState(this.getUndoRedoState())},e.prototype.getUndoRedoState=function(){return{layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:this.grapher?this.grapher.getUndoRedoState():void 0,expressions:V.getUndoRedoState(this.listModel),wasCompleteSetState:this.isCurrentlyDoingSetState}},e.prototype.getState=function(e){var t={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(t.stripDefaults=!!e.stripDefaults);var r={version:n.currentVersion,graph:this.grapher.getState(t),expressions:V.getState(this.listModel,t)};return p.default(r)},e.prototype.getBlankState=function(){return this.graphSettings.config.clearIntoDegreeMode?L.__assign({},E.default,{graph:L.__assign({},E.default.graph,{degreeMode:!0})}):E.default},e.prototype.externalSetState=function(e,t){this._clearPendingImageUploads(),t||(t={}),e||(e=this.getBlankState()),"string"==typeof e&&(e=JSON.parse(e)),e&&(e=n.migrateToLatest(e));var r=this.layoutModel;this.setState(e,t),this.layoutModel=L.__assign({},x.defaultLayoutModel(this.graphSettings.config),{keypadMinimized:r.keypadMinimized,keypadLayout:r.keypadLayout,keypadFunctionsTab:r.keypadFunctionsTab,keypadFunctionsOpen:r.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||t.forceExpressionsOpen)}),this.settingsViewModel=w.defaultSettingsViewModel(),z.setFocusLocation(this,void 0),this.enqueueEvent("clearUnsavedChanges")},e.prototype.setState=function(e,t){if(this.lastParsableObjects={},this.lastViewState=void 0,this.isCurrentlyDoingSetState=!0,"graph"in e&&this.grapher&&this.grapher.setGrapherState(e.graph),"expressions"in e){V.setSelected(this.listModel,void 0);var r=V.getLargestIntegerId(e.expressions);r>=this.__nextItemId&&(this.__nextItemId=r+1),V.setListState(this.listModel,e.expressions,t)}e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),t&&t.allowUndo||this.clearUndoRedoHistory()},e.prototype.updateToState=function(e){"graph"in e&&this.grapher&&this.grapher.setGrapherState(e.graph,{doNotClear:!0}),"expressions"in e&&V.restoreListState(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel)},e.prototype.commitUndoRedoSynchronously=function(e){var t,r,n=this.getUndoRedoState(),i=this.stateStack.getState();t=i,r=n,g.isEqual(T(t),T(r))||(this.stateStack.addState(n),this.enqueueEvent("change"))},e.prototype.undo=function(){if(this.canUndo()){this.stateStack.undo();var e=this.stateStack.getState();e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change")}},e.prototype.redo=function(){if(this.canRedo()){this.stateStack.redo();var e=this.stateStack.getState();e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change")}},e.prototype.clearUndoRedoHistory=function(){this.stateStack.clear()},e.prototype.canUndo=function(){return this.stateStack.canUndo()},e.prototype.canRedo=function(){return this.stateStack.canRedo()},e.prototype._closeAddExpression=function(){this.layoutModel=L.__assign({},this.layoutModel,{addExpressionOpen:!1})},e.prototype.doesDOMHaveSize=function(){return 0<this.layoutMeasurements.width&&0<this.layoutMeasurements.height},e.prototype._getExpListWidth=function(){var e;if(void 0!==this.userSpecifiedExpListWidth)e=Math.max(280,Math.min(this.layoutMeasurements.width-200,this.userSpecifiedExpListWidth));else{if(!(e=this.layoutMeasurements.width))return 356;var t=.2*e+160;e=Math.min(500,Math.max(280,t))}var r=this.layoutMeasurements.width-this.layoutMeasurements.height;return Math.abs(r-e)<=10?r:e},e.prototype._setExpListWidth=function(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)},e.prototype.getKeypadHeight=function(){return this.computeMajorLayout().keypad.height},e.prototype.isKeypadOpen=function(){var e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e},e.prototype.isKeypadFunctionsPopoverOpen=function(){return!!this.layoutModel.keypadFunctionsOpen},e.prototype.getKeypadLayout=function(){return this.layoutModel.keypadLayout},e.prototype.isLetterKeypadOpen=function(){var e=this.getKeypadLayout();return this.isKeypadOpen()&&("letters"===e||"noQwertyLetters"===e||"capitalLetters"===e)},e.prototype.getKeypadFunctionsTab=function(){return this.layoutModel.keypadFunctionsTab},e.prototype.isFileDraggedOver=function(){return this.layoutModel.isFileDraggedOver},e.prototype.computeMajorLayout=function(){var e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,r=this.isNarrow(),n=this.isListVisible(),i=this.isKeypadOpen(),o=!this.isGrapherEnabled(),a=!this.isListEnabled(),s={left:0,top:0,width:0,height:0},l={left:0,top:0,width:0,height:0},c={left:0,top:t,width:e,height:168};return a?(l.width=e,l.height=t):o?(s.width=e,s.height=t):n?l.height=r?(s.width=e,s.height=Math.round(.58*t),s.top=t-s.height,l.width=e,t-s.height):(s.width=this.getExpListWidth(),s.height=t,l.left=s.width,l.width=e-l.left,t):n||(l.height=(l.width=(r?(s.width=e,s.height=Math.round(.58*t),s.top=t):(s.width=this.getExpListWidth(),s.height=t,s.left=-s.width),e),t)),i&&(c.top-=c.height,a||(s.height-=c.height)),{list:s,grapher:l,keypad:c}},e.prototype.isNarrow=function(){return this.layoutMeasurements.width<450},e}();t.default=C}),define("lib/aria",["require","exports","jquery"],function(e,t,r){"use strict";function n(e){o.push(e)}var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.queue=n,t.alert=function(e){void 0!==e&&n(e),void 0!==i&&0<o.length&&i.empty().text(o.join(" ").replace(/ +(?= )/g,"")),o.length=0},r(document).ready(function(){var e=".dcg-aria-alert";0===r(e).length&&r("body").append("<p aria-live='assertive' aria-atomic='true' class='dcg-aria-alert'></p>"),i=r(e)}),o=[]}),define("main/instancehotkeys",["require","exports","keys","lib/aria","jquery","graphing-calc/models/expression"],function(e,t,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.controller=e}return e.prototype.handleKeydown=function(e){var t=this;if(i.isUndo(e))e.stopPropagation(),e.preventDefault(),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(i.isRedo(e))e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"redo"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if("E"===i.lookupChar(e)){e.preventDefault(),e.stopPropagation(),this.controller.getSelectedItem()||this.controller.dispatch({type:"set-selected-index",index:0});var r=this.controller.getSelectedItem();r?(o.alert(this.controller.t("Expression list")),this.controller.dispatch({type:"move-focus-to-item",id:r.id})):o.alert(this.controller.t("Unable to focus expression list"))}else"X"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(o.alert(this.controller.t("Add expression")),this.controller.dispatch({type:"new-expression"})):o.alert(this.controller.t("Unable to add expression"))):"O"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(o.alert(this.controller.t("Add note")),this.controller.dispatch({type:"new-text"})):o.alert(this.controller.t("Unable to add note"))):"F"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled()?(o.alert(this.controller.t("Add folder")),this.controller.dispatch({type:"new-folder"})):o.alert(this.controller.t("Unable to add folder"))):"I"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled()?(o.alert(this.controller.t("Add image")),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.find$(".dcg-action-newimage input[type=file]").click()):o.alert(this.controller.t("Unable to add image"))):"T"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(o.alert(this.controller.t("Add table")),this.controller.dispatch({type:"new-table"})):o.alert(this.controller.t("Unable to add table"))):"G"===i.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0})):"P"===i.lookupChar(e)&&(e.preventDefault(),e.stopPropagation(),this.focusElement(this.controller.find$(".dcg-movable-point:visible, .dcg-offscreen-point").filter("[tabindex=0]").first(),this.controller.t("No interactive points on screen")));else if((e.altKey||e.metaKey)&&!e.ctrlKey&&e.shiftKey&&"F"===i.lookupChar(e)&&this.controller.isDecimalToFractionConversionEnabled()){var n=this.controller.getSelectedItem();n&&"expression"===n.type&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:n.id}),this.controller.runAfterDispatch(function(){s.shouldEvaluationDisplayAsFraction(n)?o.alert(t.controller.t("Show as Fraction")):o.alert(t.controller.t("Show as Decimal"))}))}else e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||i.lookup(e)!==i.BACKSPACE||a(document.activeElement).is('input, textarea, [role="textbox"]')||e.preventDefault()},e.prototype.focusElement=function(e,t){e.length?e.focus():t&&o.alert(t)},e}();t.default=r}),define("lib/defocus-mobile",["require","exports","jquery","touchtracking"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=r(document.activeElement);n.elIsFocusable(e)&&r("<input />").prependTo("body").focus().attr({readonly:"readonly",disabled:"true"}).blur().remove()}}),define("ipad.scrollfix",["require","jquery"],function(e){var p=e("jquery"),t=!1,r=function(e){t||p(e).bind("touchstart",function(e){var t=p(e.target),n=0,i=null;if(!t.closest("[disablescroll]").length)for(;0===n&&t.length&&void 0!==t[0].tagName;){var r=t.css("overflow"),o=t.css("overflow-y");if("hidden"!==r&&"visible"!==r&&"hidden"!==o&&"hidden"!==o){var a=t.scrollTop();0!==a&&(n=2),t.scrollTop(a+1),t.scrollTop()!==a&&(n|=1,t.scrollTop(a))}t=t.parent()}if(0!==n){i=[];for(var s=e.originalEvent.touches,l=0;l<s.length;l++){var c={};for(var u in s[l])s[l].hasOwnProperty(u)&&(c[u]=s[l][u]);i.push(c)}}p(document).on("touchmove.scrollfix",function(e){if(i){var t=i[0],r=e.originalEvent.touches[0].screenY-t.screenY;0<r&&!(2&n)?n=0:r<0&&!(1&n)&&(n=0),r&&(i=null)}0===n&&e.preventDefault()}),p(document).on("touchend.scrollfix",function(){p(document).off(".scrollfix")})})};return{limitScrollOnElement:r,limitScrollOnDocument:function(){r(document),t=!0}}}),define("expressions/abstract-item-view",["require","exports","tslib","dcgview","jquery.handleevent"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()},t.prototype.onItemViewMounted=function(){this._isDragCopy||(this.model.dcgView=this),this._isFirstRender=!1},t.prototype.onItemViewUnmounted=function(){this._isDragCopy||(this.model.dcgView=void 0)},t.prototype.isFirstRender=function(){return this._isFirstRender},t.prototype.onMouseSelect=function(e){"dcg-tap"===e.type&&"mouse"===e.device||"dcg-tapstart"===e.type&&"touch"===e.device||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))},t.prototype.onDelete=function(){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.id})},t.prototype.onDragPending=function(e){this.props.onDragPending(e)},t}(n.Class);t.default=i}),define("expressions/abstract_icon_view",["require","exports","tslib","keys","jquery","dcgview"],function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.guid="options-menu-view"+ ++a,this.controller=this.props.controller()},t.prototype.positionOptionsMenu=function(){var e=this.controller.getExppanelSelectorOrThrow(),t=o(this.rootElt).offset(),r=o(this.optionsMenu.findRootNode()),n=t.top-e.closest(".dcg-container").offset().top,i=t.left-e.closest(".dcg-container").offset().left;r.css({position:"absolute",top:n+"px",left:i+"px",display:"block"})},t.prototype.toggleOptions=function(){var t=this;return this.optionsShown?void this.hideOptions():(this.optionsShown=!0,this.optionsMenu=this.createOptionsMenuView(),this.positionOptionsMenu(),setTimeout(function(){t.optionsShown&&t.controller.getExppanelSelectorOrThrow().on("scroll."+t.guid,function(){t.hideOptions()})},0),o(document).on("keydown."+this.guid,function(e){n.lookup(e)===n.ESCAPE&&t.hideOptions()}),void o(document).on("dcg-tapstart."+this.guid,function(e){o(e.target).closest(".dcg-options-menu").length||o(e.target).closest(t.rootElt).length||t.hideOptions()}))},t.prototype.hideOptions=function(){if((this.optionsShown||this.optionsMenu)&&(this.optionsShown=!1,o(document).off("dcg-tapstart."+this.guid),o(document).off("keydown."+this.guid),this.controller.getExppanelSelectorOrThrow().off("scroll."+this.guid),this.optionsMenu)){try{i.unmountFromNode(this.getOptionsMenuContainerSelector()[0])}catch(e){}this.optionsMenu=null}},t.prototype.getOptionsMenuContainerSelector=function(){return this.controller.getExppanelSelectorOrThrow().closest(".dcg-container").find(".dcg-options-menu-container")},t.prototype.didUnmount=function(){this.hideOptions()},t.prototype.didUpdate=function(){this.optionsMenu&&this.optionsMenu.update()},t}(i.Class);t.default=s}),define("loadcss!expressions/circular-icon-view",function(){}),define("expressions/circular-icon-view",["require","exports","tslib","dcgview","loadcss!./circular-icon-view"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.Components.If,o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return n.createElement("span",{class:function(){return{"dcg-do-not-blur":!0,"dcg-circular-icon":!0,"dcg-thick-outline":t.isThickOutline(),"dcg-white-icon":!!t.props.whiteIcon&&t.props.whiteIcon(),"dcg-hidden":t.isHidden(),"dcg-semi-transparent":t.props.semiTransparent&&t.props.semiTransparent(),"dcg-colored-icon":!t.isThickOutline()&&!t.isHidden()&&!t.hasBackgroundImage(),"dcg-has-background-image":t.hasBackgroundImage()}},style:function(){return{background:t.getBackgroundColor()}}},n.createElement(i,{predicate:this.bindFn(this.hasBackgroundImage)},function(){return n.createElement("span",{class:n.const("dcg-background-image"),style:function(){return{"background-image":t.props.backgroundImage&&t.props.backgroundImage(),opacity:t.props.backgroundOpacity&&t.props.backgroundOpacity()}}})}),n.createElement(i,{predicate:function(){return!!t.backgroundIcon()}},function(){return n.createElement("i",{class:function(){var e;return(e={})[t.backgroundIcon()]=!0,e["dcg-layered-icon"]=!0,e},style:function(){return{opacity:t.backgroundOpacity()}}})}),n.createElement(i,{predicate:function(){return!!t.primaryIcon()}},function(){return n.createElement("i",{class:function(){var e;return(e={})[t.primaryIcon()]=!0,e["dcg-layered-icon"]=!0,e},style:function(){return{color:t.props.foregroundColor&&t.props.foregroundColor()}}})}))},t.prototype.getBackgroundColor=function(){if(!this.isHidden()&&this.props.backgroundColor)return this.props.backgroundColor()},t.prototype.isHidden=function(){return"hidden"===this.props.iconType()},t.prototype.isThickOutline=function(){var e=this.props.iconType();return"folder"===e||"pause"===e||"play"===e||"fraction"===e},t.prototype.hasBackgroundImage=function(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()},t.prototype.primaryIcon=function(){var e=this.props.iconType();switch(e){case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":return"";case"fraction":return"dcg-icon-fraction";default:return e}},t.prototype.backgroundOpacity=function(){var e=this.backgroundIcon();return"dcg-icon-polygon-filled"===e||"dcg-icon-parametric-filled"===e||"dcg-icon-shaded-inequality-shade2"===e?.5:1},t.prototype.backgroundIcon=function(){var e=this.props.iconType();return"polygon-dashed-filled"===e||"polygon-dotted-filled"===e||"polygon-default-filled"===e||"polygon-none-filled"===e?"dcg-icon-polygon-filled":"parametric-dashed-filled"===e||"parametric-dotted-filled"===e||"parametric-default-filled"===e||"parametric-none-filled"===e?"dcg-icon-parametric-filled":"table-points-and-lines"===e?"dcg-icon-lines-solid":"shaded-inequality"===e?"dcg-icon-shaded-inequality-shade2":""},t}(n.Class);t.CircularIconView=o}),define("loadcss!expressions/color-menu",function(){}),define("expressions/color-menu",["require","exports","tslib","dcgview","underscore","lib/color-helpers","./circular-icon-view","loadcss!./color-menu"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components,l=s.For,c=s.If,u=s.Input,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),n.createElement("div",null,n.createElement(l,{each:function(){return i.values(t.controller.getColors())}},n.createElement("div",{class:n.const("dcg-color-menu dcg-do-not-blur"),role:n.const("complementary"),"aria-label":function(){return t.controller.t("Color Menu")}},function(e){return n.createElement("span",{class:n.const("dcg-color-option"),handleevent:n.const("true"),role:n.const("button"),tabindex:n.const(0),"aria-label":t.const(e),onTap:function(){return t.props.onColorSelected(e)}},n.createElement(a.CircularIconView,{iconType:function(){return t.props.selectedColor()===e?"check":"none"},backgroundColor:function(){return e}}))})),n.createElement(c,{predicate:function(){return t.controller.canUseAdvancedStyling()}},function(){return n.createElement("div",{class:n.const("dcg-advanced-color-styling")},n.const("Hex:"),n.createElement(u,{class:function(){return{"dcg-error":!o.isValidHexColor(t.props.selectedColor())}},value:t.props.selectedColor,onInput:function(e){t.props.onColorSelected(e)}}))}))},t}(n.Class);t.default=p}),define("loadcss!expressions/toggle-view",function(){}),define("expressions/toggle-view",["require","exports","tslib","dcgview","loadcss!./toggle-view"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:function(){return{"dcg-toggle-view":!0,"dcg-toggled":e.props.toggled()}},role:n.const("checkbox"),tabindex:n.const("0"),toggled:function(){return e.props.toggled()},onTap:this.bindFn(this.props.onChange)},n.createElement("div",{class:n.const("dcg-toggle-switch")}))},t}(n.Class);t.default=i}),define("loadcss!dcgview-helpers/checkbox",function(){}),define("dcgview-helpers/checkbox",["require","exports","tslib","dcgview","jquery","loadcss!./checkbox"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:function(){return{"dcg-component-checkbox":!0,"dcg-checked":e.props.checked(),"dcg-disabled":e.props.disabled&&e.props.disabled(),"dcg-small":e.props.small&&e.props.small(),"dcg-green":e.props.green&&e.props.green()}},onTap:this.bindFn(this.onChange)},n.createElement("span",{tabindex:n.const(0),class:n.const("dcg-checkbox"),role:n.const("checkbox"),"aria-label":this.props.ariaLabel,"aria-disabled":function(){return e.props.disabled&&e.props.disabled()},"aria-checked":this.props.checked},n.createElement("i",{class:n.const("dcg-icon-check"),"aria-hidden":n.const("true")})),n.createElement("span",{class:n.const("dcg-checkbox-children")},this.children))},t.prototype.onChange=function(e){e.target&&i(e.target).attr("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())},t}(n.Class);t.Checkbox=o}),define("expressions/expression_options_view",["require","exports","tslib","dcgview","underscore","graphing/dragmode","./color-menu","math/expression-types","graphing-calc/models/expression","expressions/styles","expressions/toggle-view","dcgview-helpers/checkbox","./circular-icon-view"],function(e,t,r,i,n,o,a,s,l,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.Components,f=h.For,g=h.If,m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id;var e=this.controller.getValidPointStylesForItem(this.id),r=this.controller.getValidLineStylesForItem(this.id),n=l.isPolygon(this.model)||l.isParametric(this.model);return i.createElement("div",{class:function(){return{"dcg-exp-options-menu":!0,"dcg-options-menu":!0,"dcg-colors-only":0===e.length&&0===r.length,"dcg-with-drag":0!==t.controller.getUIDragModesForItem(t.id).length}}},i.createElement("div",{class:i.const("dcg-triangle")}),i.createElement("div",{class:i.const("dcg-options-menu-column-left")},i.createElement(g,{predicate:this.bindFn(this.shouldShowZoomFit)},function(){return i.createElement("div",{class:function(){return{"dcg-zoom-fit-btn":!0,"dcg-btn-blue":!0,"dcg-disabled":t.shouldDisableZoomFit()}},onTap:t.bindFn(t.onZoomFit)},function(){return t.controller.t("Zoom Fit")})}),i.createElement(g,{predicate:function(){return 0<e.length}},function(){return i.createElement("div",{class:i.const("dcg-styles-div dcg-options-menu-section")},i.createElement("div",{class:i.const("dcg-styles-menu dcg-dividing-line-after")},i.createElement("span",{class:i.const("dcg-toggle-title")},function(){return l.isSinglePoint(t.model)?t.controller.t("Style"):t.controller.t("Points")}),i.createElement(g,{predicate:function(){return!l.isSinglePoint(t.model)}},function(){return i.createElement(u.default,{toggled:function(){return t.getDisplayProps().points},onChange:t.bindFn(t.onTogglePoints)})}),i.createElement(g,{predicate:function(){return t.getDisplayProps().points}},function(){return i.createElement(f,{each:function(){return e}},i.createElement("div",{class:i.const("dcg-style-icons")},function(e){return i.createElement("div",{class:i.const("dcg-style-icon-container"),onTap:function(){return t.onPointStyleSelected(e)}},i.createElement(d.CircularIconView,{backgroundColor:function(){return t.model.color},semiTransparent:function(){return t.model.pointStyle!==e},iconType:function(){return"CROSS"===e?"point-cross":"OPEN"===e?"point-open":"point-default"}}))}))})))}),i.createElement(g,{predicate:function(){return 0<r.length&&!l.isSinglePoint(t.model)}},function(){return i.createElement("div",{class:i.const("dcg-styles-div dcg-options-menu-section dcg-lines-menu")},i.createElement("div",{class:function(){return{"dcg-styles-menu":!0,"dcg-dividing-line-after":t.controller.getUIDragModesForItem(t.id).length||n}}},i.createElement("span",{class:i.const("dcg-toggle-title")},function(){return t.shouldShowLinesToggle()?t.controller.t("Lines"):t.controller.t("Style")}),i.createElement(g,{predicate:function(){return t.shouldShowLinesToggle()}},function(){return i.createElement(u.default,{toggled:function(){return t.getDisplayProps().lines},onChange:t.bindFn(t.onToggleLines)})}),i.createElement(g,{predicate:function(){return t.shouldShowLineStyles()}},function(){return i.createElement(f,{each:function(){return r}},i.createElement("div",{class:i.const("dcg-style-icons")},function(e){return i.createElement("div",{class:i.const("dcg-style-icon-container"),onTap:function(){return t.onLineStyleSelected(e)}},i.createElement(d.CircularIconView,{backgroundColor:function(){return t.model.color},semiTransparent:function(){return t.model.lineStyle!==e},iconType:function(){return"DOTTED"===e?"graph-dotted":"DASHED"===e?"graph-dashed":"graph-default"}}))}))}),i.createElement(g,{predicate:function(){return t.shouldShowLineStyles()&&t.controller.canUseAdvancedStyling()&&(t.model.lineStyle===c.SOLID||t.model.lineStyle===c.SINGLE_PIXEL)}},function(){return i.createElement("div",null,i.createElement(p.Checkbox,{checked:function(){return t.model.lineStyle===c.SINGLE_PIXEL},onChange:function(e){t.onLineStyleSelected(e?c.SINGLE_PIXEL:c.SOLID)},ariaLabel:function(){return t.controller.t("1px wide")}},function(){return t.controller.t("1px wide")}))})))}),i.createElement(g,{predicate:function(){return 0<t.controller.getUIDragModesForItem(t.id).length}},function(){return i.createElement("div",{class:i.const("dcg-drag-div dcg-options-menu-section")},i.createElement("div",{class:i.const("dcg-drag-menu")},i.createElement("span",{class:i.const("dcg-toggle-title")},function(){return t.controller.t("Drag")}),i.createElement(u.default,{toggled:function(){return t.model.reconciledDragMode!==o.NONE},onChange:t.bindFn(t.onToggleDrag)}),i.createElement(g,{predicate:function(){return t.model.reconciledDragMode!==o.NONE}},function(){return i.createElement(f,{each:function(){return t.controller.getUIDragModesForItem(t.id)}},i.createElement("div",{class:i.const("dcg-style-icons")},function(e){return i.createElement("div",{class:function(){return{"dcg-style-icon-container":!0,"dcg-disabled":t.isDisabled(e)}},onTap:function(){return t.onDragModeSelected(e)}},i.createElement(d.CircularIconView,{backgroundColor:function(){return t.isDisabled(e)?"#bbb":t.model.color},semiTransparent:function(){return t.model.reconciledDragMode!==e},iconType:function(){return"X"===e?"movable-horizontal":"Y"===e?"movable-vertical":"movable-both"}}))}))})))}),i.createElement(g,{predicate:function(){return n}},function(){return i.createElement("div",{class:i.const("dcg-styles-div dcg-options-menu-section")},i.createElement("div",{class:i.const("dcg-styles-menu")},i.createElement(p.Checkbox,{checked:function(){return t.getDisplayProps().fill},onChange:t.bindFn(t.onToggleFill),ariaLabel:function(){return t.controller.t("Fill")}},function(){return t.controller.t("Fill")})))})),i.createElement("div",{class:i.const("dcg-options-menu-column-right")},i.createElement("div",{class:i.const("dcg-colors-div dcg-options-menu-section")},i.createElement("div",{class:i.const("dcg-title")},function(){return t.controller.t("Color")}),i.createElement(a.default,{controller:function(){return t.props.controller()},selectedColor:function(){return t.model.color},onColorSelected:this.bindFn(this.onColorSelected)}))))},t.prototype.onToggleFill=function(){this.controller.dispatch({type:"set-item-fill",id:this.id,fill:!this.getDisplayProps().fill})},t.prototype.onColorSelected=function(e){this.controller.dispatch({type:"set-item-color",id:this.id,color:e})},t.prototype.shouldShowLinesToggle=function(){return l.isPointOrPointList(this.model)||l.isParametric(this.model)||l.isPolygon(this.model)},t.prototype.shouldShowLineStyles=function(){return this.getDisplayProps().lines||!this.shouldShowLinesToggle()},t.prototype.shouldShowZoomFit=function(){return l.shouldShowZoomFitOption(this.model)},t.prototype.shouldDisableZoomFit=function(){return l.shouldDisableZoomFitOption(this.model)},t.prototype.onZoomFit=function(){this.model.boundingBox&&this.controller.dispatch({type:"set-viewport",viewport:l.computeFittedViewport(this.model.boundingBox)})},t.prototype.onTogglePoints=function(){this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.getDisplayProps().points})},t.prototype.onPointStyleSelected=function(e){this.model.pointStyle!==e&&this.controller.dispatch({type:"set-item-pointstyle",id:this.id,pointStyle:e})},t.prototype.onToggleLines=function(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.getDisplayProps().lines})},t.prototype.onLineStyleSelected=function(e){this.model.lineStyle!==e&&this.controller.dispatch({type:"set-item-linestyle",id:this.id,lineStyle:e})},t.prototype.isDisabled=function(e){var t=this.controller.getEnabledDragModesForItem(this.id);return!n.contains(t,e)},t.prototype.getDragMode=function(){return this.model.reconciledDragMode||this.model.dragMode},t.prototype.getDisplayProps=function(){return s.getReconciledExpressionProps(this.model.formula.expression_type,{points:this.model.points,lines:this.model.lines,fill:this.model.fill})},t.prototype.onToggleDrag=function(){var e=this.model.reconciledDragMode!==o.NONE?o.NONE:o.XY;this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})},t.prototype.onDragModeSelected=function(e){this.isDisabled(e)||this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})},t}(i.Class);t.default=m}),define("loadcss!lib/tooltip",function(){}),define("lib/tooltip",["require","exports","tslib","keys","dcgview","jquery","underscore","loadcss!./tooltip"],function(e,t,r,c,u,p,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return u.createElement("div",{class:u.const("dcg-tooltip-positioning-container"),style:function(){return{top:e.props.hitAreaRect().top+"px",left:e.props.hitAreaRect().left+"px",width:e.props.hitAreaRect().width+"px",height:e.props.hitAreaRect().height+"px"}}},u.createElement("div",{class:u.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},u.createElement("div",{class:u.const("dcg-tooltip-message"),style:function(){return{background:e.getBackgroundColor(),cursor:e.props.isStickyAndNotStuck()?"pointer":"default"}}},this.props.tooltip)),u.createElement("div",{class:u.const("dcg-tooltip-arrow"),style:this.bindFn(this.getArrowStyle)}))},t.prototype.getArrowStyle=function(){var e=this.props.gravity();switch(e){case"s":case"sw":case"se":return{top:"100%",left:"50%",border:"5px solid transparent","border-color":"transparent transparent "+this.getBackgroundColor()+" transparent","margin-top":"-5px","margin-left":"-5px"};case"n":case"nw":case"ne":return{bottom:"100%",left:"50%",border:"5px solid transparent","border-color":this.getBackgroundColor()+" transparent transparent transparent","margin-bottom":"-5px","margin-left":"-5px"};case"e":return{top:"50%",left:"100%",border:"5px solid transparent","border-color":"transparent "+this.getBackgroundColor()+" transparent transparent","margin-left":"-5px","margin-top":"-5px"};case"w":return{top:"50%",right:"100%",border:"5px solid transparent","border-color":"transparent transparent transparent "+this.getBackgroundColor(),"margin-right":"-5px","margin-top":"-5px"};default:return e}},t.prototype.getBackgroundColor=function(){return this.props.isStickyAndNotStuck()?"#666":"#000"},t.prototype.getMessageStyle=function(){var e=this.props.hitAreaRect(),t=this.props.gravity(),r=this.props.offset().left||0;switch(t){case"s":return{top:"100%",transform:"translate(-50%, 0)",left:.5*e.width+r+"px","margin-top":"5px","text-align":"center"};case"sw":return{top:"100%",right:-r+"px","margin-top":"5px","text-align":"right"};case"se":return{top:"100%",left:r+"px","margin-top":"5px","text-align":"left"};case"n":return{bottom:"100%",transform:"translate(-50%, 0)",left:.5*e.width+r+"px","margin-bottom":"5px","text-align":"center"};case"nw":return{bottom:"100%",right:-r+"px","margin-bottom":"5px","text-align":"right"};case"ne":return{bottom:"100%",left:r+"px","margin-bottom":"5px","text-align":"left"};case"e":return{transform:"translate(0, -50%)",left:"100%",top:.5*e.height+"px","margin-left":5+r+"px","text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",top:.5*e.height+"px","margin-right":5-r+"px","text-align":"right"};default:return t}},t}(u.Class),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.uuid=n.uniqueId(),this.isMounted=!0},t.prototype.template=function(){var t=this;return u.createElement("div",{class:u.const("dcg-tooltip-hit-area-container"),handleevent:u.const("true"),didMount:function(e){t.hitAreaNode=e,t.setupEventListeners(t.hitAreaNode)},onTap:function(){return t.isStuck?(t.clearTimeouts(),void t.hideTooltip()):void(t.isSticky()?(t.showTooltip(),t.stickTooltip()):t.hideTooltip())}},this.children)},t.prototype.didUpdate=function(){this.updateTooltip()},t.prototype.updateTooltip=function(){if(this.wrapperRef){var e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),r=this.wrapperRef,n=r.originalTop,i=r.originalLeft,o=e.top-t.top,a=e.left-t.left;3<Math.abs(o-n)||3<Math.abs(a-i)?this.hideTooltip():this.wrapperRef.view.update()}},t.prototype.setupEventListeners=function(t){var r=this;p(t).on("tipsyshow",function(e){e.target===t&&(r.props.disabled&&r.props.disabled()||(r.clearTimeouts(),r.showTooltipTimeout=setTimeout(r.bindFn(r.showTooltip),500)))}).on("tipsyhide",function(e){e.target!==t||r.isStuck||(r.clearTimeouts(),r.hideTooltipTimeout=setTimeout(r.bindFn(r.hideTooltip),150))})},t.prototype.willUnmount=function(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()},t.prototype.stickTooltip=function(){var t=this;this.isMounted&&this.wrapperRef&&(this.isStuck||(p(document).on("mousedown.dcg-tooltip-"+this.uuid+" touchstart.dcg-tooltip-"+this.uuid+" pointerdown.dcg-tooltip-"+this.uuid,function(e){t.wrapperRef&&(p(e.target).closest(t.hitAreaNode).length||p(e.target).closest(t.wrapperRef.elt).length||t.hideTooltip())}),this.isStuck=!0,this.updateTooltip()))},t.prototype.clearTimeouts=function(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)},t.prototype.showTooltip=function(){var t=this;if(this.isMounted&&!this.wrapperRef){var e=this.hitAreaNode.getBoundingClientRect(),r=document.createElement("div");r.className="dcg-tooltip-mount-pt",p(this.hitAreaNode).closest(".dcg-tap-container")[0].appendChild(r);var n=r.getBoundingClientRect(),i=e.left-n.left,o=e.top-n.top,a={tooltip:this.props.tooltip,isStickyAndNotStuck:function(){return t.isSticky()&&!t.isStuck},offset:function(){return t.props.offset?t.props.offset():{}},gravity:function(){return t.props.gravity?t.props.gravity():"s"},hitAreaRect:function(){return{top:o||0,left:i||0,width:e.width||0,height:e.height||0}}};this.setupEventListeners(r),p(r).on("dcg-tap",function(){t.isSticky()&&t.stickTooltip()});var s=u.mountToNode(d,r,a);p(document).on("keydown.dcg-tooltip-"+this.uuid,function(e){c.lookup(e)===c.ESCAPE&&t.hideTooltip()});var l=function(){return t.updateTooltip()};window.addEventListener("scroll",l,!0),this.wrapperRef={elt:r,view:s,originalLeft:i,originalTop:o,onScroll:l}}},t.prototype.hideTooltip=function(){this.wrapperRef&&(this.isStuck=!1,p(document).off(".dcg-tooltip-"+this.uuid),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),u.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)},t.prototype.isSticky=function(){return!!this.props.sticky&&this.props.sticky()},t}(u.Class);t.Tooltip=i}),define("loadcss!dcgview-helpers/tooltipped-error",function(){}),define("dcgview-helpers/tooltipped-error",["require","exports","tslib","dcgview","lib/tooltip","loadcss!./tooltipped-error"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement(i.Tooltip,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity},n.createElement("div",{class:function(){return{"dcg-tooltipped-error":!0,"dcg-white":e.props.isWhite&&e.props.isWhite(),"dcg-small":e.props.size&&"small"===e.props.size()}}},n.createElement("i",{class:n.const("dcg-icon-error")})))},t}(n.Class);t.TooltippedError=o}),define("expressions/play-pause-icon-view",["require","exports","tslib","dcgview","lib/aria","./circular-icon-view","jquery.handleevent"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:n.const("dcg-circular-icon-container"),"aria-label":this.bindFn(this.getAriaLabel),tabindex:n.const("0"),onTap:this.bindFn(this.toggleSliderIsPlaying)},n.createElement(o.CircularIconView,{iconType:function(){return e.props.model().slider.isPlaying?"pause":"play"},whiteIcon:function(){return e.props.controller().isItemSelected(e.props.model().id)||e.props.controller().isItemBeingDragged(e.props.model().id)}}))},t.prototype.getAriaLabel=function(){if(!this.props.model().sliderExists)return"";var e=this.props.model().dependent;return e?this.props.model().slider.isPlaying?this.props.controller().t("Pause __variable__ Animation",{variable:e}):this.props.controller().t("Play __variable__ Animation",{variable:e}):""},t.prototype.toggleSliderIsPlaying=function(){var e=this.props.model();if(e.sliderExists){this.props.controller().dispatch({type:"set-slider-isplaying",id:e.id,isPlaying:!e.slider.isPlaying});var t,r=e.dependent;t=e.slider.isPlaying?this.props.controller().t("__variable__ playing",{variable:r}):this.props.controller().t("__variable__ paused",{variable:r}),i.alert(t)}},t}(n.Class);t.PlayPauseIconView=a}),define("expressions/expression-icon-view",["require","exports","tslib","dcgview","./abstract_icon_view","graphing/dragmode","expressions/styles","math/comparators","./expression_options_view","math/expression-types","graphing-calc/models/expression","../dcgview-helpers/tooltipped-error","./play-pause-icon-view","./circular-icon-view","jquery.handleevent"],function(e,t,r,n,i,l,c,u,o,a,p,s,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=n.Components.Switch,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.model=this.props.model()},t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-expression-icon-container")},n.createElement(f,{key:this.bindFn(this.getIconMode)},function(e){switch(e){case"error":return n.createElement(s.TooltippedError,{error:function(){return t.controller.unpack(t.model.error)},isWhite:function(){return t.controller.isItemSelected(t.model.id)||t.controller.isItemBeingDragged(t.model.id)},gravity:t.const("se")});case"none":return n.createElement("span",null);case"slider":return n.createElement(d.PlayPauseIconView,{controller:t.props.controller,model:t.props.model});case"icon":return n.createElement("div",{class:n.const("dcg-circular-icon-container"),role:n.const("button"),onTap:function(e){if(!e.wasHandled("dragdrop")&&!e.wasLongheld())return t.optionsShown?t.toggleOptions():t.controller.isInEditListMode()?t.toggleOptions():t.isFraction()?t.onToggleFractionDisplay():void t.toggleGraphShown()},didMount:function(e){return t.rootElt=e},onLongHold:function(e){e.handle("dcg-longhold"),e.handle("dcg-tap"),t.toggleOptions()}},n.createElement(h.CircularIconView,{iconType:t.bindFn(t.getIconType),backgroundColor:t.bindFn(t.getBackgroundColor),whiteIcon:t.bindFn(t.isSelected),foregroundColor:t.bindFn(t.getForegroundColor)}));default:return e}}))},t.prototype.isSelected=function(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)},t.prototype.isFraction=function(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)},t.prototype.getIconMode=function(){return this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?this.model.isGraphable&&!this.model.loading?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":"none":"none"},t.prototype.createOptionsMenuView=function(){var e=this.getOptionsMenuContainerSelector();return n.mountToNode(o.default,e[0],{controller:this.props.controller,model:this.props.model})},t.prototype.toggleGraphShown=function(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})},t.prototype.hasError=function(){return!!this.model.error&&!p.isEmpty(this.model)},t.prototype.hasSlider=function(){return!!this.model.sliderExists},t.prototype.getDisplayProps=function(){return a.getReconciledExpressionProps(this.model.formula.expression_type,{points:this.model.points,lines:this.model.lines,fill:this.model.fill})},t.prototype.getBackgroundColor=function(){if(!this.isFraction())return this.model.color;var e=this.isSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?e?"#fff":"#000":""},t.prototype.getForegroundColor=function(){if(!this.isFraction())return"";var e=this.isSelected();return e!==this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?"#fff":e?"#6399cb":"#000"},t.prototype.onToggleFractionDisplay=function(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})},t.prototype.getIconType=function(){if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";if(this.isFraction())return"fraction";var e=this.model.pointStyle,t=this.model.lineStyle,r=this.getDisplayProps(),n=this.model.formula;if(this.model.reconciledDragMode===l.X)return"movable-horizontal";if(this.model.reconciledDragMode===l.Y)return"movable-vertical";if(this.model.reconciledDragMode===l.XY)return"movable-both";if(p.isPointOrPointList(this.model))return p.isSinglePoint(this.model)?e===c.OPEN?"point-open":e===c.CROSS?"point-cross":"point-default":r.lines&&r.points?"table-points-and-lines":r.lines?"table-lines":"table-points";var i=this.getDisplayProps().fill;if(p.isPolygon(this.model))return i?r.lines?t===c.DASHED?"polygon-dashed-filled":t===c.DOTTED?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":r.lines?t===c.DASHED?"polygon-dashed":t===c.DOTTED?"polygon-dotted":"polygon-default":"none";if(p.isParametric(this.model))return i?r.lines?t===c.DASHED?"parametric-dashed-filled":t===c.DOTTED?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":r.lines?t===c.DASHED?"graph-dashed":t===c.DOTTED?"graph-dotted":"graph-default":"none";var o=n.operator,a=0!==u.table[o].direction,s=!1===u.table[o].inclusive;return n.is_shade_between?"shaded-inequality":!s&&a?"shaded-inequality":s&&!a?"inequality":s&&a?"shaded-inequality":t===c.DASHED?"graph-dashed":t===c.DOTTED?"graph-dotted":"graph-default"},t}(i.default);t.default=g}),define("loadcss!expressions/evaluation-view",function(){}),define("expressions/evaluation-view",["require","exports","tslib","dcgview","graphing/label","dcgview-helpers/static-mathquill-view","loadcss!./evaluation-view"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.Components,s=a.Switch,l=a.If,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-evaluation-container")},n.createElement("div",{class:function(){return{"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":t.props.controller().isInEditListMode()}},handleEvent:n.const("true")},n.createElement("div",{class:n.const("dcg-evaluation-label-container"),onTap:this.bindFn(this.onSelectEvaluation)},n.createElement(l,{predicate:function(){return!!t.props.dependent()}},function(){return n.createElement(o.default,{latex:function(){return i.identifierToLatex(t.props.dependent())}},n.createElement("span",null))}),n.createElement("span",{class:n.const("dcg-equals")},n.createElement(o.default,{latex:this.const("=")}))),n.createElement("span",{class:n.const("dcg-text-selectable dcg-evaluation-html"),didMount:this.bindFn(this.didMountEvaluation)},n.createElement(s,{key:function(){return t.getEvaluationType()}},function(e){switch(e){case"list":return n.createElement("span",null,function(){return t.props.val().length},n.const(" element list"));case"fraction":return n.createElement(o.default,{latex:function(){return i.truncatedLatexLabel(t.props.val(),t.getLabelOptions())}});case"undefined":return n.createElement("span",null,n.const("undefined"));case"scientific":return n.createElement(o.default,{latex:function(){return t.getNumberLabel().mantissa+"\\times10^{"+t.getNumberLabel().exponent+"}"}});case"decimal":return n.createElement(o.default,{latex:function(){return t.getNumberLabel().value}});default:return e}}))),n.createElement("div",{class:n.const("dcg-clear")}))},t.prototype.getNumberLabel=function(){return e=this.props.val(),t=this.getLabelOptions(),i.numericLabel(e,t);var e,t},t.prototype.getEvaluationType=function(){var e=this.props.val();return Array.isArray(e)?"list":this.getNumberLabel().type},t.prototype.getLabelOptions=function(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())},t.prototype.didMountEvaluation=function(e){this.evaluationNode=e},t.prototype.onSelectEvaluation=function(){var e=document.createRange();e.selectNodeContents(this.evaluationNode),window.getSelection().removeAllRanges(),window.getSelection().addRange(e)},t}(n.Class);t.default=c}),define("expressions/unresolved_view",["require","exports","tslib","dcgview"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return this.controller=this.props.controller(),n.createElement("div",{class:n.const("dcg-unresolved")},n.createElement("i",{class:n.const("dcg-icon-error")}),n.const(""),function(){return e.controller.t("This equation contains fine detail that has not been fully resolved.")},n.createElement("a",{href:n.const("http://support.desmos.com/entries/29577773-Unresolved-Detail-In-Plotted-Functions"),target:n.const("_blank")},function(){return e.controller.t("Learn more.")}))},t}(n.Class);t.default=i}),define("loadcss!domain",function(){}),define("expressions/domain_view",["require","exports","tslib","dcgview","dcgview-helpers/static-mathquill-view","dcgview-helpers/mathquill-view","graphing-calc/models/expression","graphing/label","bugsnag","loadcss!domain"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id},t.prototype.template=function(){var r=this;return n.createElement("div",{class:n.const("dcg-domain dcg-do-blur"),handleEvent:n.const("true")},n.createElement("div",{class:n.const("dcg-display-domain dcg-do-blur"),handleEvent:n.const("true")},n.createElement("div",{class:n.const("dcg-editable-mathquill-container")},n.createElement(o.default,{latex:function(){return r.getMinLatex()},placeholder:function(){return s.value(a.getDomainMin(r.model)).string},isFocused:function(){return"min"===r.getFocusedInput()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.controller.t("domain Minimum: ")},getAriaPostLabel:this.const(""),hasError:function(){return!a.isDomainMinValid(r.model)},onUserPressedKey:function(e,t){r.handlePressedKey("min",e,t)},onUserChangedLatex:function(e){return r.dispatchMinLatexIfChanged(e)},onFocusedChanged:function(e){return r.handleFocusedChanged("min",e)},dataLabelAttributeValue:this.const("domain-min")}),n.createElement("span",{class:n.const("dcg-interval-interior")},n.createElement(i.default,{latex:function(){return r.getDomainVariableLatex()}},n.createElement("span",null))),n.createElement(o.default,{latex:function(){return r.getMaxLatex()},placeholder:function(){return s.value(a.getDomainMax(r.model)).string},isFocused:function(){return"max"===r.getFocusedInput()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.controller.t("domain Maximum: ")},getAriaPostLabel:this.const(""),hasError:function(){return!a.isDomainMaxValid(r.model)},onUserPressedKey:function(e,t){r.handlePressedKey("max",e,t)},onUserChangedLatex:function(e){return r.dispatchMaxLatexIfChanged(e)},onFocusedChanged:function(e){return r.handleFocusedChanged("max",e)},dataLabelAttributeValue:this.const("domain-max")}))))},t.prototype.handlePressedKey=function(e,t,r){if("Esc"!==t){if("Enter"===t)return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=o.default.getFocusedMathquill();if(n){if("Left"===t||"Right"===t||"Down"===t||"Up"===t)return void(o.default.applyArrowKeyAndReturnIfWasAtBounds(n,t,r)&&("Left"===t?"max"===e&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"}}):"Right"===t?"min"===e&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"}}):"Down"===t?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):"Up"===t&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}})));n.keystroke(t,r),"min"===e?this.dispatchMinLatexIfChanged(n.latex()):"max"===e&&this.dispatchMaxLatexIfChanged(n.latex())}}else this.controller.dispatch({type:"set-focus-location",location:void 0})},t.prototype.handleFocusedChanged=function(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})},t.prototype.dispatchMinLatexIfChanged=function(e){if(this.getMinLatex()!==e){var t=this.getDomainType();if("unknown"===t)return void l.notify("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:a.getState(this.model,{stripDefaults:!0})}});this.controller.dispatch("polar"===t?{type:"set-polar-domain-minlatex",id:this.id,latex:e}:{type:"set-parametric-domain-minlatex",id:this.id,latex:e})}},t.prototype.dispatchMaxLatexIfChanged=function(e){if(this.getMaxLatex()!==e){var t=this.getDomainType();if("unknown"===t)return void l.notify("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:a.getState(this.model,{stripDefaults:!0})}});this.controller.dispatch("polar"===t?{type:"set-polar-domain-maxlatex",id:this.id,latex:e}:{type:"set-parametric-domain-maxlatex",id:this.id,latex:e})}},t.prototype.getFocusedInput=function(){var e=this.controller.getFocusLocation();if(e&&"domain-limit"===e.type&&e.id===this.id)return e.location},t.prototype.getMinLatex=function(){switch(this.getDomainType()){case"parametric":return a.getParametricDomainMin(this.model);case"polar":return a.getPolarDomainMin(this.model);default:return""}},t.prototype.getMaxLatex=function(){switch(this.getDomainType()){case"parametric":return a.getParametricDomainMax(this.model);case"polar":return a.getPolarDomainMax(this.model);default:return""}},t.prototype.getDomainVariableLatex=function(){switch(this.getDomainType()){case"parametric":return"\\le t \\le";case"polar":return"\\le \\theta \\le";default:return""}},t.prototype.getDomainType=function(){return a.isPolar(this.model)?"polar":a.isParametric(this.model)?"parametric":"unknown"},t}(n.Class);t.default=c}),define("loadcss!regression",function(){}),define("expressions/regression_view",["require","exports","tslib","dcgview","graphing/label","dcgview-helpers/static-mathquill-view","loadcss!regression"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.Components,s=a.If,l=a.For,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,n.createElement(s,{predicate:this.bindFn(this.getRegression)},function(){return n.createElement("div",{class:n.const("dcg-regression-container")},n.createElement("div",{class:n.const("dcg-handle-event"),handleEvent:n.const("true")},n.createElement(s,{predicate:t.bindFn(t.getShouldSuggestLogMode)},function(){return n.createElement("div",{class:n.const("dcg-log-mode-toggle")},n.createElement("div",{class:function(){return{"dcg-action-log-mode-toggle":!0,"dcg-toggled-on":t.getIsLogModeRegression()}},onTap:t.bindFn(t.onTapLogMode)},n.createElement("span",{class:n.const("dcg-log-mode-checkbox"),role:n.const("checkbox"),"aria-checked":function(){return t.getIsLogModeRegression()},tabindex:n.const("0"),"aria-label":function(){return t.controller.t("Log Mode")}},n.createElement("i",{class:n.const("dcg-icon-check")})),function(){return t.controller.t("Log Mode")}),n.createElement("a",{"aria-label":function(){return t.controller.t("Log Mode Help")},class:n.const("dcg-log-mode-toggle-help"),target:n.const("_blank"),href:n.const("http://support.desmos.com/hc/en-us/articles/204349605")},n.createElement("i",{class:n.const("dcg-icon-question-sign")})))}),n.createElement("div",{class:n.const("dcg-statistics"),role:n.const("group"),"aria-label":function(){return t.controller.t("Statistics")}},n.createElement("div",{class:n.const("dcg-regression-title dcg-residuals-title")},function(){return t.controller.t("Statistics")},n.const(""),n.createElement(s,{predicate:function(){return t.getRegression().statistics.hasOwnProperty("RMSE")}},function(){return n.createElement("a",{class:n.const("dcg-regression-about-link"),target:n.const("_blank"),href:n.const("http://support.desmos.com/entries/60176149-What-is-RMSE-"),"aria-label":function(){return t.controller.t("What is RMSE?")}},n.createElement("i",{class:n.const("dcg-icon-question-sign")}))}),n.createElement(s,{predicate:function(){return t.getRegression().statistics.Rsquared<0}},function(){return n.createElement("a",{"aria-label":function(){return t.controller.t("Why am I seeing a negative R Squared value?")},class:n.const("dcg-regression-about-link"),target:n.const("_blank"),href:n.const("http://support.desmos.com/entries/60460125-Why-am-I-seeing-a-negative-R-2-value-")},n.createElement("i",{class:n.const("dcg-icon-question-sign")}))})),n.createElement("div",{class:n.const("dcg-statistics-values")},n.createElement(s,{predicate:function(){return t.getRegression().statistics.hasOwnProperty("Rsquared")}},function(){return n.createElement("div",null,n.createElement(o.default,{latex:function(){return"R^2="+t.getRoundedStat("Rsquared")}},n.createElement("span",{tabindex:n.const("0")})))}),n.createElement(s,{predicate:function(){return t.getRegression().statistics.hasOwnProperty("rsquared")}},function(){return n.createElement("div",null,n.createElement(o.default,{latex:function(){return"r^2="+t.getRoundedStat("rsquared")}},n.createElement("span",{tabindex:n.const("0")})))}),n.createElement(s,{predicate:function(){return t.getRegression().statistics.hasOwnProperty("r")}},function(){return n.createElement("div",null,n.createElement(o.default,{latex:function(){return"r="+t.getRoundedStat("r")}},n.createElement("span",{class:n.const("dcg-r-value"),tabindex:n.const("0")})))}),n.createElement(s,{predicate:function(){return t.getRegression().statistics.hasOwnProperty("RMSE")}},function(){return n.createElement("div",null,n.createElement(o.default,{latex:function(){return"\\operatorname{RMSE}="+t.getRoundedStat("RMSE")}},n.createElement("span",{tabindex:n.const("0")})))}))),n.createElement("div",{role:n.const("group"),"aria-label":function(){return t.controller.t("Residuals")},class:n.const("dcg-residuals")},n.createElement("div",{class:n.const("dcg-regression-title dcg-residuals-title")},function(){return t.controller.t("Residuals")}),n.createElement(o.default,{latex:t.bindFn(t.getResidualVariable)},n.createElement("span",{class:n.const("dcg-residuals-variable"),tabindex:n.const("0")})),n.createElement("div",{class:function(){return{"dcg-residual-suggestion":!0,"dcg-action-plot-residual":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-visible":t.getResidualSuggestionVisible()}},"aria-hidden":function(){return!t.getResidualSuggestionVisible()},role:n.const("button"),tabindex:function(){return t.getResidualSuggestionVisible()?"0":void 0},onTap:t.bindFn(t.onTapResidualsSuggestion)},function(){return t.controller.t("plot")})),n.createElement(s,{predicate:function(){return 0<Object.keys(t.getRegression().parameters).length}},function(){return n.createElement("div",{class:n.const("dcg-parameters-container")},n.createElement("div",{class:n.const("dcg-regression-title dcg-parameters-title")},function(){return t.controller.t("Parameters")}),n.createElement(l,{each:function(){return Object.keys(t.getRegression().parameters)}},n.createElement("div",{role:n.const("group"),"aria-label":function(){return t.controller.t("Parameters")},class:n.const("dcg-parameters")},function(e){return n.createElement(o.default,{latex:function(){return e+"="+t.getRoundedParam(e)}},n.createElement("span",{class:n.const("dcg-parameter"),tabindex:n.const("0")}))})))}),n.createElement("div",{class:n.const("dcg-clear")})))})},t.prototype.onTapResidualsSuggestion=function(){this.controller.dispatch({type:"plot-residuals",id:this.id})},t.prototype.onTapLogMode=function(){this.controller.dispatch({type:"toggle-logmode",id:this.id})},t.prototype.getRegression=function(){return this.model.formula.regression},t.prototype.getResidualVariable=function(){return this.getRegression().residualVariable||""},t.prototype.getResidualSuggestionVisible=function(){return void 0!==this.getRegression().residualSuggestionId},t.prototype.getShouldSuggestLogMode=function(){return!!this.getRegression().shouldSuggestLogMode},t.prototype.getIsLogModeRegression=function(){return!!this.model.isLogModeRegression},t.prototype.getRoundedParam=function(e){return i.truncatedLatexLabel(this.getRegression().parameters[e],{zeroCutoff:1e-15,digits:6,smallCutoff:1e-6,bigCutoff:1e9})},t.prototype.getRoundedStat=function(e){return i.truncatedLatexLabel(this.getRegression().statistics[e],{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})},t}(n.Class);t.default=c}),function(){define("dcgview-helpers/dragdrop",["require","underscore","underscore_model","jquery","pjs","lib/animation-frame"],function(e){var i,o,t,r;return e("underscore"),r=e("underscore_model").UnderscoreModel,i=e("jquery"),t=e("pjs"),o=e("lib/animation-frame"),t(r,function(e,t){return{init:function(e){return this.options=null!=e?e:{},t.init.call(this),this.dragging=!1},_evt2pt:function(e){return{x:e.changedTouches[0].pageX-this._offsetPt.x,y:e.changedTouches[0].pageY-this._offsetPt.y}},_dispatch:function(e,t){var r;if(!this._destroyed)return r=this._evt2pt(t),this.triggerEvent(e,{x:r.x,y:r.y,dx:r.x-this._startPt.x,dy:r.y-this._startPt.y,evt:t})},destroy:function(){return i(document).off("."+this.guid),this._destroyed=!0},startDrag:function(e,t){if(null==t&&(t={}),!this.dragging)return i(document).on("dcg-tapmove."+this.guid,(n=this,function(e){return e.originalEvent.preventDefault(),n.options.doNotThrottle?void n.doDrag(e):(o.cancelAnimationFrame(n.frameThrottle),n.frameThrottle=o.requestAnimationFrame(function(){return n.doDrag(e)}))})),i(document).on("dcg-tapend."+this.guid+" dcg-tapcancel."+this.guid,(r=this,function(e){return r.endDrag(e)})),this._offsetPt={x:0,y:0},null!=t.origin&&(this._offsetPt={x:this._evt2pt(e).x-t.origin.x,y:this._evt2pt(e).y-t.origin.y}),this._startPt=this._evt2pt(e),this.setProperty("dragging",!0),this._dispatch("onGrab",e);var r,n},doDrag:function(e){if(this.dragging)return this._dispatch("onDrag",e)},endDrag:function(e){if(this.dragging)return i(document).off("."+this.guid),this.doDrag(e),this.setProperty("dragging",!1),this._dispatch("onDrop",e)}}})})}.call(this),define("loadcss!dcgview-helpers/slider",function(){}),define("dcgview-helpers/slider",["require","exports","./dragdrop","lib/rounding","tslib","keys","dcgview","jquery","lib/conditional_blur","loadcss!./slider"],function(e,t,n,a,r,i,o,s,l){"use strict";function c(e,t,r){return Math.min(Math.max(e,t),r)}Object.defineProperty(t,"__esModule",{value:!0});var u=o.Components.If,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return o.createElement("div",{class:function(){return{"dcg-slider-interior":!0,"dcg-disable-slider":e.shouldDisableSlider()}},didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag),style:o.const({"touch-action":"none"})},o.createElement("div",{class:o.const("dcg-track")},o.createElement("div",{class:o.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),o.createElement("div",{class:o.const("dcg-graphic")})),o.createElement(u,{predicate:this.bindFn(this.shouldShowZeroMarker)},function(){return o.createElement("div",{class:o.const("dcg-zeroMarker"),style:function(){return{left:e.getZeroMarkerPercent()+"%"}}})}),o.createElement("div",{class:function(){return{"dcg-thumb":!0,"dcg-down":e.isDragging}},role:o.const("slider"),tabindex:o.const("0"),disablescroll:o.const("true"),style:function(){return{left:e.getThumbPercent()+"%"}},onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-minvalue":this.props.min,"aria-maxvalue":this.props.max,"aria-valuenow":this.props.value,manageFocus:this.buildFocusManager()},o.createElement("div",{class:o.const("dcg-graphic")}),o.createElement("div",{class:o.const("dcg-center")})))},t.prototype.willUnmount=function(){this.dragDrop.destroy()},t.prototype.didMountRoot=function(e){var r=this;this.rootNode=e,this.dragDrop=n(),this.isMounted=!0,this.dragDrop.observeEvent("onDrop",function(){r.isDragging=!1,r.update(),r.props.onDrop&&r.props.onDrop()}),this.dragDrop.observeEvent("onGrab",function(){r.isDragging=!0,r.update(),r.props.onGrab&&r.props.onGrab()}),this.dragDrop.observeEvent("onDrag",function(e,t){r.props.onDragUpdate(r.valueFromPixels(t.x))})},t.prototype.didMountTickMarks=function(e){this.tickMarksNode=e,this.renderTickMarks()},t.prototype.didUpdate=function(){this.renderTickMarks()},t.prototype.shouldDisableSlider=function(){return this.props.min()===this.props.max()},t.prototype.renderTickMarks=function(){if(this.tickMarksNode){var e,t=this.props.step(),r=this.props.min(),n=this.props.max();if((e=void 0===t?0:100*t/(n-r))<3&&(e=0),100<e&&(e=0),isNaN(e)&&(e=0),this.lastTickMarksPercent!==e){var i="";if(0<(this.lastTickMarksPercent=e)&&e<100)for(var o=e;o<100;o+=e)i+='<div class="dcg-tick" style="left:'+o+'%"></div>';this.tickMarksNode.innerHTML=i}}},t.prototype.shouldShowZeroMarker=function(){return this.props.min()<=0&&0<=this.props.max()},t.prototype.getZeroMarkerPercent=function(){var e=this.props.min();return 100*(0-e)/(this.props.max()-e)},t.prototype.getThumbPercent=function(){return 100*this.percentFromValue(this.props.value())},t.prototype.valueFromPixels=function(e){if(!this.isMounted)return 0;var t=this.props.min(),r=this.props.max(),n=this.rootNode.getBoundingClientRect().width,i=t+(r-t)*c(e/n,0,1),o=(r-t)/n;return a.shortestDecimalBetween(i-o,i+o)},t.prototype.percentFromValue=function(e){var t=this.props.min();return c((e-t)/(this.props.max()-t),0,1)},t.prototype.pixelsFromValue=function(e){if(!this.isMounted)return 0;var t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t},t.prototype.onKeyDown=function(e){switch(i.lookup(e)){case i.ENTER:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault());break;case i.ESCAPE:s(document.activeElement).blur();break;case i.LEFT:case i.DOWN:this.props.onKeyboardUpdate("down"),e.preventDefault();break;case i.RIGHT:case i.UP:this.props.onKeyboardUpdate("up"),e.preventDefault();break;case i.PAGEDOWN:this.props.onKeyboardUpdate("bigdown"),e.preventDefault();break;case i.PAGEUP:this.props.onKeyboardUpdate("bigup"),e.preventDefault();break;case i.HOME:this.props.onKeyboardUpdate("min"),e.preventDefault();break;case i.END:this.props.onKeyboardUpdate("max"),e.preventDefault()}},t.prototype.onStartDrag=function(e){if("keyboard"!==e.device&&e.target){e.preventDefault(),l.default();var t={x:0,y:0};1===s(e.target).closest(".dcg-thumb").length?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}},t.prototype.buildFocusManager=function(){return this.props.onFocusedChanged&&this.props.isFocused?this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged}):this.const(void 0)},t}(o.Class);t.default=p}),define("expressions/slider_limits_view",["require","exports","tslib","dcgview","dcgview-helpers/static-mathquill-view","dcgview-helpers/mathquill-view","graphing-calc/models/expression","graphing/label"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var r=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,n.createElement("div",{class:n.const("dcg-slider_menu dcg-do-blur"),handleEvent:n.const("true")},n.createElement("div",{class:n.const("dcg-editable-mathquill-container")},n.createElement(o.default,{latex:function(){return r.model.slider.hardMin?r.model.slider.min:""},isFocused:function(){return"min"===r.getFocusedInput()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.controller.t("Slider Minimum: ")},getAriaPostLabel:this.const(""),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey("min",e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged("min",e)},onFocusedChanged:function(e){return r.handleFocusedChanged("min",e)}},n.createElement("span",{class:function(){return{"dcg-math-field":!0,"dcg-focus":"min"===r.getFocusedInput(),"dcg-invalid":!a.isSliderMinValid(r.model)}},"data-dcg-limit":n.const("slidermin")})),n.createElement("span",{class:n.const("dcg-interval-interior")},n.createElement(i.default,{latex:this.bindFn(this.getDependentLatex)},n.createElement("span",null))),n.createElement(o.default,{latex:function(){return r.model.slider.hardMax?r.model.slider.max:""},isFocused:function(){return"max"===r.getFocusedInput()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.controller.t("Slider Maximum: ")},getAriaPostLabel:this.const(""),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey("max",e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged("max",e)},onFocusedChanged:function(e){return r.handleFocusedChanged("max",e)}},n.createElement("span",{class:function(){return{"dcg-math-field":!0,"dcg-focus":"max"===r.getFocusedInput(),"dcg-invalid":!a.isSliderMaxValid(r.model)}},"data-dcg-limit":n.const("slidermax")})),n.createElement("span",{class:n.const("dcg-slider-step-container")},n.createElement("span",{class:n.const("dcg-slider-step-label"),"aria-hidden":n.const("true")},function(){return r.controller.t("step:")}),n.createElement(o.default,{latex:function(){return r.model.slider.step},isFocused:function(){return"step"===r.getFocusedInput()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.controller.t("Slider Step Size: ")},getAriaPostLabel:this.const(""),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey("step",e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged("step",e)},onFocusedChanged:function(e){return r.handleFocusedChanged("step",e)}},n.createElement("span",{class:function(){return{"dcg-math-field":!0,"dcg-focus":"step"===r.getFocusedInput(),"dcg-invalid":!a.isSliderStepValid(r.model)}},"data-dcg-limit":n.const("sliderstep")})))))},t.prototype.handlePressedKey=function(e,t,r){if("Esc"!==t){if("Enter"===t)return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=o.default.getFocusedMathquill();if(n){if("Left"===t||"Right"===t||"Down"===t||"Up"===t)return void(o.default.applyArrowKeyAndReturnIfWasAtBounds(n,t,r)&&("Left"===t?"max"===e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.model.id,location:"min"}}):"step"===e&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.model.id,location:"max"}}):"Right"===t?"min"===e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.model.id,location:"max"}}):"max"===e&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.model.id,location:"step"}}):"Down"===t?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):"Up"===t&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}})));n.keystroke(t,r),this.handleLatexChanged(e,n.latex())}}else this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}})},t.prototype.handleLatexChanged=function(e,t){"min"===e?this.dispatchMinLatexIfChanged(t):"max"===e?this.dispatchMaxLatexIfChanged(t):"step"===e&&this.dispatchStepLatexIfChanged(t)},t.prototype.handleFocusedChanged=function(e,t){var r=this;t&&this.getFocusedInput()!==e&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}),t?clearTimeout(this.saveAfterBlurTimeout):this.saveAfterBlurTimeout=setTimeout(function(){clearTimeout(r.saveAfterBlurTimeout),r.getFocusedInput()===e&&r.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:r.id,location:e}})},1)},t.prototype.dispatchMinLatexIfChanged=function(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})},t.prototype.dispatchMaxLatexIfChanged=function(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})},t.prototype.dispatchStepLatexIfChanged=function(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})},t.prototype.getDependentLatex=function(){var e=this.model.dependent||"";return" \\le "+s.identifierToLatex(e)+" \\le "},t.prototype.getFocusedInput=function(){var e=this.controller.getFocusLocation();if(e&&"slider-limit"===e.type&&e.id===this.id)return e.location},t}(n.Class);t.default=l}),define("loadcss!expressions/slider-view",function(){}),define("expressions/slider_view",["require","exports","tslib","keys","dcgview","dcgview-helpers/slider","./slider_limits_view","dcgview-helpers/static-mathquill-view","graphing-calc/models/expression","loadcss!./slider-view"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.Components.If,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,i.createElement("span",{class:i.const("dcg-slider-container"),tapboundary:i.const("true"),onKeydown:function(e){"Tab"!==n.lookup(e)||e.altKey||e.metaKey||e.ctrlKey||(e.shiftKey&&t.isSliderThumbFocused()?(t.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:t.id,location:"step"}}),e.preventDefault(),e.stopPropagation()):!e.shiftKey&&t.isSliderStepFocused()&&(t.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:t.id}}),e.preventDefault(),e.stopPropagation()))}},i.createElement(c,{predicate:function(){return t.shouldShowSlider()}},function(){return i.createElement("div",{class:i.const("dcg-do-blur dcg-slider"),handleEvent:i.const("true")},i.createElement("div",{class:i.const("dcg-minLabel dcg-template-minlabelhtml"),role:i.const("button"),tabindex:i.const("0"),"aria-label":function(){return t.controller.t("Edit __variable__ Limits",{variable:'"'+t.model.dependent+'"'})},onTap:function(){return t.onEditLimit("min")}},i.createElement(s.default,{latex:function(){return l.getDisplaySliderMin(t.model)}})),i.createElement(o.default,{min:function(){return l.getSliderMin(t.model)},max:function(){return l.getSliderMax(t.model)},step:function(){return l.getSliderStep(t.model)},value:function(){return l.getSliderValue(t.model)},ariaLabel:function(){return'"'+t.model.dependent+'"'},onGrab:t.bindFn(t.onGrab),onDrop:t.bindFn(t.onDrop),onDragUpdate:t.bindFn(t.onDragUpdate),onKeyboardUpdate:t.bindFn(t.onKeyboardUpdate),onEnterPress:function(){return t.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})},isFocused:t.bindFn(t.isSliderThumbFocused),onFocusedChanged:function(e){e?t.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:t.id}}):t.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:t.id}})}}),i.createElement("div",{class:i.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:function(){return t.onEditLimit("max")}},i.createElement(s.default,{latex:function(){return l.getDisplaySliderMax(t.model)}})))}),i.createElement(c,{predicate:function(){return t.shouldShowLimitInputs()}},function(){return i.createElement(a.default,{model:t.props.model,controller:t.props.controller})}))},t.prototype.onGrab=function(){this.dispatchIsDraggingIfChanged(!0)},t.prototype.onDrop=function(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)},t.prototype.onKeyboardUpdate=function(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})},t.prototype.onDragUpdate=function(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})},t.prototype.onEditLimit=function(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})},t.prototype.dispatchIsPlayingIfChanged=function(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})},t.prototype.dispatchIsDraggingIfChanged=function(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})},t.prototype.shouldShowLimitInputs=function(){if(this.controller.isInEditListMode())return!0;if(!l.isSliderMinValid(this.model))return!0;if(!l.isSliderMaxValid(this.model))return!0;if(!l.isSliderStepValid(this.model))return!0;if(this.props.forceLimitInputsVisible())return!0;var e=this.controller.getFocusLocation();return!(!e||"slider-limit"!==e.type||e.id!==this.id)},t.prototype.shouldShowSlider=function(){return!this.shouldShowLimitInputs()},t.prototype.isSliderThumbFocused=function(){var e=this.controller.getFocusLocation();return!(!e||"slider-thumb"!==e.type||e.id!==this.id)},t.prototype.isSliderStepFocused=function(){var e=this.controller.getFocusLocation();return!(!e||"slider-limit"!==e.type||e.id!==this.id||"step"!==e.location)},t}(i.Class);t.default=u}),define("loadcss!expressions/slider-speed-view",function(){}),define("expressions/slider_speed_view",["require","exports","expressions/slider_loop_modes","tslib","underscore","lib/aria","dcgview","graphing-calc/json/expression","loadcss!./slider-speed-view"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],c=i.min(l),u=i.max(l),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.model=this.props.model()},t.prototype.template=function(){var e=this;return a.createElement("div",{class:a.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:a.const("true")},a.createElement("span",{class:a.const("dcg-action-toggle-slider-loop-mode"),onTap:function(){return e.toggleLoopMode()},role:a.const("button"),"aria-label":function(){return e.getLoopModeAriaLabel()},"aria-hidden":function(){return e.isHidden()},tabindex:function(){return e.isHidden()?-1:0},loopMode:function(){return e.model.slider.loopMode}},a.createElement("span",{class:a.const("dcg-toggle-loop-mode-top")},a.createElement("i",{class:a.const("dcg-icon-bottom-arrow")})),a.createElement("span",{class:a.const("dcg-toggle-loop-mode-bottom")},a.createElement("i",{class:a.const("dcg-icon-bottom-arrow")}))),a.createElement("span",{class:function(){return{"dcg-action-slower":!0,"dcg-disabled":e.isSlowerDisabled()}},onTap:function(){return e.animateSlower()},role:a.const("button"),"aria-label":function(){return e.getSlowerAriaLabel()},"aria-hidden":function(){return e.isHidden()},tabindex:function(){return e.isHidden()?-1:0},"aria-disabled":function(){return e.isSlowerDisabled()}},a.const("")),a.createElement("span",{class:a.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),a.const("x")),a.createElement("span",{class:function(){return{"dcg-action-faster":!0,"dcg-disabled":e.isFasterDisabled()}},onTap:function(){return e.animateFaster()},role:a.const("button"),"aria-label":function(){return e.getFasterAriaLabel()},"aria-hidden":function(){return e.isHidden()},tabindex:function(){return e.isHidden()?-1:0},"aria-disabled":function(){return e.isFasterDisabled()}},a.const("")))},t.prototype.computeSpeed=function(){var e=s.DEFAULT_SLIDER_PERIOD/this.model.slider.animationPeriod;return Number(e.toFixed(3))},t.prototype.isSlowerDisabled=function(){return c>=this.computeSpeed()},t.prototype.isFasterDisabled=function(){return u<=this.computeSpeed()},t.prototype.animateSlower=function(){var t=this.computeSpeed(),e=i.filter(l,function(e){return e<t});0!==e.length&&this.setPeriodFromSpeed(i.max(e))},t.prototype.animateFaster=function(){var t=this.computeSpeed(),e=i.filter(l,function(e){return t<e});0!==e.length&&this.setPeriodFromSpeed(i.min(e))},t.prototype.toggleLoopMode=function(){var e;e=this.model.slider.loopMode===r.LOOP_FORWARD_REVERSE?r.LOOP_FORWARD:r.LOOP_FORWARD_REVERSE,this.controller.dispatch({type:"set-slider-loopmode",id:this.model.id,loopMode:e})},t.prototype.setPeriodFromSpeed=function(e){var t=s.DEFAULT_SLIDER_PERIOD/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),o.alert(this.controller.t("Animating at __speed__x",{speed:e+""}))},t.prototype.isHidden=function(){return!this.model.slider.isPlaying},t.prototype.getSlowerAriaLabel=function(){this.controller.t("Animate __variable__ Slower",{variable:this.model.dependent})},t.prototype.getFasterAriaLabel=function(){this.controller.t("Animate __variable__ Faster",{variable:this.model.dependent})},t.prototype.getLoopModeAriaLabel=function(){return this.model.slider.loopMode===r.LOOP_FORWARD_REVERSE?this.controller.t("Loop __variable__ Forward and Reverse",{variable:this.model.dependent}):this.controller.t("Loop __variable__ Forward",{variable:this.model.dependent})},t}(a.Class);t.default=p}),define("loadcss!prompt-sliders",function(){}),define("expressions/promptslider_view",["require","exports","tslib","graphing/label","jquery","lib/aria","dcgview","loadcss!prompt-sliders"],function(e,t,r,n,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o.Components,l=s.For,c=s.If,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.model=this.props.model()},t.prototype.template=function(){var e=this;return o.createElement("div",{class:o.const("dcg-create-sliders dcg-action-createslider"),handleEvent:o.const("true"),onTap:this.bindFn(this.onCreateSlider)},o.createElement("span",{class:o.const("dcg-msg")},function(){return e.controller.t("add slider:")}),o.createElement("span",{class:o.const("btns")},o.createElement(l,{each:function(){return e.model.missingVariables}},o.createElement("span",null,function(t){return o.createElement("div",{class:o.const("dcg-slider-btn-container"),var_name:e.const(t)},o.createElement("div",{role:o.const("button"),tabindex:o.const("0"),class:function(){return{"dcg-btn-slider":!0,"dcg-btn-blue":1===e.model.missingVariables.length,"dcg-btn-light-gray":1!==e.model.missingVariables.length}},didMount:function(e){e.innerHTML=n.identifierToHTML(t)}}))})),o.createElement(c,{predicate:function(){return 1<e.model.missingVariables.length}},function(){return o.createElement("div",{class:o.const("dcg-slider-btn-container dcg-all")},o.createElement("div",{role:o.const("button"),tabindex:o.const("0"),class:o.const("dcg-btn-slider dcg-btn-blue")},function(){return e.controller.t("all")}))})))},t.prototype.onCreateSlider=function(e){if(this.controller.dispatch({type:"set-none-selected"}),e.target){var t=a(e.target).closest(".dcg-slider-btn-container");if(t.length){var r=!1;if(t.hasClass("dcg-all"))this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:this.model.missingVariables}),r=!0;else{var n=[t.attr("var_name")];this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:n}),r=1==this.model.missingVariables.length}if("keyboard"===e.device){var i=this.model.id,o=this.props.controller().getItemSelectorById(i);if(!o)return;r?this.controller.dispatch({type:"move-focus-to-item",id:i}):o.find(".dcg-btn-blue").focus()}}}},t.prototype.didMount=function(){var n=this;this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout),this.promptAlertTimeout=setTimeout(function(){for(var e=[],t=n.model.missingVariables,r=0;r<t.length;r++)e.push('"'+t[r]+'"');i.alert(n.controller.t("Add slider for __vars__",{vars:e.join(",")})),n.promptAlertTimeout=0},2e3)},t.prototype.didUnmount=function(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout)},t}(o.Class);t.default=u}),define("loadcss!expressions/label-dropdown-view",function(){}),define("expressions/label-dropdown-view",["require","exports","tslib","dcgview","main/label-sizes","main/label-orientations","dcgview-helpers/checkbox","loadcss!./label-dropdown-view"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components,l=s.For,c=s.Switch,u=s.If,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var r=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,n.createElement("div",{class:n.const("dcg-label-dropdown-view dcg-popover dcg-left")},n.createElement("div",{class:n.const("dcg-arrow")}),n.createElement("div",{class:n.const("dcg-label-group-container")},n.createElement("div",{class:n.const("dcg-label-group")},n.createElement("div",{role:n.const("heading"),"aria-level":n.const(1),class:n.const("dcg-label-group-title")},n.const("Label Position")),n.createElement(l,{each:this.bindFn(this.getLabelOrientations)},n.createElement("div",{role:n.const("group"),"aria-label":function(){return r.controller.t("Label Position")},class:n.const("dcg-label-options")},function(t){return n.createElement("a",{role:n.const("button"),tabindex:n.const(0),class:function(){return{"dcg-menu-option":!0,"dcg-label-position":!0,"dcg-menu-option-selected":r.isorientationSelected(t)}},"aria-pressed":function(){return r.isorientationSelected(t)},onTap:function(){return r.setorientation(t)},"aria-label":function(){return r.capitalizeFirst(t)}},n.createElement("span",{class:n.const("dcg-menu-option-icon")},n.createElement("i",{class:n.const("dcg-icon-position-arrows")}),n.createElement("span",{class:function(){var e;return(e={"dcg-position-direction-icon":!0})[r.getPositionIconClass(t)]=!0,e}},n.createElement(c,{key:function(){return t}},function(e){return"default"==e?n.createElement("div",{class:n.const("dcg-default-position")}):n.createElement("i",{class:n.const("dcg-icon-position-arrows-single")})}))),n.createElement("span",{class:n.const("dcg-menu-option-label")},function(){return r.capitalizeFirst(t)}))}))),n.createElement("div",{class:n.const("dcg-label-group")},n.createElement("div",{class:n.const("dcg-label-group-title")},n.const("Font Size")),n.createElement(l,{each:this.bindFn(this.getLabelSizes)},n.createElement("div",{role:n.const("group"),"aria-label":function(){return r.controller.t("Size")},class:n.const("dcg-label-options")},function(t){return n.createElement("a",{role:n.const("button"),tabindex:n.const(0),class:function(){var e;return(e={"dcg-menu-option":!0,"dcg-menu-option-selected":r.isSizeSelected(t),"dcg-label-size":!0})[r.getSizeClass(t)]=!0,e},"aria-pressed":function(){return r.isSizeSelected(t)},onTap:function(){return r.setLabelSize(t)},"aria-label":function(){return r.capitalizeFirst(t)}},n.createElement("span",{class:n.const("dcg-menu-option-icon")},n.const("A")),n.createElement("span",{class:n.const("dcg-menu-option-label")},function(){return r.capitalizeFirst(t)}))})),n.createElement(u,{predicate:function(){return r.controller.canUseAdvancedStyling()}},function(){return n.createElement("div",{class:n.const("dcg-vertical-label-container")},n.createElement(a.Checkbox,{checked:r.bindFn(r.getVerticalLabel),onChange:r.bindFn(r.setVerticalLabel),ariaLabel:r.const("Vertical Label")},n.const("Vertical")))}))))},t.prototype.capitalizeFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.prototype.getLabelOrientations=function(){return[o.DEFAULT,o.LEFT,o.RIGHT,o.ABOVE,o.BELOW]},t.prototype.getLabelSizes=function(){return[i.SMALL,i.MEDIUM,i.LARGE]},t.prototype.getSizeClass=function(e){switch(e){case i.SMALL:return"dcg-small-label";case i.LARGE:return"dcg-large-label";case i.MEDIUM:return"dcg-medium-label"}},t.prototype.isSizeSelected=function(e){return this.model.labelSize===e},t.prototype.isorientationSelected=function(e){return this.model.labelOrientation===e},t.prototype.getPositionIconClass=function(e){switch(e){case o.ABOVE:return"dcg-position-icon-above";case o.BELOW:return"dcg-position-icon-below";case o.LEFT:return"dcg-position-icon-left";case o.RIGHT:return"dcg-position-icon-right";case o.DEFAULT:return"dcg-position-icon-default"}},t.prototype.setorientation=function(e){this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})},t.prototype.setVerticalLabel=function(e){this.controller.dispatch({type:"set-item-vertical-label",id:this.id,verticalLabel:e})},t.prototype.getVerticalLabel=function(){return!!this.model.verticalLabel},t.prototype.setLabelSize=function(e){this.controller.dispatch({type:"set-item-labelSize",id:this.id,labelSize:e})},t.prototype.getLabelSize=function(){return this.model.labelSize},t}(n.Class);t.LabelDropdownView=p}),define("loadcss!expressions/label_view",function(){}),define("expressions/label_view",["require","exports","tslib","keys","dcgview","./label-dropdown-view","jquery","loadcss!./label_view"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.Components,l=s.Input,c=s.If,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,i.createElement("div",{class:function(){return{"dcg-label-visible":t.getShowLabel(),"dcg-label-container":!0,"dcg-do-blur":!0}},tapboundary:i.const("true"),handleEvent:i.const("true")},i.createElement("span",{role:i.const("checkbox"),"aria-checked":this.bindFn(this.getShowLabel),tabindex:i.const("0"),class:function(){return{"dcg-checkbox":!0,"dcg-checkbox-checked":t.getShowLabel()}},"aria-label":function(){return t.controller.t("Label")},onTap:this.bindFn(this.onCheckboxInput)},i.createElement("span",{class:function(){return{"dcg-checkbox-box":!0,"dcg-checked":t.getShowLabel()}}},i.createElement("i",{class:i.const("dcg-icon-check")})),i.const(""),i.createElement("span",{class:i.const("dcg-checkbox-label"),"aria-hidden":i.const("true")},function(){return t.controller.t("Label")})),i.createElement(l,{class:function(){return{"dcg-label-input":!0,"dcg-disabled-input":t.getIsDisabled()}},"aria-label":function(){return t.controller.t("Label Text")},"aria-disabled":this.bindFn(this.getIsDisabled),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)}),i.createElement("span",{class:function(){return{"dcg-dropdown-container":!0,"dcg-no-label":!t.getShowLabel()}},didMount:function(e){return t.$dropdownContainer=a(e)}},i.createElement("span",{class:i.const("dcg-dropdown-wrench-container"),role:i.const("button"),tabindex:i.const(0),"aria-label":function(){return t.controller.t("Label Settings")},onTap:this.bindFn(this.toggleDropdown),selected:this.bindFn(this.showLabelDropdown),"aria-expanded":this.bindFn(this.showLabelDropdown)},i.createElement("i",{class:i.const("dcg-icon-wrench")})),i.createElement(c,{predicate:this.bindFn(this.showLabelDropdown)},function(){return i.createElement(o.LabelDropdownView,{controller:t.props.controller,model:t.props.model})})))},t.prototype.showLabelDropdown=function(){return this.model.labelDropdownOpen},t.prototype.showDropdown=function(e){var t=this,r=a(e.target);a(document).on("mousedown.dcg-"+this.id+" touchstart.dcg-"+this.id+" pointerdown.dcg-"+this.id,function(e){t.showLabelDropdown()&&(0<a(e.target).closest(t.$dropdownContainer).length||t.hideDropdown())}),a(document).on("keydown.dcg-"+this.id,function(e){n.lookup(e)===n.ESCAPE&&(t.hideDropdown(),r.focus())}),this.controller.dispatch({type:"set-item-label-dropdown-open",id:this.id,open:!0})},t.prototype.hideDropdown=function(){a(document).off(".dcg-"+this.id),this.controller.dispatch({type:"set-item-label-dropdown-open",id:this.id,open:!1})},t.prototype.toggleDropdown=function(e){this.showLabelDropdown()?this.hideDropdown():this.showDropdown(e)},t.prototype.getLabel=function(){return this.model.label||""},t.prototype.getShowLabel=function(){return!!this.model.showLabel},t.prototype.getIsDisabled=function(){return 0===this.getLabel().length&&!this.getShowLabel()},t.prototype.onLabelInput=function(e){var t=e;this.controller.dispatch({type:"set-item-label",id:this.id,label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!!t})},t.prototype.onCheckboxInput=function(){this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!this.getShowLabel()})},t}(i.Class);t.default=u}),define("loadcss!expressions/distribution_parameters_view",function(){}),define("expressions/distribution_parameters_view",["require","exports","parser","tslib","dcgview","graphing-calc/models/expression","dcgview-helpers/mathquill-view","math/distribution-spec","loadcss!./distribution_parameters_view"],function(e,t,r,n,i,o,a,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.Components.For,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.init=function(){this.focusedValues={}},t.prototype.template=function(){var r=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,i.createElement("div",{class:i.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:i.const("true"),handleEvent:i.const("true")},i.createElement(s,{each:this.bindFn(this.getListOfParameters)},i.createElement("div",null,function(t){return i.createElement("span",null,i.createElement("span",{class:i.const("dcg-parameter-name")},function(){return t},i.const(":")),i.createElement(a.default,{latex:function(){return r.getParameterDisplayLatex(t)},hasError:function(){return r.isInputInvalid(t)},isFocused:function(){return r.isInputFocused(t)},onFocusedChanged:function(e){return r.handleFocusedChanged(t,e)},placeholder:function(){return r.getDefaultValue(t)},config:r.const({}),getAriaLabel:function(){return t},getAriaPostLabel:function(){return""},onUserChangedLatex:function(e){return r.handleLatexChanged(t,e)},capExpressionSize:function(){return!!r.model.controller.getGraphSettings().config.capExpressionSize}}))})))},t.prototype.getDefaultValue=function(e){var t=o.parseToplevelFunction(this.model);if(!t)return"";var r=t.params.indexOf(e);return t.defaults[r]||""},t.prototype.getParameterDisplayLatex=function(e){var t=this.focusedValues[e];return void 0!==t?t:this.getParameterExtractedValue(e)},t.prototype.getParameterExtractedValue=function(e){var t=o.parseToplevelFunction(this.model);return t&&t.values[e]||""},t.prototype.getListOfParameters=function(){var e=o.parseToplevelFunction(this.model);return e?e.params:[]},t.prototype.isInputFocused=function(e){var t=this.controller.getFocusLocation();return!(!t||"distribution-param"!==t.type||t.id!==this.id)&&t.location===e},t.prototype.handleFocusedChanged=function(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"distribution-param",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"distribution-param",id:this.id,location:e}})},t.prototype.willUpdate=function(){for(var e in this.focusedValues)this.isInputFocused(e)||delete this.focusedValues[e]},t.prototype.isInvalidParameterLatex=function(e){return!!e&&!!r.parse(e).isError},t.prototype.isInputInvalid=function(e){var t=this.getParameterDisplayLatex(e);return this.isInvalidParameterLatex(t)},t.prototype.handleLatexChanged=function(e,t){if(this.isInputFocused(e)&&(this.focusedValues[e]=t),!this.isInvalidParameterLatex(t)){var r=this.model.latex,n=g.parseToplevelFunction(r);if(n){for(var i=n.symbol,o=n.span,a=[],s=0,l=this.getListOfParameters();s<l.length;s++){var c=l[s],u=c===e?t:this.getParameterExtractedValue(c);a.push(u)}for(;""===a[a.length-1];)a.pop();for(var p=0;p<a.length;p++){""===(u=a[p])&&n.defaults[p]&&(a[p]=n.defaults[p])}var d="\\operatorname{"+i+"}",h=0===a.length?d:d+"\\left("+a.join(",")+"\\right)";if(g.parseToplevelFunction(h)){var f=o.input.slice(0,o.start)+h+o.input.slice(o.end);this.controller.dispatch({type:"set-item-latex",id:this.model.id,latex:f})}}}},t}(i.Class);t.default=l}),define("loadcss!expressions/cdf-footer-view",function(){}),define("expressions/cdf-footer-view",["require","exports","tslib","dcgview","graphing-calc/models/expression","dcgview-helpers/mathquill-view","dcgview-helpers/checkbox","loadcss!./cdf-footer-view"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components.If,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.focusedValues={},e}return r.__extends(e,t),e.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,n.createElement("div",{class:n.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:n.const("true"),handleEvent:n.const("true")},n.createElement(a.Checkbox,{checked:function(){return i.shouldShowCDFFooter(t.model)},onChange:function(e){t.controller.dispatch({type:"set-show-cdf",id:t.model.id,showCDF:e})},ariaLabel:function(){return t.controller.t("Show Area Under Curve")}},function(){return t.controller.t("Show Area Under Curve")}),n.createElement(s,{predicate:function(){return i.shouldShowCDFFooter(t.model)}},function(){return n.createElement("div",null,n.createElement("span",{class:n.const("dcg-cdf-limit-name")},function(){return t.controller.t("CDF Min:")}),n.createElement(o.default,{latex:function(){return i.getCDFMin(t.model)},hasError:function(){return!i.isCDFMinValid(t.model)},isFocused:function(){return t.isInputFocused("min")},onFocusedChanged:function(e){return t.handleFocusedChanged("min",e)},config:t.const({}),getAriaLabel:function(){return t.controller.t("CDF Min")},getAriaPostLabel:function(){return""},onUserChangedLatex:function(e){return t.controller.dispatch({type:"set-cdf-min",id:t.model.id,latex:e})},capExpressionSize:function(){return!!t.model.controller.getGraphSettings().config.capExpressionSize}}),n.createElement("span",{class:n.const("dcg-cdf-limit-name")},function(){return t.controller.t("CDF Max:")}),n.createElement(o.default,{latex:function(){return i.getCDFMax(t.model)},hasError:function(){return!i.isCDFMaxValid(t.model)},isFocused:function(){return t.isInputFocused("max")},onFocusedChanged:function(e){return t.handleFocusedChanged("max",e)},config:t.const({}),getAriaLabel:function(){return t.controller.t("CDF Max")},getAriaPostLabel:function(){return""},onUserChangedLatex:function(e){return t.controller.dispatch({type:"set-cdf-max",id:t.model.id,latex:e})},capExpressionSize:function(){return!!t.model.controller.getGraphSettings().config.capExpressionSize}}),n.createElement("div",null,n.const("= "),function(){return i.getCDFEvaluation(t.model)}))}))},e.prototype.isInputFocused=function(e){var t=this.controller.getFocusLocation();return!(!t||"cdf-limit"!==t.type||t.id!==this.id)&&t.location===e},e.prototype.handleFocusedChanged=function(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})},e}(n.Class);t.default=l}),define("loadcss!expressions/expression-edit-actions",function(){}),define("expressions/expression-edit-actions",["require","exports","tslib","dcgview","lib/tooltip","graphing/dragmode","expressions/styles","graphing-calc/models/expression","loadcss!./expression-edit-actions"],function(e,t,r,n,i,p,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.Components.If,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.template=function(){var e=this;return n.createElement(o,{predicate:function(){return e.controller.isInEditListMode()}},function(){return n.createElement("span",{class:function(){return{"dcg-expression-edit-actions":!0,"dcg-limited-height":e.limitedHeight()}},style:function(){return{background:e.controller.getBackgroundColor()}}},n.createElement(o,{predicate:function(){return!e.controller.hasBackgroundColor()}},function(){return n.createElement("span",{class:n.const("dcg-graphic"),handleEvent:n.const("true ")})}),n.createElement(o,{predicate:e.bindFn(e.canConvertToTable)},function(){return n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Convert to Table")},gravity:e.const("s")},n.createElement("span",{class:n.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:n.const("true"),onTap:e.bindFn(e.onCreateTable)},n.createElement("i",{class:n.const("dcg-icon-table")})))}),n.createElement(o,{predicate:e.bindFn(e.canDuplicate)},function(){return n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Duplicate")},gravity:e.const("s")},n.createElement("span",{class:n.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:n.const("true"),onTap:e.bindFn(e.onDuplicateWithoutFocus)},n.createElement("i",{class:n.const("dcg-icon-duplicate")})))}),n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Delete")},gravity:e.const("sw")},n.createElement("span",{class:n.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:n.const("true"),onTap:e.bindFn(e.onDelete)},n.createElement("i",{class:n.const("dcg-icon-remove")}))))})},t.prototype.model=function(){return this.controller.getItemModel(this.props.id())},t.prototype.canConvertToTable=function(){var e=this.model();return!(!e||"expression"!==e.type||!e.isTableable)},t.prototype.canDuplicate=function(){var e=this.model();return!(!e||"expression"!==e.type||this.isSlider())},t.prototype.limitedHeight=function(){var e=this.model();return e&&("image"===e.type||this.isSlider())},t.prototype.isSlider=function(){var e=this.model();return e&&"expression"===e.type&&e.sliderExists},t.prototype.onCreateTable=function(){var e=this.model();if(e&&"expression"===e.type){var t=e.formula;if(e.isTableable){var r,n=t.table_info,i=e.index,o=[],a=[];if(n.values)for(r=0;r<n.values.length;r++){var s=n.values[r][0];o.push(s?s+"":"");var l=n.values[r][1];a.push(l?l+"":"")}else for(r=-2;r<=2;r++)o.push(r+""),a.push("");var c={id:this.controller.generateId(),type:"table",columns:[{id:this.controller.generateId(),latex:n.independent_variable,color:this.controller.getNextColor(),hidden:!1,values:o,points:!0,lines:!1,dragMode:p.NONE,pointStyle:d.POINT,lineStyle:d.SOLID},{id:this.controller.generateId(),latex:n.dependent_column,color:e.color,hidden:!1,values:a,points:!0,lines:!(h.isPointOrPointList(e)||e.hidden),dragMode:p.NONE,pointStyle:d.POINT,lineStyle:d.SOLID}]},u=this.controller;this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1}),n.by_reference?this.controller.dispatch({type:"insert-item-at-index",index:i+1,state:c,folderId:e.folderId,focus:!0}):this.controller.dispatch({type:"replace-item-at-index",index:i,state:c,focus:!0});this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("Table created."),undoCallback:function(){u.dispatch({type:"undo"}),u.dispatch({type:"set-edit-list-mode",isEditListMode:!0})}}})}}},t.prototype.onDelete=function(){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id()})},t.prototype.onDuplicateWithoutFocus=function(){this.controller.dispatch({type:"duplicate-expression",id:this.props.id()})},t}(n.Class);t.ExpressionEditActions=a}),define("loadcss!expressions/expression-footer",function(){}),define("expressions/expression_view",["require","exports","config","tslib","browser","./abstract-item-view","dcgview-helpers/mathquill-view","lib/conditional_blur","./expression-icon-view","./evaluation-view","expressions/unresolved_view","expressions/domain_view","expressions/regression_view","expressions/slider_view","expressions/slider_speed_view","expressions/promptslider_view","expressions/label_view","expressions/distribution_parameters_view","expressions/cdf-footer-view","graphing-calc/models/expression","graphing/label","./expression-edit-actions","dcgview","jquery.handleevent","loadcss!./expression-footer"],function(e,t,r,n,i,o,a,s,l,c,u,p,d,h,f,g,m,y,v,b,x,w,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=_.Components,E=S.If,M=S.Switch,I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted(),clearTimeout(this.dispatchBlurTimeout)},t.prototype.didUpdate=function(){var e=this;this.isFocused()&&(this.wasMainLatexFocusedThisFrame=!0),clearTimeout(this.dispatchBlurTimeout),this.dispatchBlurTimeout=setTimeout(function(){e.wasMainLatexFocusedThisFrame=e.isFocused(),e.update()},0)},t.prototype.template=function(){var r=this;return _.createElement("div",{class:function(){return{"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!r.model.folderId,"dcg-selected":r.controller.isItemSelected(r.id),"dcg-dragging":!!r.controller.isItemBeingDragged(r.id),"dcg-isPlaying":r.isSliderPlaying(),"dcg-hasSlider":r.hasSlider(),"dcg-hasEvaluation":r.controller.shouldShowEvaluationForItem(r.id),"dcg-hasRegression":r.hasRegression(),"dcg-hasDomain":r.hasDomain()}},"expr-id":function(){return r.model.id}},_.createElement("div",{class:_.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},_.createElement("div",{class:_.const("dcg-main")},_.createElement(a.default,{latex:function(){return b.getDisplayLatex(r.model)},getAriaLabel:this.bindFn(this.getAriaLabel),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:function(){return r.isFocused()},capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},config:this.const({}),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey(e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged(e)},onFocusedChanged:function(e){return r.handleMQFocusedChanged(e)}},_.createElement("div",{class:_.const("dcg-expression-mathquill")}))),_.createElement("i",{class:_.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:_.const("true"),onTap:this.bindFn(this.onDelete)}),_.createElement(E,{predicate:this.bindFn(this.hasSlider)},function(){return _.createElement(f.default,{model:r.props.model,controller:r.props.controller})}),_.createElement(E,{predicate:this.bindFn(this.shouldShowFooter)},function(){return _.createElement("div",{class:r.getFooterClass()},_.createElement(M,{key:r.bindFn(r.getFooterType)},function(e){switch(e){case"regression":return _.createElement(d.default,{model:r.props.model,controller:r.props.controller});case"label":return _.createElement(m.default,{model:r.props.model,controller:r.props.controller});case"slider":return _.createElement(h.default,{model:r.props.model,controller:r.props.controller,forceLimitInputsVisible:r.bindFn(r.shouldForceSliderLimitInputs)});case"domain":return _.createElement(p.default,{model:r.props.model,controller:r.props.controller});case"evaluation":return _.createElement(c.default,{id:function(){return r.props.model().id},dependent:function(){return r.model.dependent||""},val:function(){return r.controller.getEvaluationValueForItem(r.id)},controller:r.props.controller});case"toplevel-function":return _.createElement("div",null,_.createElement(y.default,{model:r.props.model,controller:r.props.controller}),_.createElement(E,{predicate:function(){return r.showCDFFooter()}},function(){return _.createElement(v.default,{model:r.props.model,controller:r.props.controller})}));case"unresolved":return _.createElement(u.default,{controller:r.props.controller});default:return _.createElement("span",null)}}),_.createElement(E,{predicate:r.bindFn(r.shouldShowSliderPrompt)},function(){return _.createElement(g.default,{model:r.props.model,controller:r.props.controller})}))})),_.createElement("span",{class:_.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:_.const("true"),tapboundary:_.const("true"),disablescroll:_.const("true"),style:_.const("touch-action:none"),onTapStart:this.bindFn(this.onDragPending)},_.createElement("span",{class:_.const("dcg-num")},function(){return r.model.displayIndex}),_.createElement("div",{class:_.const("dcg-tab-interior dcg-action-icon-mouse")},_.createElement(l.default,{model:this.props.model,controller:this.props.controller}))),_.createElement(w.ExpressionEditActions,{controller:this.props.controller,id:function(){return r.model.id}}))},t.prototype.shouldShowFooter=function(){return!!this.shouldShowSliderPrompt()||!!this.getFooterType()},t.prototype.getFooterType=function(){return this.hasRegression()?"regression":this.shouldShowLabelView()?"label":this.hasSlider()?"slider":this.hasDomain()?"domain":this.controller.shouldShowEvaluationForItem(this.id)?"evaluation":this.isToplevelFunction()?"toplevel-function":this.model.unresolved?"unresolved":void 0},t.prototype.getFooterClass=function(){return this.isFirstRender()?this.const("dcg-expression-bottom"):this.const("dcg-expression-bottom dcg-fadein-bottom")},t.prototype.onCreateSliders=function(e){this.controller.dispatch({type:"create-sliders-for-item",id:this.id,variables:e})},t.prototype.shouldShowLabelView=function(){return r.get("labels")&&b.isPointOrPointList(this.model)},t.prototype.shouldShowSliderPrompt=function(){return 0<this.model.missingVariables.length},t.prototype.hasRegression=function(){return!(!this.model.formula||!this.model.formula.is_regression)},t.prototype.hasDomain=function(){return b.hasDomain(this.model)},t.prototype.isToplevelFunction=function(){return b.isToplevelFunction(this.model)},t.prototype.showCDFFooter=function(){return b.shouldShowCDFCheckbox(this.model)},t.prototype.hasSlider=function(){return!!this.model.sliderExists},t.prototype.isSliderPlaying=function(){return!(!this.model.sliderExists||!this.model.slider.isPlaying)},t.prototype.getLabelOptions=function(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)},t.prototype.getAriaLabel=function(){var e;return this.shouldShowLabelView()?(e=this.model.label&&""!==this.model.label?this.model.label:this.controller.t("Label"),this.model.showLabel?e:this.controller.t("Hidden __label__",{label:e})):this.controller.t("Expression __index__",{index:this.model.displayIndex})},t.prototype.getFormulaAria=function(){var e=this.model.formula,t="";if(!e)return t;if(b.isEmpty(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.id)){t="equals ";var r=e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.constant_value;t+=Array.isArray(r)?r.length+" element list.":x.truncatedAriaLabel(r,this.getLabelOptions())}else e.error&&!this.shouldShowSliderPrompt()?t=this.controller.unpack(e.error):this.model.shouldGraph&&(e.is_graphable||e.is_regression)&&(t=e.is_graphable&&e.is_regression?this.controller.t("Has graph and regression. To access statistics, press Tab."):e.is_regression?this.controller.t("Has regression. To access statistics, press Tab."):this.controller.t("Has graph."),e.is_graphable&&(t+=i.IS_APPLE?this.controller.t(" To audio trace, press OPTION+T."):this.controller.t(" To audio trace, press ALT+T.")));return t},t.prototype.handlePressedKey=function(e,t){var r=a.default.getFocusedMathquill();if(r){if("Esc"===e)return s.default(),void(this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}}));if("Up"===e||"Down"===e)return a.default.applyArrowKeyAndReturnIfWasAtBounds(r,e,t)?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0;if("Delete"===e||"Backspace"===e){if(b.isEmpty(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if("Enter"===e)return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});r.keystroke(e,t),this.handleLatexChanged(r.latex())}},t.prototype.handleLatexChanged=function(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e})},t.prototype.handleMQFocusedChanged=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})},t.prototype.shouldForceSliderLimitInputs=function(){return!!this.isFocused()||!this.isSliderThumbFocused()&&!!this.wasMainLatexFocusedThisFrame},t.prototype.onMouseSelect=function(e){"keyboard"!==e.device&&("dcg-tap"===e.type&&"mouse"===e.device||"dcg-tapstart"===e.type&&"touch"===e.device||this.controller.isInEditListMode()||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))},t.prototype.isFocused=function(){var e=this.controller.getFocusLocation();return!!e&&"expression"===e.type&&e.id===this.id},t.prototype.isSliderThumbFocused=function(){var e=this.controller.getFocusLocation();return!!e&&"slider-thumb"===e.type&&e.id===this.id},t}(o.default);t.default=I}),define("loadcss!expressions/smart_textarea",function(){}),define("expressions/smart_textarea",["require","exports","tslib","keys","browser","dcgview","jquery","lib/conditional_blur","jquery.handleevent","loadcss!./smart_textarea"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o.Components.Textarea,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return o.createElement("div",{class:o.const("dcg-smart-textarea-container")},o.createElement("div",{class:o.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),o.createElement(l,{class:function(){return{"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!e.props.text()}},"aria-label":function(){return e.props.ariaLabel?e.props.ariaLabel():void 0},placeholder:this.props.placeholder,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeydown:this.bindFn(this.onKeydownEvent)}))},t.prototype.getDisplayTextHTML=function(){var e=this.props.text()||"";if(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),!this.props.showLinks())return e;return e.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target ='_blank'>$1</a>")},t.prototype.willUnmount=function(){this.textareaNode=void 0},t.prototype.didMountDisplay=function(e){this.displayNode=e,a(e).on("touchend",function(e){e.preventDefault()}),a(e).on("dcg-tap dcg-tapstart","a",function(e){e.handle()}),this.renderDisplayText()},t.prototype.didMountTextarea=function(e){var t=this;this.textareaNode=e,a(e).on("dcg-tapstart",function(e){e.handle()}),a(e).on("focusin focusout",function(){return t.onFocusEvent()}),this.updateFocused()},t.prototype.didUpdate=function(){this.updateFocused(),this.renderDisplayText()},t.prototype.onFocusEvent=function(){if(this.textareaNode){var e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}},t.prototype.renderDisplayText=function(){if(this.displayNode){var e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}},t.prototype.isFocused=function(){return document.activeElement===this.textareaNode},t.prototype.shouldBeFocused=function(){return this.props.shouldFocus()},t.prototype.updateFocused=function(){if(this.textareaNode){var e=this.isFocused(),t=this.shouldBeFocused();if(e!==t)if(t){if(i.IS_IPAD&&i.IS_IN_IFRAME)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}else this.textareaNode.blur()}},t.prototype.onKeydownEvent=function(e){var t=this.textareaNode;if(t){var r=n.lookup(e);r!==n.ENTER||e.metaKey?r===n.ESCAPE?s.default():r===n.UP?0===t.selectionStart&&0===t.selectionEnd&&(e.preventDefault(),this.props.onSpecialKey("Up")):r===n.DOWN?t.selectionStart===t.value.length&&t.selectionEnd===t.value.length&&(e.preventDefault(),this.props.onSpecialKey("Down")):r===n.BACKSPACE?0===t.value.length&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):r===n.DELETE&&0===t.value.length&&(e.preventDefault(),this.props.onSpecialKey("Delete")):(e.preventDefault(),this.props.onSpecialKey("Enter")),this.props.onKeydown&&this.props.onKeydown(e)}},t}(o.Class);t.default=c}),define("expressions/text_view",["require","exports","tslib","./abstract-item-view","./smart_textarea","dcgview","./expression-edit-actions","jquery.handleevent"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted()},t.prototype.template=function(){var e=this;return o.createElement("div",{class:function(){return{"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-expressiontext":!0,"dcg-inFolder":!!e.model.folderId,"dcg-selected":!!e.controller.isItemSelected(e.id),"dcg-dragging":!!e.controller.isItemBeingDragged(e.id)}},"expr-id":function(){return e.model.id},onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},o.createElement("div",{class:o.const("dcg-fade-container")},o.createElement("div",{class:o.const("dcg-main")},o.createElement(i.default,{shouldFocus:this.bindFn(this.isFocused),text:function(){return e.model.text},placeholder:function(){return e.controller.t("Enter a note...")},showLinks:function(){return e.controller.areLinksEnabled()},onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey)})),o.createElement("i",{class:o.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:o.const("true"),onTap:this.bindFn(this.onDelete)})),o.createElement("span",{class:o.const("dcg-tab dcg-action-drag"),handleevent:o.const("true"),tapboundary:o.const("true"),disablescroll:o.const("true"),style:o.const("touch-action:none"),onTapStart:this.bindFn(this.onDragPending)},o.createElement("span",{class:o.const("dcg-num")},function(){return e.model.displayIndex}),o.createElement("div",{class:o.const("dcg-tab-interior")}),o.createElement("i",{class:o.const("dcg-icon-text")})),o.createElement(a.ExpressionEditActions,{controller:this.props.controller,id:function(){return e.model.id}}))},t.prototype.onInput=function(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})},t.prototype.onFocusChange=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})},t.prototype.onSpecialKey=function(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})},t.prototype.isFocused=function(){var e=this.controller.getFocusLocation();return!(!e||"text"!==e.type||e.id!==this.id)},t}(n.default);t.default=s}),define("expressions/tables/table_column_menu_view",["require","exports","tslib","dcgview","expressions/color-menu","graphing/dragmode","expressions/styles","expressions/toggle-view","../circular-icon-view"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.Components,u=c.For,p=c.If,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.columnId=this.model.id,this.tableModel=this.model.table,this.tableId=this.tableModel.id,n.createElement("div",{class:n.const("dcg-table-column-menu dcg-options-menu")},n.createElement("div",{class:n.const("dcg-triangle")}),n.createElement("div",{class:n.const("dcg-options-menu-column-left")},n.createElement("div",{class:n.const("dcg-options-menu-section")},n.createElement("span",{class:n.const("dcg-toggle-title")},function(){return t.controller.t("Points")}),n.createElement(s.default,{toggled:function(){return t.model.points},onChange:function(){return t.onTogglePoints(!t.model.points)}}),n.createElement(p,{predicate:function(){return t.model.points}},function(){return n.createElement(u,{each:function(){return t.controller.getPointStyles()}},n.createElement("div",{class:n.const("dcg-style-icons")},function(e){return n.createElement("div",{class:n.const("dcg-style-icon-container"),onTap:function(){return t.onPointStyleSelected(e)}},n.createElement(l.CircularIconView,{backgroundColor:function(){return t.model.color},semiTransparent:function(){return t.model.pointStyle!==e},iconType:function(){return"CROSS"===e?"point-cross":"OPEN"===e?"point-open":"point-default"}}))}))})),n.createElement("div",{class:n.const("dcg-options-menu-section")},n.createElement("span",{class:n.const("dcg-toggle-title")},function(){return t.controller.t("Lines")}),n.createElement(s.default,{toggled:function(){return t.model.lines},onChange:function(){return t.onToggleLines(!t.model.lines)}}),n.createElement(p,{predicate:function(){return t.model.lines}},function(){return n.createElement("div",{class:n.const("dcg-line-options")},n.createElement(u,{each:function(){return t.controller.getLineStyles()}},n.createElement("div",{class:n.const("dcg-style-icons")},function(e){return n.createElement("div",{class:n.const("dcg-style-icon-container"),onTap:function(){return t.onLineStyleSelected(e)}},n.createElement(l.CircularIconView,{backgroundColor:function(){return t.model.color},semiTransparent:function(){return t.model.lineStyle!==e},iconType:function(){return"DOTTED"===e?"graph-dotted":"DASHED"===e?"graph-dashed":"graph-default"}}))})))})),n.createElement(p,{predicate:function(){return t.model.draggable}},function(){return n.createElement("div",{class:n.const("dcg-drag-div dcg-options-menu-section")},n.createElement("span",{class:n.const("dcg-toggle-title")},function(){return t.controller.t("Drag")}),n.createElement(s.default,{toggled:function(){return t.model.dragMode!==o.NONE},onChange:function(){return t.onToggleDrag()}}),n.createElement(p,{predicate:function(){return t.model.dragMode!==o.NONE}},function(){return n.createElement(u,{each:function(){return t.controller.getUIDragModes()}},n.createElement("div",{class:n.const("dcg-style-icons")},function(e){return n.createElement("div",{class:n.const("dcg-style-icon-container"),onTap:function(){return t.onDragModeSelected(e)}},n.createElement(l.CircularIconView,{backgroundColor:function(){return t.model.color},semiTransparent:function(){return t.model.dragMode!==e},iconType:function(){return"X"===e?"movable-horizontal":"Y"===e?"movable-vertical":"movable-both"}}))}))}))})),n.createElement("div",{class:n.const("dcg-options-menu-column-right")},n.createElement("div",{class:n.const("dcg-colors-div dcg-options-menu-section")},n.createElement("div",{class:n.const("dcg-toggle-title")},function(){return t.controller.t("Color")}),n.createElement(i.default,{controller:function(){return t.props.controller()},selectedColor:function(){return t.model.color},onColorSelected:this.bindFn(this.onColorSelected)}))))},t.prototype.getPointStyleClass=function(e){switch(e){case a.CROSS:return"dcg-graph-CROSS";case a.OPEN:return"dcg-graph-OPEN";default:return"dcg-graph-POINT"}},t.prototype.getLineStyleClass=function(e){switch(e){case a.DASHED:return"dcg-graph-DASHED";case a.DOTTED:return"dcg-graph-DOTTED";default:return"dcg-graph-SOLID"}},t.prototype.onColorSelected=function(e){this.controller.dispatch({type:"set-tablecolumn-color",tableId:this.tableId,columnId:this.columnId,color:e})},t.prototype.onTogglePoints=function(e){this.controller.dispatch({type:"set-tablecolumn-points",tableId:this.tableId,columnId:this.columnId,bool:e})},t.prototype.onPointStyleSelected=function(e){this.controller.dispatch({type:"set-tablecolumn-pointstyle",tableId:this.tableId,columnId:this.columnId,pointStyle:e})},t.prototype.onToggleLines=function(e){this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.tableId,columnId:this.columnId,bool:e})},t.prototype.onLineStyleSelected=function(e){this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.tableId,columnId:this.columnId,lineStyle:e})},t.prototype.onToggleDrag=function(){var e=this.columnId,t=this.tableId,r=this.model.dragMode===o.NONE?o.XY:o.NONE;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:t,columnId:e,dragMode:r})},t.prototype.onDragModeSelected=function(e){var t=this.columnId,r=this.tableId;this.model.dragMode!==e&&this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:r,columnId:t,dragMode:e})},t}(n.Class);t.default=d}),define("expressions/tables/table_icon_view",["require","exports","tslib","dcgview","expressions/abstract_icon_view","./table_column_menu_view","dcgview-helpers/tooltipped-error","../circular-icon-view","jquery.handleevent"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.Components.Switch,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.model=this.props.model()},t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-table-icon-container")},n.createElement(l,{key:this.bindFn(this.typeOfIcon)},function(e){switch(e){case"error":return n.createElement(a.TooltippedError,{error:function(){return t.controller.unpack(t.model.error)},gravity:t.const("se")});case"none":return n.createElement("span",null);case"icon":return n.createElement("div",{class:n.const("dcg-circular-icon-container"),role:n.const("button"),handleevent:n.const("true"),onTap:function(e){if(!e.wasHandled("dragdrop")&&!e.wasLongheld())return t.optionsShown?t.toggleOptions():t.controller.isInEditListMode()?t.toggleOptions():void t.toggleGraphShown()},didMount:function(e){return t.rootElt=e},onLongHold:function(e){e.handle("dcg-longhold"),e.handle("dcg-tap"),t.toggleOptions()}},n.createElement(s.CircularIconView,{iconType:t.bindFn(t.getIcon),backgroundColor:function(){return t.model.color}}));default:return e}}))},t.prototype.didUpdate=function(){this.optionsMenu&&this.optionsMenu.update()},t.prototype.didMountRoot=function(e){this.rootElt=e},t.prototype.createOptionsMenuView=function(){var e=this.getOptionsMenuContainerSelector();return n.mountToNode(o.default,e[0],{controller:this.props.controller,model:this.props.model})},t.prototype.toggleGraphShown=function(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})},t.prototype.hasError=function(){return!!this.model.error},t.prototype.getIcon=function(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"},t.prototype.typeOfIcon=function(){return""===this.model.latex?"none":this.controller.getGraphSettings().config.graphpaper?this.model.error?"error":0===this.model.index?"none":"icon":"none"},t}(i.default);t.default=c}),define("expressions/tables/header-view",["require","exports","tslib","browser","dcgview","./table_icon_view","dcgview-helpers/mathquill-view","underscore","graphing-calc/models/table","graphing/dragmode"],function(e,t,r,n,i,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.Components.If,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table},t.prototype.isRightSide=function(){return this.lookupCellPosition().column>=this.table.columnModels.length-1},t.prototype.template=function(){var r=this;return i.createElement("div",{role:i.const("columnheader"),class:function(){return{"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":0===r.model.index,"dcg-right":r.isRightSide(),"dcg-selected":r.shouldFocus(),"dcg-error":!!r.model.error}},index:function(){return r.model.index},onTapStart:this.bindFn(this.focusThisCell)},i.createElement("div",{class:i.const("dcg-inner-border")}),i.createElement(u,{predicate:function(){return!r.isRightSide()}},function(){return i.createElement(o.default,{model:r.props.model,controller:r.props.controller})}),i.createElement(a.default,{latex:function(){return r.model.latex||""},isFocused:this.bindFn(this.shouldFocus),capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},config:this.const({}),getAriaLabel:this.bindFn(this.getAriaLabel),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey(e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged(e)},onFocusedChanged:function(e){return r.handleMQFocusedChanged(e)},selectOnFocus:this.const(!0)},i.createElement("span",{class:i.const("dcg-math-field dcg-cell-math-content")})),i.createElement(u,{predicate:function(){return r.model.dragMode!==c.NONE&&!r.model.error}},function(){return i.createElement("span",{class:i.const("dcg-drag-icon"),"dcg-drag-mode":function(){return r.model.dragMode},style:function(){return{color:r.model.color}}},i.createElement("i",{class:function(){return{"dcg-icon-move":r.model.dragMode===c.XY,"dcg-icon-move-horizontal":r.model.dragMode===c.X,"dcg-icon-move-vertical":r.model.dragMode===c.Y}}}))}),i.createElement("div",{class:i.const("dcg-empty-line")}),i.createElement(u,{predicate:function(){return r.isRightSide()}},function(){return i.createElement("span",{class:i.const("dcg-fade-right")})}))},t.prototype.focusThisCell=function(e){e.wasHandled()||(e.handle(),this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))},t.prototype.lookupCellPosition=function(){return{row:0,column:this.model.index}},t.prototype.getAriaLabel=function(){var e=this.lookupCellPosition();return this.controller.t("Column header __column__",{column:e.column+1})},t.prototype.getAriaPostLabel=function(){var e="",t=this.model;return t.shouldGraph&&(t.points||t.lines)&&!l.isColumnEmpty(t)&&(e=this.controller.t("Has graph."),e+=n.IS_APPLE?" "+this.controller.t("To audio trace, press OPTION+T."):" "+this.controller.t(" To audio trace, press ALT+T.")),e},t.prototype.handlePressedKey=function(e,t){var r=a.default.getFocusedMathquill();r&&(a.default.handleKeystrokeAndDecideIfSpecialEvent(r,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(r.latex()))},t.prototype.handleLatexChanged=function(e){this.model.latex!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})},t.prototype.shouldFocus=function(){return s.isEqual(this.lookupCellPosition(),l.getSelectedCell(this.table))},t.prototype.handleMQFocusedChanged=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})},t}(i.Class);t.default=p}),define("expressions/tables/cell-view",["require","exports","tslib","keys","dcgview","dcgview-helpers/mathquill-view","dcgview-helpers/static-mathquill-view","underscore","graphing-calc/models/table","../../dcgview-helpers/tooltipped-error"],function(e,t,r,n,i,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.Components.If,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.column.table},t.prototype.template=function(){var r=this;return i.createElement("div",{role:i.const("gridcell"),class:function(){return{"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":r.isEmpty(),"dcg-non-editable":!!r.model.column.disabled,"dcg-error":!!r.hasError(),"dcg-selected":r.shouldFocus()}},onTapStart:this.bindFn(this.focusThisCell)},i.createElement("div",{class:i.const("dcg-inner-border")}),i.createElement(u,{predicate:this.bindFn(this.hasError)},function(){return i.createElement("span",{class:i.const("dcg-table-icon-error-container")},i.createElement(c.TooltippedError,{error:r.bindFn(r.getErrorMessage),gravity:r.const("se"),size:r.const("small")}))}),i.createElement(u,{predicate:function(){return!!r.model.column.disabled}},function(){return i.createElement(a.default,{getAriaLabel:r.bindFn(r.getAriaLabel),latex:function(){return r.getValue()}},i.createElement("span",{class:i.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"),tabindex:function(){return r.isEmpty()?-1:0},onKeyDown:r.bindFn(r.handleKeydownOnReadonlyCell),manageFocus:r.const({shouldBeFocused:r.bindFn(r.shouldFocusReadonlyCell),onFocusedChanged:r.bindFn(r.handleFocusedChanged)})}))}),i.createElement(u,{predicate:function(){return!r.model.column.disabled}},function(){return i.createElement(o.default,{latex:function(){return r.getValue()},isFocused:r.bindFn(r.shouldFocusEditableCell),capExpressionSize:function(){return!!r.controller.getGraphSettings().config.capExpressionSize},config:r.const({}),getAriaLabel:r.bindFn(r.getAriaLabel),getAriaPostLabel:r.bindFn(r.getErrorMessage),hasError:r.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey(e,t)},onUserChangedLatex:function(e){return r.handleLatexChanged(e)},onFocusedChanged:function(e){return r.handleFocusedChanged(e)},selectOnFocus:r.const(!0)},i.createElement("span",{class:i.const("dcg-math-field dcg-cell-math-content")}))}),i.createElement("div",{class:i.const("dcg-empty-line")}))},t.prototype.focusThisCell=function(e){e.wasHandled()||(e.handle(),this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))},t.prototype.handlePressedKey=function(e,t){var r=o.default.getFocusedMathquill();r&&(o.default.handleKeystrokeAndDecideIfSpecialEvent(r,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(r.latex()))},t.prototype.handleKeydownOnReadonlyCell=function(e){var t=n.lookup(e);"Tab"!==t&&(e.preventDefault(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))},t.prototype.handleLatexChanged=function(e){this.getValue()!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})},t.prototype.shouldFocus=function(){return s.isEqual(this.lookupCellPosition(),l.getSelectedCell(this.table))},t.prototype.shouldFocusReadonlyCell=function(){return!!this.model.column.disabled&&this.shouldFocus()},t.prototype.shouldFocusEditableCell=function(){return!this.model.column.disabled&&this.shouldFocus()},t.prototype.handleFocusedChanged=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})},t.prototype.lookupCellPosition=function(){return{row:this.model.row.index,column:this.model.column.index}},t.prototype.getPackedError=function(){return this.model.column.packedErrors[this.model.row.index-1]},t.prototype.hasError=function(){return!!this.getPackedError()},t.prototype.getErrorMessage=function(){var e=this.getPackedError();return e?this.controller.unpack(e):""},t.prototype.getValue=function(){var e=this.model.column.index,t=this.model.row.index-1;return this.model.column.disabled?this.model.column.computedValues[t]||"":this.table.columns[e].values[t]||""},t.prototype.isEmpty=function(){return""===this.getValue()},t.prototype.getAriaLabel=function(){var e=this.lookupCellPosition(),t=e.row,r=e.column+1;return this.controller.t("Row __row__ Col __column__",{row:t.toString(),column:r.toString()})},t}(i.Class);t.default=p}),define("loadcss!expressions/table-view",function(){}),define("expressions/table-view",["require","exports","tslib","keys","lib/aria","./abstract-item-view","dcgview","./tables/header-view","./tables/cell-view","lib/conditional_blur","graphing-calc/models/table","vendor/mathquill","jquery","./expression-edit-actions","loadcss!./table-view","jquery.handleevent"],function(e,t,r,n,i,o,a,s,l,c,u,p,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.Components.For,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted()},t.prototype.template=function(){var t=this;return a.createElement("div",{class:function(){return{"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-inFolder":!!t.model.folderId,"dcg-selected":!!t.controller.isItemSelected(t.id),"dcg-dragging":!!t.controller.isItemBeingDragged(t.id),"dcg-no-faded-h":t.isRightFocused(),"dcg-no-faded-v":t.isBottomFocused()}},"expr-id":function(){return t.model.id},onTapStart:this.bindFn(this.onMouseSelect),didMount:this.bindFn(this.didMountContainer),onKeydown:this.bindFn(this.onKeydown)},a.createElement("div",{class:a.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},a.createElement("div",{class:a.const("dcg-main")},a.createElement("div",{class:a.const("dcg-table-container"),didMount:this.bindFn(this.didMountContainer)},a.createElement("div",{class:a.const("dcg-table-sliding-container"),style:function(){return{transform:"translateX("+t.computeScrolledX()+"px)"}}},a.createElement(f,{each:function(){return t.model.rowModels},key:function(e){return e.guid}},a.createElement("div",{role:a.const("grid"),class:function(){return{"dcg-tabledata":!0,"dcg-focus-in-bottom-row":t.isBottomFocused(),"dcg-focus-in-right-column":t.isRightFocused()}}},function(e){return a.createElement(f,{each:function(){return e.cells},key:function(e){return e.guid}},a.createElement("tr",{role:a.const("row"),"aria-rowindex":function(){return e.index},class:a.const("dcg-row")},function(e){return"header"===e.type?a.createElement(s.default,{controller:t.props.controller,model:t.const(e)}):a.createElement(l.default,{controller:t.props.controller,model:t.const(e)})}))}))))),a.createElement("i",{class:a.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:a.const("true"),onTap:this.bindFn(this.onDelete)})),a.createElement("span",{class:a.const("dcg-tab dcg-action-drag"),handleevent:a.const("true"),tapboundary:a.const("true"),disablescroll:a.const("true"),style:a.const("touch-action:none"),onTapStart:this.bindFn(this.onDragPending)},a.createElement("span",{class:a.const("dcg-num")},function(){return t.model.displayIndex}),a.createElement("div",{class:a.const("dcg-tab-interior")})),a.createElement(h.ExpressionEditActions,{controller:this.props.controller,id:function(){return t.model.id}}))},t.prototype.didMountContainer=function(e){this.node=e,d(e).on("scroll",function(){return e.scrollLeft=0})},t.prototype.getSelectedCell=function(){return u.getSelectedCell(this.model)},t.prototype.computeScrolledX=function(){if(!this.getSelectedCell()||!this.node)return 0;var e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(null===e||null===t)return 0;var r=this.node.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.left-e.getBoundingClientRect().left,o=r.width-i-n.width-80,a=Math.min(0,r.width-e.scrollWidth-30);return o=Math.max(o,a),Math.min(0,o)},t.prototype.onMouseSelect=function(e){"dcg-tap"===e.type&&"mouse"===e.device||"dcg-tapstart"===e.type&&"touch"===e.device||e.wasHandled()||(e.handle(),c.default(),this.controller.dispatch({type:"set-selected-id",id:this.id}))},t.prototype.isBottomFocused=function(){var e=this.getSelectedCell();return!!e&&e.row===this.model.columnModels[0].cells.length},t.prototype.isRightFocused=function(){var e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1},t.prototype.isFocused=function(){return!!this.getSelectedCell()},t.prototype.onKeydown=function(e){!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||("Up"===n.lookup(e)?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):"Down"===n.lookup(e)?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):"Left"===n.lookup(e)?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):"Right"===n.lookup(e)?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):"H"===n.lookupChar(e)&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))},t.prototype.moveToFirstCellInColumn=function(){var e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})},t.prototype.moveToLastCellInColumn=function(){var e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:this.model.rowModels.length-1,column:e.column}}})},t.prototype.moveToFirstCellInRow=function(){var e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})},t.prototype.moveToLastCellInRow=function(){var e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:this.model.columnModels[0].cells.length-1}}})},t.prototype.speakColumnHeader=function(){var e=this.controller.t("No column header"),t=this.getSelectedCell();if(t){var r=this.model.rowModels[0].cells[t.column];if(r&&"header"===r.type&&r.latex&&""!==r.latex)e=p.MQ.StaticMath(d("<span>"+r.latex+"</span>")[0]).mathspeak()}i.alert(e)},t}(o.default);t.default=g}),define("loadcss!expressions/folder-view",function(){}),define("expressions/folder-view",["require","exports","tslib","browser","keys","lib/aria","./expression-edit-actions","./abstract-item-view","./smart_textarea","dcgview","./circular-icon-view","jquery.handleevent","loadcss!./folder-view"],function(e,t,r,n,i,o,a,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted()},t.prototype.template=function(){var e=this;return c.createElement("div",{class:function(){return{"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-expressionfolder":!0,"dcg-inFolder":!!e.model.folderId,"dcg-selected":e.controller.isItemSelected(e.id),"dcg-dragging":!!e.controller.isItemBeingDragged(e.id),"dcg-collapsed":!!e.model.collapsed,"dcg-hidden":!!e.model.hidden,"dcg-has-items":0<e.controller.getNumberOfItemsInFolder(e.id),"dcg-secretFolder":e.model.secret&&!e.controller.canAdministerSecretFolders()}},"expr-id":function(){return e.model.id},onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},c.createElement("div",{class:c.const("dcg-fade-container")},c.createElement("div",{class:c.const("dcg-main")},c.createElement("div",{role:c.const("button"),tabindex:c.const("0"),"aria-pressed":function(){return e.model.collapsed},"aria-label":function(){return e.controller.t("Collapse Folder")},class:c.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:c.const("true"),onTap:this.bindFn(this.toggleCollapsed)},c.createElement("i",{class:c.const("dcg-icon-caret-down")})),c.createElement(l.default,{shouldFocus:this.bindFn(this.isFocused),text:function(){return e.model.title},placeholder:function(){return e.controller.t("Enter a note...")},showLinks:function(){return e.controller.areLinksEnabled()},onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel)}),c.createElement("div",{role:c.const("checkbox"),"aria-checked":function(){return e.model.secret},"aria-label":function(){return e.controller.t("Hide this folder from students")},class:function(){return{"dcg-action-toggle-secret-folder":!0,"dcg-do-not-blur":!0,"dcg-checked":e.model.secret}},style:function(){return{display:e.controller.canAdministerSecretFolders()?void 0:"none"}},handleEvent:c.const("true"),onTap:this.bindFn(this.toggleSecret)},c.createElement("span",{class:c.const("dcg-checkbox-box")},c.createElement("i",{class:c.const("dcg-icon-check")})),c.createElement("span",{class:c.const("dcg-checkbox-label")},function(){return e.controller.t("Hide this folder from students.")}))),c.createElement("i",{class:c.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:c.const("true"),onTap:this.bindFn(this.onDelete)})),c.createElement("span",{class:c.const("dcg-tab dcg-action-drag"),handleevent:c.const("true"),tapboundary:c.const("true"),disablescroll:c.const("true"),style:c.const("touch-action:none"),onTapStart:this.bindFn(this.onDragPending)},c.createElement("span",{class:c.const("dcg-num")},function(){return e.model.displayIndex}),c.createElement("div",{class:c.const("dcg-tab-interior")},c.createElement("span",{role:c.const("button"),tabindex:c.const("0"),"aria-pressed":function(){return!!e.model.hidden},"aria-label":function(){return e.controller.t("Hide Folder")},class:c.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},c.createElement(u.CircularIconView,{iconType:function(){return e.model.hidden?"hidden":"folder"},whiteIcon:function(){return e.controller.isItemSelected(e.model.id)||e.controller.isItemBeingDragged(e.model.id)}})))),c.createElement(a.ExpressionEditActions,{controller:this.props.controller,id:function(){return e.model.id}}))},t.prototype.toggleHidden=function(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})},t.prototype.toggleSecret=function(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})},t.prototype.toggleCollapsed=function(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})},t.prototype.onInput=function(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})},t.prototype.onFocusChange=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})},t.prototype.onSpecialKey=function(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})},t.prototype.onKeydown=function(e){var t=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey,r=e.metaKey&&!e.altKey&&!e.shiftKey&&!e.ctrlKey;(n.IS_APPLE?r:t)&&i.lookup(e)===i.UP&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed}),this.model.collapsed?o.alert(this.controller.t("folder collapsed")):o.alert(this.controller.t("folder expanded")))},t.prototype.isFocused=function(){var e=this.controller.getFocusLocation();return!(!e||"folder"!==e.type||e.id!==this.id)},t.prototype.getAriaLabel=function(){var e="";this.model.hidden||this.model.collapsed||this.model.secret?!this.model.hidden||this.model.collapsed||this.model.secret?this.model.hidden||!this.model.collapsed||this.model.secret?this.model.hidden||this.model.collapsed||!this.model.secret?this.model.hidden&&this.model.collapsed&&!this.model.secret?e=this.controller.t("Hidden Collapsed Folder"):this.model.hidden&&!this.model.collapsed&&this.model.secret?e=this.controller.t("Hidden Secret Folder"):!this.model.hidden&&this.model.collapsed&&this.model.secret?e=this.controller.t("Collapsed Secret Folder"):this.model.hidden&&this.model.collapsed&&this.model.secret&&(e=this.controller.t("Hidden Collapsed Secret Folder")):e=this.controller.t("Secret Folder"):e=this.controller.t("Collapsed Folder"):e=this.controller.t("Hidden Folder"):e=this.controller.t("Folder");var t=this.controller.getNumberOfItemsInFolder(this.id);return 0<t?this.controller.t("__folder__ has __count__ items",{folder:e,count:t}):e},t}(s.default);t.default=p}),define("loadcss!image_opacity_menu",function(){}),define("expressions/image_options_view",["require","exports","tslib","dcgview","dcgview-helpers/checkbox","./circular-icon-view","loadcss!image_opacity_menu"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.Components.For,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,n.createElement("div",{class:n.const("dcg-exp-options-menu dcg-image-options-menu dcg-options-menu")},n.createElement("div",{class:n.const("dcg-triangle")}),n.createElement("div",{class:n.const("dcg-opacities-menu dcg-dividing-line-after")},n.createElement("div",{class:n.const("dcg-title")},function(){return t.controller.t("Opacity")}),n.createElement(a,{each:function(){return t.controller.getImageOpacities()}},n.createElement("div",{class:n.const("dcg-opacities-menu")},function(e){return n.createElement("span",{class:n.const("dcg-opacity-option"),role:n.const("button"),tabindex:n.const(0),"aria-label":function(){return"opacity: "+e},handleevent:n.const("true"),onTap:function(){return t.onSelectOpacity(e)}},n.createElement(o.CircularIconView,{backgroundImage:t.const("url("+encodeURI(t.model.image_url)+")"),iconType:function(){return t.model.opacity===e?"check":"none"},backgroundOpacity:t.const(e)}))}))),n.createElement("div",{class:n.const("dcg-styles-div dcg-options-menu-section")},n.createElement("div",{class:n.const("dcg-styles-menu")},n.createElement(i.Checkbox,{checked:function(){return!t.model.foreground},onChange:this.bindFn(this.onToggleForeground),ariaLabel:function(){return t.controller.t("Place behind graphs")}},function(){return t.controller.t("Place behind graphs")}))))},t.prototype.onToggleForeground=function(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.id,foreground:!e})},t.prototype.onSelectOpacity=function(e){this.controller.dispatch({type:"set-image-opacity",id:this.id,opacity:e})},t}(n.Class);t.default=s}),define("loadcss!expressions/image-icon-view",function(){}),define("expressions/image-icon-view",["require","exports","tslib","dcgview","./abstract_icon_view","./image_options_view","../dcgview-helpers/tooltipped-error","./circular-icon-view","jquery.handleevent","loadcss!./image-icon-view"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.Components.Switch,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.model=this.props.model()},t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-expression-icon-container dcg-image-icon-container")},n.createElement(l,{key:this.bindFn(this.typeOfIcon)},function(e){switch(e){case"error":return n.createElement(a.TooltippedError,{error:function(){return t.controller.unpack(t.model.error)},isWhite:t.bindFn(t.isSelected),gravity:t.const("se")});case"failed":return n.createElement("span",null);case"loading":return n.createElement("span",{class:n.const("dcg-image-loading dcg-circular-icon-container")});case"hidden":case"image":return n.createElement("div",{class:n.const("dcg-circular-icon-container"),role:n.const("button"),onTap:function(e){e.wasHandled("dragdrop")||e.wasLongheld()||t.toggleImageShown()},didMount:function(e){return t.rootElt=e},onLongHold:function(e){e.handle("dcg-longhold"),e.handle("dcg-tap"),t.toggleOptions()}},n.createElement(s.CircularIconView,{iconType:function(){return"hidden"===e?"hidden":"background"},backgroundImage:t.bindFn(t.getBackgroundImage),backgroundOpacity:function(){return t.model.opacity},whiteIcon:t.bindFn(t.isSelected)}));default:return e}}))},t.prototype.isSelected=function(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)},t.prototype.typeOfIcon=function(){return"loading"===this.model.loadStatus?"loading":"failed"===this.model.loadStatus?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"},t.prototype.createOptionsMenuView=function(){var e=this.getOptionsMenuContainerSelector();return n.mountToNode(o.default,e[0],{controller:this.props.controller,model:this.props.model})},t.prototype.hasError=function(){return!!this.model.error},t.prototype.getBackgroundImage=function(){return this.model.image_url===this.lastURL||(this.lastURL=this.model.image_url,this.lastEncodedURL="url("+encodeURI(this.model.image_url)+")"),this.lastEncodedURL},t.prototype.toggleImageShown=function(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})},t}(i.default);t.default=c}),define("loadcss!expressions/image-view",function(){}),define("expressions/image-view",["require","exports","tslib","./abstract-item-view","./smart_textarea","dcgview","dcgview-helpers/mathquill-view","lib/conditional_blur","expressions/promptslider_view","./image-icon-view","graphing-calc/models/image","./expression-edit-actions","jquery.handleevent","loadcss!./image-view"],function(e,t,r,n,i,o,l,c,a,s,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=o.Components,h=d.If,f=d.Switch,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var r=this;return o.createElement("div",{class:o.const("dcg-image-input-mathquill")},o.createElement(l.default,{latex:function(){return r.props.model()[r.props.name()]},isFocused:function(){return r.props.focusedInput()===r.props.name()},capExpressionSize:function(){return!!r.props.controller().getGraphSettings().config.capExpressionSize},selectOnFocus:this.const(!0),config:this.const({}),getAriaLabel:function(){return r.props.controller().t(r.props.name())},getAriaPostLabel:this.const(""),hasError:this.const(!1),onUserPressedKey:function(e,t){return r.handlePressedKey(e,t)},onUserChangedLatex:this.bindFn(this.handleLatexChanged),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged)},o.createElement("span",{class:function(){return{"dcg-focus":r.props.focusedInput()===r.props.name(),"dcg-invalid":u.hasInputError(r.props.model(),r.props.name())}}})))},t.prototype.handlePressedKey=function(e,t){var r=this.props.name(),n=l.default.getFocusedMathquill(),i=["center","angle","width","height"],o=i.indexOf(r);if(n){if("Esc"===e)return void c.default();var a=-1;"Up"===e&&(a=o-1),"Down"===e&&(a=o+1),"Left"===e&&(a=o-2),"Right"===e&&(a=o+2);var s=e;if(0<=a&&a<i.length)return void(l.default.applyArrowKeyAndReturnIfWasAtBounds(n,s,t)&&this.focusInput(i[a]));n.keystroke(e,t),this.handleLatexChanged(n.latex())}},t.prototype.focusInput=function(e){this.props.controller().dispatch({type:"set-focus-location",location:{type:"image",id:this.props.model().id,location:e}})},t.prototype.handleLatexChanged=function(e){var t=this.props.name();this.props.model().draggingOnGraphpaper||u.getMQAttribute(this.props.model(),t)!==e&&this.props.controller().dispatch({type:"set-image-mq-attribute",id:this.props.model().id,attribute:t,latex:e})},t.prototype.handleMQFocusedChanged=function(e){var t=this.props.name();e?this.props.focusedInput()!==t&&this.props.controller().dispatch({type:"set-focus-location",location:{type:"image",id:this.props.model().id,location:t}}):this.props.controller().dispatch({type:"blur-focus-location",location:{type:"image",id:this.props.model().id,location:t}})},t}(o.Class),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted()},t.prototype.template=function(){var t=this;return o.createElement("div",{class:function(){return{"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-expressionimage":!0,"dcg-inFolder":!!t.model.folderId,"dcg-selected":t.controller.isItemSelected(t.id),"dcg-dragging":!!t.controller.isItemBeingDragged(t.id),"dcg-input-focused":t.getFocusedInput()&&"name"!==t.getFocusedInput()}},"expr-id":function(){return t.model.id},onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},o.createElement("div",{class:o.const("dcg-fade-container")},o.createElement("div",{class:o.const("dcg-main")},o.createElement(f,{key:function(){return t.model.loadStatus}},function(e){switch(e){case"failed":return o.createElement("div",null,o.createElement("div",{class:o.const("dcg-image-failed")},function(){return t.controller.t("Failed to load image.")}),o.createElement("div",{role:o.const("button"),tabindex:o.const(0),class:o.const("dcg-retry-loading-image"),onTap:t.bindFn(t.onRetryLoad)},function(){return t.controller.t("Retry.")}));case"loading":return o.createElement("div",null,o.createElement("div",{class:o.const("dcg-image-loading")},function(){return t.controller.t("Loading image...")}),o.createElement("div",{role:o.const("button"),tabindex:o.const(0),class:o.const("dcg-retry-loading-image"),onTap:t.bindFn(t.onRetryLoad)},function(){return t.controller.t("Retry.")}));case"loaded":return o.createElement("div",{class:o.const("dcg-image-loaded")},o.createElement(i.default,{shouldFocus:function(){return"name"===t.getFocusedInput()},text:function(){return t.model.name},placeholder:function(){return t.controller.t("Enter a note...")},showLinks:function(){return t.controller.areLinksEnabled()},onInput:t.bindFn(t.onNameInput),onFocusChange:t.bindFn(t.onNameFocusChange),onSpecialKey:t.bindFn(t.onNameSpecialKey)}),o.createElement("div",{class:o.const("dcg-do-blur dcg-image-input-grid"),handleEvent:o.const("true")},o.createElement("div",{class:o.const("dcg-image-input-name")},function(){return t.controller.t("Center:")}),o.createElement(g,{name:t.const("center"),controller:function(){return t.controller},model:function(){return t.model},focusedInput:t.bindFn(t.getFocusedInput)}),o.createElement("div",{class:o.const("dcg-image-input-name")},function(){return t.controller.t("Width:")}),o.createElement(g,{name:t.const("width"),controller:function(){return t.controller},model:function(){return t.model},focusedInput:t.bindFn(t.getFocusedInput)}),o.createElement("div",{class:o.const("dcg-image-input-name")},function(){return t.controller.t("Angle:")}),o.createElement(g,{name:t.const("angle"),controller:function(){return t.controller},model:function(){return t.model},focusedInput:t.bindFn(t.getFocusedInput)}),o.createElement("div",{class:o.const("dcg-image-input-name")},function(){return t.controller.t("Height:")}),o.createElement(g,{name:t.const("height"),controller:function(){return t.controller},model:function(){return t.model},focusedInput:t.bindFn(t.getFocusedInput)})));default:return e}})),o.createElement("span",{class:o.const("dcg-fadeout")}),o.createElement("i",{class:o.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:o.const("true"),onTap:this.bindFn(this.onDelete)}),o.createElement(h,{predicate:function(){return 0<t.model.missingVariables.length}},function(){return o.createElement("div",{class:t.getFooterClass()},o.createElement(a.default,{model:t.props.model,controller:t.props.controller}))})),o.createElement("span",{class:o.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:o.const("true"),tapboundary:o.const("true"),disablescroll:o.const("true"),style:o.const("touch-action:none"),onTapStart:this.bindFn(this.onDragPending)},o.createElement("span",{class:o.const("dcg-num")},function(){return t.model.displayIndex}),o.createElement("div",{class:o.const("dcg-tab-interior dcg-action-icon-mouse")},o.createElement(s.default,{model:this.props.model,controller:this.props.controller}))),o.createElement(p.ExpressionEditActions,{controller:this.props.controller,id:function(){return t.model.id}}))},t.prototype.getFooterClass=function(){return this.isFirstRender()?this.const("dcg-expression-bottom"):this.const("dcg-expression-bottom dcg-fadein-bottom")},t.prototype.onNameInput=function(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})},t.prototype.onNameFocusChange=function(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):"name"===this.getFocusedInput()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})},t.prototype.onNameSpecialKey=function(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})},t.prototype.getFocusedInput=function(){var e=this.controller.getFocusLocation();if(e&&"image"===e.type&&e.id===this.model.id)return e.location},t.prototype.onRetryLoad=function(){this.controller.dispatch({type:"image-retry-loading",id:this.id})},t}(n.default);t.default=m}),define("expressions/shell_view",["require","exports","tslib","dcgview","./abstract-item-view"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.didMount=function(){this.onItemViewMounted()},t.prototype.willUnmount=function(){this.onItemViewUnmounted()},t.prototype.template=function(){var e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),n.createElement("div",{class:n.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:n.const(e)})},t}(i.default);t.default=o}),define("expressions/drag_container_view",["require","exports","tslib","dcgview"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.template=function(){var e=this;return n.createElement("div",{class:n.const("dcg-drag-container"),style:function(){return{top:e.getTopPx()}}},this.children)},t.prototype.getTopPx=function(){var e=this.controller.getRawDragState();if(e)return e.itemTop+"px"},t}(n.Class);t.default=i}),define("loadcss!new_expression",function(){}),define("expressions/new_expression_view",["require","exports","tslib","dcgview","loadcss!new_expression"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return this.controller=this.props.controller(),n.createElement("div",{class:n.const("dcg-expressionitem dcg-new-expression dcg-opened")},n.createElement("div",{class:n.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},n.createElement("div",{class:n.const("dcg-new-expression-fade")})),n.createElement("span",{class:n.const("dcg-tab")},n.createElement("span",{class:n.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),n.createElement("div",{class:n.const("dcg-tab-interior")})))},t.prototype.getIndex=function(){return this.controller.getNextDisplayIndex()},t.prototype.newMath=function(){this.controller.dispatch({type:"new-expression-at-end"})},t}(n.Class);t.default=i}),define("loadcss!add_expression",function(){}),define("expressions/add_expression_view",["require","exports","tslib","keys","browser","lib/tooltip","dcgview","jquery","loadcss!add_expression"],function(e,t,r,o,n,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a.Components.If,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return this.controller=this.props.controller(),a.createElement("div",{class:a.const("dcg-add-expression-container")},a.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Add Item")},gravity:function(){return e.controller.isNarrow()?"ne":"se"}},a.createElement("span",{class:function(){return{"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":e.controller.isAddExpressionOpen()}},handleEvent:a.const("true"),role:a.const("button"),tabindex:a.const("0"),"aria-haspopup":a.const("true"),"aria-expanded":function(){return e.controller.isAddExpressionOpen()},"aria-label":function(){return e.controller.t("Add Item")},onTap:this.bindFn(this.toggleAddExpression),didMount:this.bindFn(this.didMountToggleButton)},a.createElement("i",{class:a.const("dcg-icon-plus")}))),a.createElement(l,{predicate:function(){return e.controller.isAddExpressionOpen()}},function(){return a.createElement("div",{class:function(){return{"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!e.controller.isNarrow(),"dcg-right":e.controller.isNarrow()}},role:a.const("complementary"),"aria-label":a.const("Add Item Menu"),didMount:e.bindFn(e.didMountPopover),didUnmount:e.bindFn(e.didUnmountPopover)},a.createElement("div",{class:a.const("dcg-popover-interior")},a.createElement("div",{class:a.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:a.const("button"),tabindex:a.const(0),"aria-label":function(){return e.controller.t("Add Expression")},didMount:e.bindFn(e.didMountNewExpression),onTap:e.bindFn(e.newExpression),handleEvent:a.const("true")},a.createElement("i",{class:a.const("dcg-icon-new-expression dcg-expression-icon")}),function(){return e.controller.t("expression")}),a.createElement(l,{predicate:function(){return e.controller.areNotesEnabled()}},function(){return a.createElement("div",{class:a.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:a.const("button"),tabindex:a.const(0),"aria-label":function(){return e.controller.t("Add Note")},onTap:e.bindFn(e.newText),handleEvent:a.const("true")},a.createElement("i",{class:a.const("dcg-icon-new-text dcg-expression-icon")}),function(){return e.controller.t("note")})}),a.createElement("div",{class:a.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:a.const("button"),tabindex:a.const(0),"aria-label":function(){return e.controller.t("Add Table")},onTap:e.bindFn(e.newTable),handleEvent:a.const("true")},a.createElement("i",{class:a.const("dcg-icon-new-table dcg-expression-icon")}),function(){return e.controller.t("table")}),a.createElement(l,{predicate:function(){return e.controller.areFoldersEnabled()}},function(){return a.createElement("div",{class:a.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:a.const("button"),tabindex:a.const(0),"aria-label":function(){return e.controller.t("Add Folder")},onTap:e.bindFn(e.newFolder),handleEvent:a.const("true")},a.createElement("i",{class:a.const("dcg-icon-new-folder dcg-expression-icon")}),function(){return e.controller.t("folder")})}),a.createElement(l,{predicate:function(){return e.controller.areImagesEnabled()}},function(){return a.createElement("div",{class:a.const("dcg-new-item dcg-do-not-blur dcg-action-newimage"),role:a.const("button"),tabindex:a.const(0),"aria-label":function(){return e.controller.t("Add Image")},onTap:e.bindFn(e.newImage),handleEvent:a.const("true")},a.createElement("i",{class:a.const("dcg-icon-new-image dcg-expression-icon")}),function(){return e.controller.t("image")},a.createElement("input",{type:a.const("file"),accept:a.const("image/*"),style:a.const("display: none"),didMount:e.bindFn(e.didMountFileInput)}))})),a.createElement("span",{class:a.const("dcg-arrow")}))}))},t.prototype.didMountPopover=function(e){var i=this;this.popoverNode=e,s(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",function(e){i.eventShouldClosePopover(e)&&i.controller.dispatch({type:"close-add-expression"})}),s(document).on("keydown.add-expression-view",function(e){if("Esc"===o.lookup(e)&&i.controller.dispatch({type:"close-add-expression"}),"Tab"===o.lookup(e)&&!e.altKey&&!e.metaKey&&!e.ctrlKey){var t=document.activeElement,r=s(i.toggleButtonNode),n=s(i.popoverNode).find(".dcg-new-item:last");e.shiftKey||t!==n[0]?e.shiftKey&&t===r[0]&&(n.focus(),e.preventDefault(),e.stopPropagation()):(r.focus(),e.preventDefault(),e.stopPropagation())}}),n.IS_IPAD&&n.IS_IN_IFRAME&&s(e).on("dcg-tapstart",function(e){return e.preventDefault()}),s(e).find(".dcg-new-item").on("touchstart",function(e){return e.preventDefault()})},t.prototype.didMountFileInput=function(e){var t=this;this.fileInputNode=e,s(e).on("change",function(){t.insertFiles(e.files),s(e).val("")})},t.prototype.didMountToggleButton=function(e){this.toggleButtonNode=e},t.prototype.didMountNewExpression=function(e){this.controller.getAddExpressionViewModel().focusOnOpen&&s(e).focus()},t.prototype.didUnmountPopover=function(){s(document).off(".add-expression-view")},t.prototype.toggleAddExpression=function(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:"keyboard"===e.device})},t.prototype.newExpression=function(){this.controller.dispatch({type:"new-expression"})},t.prototype.newText=function(){this.controller.dispatch({type:"new-text"})},t.prototype.newFolder=function(){this.controller.dispatch({type:"new-folder"})},t.prototype.newTable=function(){this.controller.dispatch({type:"new-table"})},t.prototype.newImage=function(){this.fileInputNode.click()},t.prototype.insertFiles=function(e){this.controller.dispatch({type:"new-images",files:e})},t.prototype.eventShouldClosePopover=function(e){var t=!!s(e.target).closest(this.popoverNode).length,r=!!s(e.target).closest(this.toggleButtonNode).length;return!(t||r)},t}(a.Class);t.default=c}),define("loadcss!expressions/expressions-header",function(){}),define("expressions/expressions-header",["require","exports","tslib","./add_expression_view","dcgview","lib/tooltip","loadcss!./expressions-header"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i.Components.If,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.template=function(){var e=this;return i.createElement("div",{class:function(){return{"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":e.props.expsScrolled()}},role:i.const("toolbar"),"aria-label":function(){return e.controller.t("Expression Bar")},onTapStart:this.bindFn(this.clearSelectionOnMobile),style:function(){return{background:e.controller.hasBackgroundColor()?e.controller.getPillboxBackgroundColor():void 0}}},i.createElement("div",{class:i.const("dcg-left-buttons")},i.createElement(a,{predicate:this.bindFn(this.showHamburger)},function(){return i.createElement("span",{class:i.const("dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:i.const("true"),tooltip:function(){return e.controller.t("Open Graph (ctrl+o)")},role:i.const("button"),tabindex:i.const("0"),"aria-label":function(){return e.controller.t("Open Graph")},onTap:function(){return e.controller.dispatch({type:"open-drawer"})}},i.createElement("i",{class:i.const("dcg-icon-hamburger")}))}),i.createElement(a,{predicate:function(){return!e.controller.isInEditListMode()}},function(){return i.createElement(n.default,{controller:function(){return e.props.controller()}})}),i.createElement(a,{predicate:function(){return e.controller.isInEditListMode()&&!e.controller.hasDefaultState()}},function(){return i.createElement("span",{class:i.const("dcg-btn-red dcg-action-clearall"),role:i.const("button"),onTap:function(){return e.controller.dispatch({type:"clear-graph"})}},function(){return e.controller.t("Delete All")})}),i.createElement(a,{predicate:function(){return e.controller.isInEditListMode()&&e.controller.hasDefaultState()}},function(){return i.createElement("span",{class:i.const("dcg-btn-red dcg-action-reset"),role:i.const("button"),onTap:function(){return e.controller.dispatch({type:"reset-graph"})}},function(){return e.controller.t("Reset")})})),i.createElement("div",{class:i.const("dcg-center-buttons")},i.createElement(o.Tooltip,{tooltip:function(){return e.controller.t("Undo (ctrl+z)")},gravity:function(){return e.controller.isNarrow()?"n":"s"},disabled:function(){return!e.controller.canUndo()}},i.createElement("span",{class:function(){return{"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-disabled":!e.controller.canUndo()}},role:i.const("button"),tabindex:i.const("0"),"aria-label":function(){return e.controller.t("Undo")},onTap:function(){return e.controller.dispatch({type:"undo"})},"aria-disabled":function(){return!e.controller.canUndo()}},i.createElement("i",{class:i.const("dcg-icon-undo")}))),i.createElement(o.Tooltip,{tooltip:function(){return e.controller.t("Redo (ctrl+y)")},gravity:function(){return e.controller.isNarrow()?"n":"s"},disabled:function(){return!e.controller.canRedo()}},i.createElement("span",{class:function(){return{"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-disabled":!e.controller.canRedo()}},role:i.const("button"),tabindex:i.const("0"),"aria-label":function(){return e.controller.t("Redo")},onTap:function(){return e.controller.dispatch({type:"redo"})},"aria-disabled":function(){return!e.controller.canRedo()}},i.createElement("i",{class:i.const("dcg-icon-redo")})))),i.createElement("div",{class:i.const("dcg-right-buttons")},i.createElement(a,{predicate:function(){return!e.controller.isInEditListMode()}},function(){return i.createElement(o.Tooltip,{tooltip:e.const("Edit List"),gravity:function(){return e.controller.isNarrow()?"n":"s"}},i.createElement("span",{class:i.const("dcg-icon-btn dcg-action-toggle-edit"),handleEvent:i.const("true"),role:i.const("button"),"aria-label":function(){return e.controller.t("Edit Expression List")},onTap:function(){return e.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!0})}},i.createElement("i",{class:i.const("dcg-icon-settings")})))}),i.createElement(a,{predicate:function(){return e.controller.isInEditListMode()}},function(){return i.createElement("span",{class:i.const("dcg-btn-blue dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:i.const("true"),role:i.const("button"),onTap:function(){return e.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1})}},function(){return e.controller.t("Done")})}),i.createElement(a,{predicate:function(){return!e.controller.isInEditListMode()&&e.controller.getGraphSettings().config.graphpaper}},function(){return i.createElement(o.Tooltip,{tooltip:e.const("Hide Expression List"),gravity:function(){return e.controller.isNarrow()?"nw":"sw"}},i.const(" "),i.createElement("span",{class:function(){return{"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":e.controller.isNarrow()}},role:i.const("button"),tabindex:i.const("0"),"aria-label":function(){return e.controller.t("Hide Expression List")},onTap:function(){return e.controller.dispatch({type:"hide-expressions-list"})}},i.createElement("i",{class:i.const("dcg-icon-hide")})))})))},t.prototype.showHamburger=function(){return!!this.controller.getGraphSettings().config.showHamburger&&!this.controller.isInEditListMode()&&!this.controller.isNarrow()},t.prototype.clearSelectionOnMobile=function(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})},t}(i.Class);t.default=s}),define("main/load-graph-from-link",["require","exports","main/migrate_state","jquery"],function(e,t,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n,e,r){var i=!1;n.dispatch({type:"toast/show",toast:{message:n.t("Importing graph..."),hideAfter:0,toastStyle:"cover",onHide:function(){i=!0}}});var o=n.getState(),a=function(){i||n.dispatch({type:"toast/show",toast:{message:n.t("Error importing graph. Check the URL?"),toastStyle:"error",hideAfter:12e3}})};l.getJSON(e).done(function(e){var t=s.migrateToLatest(e.state);r(t,function(e,t){var r;e||!t?a():(r=t,i||(n.dispatch({type:"set-state",state:r}),n.dispatch({type:"toast/show",toast:{message:n.t("Graph imported!"),undoCallback:function(){n.dispatch({type:"set-state",state:o})}}})))})}).fail(a)}}),define("lib/get-clipboard-data",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e&&e.clipboardData&&e.clipboardData.getData?e.clipboardData.getData("text/plain"):void 0}}),define("loadcss!expressions/exp-list-resizer",function(){}),define("expressions/exp-list-resizer",["require","exports","tslib","dcgview","jquery","underscore","loadcss!./exp-list-resizer"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.Components.If,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.guid=o.uniqueId("dcg-exp-list-resize")},t.prototype.template=function(){var e=this;return n.createElement(a,{predicate:this.bindFn(this.isVisible)},function(){return n.createElement("div",{class:n.const("dcg-exp-list-resizer"),onTapStart:e.bindFn(e.onTapStart)})})},t.prototype.isVisible=function(){return!this.props.controller().expressionsAreFullWidth()&&this.props.controller().isListVisible()},t.prototype.onTapStart=function(e){var r=this;this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,i(document).on("dcg-tapmove."+this.guid,function(e){if(void 0!==r.initialLeft&&void 0!==r.initialWidth){var t=e.changedTouches[0].clientX-r.initialLeft+r.initialWidth;r.props.controller().dispatch({type:"resize-exp-list",expListWidth:t})}}),i(document).on("dcg-tapend."+this.guid,this.bindFn(this.onTapEnd)),i(document).on("dcg-tapcancel."+this.guid,this.bindFn(this.onTapEnd))},t.prototype.onTapEnd=function(){i(document).off("."+this.guid),this.initialLeft=void 0,this.initialWidth=void 0},t}(n.Class);t.ExpListResizer=s}),define("loadcss!expressions/list-view",function(){}),define("loadcss!expressions",function(){}),define("loadcss!expressions.dropdown",function(){}),define("loadcss!tipsycss",function(){}),define("tipsy",["require","loadcss!tipsycss","jquery","keys"],function(e){function a(e,t){this.id=r++,this.$element=b(e),this.options=t,this.fixTitle()}function v(){return 0!==t}e("loadcss!tipsycss");var b=e("jquery"),n=e("keys"),s=null,i=!1,x=0,o={};b(document).on("dcg-tap",".tipsy-sticky",function(e){if(i)i=!1;else{var t=e.currentTarget,r=b(t);if(r.attr("tooltip")||(r=r.find("[tooltip]").filter(':not([tooltip=""])')),1===r.length&&"none"!==r.css("display")&&!r.parents().filter(function(){return"none"===b(this).css("display")}).length){var n=b.extend({},b.fn.tipsy.defaults);r.attr("tipsy-dir")?n.gravity=r.attr("tipsy-dir"):n.gravity="nw",n.fade=!1,(s=new a(r[0],n)).isOpenSticky=!0,s.renderVisible(),s.opener=t}}}),b(document).on("dcg-tapstart keydown",function(e){if("keydown"!==e.type||n.lookup(e)!==n.ESCAPE){if(s){s.clearTooltip();var t=s.opener;"dcg-tapstart"===e.type&&b(e.target).closest(t).length&&b(document).one("dcg-tapend",function(e){b(e.target).closest(t).length&&(i=!0)}),s=null}}else for(var r in o)o[r].clearTooltip()});var r=0;a.prototype={_show:function(){var e,t,r=this.getTitle();if(r&&!v()){var n=this.tip(),i=n.find(".tipsy-arrow");this.uuid=x,x++,b(document).on("scroll.tipsy"+this.uuid,this.clearTooltip.bind(this)),n.find(".tipsy-inner")[this.options.html?"html":"text"](r),n[0].className="tipsy",n.detach().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var o,a=this.$element[0],s=this.$tip[0],l=a.getBoundingClientRect(),c=s.getBoundingClientRect(),u=c.width,p=c.height,d=(e=this.options.gravity,t=this.$element[0],"function"==typeof e?e.call(t):e);switch(d.charAt(0)){case"n":o={top:l.top+l.height+this.options.offset,left:l.left+l.width/2-u/2};break;case"s":o={top:l.top-p-this.options.offset,left:l.left+l.width/2-u/2};break;case"e":o={top:l.top+l.height/2-p/2,left:l.left-u-this.options.offset};break;case"w":o={top:l.top+l.height/2-p/2,left:l.left+l.width+this.options.offset}}2==d.length&&("w"==d.charAt(1)?o.left=l.left+l.width/2-15:o.left=l.left+l.width/2-u+15);var h=0;o.left<0?(h=o.left,o.left=0):o.left+u>window.innerWidth&&(h=o.left+u-window.innerWidth,o.left=window.innerWidth-u),"n"!==d&&"s"!==d||(h-=5);var f=l.width/a.offsetWidth,g=l.height/a.offsetHeight;o.top/=g,o.left/=f,h/=f,i.css("marginLeft",h),n.css(o).addClass("tipsy-"+d),i[0].className="tipsy-arrow tipsy-arrow-"+d.charAt(0),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:1},"fast"):n.css({visibility:"visible",opacity:1}),this.options.sticky&&n.addClass("tipsy-temporary-sticky");var m=this,y=function(){m.validate(),m.validateTimeout=setTimeout(y,100)};y()}},_hide:function(){clearTimeout(this.validateTimeout),b(document).off("scroll.tipsy"+this.uuid),this.options.fade?this.tip().stop().fadeOut("fast",function(){b(this).detach()}):this.tip().detach()},clearTooltip:function(){delete this.buttonHoverTime,this.tooltipIsHovered=!1,this.isOpenSticky=!1,this.renderVisible()},renderVisible:function(){var e=!!this.renderedVisible,t=!!this.tooltipIsHovered||!!this.isOpenSticky;this.buttonHoverTime&&(e?t=!0:500<=Date.now()-this.buttonHoverTime&&(t=!0)),t!==e&&((this.renderedVisible=t)?(o[this.id]=this)._show():(delete o[this.id],this._hide()))},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,r=this.options;return this.fixTitle(),"string"==typeof(r=this.options).title?e=t.attr("title"==r.title?"original-title":r.title):"function"==typeof r.title&&(e=r.title.call(t[0])),e&&(e=(""+e).replace(/(^\s*|\s*$)/,"")),e||""},tip:function(){return this.$tip||(this.$tip=b('<div class="tipsy"><div class="tipsy-arrow"></div><div class="tipsy-inner"></div></div>'),this.$tip.on("tipsyshow",function(){clearTimeout(this.tooltipOutTimeout),this.tooltipIsHovered=!0,this.renderVisible()}.bind(this)),this.$tip.on("tipsyhide",function(){clearTimeout(this.tooltipOutTimeout),this.tooltipOutTimeout=setTimeout(function(){this.tooltipIsHovered=!1,this.renderVisible()}.bind(this),100)}.bind(this))),this.$tip},validate:function(){var e=!1;if(!!this.getTitle())try{for(var t=this.$element[0];t;){if(t===document){e=!0;break}t=t.parentNode}}catch(e){}e||this.clearTooltip()}},b.fn.tipsy=function(r){function n(e){var t=b.data(e,"tipsy");return t||(t=new a(e,b.fn.tipsy.elementOptions(e,r)),b.data(e,"tipsy",t)),t}function e(e){if(("tipsyshow"!==e.type||e.target===this)&&s!==this){var t=n(this);clearTimeout(t.buttonTimeout),t.buttonHoverTime=Date.now(),t.buttonTimeout=setTimeout(function(){t.renderVisible()},500)}}function t(e){if("tipsyhide"!==e.type||e.target===this){var t=n(this);"dcg-tapstart"===e.type&&t.options.sticky||(clearTimeout(t.buttonTimeout),t.buttonTimeout=setTimeout(function(){delete t.buttonHoverTime,t.renderVisible()},100))}}if(!0===r)return this.data("tipsy");if("string"==typeof r){var i=this.data("tipsy");return i&&i[r](),this}var o="tipsyhide dcg-tapstart dcg-tapend dcg-tapcancel";return(r=b.extend({},b.fn.tipsy.defaults,r)).delegate?this.on("tipsyshow",r.delegate,e).on(o,r.delegate,t):this.on("tipsyshow",e).on(o,t),this},b.fn.tipsy.defaults={fade:!0,gravity:"n",html:!1,offset:0,title:"tooltip"},b.fn.tipsy.elementOptions=function(e,t){t=b.extend({},t);var r=b(e).attr("tipsy-gravity");r&&(t.gravity=r);var n=parseInt(b(e).attr("tipsy-offset"),10);return isNaN(n)||(t.offset=n),t},b.fn.tipsy.autoNS=function(){return b(this).offset().top>b(document).scrollTop()+b(window).height()/2?"s":"n"},b.fn.tipsy.autoWE=function(){return b(this).offset().left>b(document).scrollLeft()+b(window).width()/2?"e":"w"},b.fn.tipsy.autoBounds=function(i,o){return function(){var e={ns:o[0],ew:1<o.length&&o[1]},t=b(document).scrollTop()+i,r=b(document).scrollLeft()+i,n=b(this);return n.offset().top<t&&(e.ns="n"),n.offset().left<r&&(e.ew="w"),b(window).width()+b(document).scrollLeft()-n.offset().left<i&&(e.ew="e"),b(window).height()+b(document).scrollTop()-n.offset().top<i&&(e.ns="s"),e.ns+(e.ew?e.ew:"")}},b(document).tipsy({delegate:".tipsy-sticky",gravity:"nw",fade:!1,sticky:!0});var t=0;return{isDisabled:v,removeDisableLock:function(){t--},addDisableLock:function(){t++}}}),define("expressions/list-view",["require","exports","tslib","touchtracking","keys","dcgview","jquery","underscore","lib/conditional_blur","./expression_view","./text_view","./table-view","./folder-view","./image-view","./shell_view","./drag_container_view","main/data_helpers","./new_expression_view","./expressions-header","main/load-graph-from-link","lib/get-clipboard-data","graphing-calc/models/abstract-item","./exp-list-resizer","loadcss!./list-view","loadcss!expressions","loadcss!expressions.dropdown","tipsy","jquery.handleevent"],function(e,t,r,n,i,o,s,a,l,c,u,p,d,h,f,g,m,y,v,b,x,w,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=o.Components,E=S.If,M=S.For,I=S.Switch,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.guid=a.uniqueId("listView"),e}return r.__extends(e,t),e.prototype.init=function(){this.controller=this.props.controller()},e.prototype.template=function(){var r=this;return o.createElement("div",{didMount:this.bindFn(this.didMountContainer)},o.createElement("div",{class:o.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:function(){return r.computeExppanelOuterStyle()}},o.createElement("div",{class:function(){return{"dcg-exppanel-container":!0,"dcg-add-shadow":r.controller.shouldRenderList()}},style:function(){return{transform:r.controller.isListVisible()?void 0:r.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"}}},o.createElement(E,{predicate:function(){return r.controller.isFileDraggedOver()}},function(){return o.createElement("div",{class:o.const("dcg-drop-image")},o.createElement("span",null,function(){return r.controller.t("Drop Image Here")}))}),o.createElement(E,{predicate:function(){return r.controller.shouldRenderList()}},function(){return o.createElement("div",{class:function(){return{"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":r.controller.isDragDropActive(),"dcg-has-background-color":r.controller.hasBackgroundColor()}},style:function(){return{background:r.controller.getBackgroundColor()}},onPaste:r.bindFn(r.onPaste),onTapStart:r.bindFn(r.onExppanelTapstart),didMount:r.bindFn(r.didMountExppanel)},o.createElement(_.ExpListResizer,{controller:r.props.controller}),o.createElement("div",{class:o.const("dcg-expressionlist"),role:o.const("complementary"),"aria-label":o.const("Expression List")},o.createElement(M,{each:function(){return r.controller.getAllItemModels()},key:function(e){return e.guid}},o.createElement("span",{class:o.const("dcg-template-expressioneach")},function(t){return o.createElement(I,{key:function(){return w.getDisplayState(t)}},function(e){switch(e){case"shell":return r.makeShellViewForModel(t);case"render":return r.makeViewForModel(t);default:return}})})),o.createElement(y.default,{controller:function(){return r.props.controller()}}),o.createElement(I,{key:function(){return r.controller.getDraggedItemId()}},function(e){if(e){var t=r.controller.getItemModel(e);return o.createElement(g.default,{controller:r.props.controller},r.makeDragCopyViewForModel(t))}}),o.createElement("div",{class:o.const("dcg-expressions-branding"),style:function(){return{opacity:r.controller.isKeypadOpen()?0:1}}},o.createElement(E,{predicate:function(){return r.controller.canEditOnWeb()}},function(){return o.createElement("span",{role:o.const("link"),tabindex:o.const(0),class:o.const("dcg-edit-branding"),onTap:function(){return r.controller.dispatch({type:"open-on-web"})}},o.createElement("div",{class:o.const("dcg-powered-by"),"aria-label":function(){return r.controller.t("Edit graph on Desmos")}},function(){return r.controller.t("edit graph on")}),o.createElement("i",{class:o.const("dcg-icon-desmos")}))}),o.createElement(E,{predicate:function(){return!r.controller.canEditOnWeb()}},function(){return o.createElement("span",{class:o.const("dcg-noedit-branding")},o.createElement("div",{class:o.const("dcg-powered-by"),"aria-label":function(){return r.controller.t("powered by Desmos")}},function(){return r.controller.t("powered by")}),o.createElement("i",{class:o.const("dcg-icon-desmos")}))}))))}),o.createElement(E,{predicate:function(){return r.controller.shouldRenderList()}},function(){return o.createElement(v.default,{controller:r.props.controller,expsScrolled:function(){return!!r.exppanel&&0<r.exppanel.scrollTop}})}))),o.createElement("div",{class:o.const("dcg-options-menu-container")}))},e.prototype.makeShellViewForModel=function(e){return o.createElement(f.default,{controller:this.props.controller,model:function(){return e},onDragPending:function(){},isDragCopy:function(){return!1}})},e.prototype.computeExppanelOuterStyle=function(){this.getListBottomAndUpdateLastExpressionPadding();var e=this.controller.computeMajorLayout().list,t=e.top;return 0<e.top&&!this.controller.isListVisible()&&(t-=e.height),{position:"absolute",left:"0px",top:t+"px",width:e.width+"px",height:e.height+"px"}},e.prototype.makeDragCopyViewForModel=function(e){return this.makeViewForModel(e,!0)},e.prototype.makeViewForModel=function(t,e){var r,n=this;if(void 0===e&&(e=!1),"table"===t.type)r=o.createElement(p.default,{controller:this.props.controller,model:function(){return t},onDragPending:function(e){return n.onDragPending(e,t.id)},isDragCopy:function(){return e}});else if("folder"===t.type)r=o.createElement(d.default,{controller:this.props.controller,model:function(){return t},onDragPending:function(e){return n.onDragPending(e,t.id)},isDragCopy:function(){return e}});else if("text"===t.type)r=o.createElement(u.default,{controller:this.props.controller,model:function(){return t},onDragPending:function(e){return n.onDragPending(e,t.id)},isDragCopy:function(){return e}});else if("image"===t.type)r=o.createElement(h.default,{controller:this.props.controller,model:function(){return t},onDragPending:function(e){return n.onDragPending(e,t.id)},isDragCopy:function(){return e}});else{if("expression"!==t.type)return;r=o.createElement(c.default,{controller:this.props.controller,model:function(){return t},onDragPending:function(e){return n.onDragPending(e,t.id)},isDragCopy:function(){return e}})}return r},e.prototype.didUnmount=function(){s(document.documentElement).off("."+this.guid)},e.prototype.didMountContainer=function(e){this.node=e,s(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))},e.prototype.didMountExppanel=function(e){this.exppanel=e},e.prototype.getListBottomAndUpdateLastExpressionPadding=function(){var e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return 0===(this.__listBottom=e)&&0!==t&&n.isTapActive()&&this.padLastExpressionUntilTapEnd(t),e},e.prototype.padLastExpression=function(e){s(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom",e+"px")},e.prototype.unpadLastExpression=function(){s(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom","0")},e.prototype.padLastExpressionUntilTapEnd=function(e){var t=this;this.padLastExpression(e),s(document).on("dcg-tap.animating-bottom",function(){t.unpadLastExpression(),s(document).off("dcg-tap.animating-bottom")})},e.prototype.handleKeyDown=function(e){if(!this.controller.inAudioTraceMode()&&!s.contains(document.body,document.activeElement)&&!s(e.target).closest(this.exppanel).length&&s.contains(document.documentElement,e.target)){var t=this.controller.getSelectedItem();if(t){var r=i.lookup(e);switch(r){case i.UP:e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case i.DOWN:e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case i.ESCAPE:e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case i.RIGHT:e.preventDefault(),t&&("expression"===t.type&&t.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:t.id}})):this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:"start"}));break;case i.TAB:e.preventDefault(),t&&this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:"start"});break;case i.LEFT:e.preventDefault(),t&&("expression"===t.type&&t.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:t.id}})):this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:"end"}));break;case i.BACKSPACE:e.preventDefault(),t&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case i.DELETE:e.preventDefault(),t&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case i.ENTER:e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),t&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||r===i.SHIFT||r===i.SPACEBAR)return;t&&("table"===t.type||this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:"end"}))}}}},e.prototype.onDragPending=function(t,r){var n=this;t.preventDefault(),l.default();var i=t.touches[0].clientY,o=i,a=setTimeout(function(){s(document).off(".dragpending"),n.onDragStart(t,r,i,o)},500);s(document).on("dcg-tapmove.dragpending",function(e){o=e.touches[0].clientY,3<Math.abs(o-i)&&(clearTimeout(a),s(document).off(".dragpending"),n.onDragStart(t,r,i,o))}),s(document).on("dcg-tapend.dragpending",function(){clearTimeout(a),s(document).off(".dragpending")})},e.prototype.onDragStart=function(e,t,r,n){1===e.touches.length&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",id:t,grabY:r,mouseY:n}))},e.prototype.onExppanelTapstart=function(e){"mouse"!==e.device&&0===s(e.target).closest(".dcg-expressionitem").length&&l.default()},e.prototype.onPaste=function(e){var t=this.controller.getGraphSettings().config,r=this.controller.getSelectedItem();if(!r||"text"!==r.type&&"folder"!==r.type){var n=x.default(e);if(n){var i=/^\s*https?:\/\/([a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(n);if(t.pasteGraphLink&&i){e.stopPropagation(),e.preventDefault();var o=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:function(e,t){return t(null,e)};return void b.default(this.controller,n,o)}if(t.pasteTableData){var a=m.parse(n);if(void 0!==a)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:a})}var s=m.getExpressions(n);return void 0!==s?(e.stopPropagation(),e.preventDefault(),void this.controller.dispatch({type:"paste-expressions",expressions:s})):void 0}}},e.prototype.onDrop=function(e){if(this.controller.areImagesEnabled()){var t=e.dataTransfer&&e.dataTransfer.files;t&&this.controller.dispatch({type:"new-images",files:t})}},e}(o.Class);t.default=T}),define("graphing-calc/keypads/dcgview-graphing",["require","exports","tslib","dcgview"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch},t}(n.Class);t.default=i}),define("loadcss!keypad/btn",function(){}),define("keypad/btn",["require","exports","tslib","dcgview","loadcss!./btn"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:n.const("dcg-keypad-btn-container"),style:function(){return{"flex-grow":e.getColSpan()}}},n.createElement("a",{role:n.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),onTap:this.props.onTap},n.createElement("span",{class:n.const("dcg-keypad-btn-content")},this.children)))},t.prototype.getClasses=function(){var e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0,e["dcg-keypad-btn-default"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0,e["dcg-keypad-btn-dark"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;default:return t}return e},t.prototype.isActive=function(){return!!this.props.active&&this.props.active()},t.prototype.getAriaLabel=function(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()},t.prototype.getColSpan=function(){return this.props.colspan?this.props.colspan():void 0},t}(n.Class);t.default=i}),define("keypad/keys",["require","exports","./btn","dcgview-helpers/static-mathquill-view","dcgview","i18n"],function(e,t,i,o,a,n){"use strict";function s(e,t){return void 0===e?a.const(t):a.const(e)}function r(n){return function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(n.command||n.typedText||n.keys[0]),ariaLabel:a.const(n.ariaLabel||n.typedText||n.keys[0]),colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/type-text",text:n.typedText||n.keys[0]})}},a.createElement("span",{class:a.const("dcg-mq-math-mode"),style:a.const("font-size: 120%")},a.const(n.keys[0]),a.const(""),a.createElement("span",{style:a.const("color: #999")},a.const(n.keys[1]))))}}function l(n){return function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(n.command||n.typedText||n.keys[1]),ariaLabel:a.const(n.ariaLabel||n.typedText||n.keys[1]),colspan:s(r.colspan,1),style:s(r.style,"default"),onTap:function(){return t({type:"keypad/type-text",text:n.typedText||n.keys[1]})}},a.createElement("span",{class:a.const("dcg-mq-math-mode"),style:a.const("font-size: 120%")},a.createElement("span",{style:a.const("color: #999")},a.const(n.keys[0])),a.const(""),a.const(n.keys[1])))}}function c(n){return function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(n.command||e),ariaLabel:a.const(n.ariaLabel||e),colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/type-text",text:n.typedText||e})}},a.createElement(o.default,{latex:a.const(n.content||e)}))}}function u(n){return function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:a.const(n.ariaLabel||e),colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/type-text",text:e+"("})}},a.createElement(o.default,{latex:a.const(e)}))}}function p(n){return function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(n.command),ariaLabel:a.const(n.ariaLabel||n.command),colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){t({type:"keypad/custom-command",command:n.command})}},a.createElement(o.default,{latex:a.const(n.content)}))}}Object.defineProperty(t,"__esModule",{value:!0});var d={"(":c({ariaLabel:n.t("Left Parenthesis")}),")":c({ariaLabel:n.t("Right Parenthesis")}),sqrt:c({content:"\\sqrt{}",ariaLabel:n.t("Square Root")}),"/":c({content:"",ariaLabel:n.t("Divide")}),"*":c({content:"",ariaLabel:n.t("Times")}),"-":c({ariaLabel:n.t("Minus")}),"+":c({ariaLabel:n.t("Plus")}),".":c({ariaLabel:n.t("Decimal")}),ans:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Answer")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/type-text",text:e})}},a.const("ans"))},enter:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Enter")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/press-key",key:"Enter"})}},a.createElement("i",{class:a.const("dcg-icon-arrow-enter")}))},shift:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Shift")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},active:s(r.active,!1),onTap:function(){return t({type:"keypad/shift"})}},a.createElement("i",{class:a.const("dcg-icon-shift")}))},left:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Left Arrow")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/press-key",key:"Left"})}},a.createElement("i",{class:a.const("dcg-icon-arrow-left")}))},right:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Right Arrow")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/press-key",key:"Right"})}},a.createElement("i",{class:a.const("dcg-icon-arrow-right")}))},123:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Toggle Numbers")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/123"})}},a.const("1 2 3"))},ABC:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Toggle Letters")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/abc"})}},a.const("A B C"))},backspace:function(e,t,r){return void 0===r&&(r={}),a.createElement(i.default,{command:a.const(e),ariaLabel:function(){return n.t("Backspace")},colspan:s(r.colspan,1),style:function(){return r.style||"default"},onTap:function(){return t({type:"keypad/press-key",key:"Backspace"})}},a.createElement("i",{class:a.const("dcg-icon-delete")}))},pi:c({content:"\\pi",ariaLabel:n.t("Pi")}),alpha:c({content:"\\alpha",ariaLabel:n.t("Alpha")}),beta:c({content:"\\beta",ariaLabel:n.t("Beta")}),theta:c({content:"\\theta",ariaLabel:n.t("Theta")}),tau:c({content:"\\tau",ariaLabel:n.t("Tau")}),"a^2":p({command:"a^2",content:"a^2",ariaLabel:n.t("Squared")}),"a^3":p({command:"a^3",content:"a^3",ariaLabel:n.t("Cubed")}),"x^3":p({command:"a^3",content:"x^3",ariaLabel:n.t("Cubed")}),"a^b":c({content:"a^b",typedText:"^",ariaLabel:n.t("Superscript")}),a_b:c({content:"a_b",typedText:"_",ariaLabel:n.t("Subscript")}),"a/b":c({content:"\\frac{a}{b}",typedText:"/",ariaLabel:n.t("A over B")}),"x^2":p({command:"a^2",content:"x^2",ariaLabel:n.t("Squared")}),"x^y":c({content:"x^y",typedText:"^",ariaLabel:n.t("Superscript")}),"x/y":c({content:"\\frac{x}{y}",typedText:"/",ariaLabel:n.t("A over B")}),nthroot:p({command:"nthroot",content:"\\sqrt[n]{}",ariaLabel:n.t("Nth Root")}),ythroot:p({command:"nthroot",content:"\\sqrt[y]{}",ariaLabel:n.t("Yth Root")}),sin:u({ariaLabel:n.t("Sine")}),cos:u({ariaLabel:n.t("Cosine")}),tan:u({ariaLabel:n.t("Tangent")}),sec:u({ariaLabel:n.t("Secant")}),csc:u({ariaLabel:n.t("Cosecant")}),cot:u({ariaLabel:n.t("Cotangent")}),sinh:u({ariaLabel:n.t("Hyperbolic Sine")}),cosh:u({ariaLabel:n.t("Hyperbolic Cosine")}),tanh:u({ariaLabel:n.t("Hyperbolic Tangent")}),sech:u({ariaLabel:n.t("Hyperbolic Secant")}),csch:u({ariaLabel:n.t("Hyperbolic Cosecant")}),coth:u({ariaLabel:n.t("Hyperbolic Cotangent")}),arcsin:p({command:"arcsin",content:"sin^{-1}",ariaLabel:n.t("Inverse Sine")}),arccos:p({command:"arccos",content:"cos^{-1}",ariaLabel:n.t("Inverse Cosine")}),arctan:p({command:"arctan",content:"tan^{-1}",ariaLabel:n.t("Inverse Tangent")}),arccsc:p({command:"arccsc",content:"csc^{-1}",ariaLabel:n.t("Inverse Cosecant")}),arcsec:p({command:"arcsec",content:"sec^{-1}",ariaLabel:n.t("Inverse Secant")}),arccot:p({command:"arccot",content:"cot^{-1}",ariaLabel:n.t("Inverse Cotangent")}),"|a|":c({typedText:"|",ariaLabel:n.t("Absolute Value")}),"|x|":c({typedText:"|",ariaLabel:n.t("Absolute Value")}),ln:u({ariaLabel:n.t("Natural Log")}),log:u({ariaLabel:n.t("Log")}),quantile:u({ariaLabel:n.t("Quantile")}),quartile:u({ariaLabel:n.t("Quartile")}),var:u({}),nCr:u({}),loga:p({command:"loga",content:"log_a",ariaLabel:n.t("Log A")}),stdev:u({ariaLabel:n.t("Standard Deviation")}),mad:u({}),nPr:u({}),total:u({}),length:u({}),min:u({}),max:u({}),cov:u({ariaLabel:n.t("Co Variance")}),corr:u({ariaLabel:n.t("Correlation")}),mean:u({ariaLabel:n.t("Mean")}),stdevp:u({ariaLabel:n.t("Standard Deviation of Population")}),mod:u({}),"e^x":c({typedText:"e^",ariaLabel:n.t("Exponent")}),sum:c({content:"\\sum",ariaLabel:n.t("Sum")}),prod:c({content:"\\prod",ariaLabel:n.t("Product")}),floor:u({ariaLabel:n.t("Floor")}),ceil:u({ariaLabel:n.t("Ceiling")}),round:u({ariaLabel:n.t("Round")}),abs:u({ariaLabel:n.t("Absolute Value")}),"!":c({ariaLabel:n.t("Factorial")}),"n!":c({typedText:"!",ariaLabel:n.t("Factorial")}),median:u({ariaLabel:n.t("Median")}),lcm:u({}),gcd:u({}),gcf:u({}),ddx:p({command:"ddx",content:"\\frac{d}{dx}"}),int:c({content:"\\int",ariaLabel:n.t("Integral")}),"%":c({content:"\\%",ariaLabel:n.t("Percent Of")}),exp:c({}),sign:u({}),normdist:u({ariaLabel:n.t("Normal Distribution")}),poissondist:u({ariaLabel:n.t("Poisson Distribution")}),binomdist:u({ariaLabel:n.t("Binomial Distribution")}),tdist:u({ariaLabel:n.t("Student-t Distribution")}),pdf:u({ariaLabel:n.t("Probability Density Function")}),cdf:u({ariaLabel:n.t("Cumulative Density Function")}),"A^-1":p({command:"A^-1",content:"A^{-1}",ariaLabel:n.t("Inverse")}),"A^T":p({command:"A^T",content:"A^T",ariaLabel:n.t("Transpose")}),"A^2":p({command:"A^2",content:"A^2",ariaLabel:n.t("Squared")}),det:u({ariaLabel:"Determinant"}),"A^n":c({content:"A^n",typedText:"^",ariaLabel:n.t("Exponent")}),a:c({}),b:c({}),c:c({}),d:c({}),e:c({}),f:c({}),g:c({}),h:c({}),i:c({}),j:c({}),k:c({}),l:c({}),m:c({}),n:c({}),o:c({}),p:c({}),q:c({}),r:c({}),s:c({}),t:c({}),u:c({}),v:c({}),w:c({}),x:c({}),boldX:c({content:"x",typedText:"x"}),y:c({}),boldY:c({content:"y",typedText:"y"}),z:c({}),A:c({}),B:c({}),C:c({}),D:c({}),E:c({}),F:c({}),G:c({}),H:c({}),I:c({}),J:c({}),K:c({}),L:c({}),M:c({}),N:c({}),O:c({}),P:c({}),Q:c({}),R:c({}),S:c({}),T:c({}),U:c({}),V:c({}),W:c({}),X:c({}),Y:c({}),Z:c({}),0:c({}),1:c({}),2:c({}),3:c({}),4:c({}),5:c({}),6:c({}),7:c({}),8:c({}),9:c({}),",":c({}),"=":c({}),"[":c({}),"]":c({}),"{}_left":r({keys:["{","}"]}),"{}_right":l({keys:["{","}"]}),"()_left":r({keys:["(",")"]}),"()_right":l({keys:["(",")"]}),"[]_left":r({keys:["[","]"]}),"[]_right":l({keys:["[","]"]}),",'_left":r({keys:[",",""]}),",'_right":l({keys:[",",""],typedText:"'"}),'"':c({}),"'":c({}),"~":c({}),":":c({}),">":c({}),"<":c({}),">=":c({content:"\\ge"}),"<=":c({content:"\\le"})};t.view=function(e,t,r){void 0===r&&(r={});var n=e.dispatch;return d[t](t,n,r)},t.spacer=function(e){return void 0===e&&(e=1),a.createElement("div",{style:a.const("flex-grow:"+e)})}}),define("keypad/dcgview-keypad",["require","exports","tslib","dcgview"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t}(n.Class);t.default=i}),define("loadcss!keypad/keypad",function(){}),define("keypad/keypad",["require","exports","tslib","dcgview","./dcgview-keypad","loadcss!./keypad"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement("div",{class:n.const("dcg-basic-keypad dcg-do-not-blur")},this.children)},t}(i.default);t.default=o}),define("loadcss!keypad/row",function(){}),define("keypad/row",["require","exports","tslib","dcgview","loadcss!./row"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement("div",{class:n.const("dcg-keypad-row")},this.children)},t}(n.Class);t.default=i}),define("graphing-calc/keypads/qwerty",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"q"),o.view(this,"w"),o.view(this,"e"),o.view(this,"r"),o.view(this,"t"),o.view(this,"y"),o.view(this,"u"),o.view(this,"i"),o.view(this,"o"),o.view(this,"p")),n.createElement(s.default,null,o.view(this,"a"),o.view(this,"s"),o.view(this,"d"),o.view(this,"f"),o.view(this,"g"),o.view(this,"h"),o.view(this,"j"),o.view(this,"k"),o.view(this,"l"),o.view(this,"theta")),n.createElement(s.default,null,o.view(this,"shift",{colspan:1.364,style:"highlight"}),o.spacer(.136),o.view(this,"z"),o.view(this,"x"),o.view(this,"c"),o.view(this,"v"),o.view(this,"b"),o.view(this,"n"),o.view(this,"m"),o.spacer(.136),o.view(this,"backspace",{colspan:1.364,style:"highlight"})),n.createElement(s.default,null,o.view(this,"123",{colspan:1.818,style:"highlight"}),o.spacer(.182),o.view(this,"a_b"),o.view(this,"()_left"),o.view(this,"[]_left"),o.view(this,"{}_left"),o.view(this,"~"),o.view(this,",'_left"),o.spacer(.182),o.view(this,"enter",{colspan:1.818,style:"highlight"})))},t}(i.default);t.default=l}),define("graphing-calc/keypads/qwerty-capital",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"Q"),o.view(this,"W"),o.view(this,"E"),o.view(this,"R"),o.view(this,"T"),o.view(this,"Y"),o.view(this,"U"),o.view(this,"I"),o.view(this,"O"),o.view(this,"P")),n.createElement(s.default,null,o.view(this,"A"),o.view(this,"S"),o.view(this,"D"),o.view(this,"F"),o.view(this,"G"),o.view(this,"H"),o.view(this,"J"),o.view(this,"K"),o.view(this,"L"),o.view(this,"tau")),n.createElement(s.default,null,o.view(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),o.spacer(.136),o.view(this,"Z"),o.view(this,"X"),o.view(this,"C"),o.view(this,"V"),o.view(this,"B"),o.view(this,"N"),o.view(this,"M"),o.spacer(.136),o.view(this,"backspace",{colspan:1.364,style:"highlight"})),n.createElement(s.default,null,o.view(this,"123",{colspan:1.818,style:"highlight"}),o.spacer(.182),o.view(this,"a^b"),o.view(this,"()_right"),o.view(this,"[]_right"),o.view(this,"{}_right"),o.view(this,":"),o.view(this,",'_right"),o.spacer(.182),o.view(this,"enter",{colspan:1.818,style:"highlight"})))},t}(i.default);t.default=l}),define("graphing-calc/keypads/numbers",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad","keypad/row","keypad/btn"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"boldX"),o.view(this,"boldY"),o.view(this,"a^2"),o.view(this,"a^b"),o.spacer(.5),o.view(this,"7",{style:"highlight"}),o.view(this,"8",{style:"highlight"}),o.view(this,"9",{style:"highlight"}),o.view(this,"/"),o.spacer(.5),n.createElement(l.default,{command:this.const("functions"),ariaLabel:function(){return e.controller.t("Functions")},colspan:this.const(2),style:this.const("highlight"),active:function(){return e.controller.isKeypadFunctionsPopoverOpen()},onTap:function(){return e.dispatch({type:"keypad/functions"})}},this.bindFn(this.getFuncsBtnText))),n.createElement(s.default,null,o.view(this,"("),o.view(this,")"),o.view(this,"<"),o.view(this,">"),o.spacer(.5),o.view(this,"4",{style:"highlight"}),o.view(this,"5",{style:"highlight"}),o.view(this,"6",{style:"highlight"}),o.view(this,"*"),o.spacer(.5),o.view(this,"left",{style:"highlight"}),o.view(this,"right",{style:"highlight"})),n.createElement(s.default,null,o.view(this,"|a|"),o.view(this,","),o.view(this,"<="),o.view(this,">="),o.spacer(.5),o.view(this,"1",{style:"highlight"}),o.view(this,"2",{style:"highlight"}),o.view(this,"3",{style:"highlight"}),o.view(this,"-"),o.spacer(1),o.view(this,"backspace",{colspan:1.5,style:"highlight"})),n.createElement(s.default,null,o.view(this,"ABC",{colspan:2,style:"highlight"}),o.view(this,"sqrt"),o.view(this,"pi"),o.spacer(.5),o.view(this,"0",{style:"highlight"}),o.view(this,".",{style:"highlight"}),o.view(this,"="),o.view(this,"+"),o.spacer(.5),o.view(this,"enter",{colspan:2,style:"highlight"})))},t.prototype.getFuncsBtnText=function(){return this.controller.isNarrow()?this.controller.t("funcs"):this.controller.t("functions")},t}(i.default);t.default=c}),define("graphing-calc/keypads/letters",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"a"),o.view(this,"b"),o.view(this,"c"),o.view(this,"d"),o.view(this,"e"),o.view(this,"f"),o.view(this,"g"),o.view(this,"h"),o.view(this,"i")),n.createElement(s.default,null,o.view(this,"j"),o.view(this,"k"),o.view(this,"l"),o.view(this,"m"),o.view(this,"n"),o.view(this,"o"),o.view(this,"p"),o.view(this,"q"),o.view(this,"r")),n.createElement(s.default,null,o.view(this,"s"),o.view(this,"t"),o.view(this,"u"),o.view(this,"v"),o.view(this,"w"),o.view(this,"x"),o.view(this,"y"),o.view(this,"z"),o.view(this,"backspace",{colspan:1,style:"highlight"})),n.createElement(s.default,null,o.view(this,"123",{colspan:1.75,style:"highlight"}),o.spacer(.1),o.view(this,"a_b"),o.view(this,"()_left"),o.view(this,"[]_left"),o.view(this,"{}_left"),o.view(this,"~"),o.view(this,","),o.spacer(.1),o.view(this,"enter",{colspan:1.75,style:"highlight"})))},t}(i.default);t.default=l}),define("graphing-calc/keypads/trig",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components.If,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement(a.default,{controller:this.props.controller},this.b("sin"),this.b("arcsin"),this.b("sinh"),this.b("cos"),this.b("arccos"),this.b("cosh"),this.b("tan"),this.b("arctan"),this.b("tanh"),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("csc")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("arccsc")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("csch")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("sec")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("arcsec")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("sech")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("cot")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("arccot")}),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("coth")}))},t.prototype.b=function(e){return o.view(this,e,{style:"popover"})},t.prototype.isNotRestricted=function(){return!this.controller.areFunctionsRestricted()},t}(i.default);t.default=l}),define("graphing-calc/keypads/stats",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components.If,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement(a.default,{controller:this.props.controller},this.b("total"),this.b("length"),this.b("mean"),this.b("median"),this.b("min"),this.b("max"),this.b("quartile"),this.b("quantile"),this.b("~"),this.b("stdev"),this.b("stdevp"),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("mad")}),this.b("var"),n.createElement(s,{predicate:this.bindFn(this.isNotRestricted)},function(){return e.b("cov")}),this.b("corr"),this.b("nCr"),this.b("nPr"),this.b("n!"))},t.prototype.b=function(e){return o.view(this,e,{style:"popover"})},t.prototype.isNotRestricted=function(){return!this.controller.areFunctionsRestricted()},t}(i.default);t.default=l}),define("graphing-calc/keypads/misc",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},this.b("lcm"),this.b("gcd"),this.b("mod"),this.b("ceil"),this.b("floor"),this.b("round"),this.b("abs"),this.b("sign"),this.b("%"),this.b("exp"),this.b("ln"),this.b("nthroot"),this.b("log"),this.b("loga"),this.b("ddx"),this.b("int"),this.b("sum"),this.b("prod"))},t.prototype.b=function(e){return o.view(this,e,{style:"popover"})},t}(i.default);t.default=s}),define("graphing-calc/keypads/distributions",["require","exports","tslib","dcgview","./dcgview-graphing","keypad/keys","keypad/keypad"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},o.view(this,"normdist"),o.view(this,"pdf"),o.view(this,"var"),o.view(this,"tdist"),o.view(this,"cdf"),o.view(this,"stdev"),o.view(this,"binomdist"),o.view(this,"mean"),o.view(this,"quantile"),o.view(this,"poissondist"),o.view(this,"median"))},t}(i.default);t.default=s}),define("loadcss!graphing-calc/keypads/functions-popover",function(){}),define("graphing-calc/keypads/functions-popover",["require","exports","tslib","dcgview","./dcgview-graphing","./trig","./stats","./misc","./distributions","loadcss!./functions-popover"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.Components,u=c.Switch,p=c.If,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-functions-popover dcg-popover dcg-top")},n.createElement("div",{class:n.const("dcg-popover-interior")},n.createElement("div",{class:n.const("dcg-popover-header")},n.createElement("span",{role:n.const("button"),"dcg-command":n.const("trigTab"),class:function(){return{"dcg-heading":!0,"dcg-selected":"trig"===t.controller.getKeypadFunctionsTab()}},onTap:function(){t.dispatch({type:"keypad/set-functions-tab",tab:"trig"})}},n.const("trig")),n.createElement("span",{role:n.const("button"),"dcg-command":n.const("statsTab"),class:function(){return{"dcg-heading":!0,"dcg-selected":"stats"===t.controller.getKeypadFunctionsTab()}},onTap:function(){t.dispatch({type:"keypad/set-functions-tab",tab:"stats"})}},n.const("stats")),n.createElement("span",{role:n.const("button"),"dcg-command":n.const("miscTab"),class:function(){return{"dcg-heading":!0,"dcg-selected":"misc"===t.controller.getKeypadFunctionsTab()}},onTap:function(){t.dispatch({type:"keypad/set-functions-tab",tab:"misc"})}},n.const("misc")),n.createElement(p,{predicate:function(){return t.controller.areDistributionsEnabled()}},function(){return n.createElement("span",{role:n.const("button"),"dcg-command":n.const("distTab"),class:function(){return{"dcg-heading":!0,"dcg-selected":"dist"===t.controller.getKeypadFunctionsTab()}},onTap:function(){t.dispatch({type:"keypad/set-functions-tab",tab:"dist"})}},n.const("dist"))})),n.createElement("div",{class:n.const("dcg-interior-buttons")},n.createElement(u,{key:function(){return t.controller.getKeypadFunctionsTab()}},function(e){switch(e){case"trig":return n.createElement(o.default,{controller:t.props.controller});case"stats":return n.createElement(a.default,{controller:t.props.controller});case"misc":return n.createElement(s.default,{controller:t.props.controller});case"dist":return n.createElement(l.default,{controller:t.props.controller});default:return n.createElement("span",null)}}))),n.createElement("div",{class:n.const("dcg-arrow")}))},t}(i.default);t.default=d}),define("loadcss!graphing-calc/keypads/graphing-keypad-container",function(){}),define("graphing-calc/keypads/main",["require","exports","tslib","dcgview","./dcgview-graphing","./qwerty","./qwerty-capital","./numbers","./letters","./functions-popover","jquery","underscore","../../lib/tooltip","loadcss!./graphing-keypad-container"],function(e,t,r,n,i,o,a,s,l,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=n.Components,f=h.Switch,g=h.If,m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return n.createElement("div",{class:n.const("dcg-keypad"),role:n.const("complementary"),"aria-label":n.const("Keypad")},n.createElement("div",{class:n.const("dcg-keys-container"),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer)},n.createElement("div",{class:n.const("dcg-keys-background dcg-do-not-blur"),style:function(){return{background:t.controller.getPillboxBackgroundColor()}}},n.createElement("div",{class:n.const("dcg-keys")},n.createElement(f,{key:function(){return t.controller.getKeypadLayout()}},function(e){switch(e){case"letters":return n.createElement(o.default,{controller:t.props.controller});case"capitalLetters":return n.createElement(a.default,{controller:t.props.controller});case"mainNumbers":return n.createElement(s.default,{controller:t.props.controller});case"noQwertyLetters":return n.createElement(l.default,{controller:t.props.controller});default:return n.createElement("span",null)}}),n.createElement(g,{predicate:function(){return t.controller.isKeypadFunctionsPopoverOpen()}},function(){return n.createElement(c.default,{controller:t.props.controller})})),n.createElement(g,{predicate:this.bindFn(this.isHideKeypadButtonVisible)},function(){return n.createElement("div",{class:n.const("dcg-minimize-keypad-container")},n.createElement(d.Tooltip,{tooltip:function(){return t.controller.t("Hide Keypad")},gravity:t.const("ne"),offset:t.const({left:6})},n.createElement("div",{role:n.const("button"),"aria-label":function(){return t.controller.t("Hide Keypad")},class:n.const("dcg-minimize-keypad"),style:function(){return{"border-bottom-color":t.controller.getPillboxBackgroundColor(),background:t.controller.getPillboxBackgroundColor()}},onTap:function(){t.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},n.createElement("i",{class:n.const("dcg-icon-keyboard")}),n.createElement("i",{class:n.const("dcg-icon-caret-down")}))))}))),n.createElement(g,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},function(){return n.createElement("div",{class:n.const("dcg-show-keypad-container")},n.createElement(d.Tooltip,{tooltip:function(){return t.controller.t("Show Keypad")},gravity:t.const("ne")},n.createElement("div",{role:n.const("button"),"aria-label":function(){return t.controller.t("Show Keypad")},class:n.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),style:function(){return{background:t.controller.getPillboxBackgroundColor()}},onTap:function(){t.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},n.createElement("i",{class:n.const("dcg-icon-keyboard")}),n.createElement("i",{class:n.const("dcg-icon-caret-up dcg-do-not-blur")}))))}))},t.prototype.didMountContainer=function(e){this.containerElt=e},t.prototype.isShowKeypadButtonVisible=function(){return!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&this.controller.isListVisible()},t.prototype.isHideKeypadButtonVisible=function(){return this.controller.isKeypadOpen()&&!this.controller.isNarrow()},t.prototype.didMount=function(){this.updatePopoverPosition()},t.prototype.didUpdate=function(){this.updatePopoverPosition()},t.prototype.computeStyles=function(){var e={};return this.controller.isNarrow()||(e.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(e.opacity="0",e.transform="translate3d(0, 255px, 0)"),e},t.prototype.updatePopoverPosition=function(){if(this.controller.isKeypadFunctionsPopoverOpen()){var e=this.controller.computeMajorLayout(),t={keypadTop:e.keypad.top,keypadWidth:e.keypad.width,keypadHeight:e.keypad.height,showToLeft:e.grapher.height<525};if(!p.isEqual(t,this.__popoverCache)){this.__popoverCache=t;var r=u(this.containerElt),n=r.find("[dcg-command=functions]"),i=r.find(".dcg-functions-popover"),o=r.find(".dcg-arrow");if(t.showToLeft){i.removeClass("dcg-top").addClass("dcg-left");var a=t.keypadHeight-(n.offset().top-r.offset().top)-n.outerHeight()/2-2-10;o.css({left:"auto",bottom:a})}else i.removeClass("dcg-left").addClass("dcg-top"),o.css({left:i.width()-n.width()/2,bottom:"auto"})}}else this.__popoverCache=void 0},t}(i.default);t.default=m}),define("loadcss!pillboxes",function(){}),define("main/graphpaper-branding-view",["require","exports","tslib","dcgview","loadcss!pillboxes"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.Components.Switch,o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),n.createElement(i,{key:function(){return t.controller.getBrandingMode()}},function(e){switch(e){case"static-edit-link":return n.createElement("div",{class:n.const("dcg-graphpaper-branding")},n.createElement("a",{href:function(){return t.controller.getEditLink()},target:n.const("_blank")},n.createElement("span",{class:n.const("dcg-powered-by"),"aria-label":function(){return t.controller.t("Edit graph on Desmos")}},function(){return t.controller.t("edit graph on")}),n.createElement("i",{class:n.const("dcg-icon-desmos")})));case"edit-link":return n.createElement("div",{class:n.const("dcg-graphpaper-branding")},n.createElement("span",{class:n.const("dcg-edit-branding"),onTap:function(){return t.controller.dispatch({type:"open-on-web"})}},n.createElement("span",{class:n.const("dcg-powered-by"),"aria-label":function(){return t.controller.t("Edit graph on Desmos")}},function(){return t.controller.t("edit graph on")}),n.createElement("i",{class:n.const("dcg-icon-desmos")})));case"powered-by":return n.createElement("div",{class:n.const("dcg-graphpaper-branding dcg-unclickable")},n.createElement("span",{class:n.const("dcg-powered-by"),"aria-label":function(){return t.controller.t("Powered by Desmos")}},function(){return t.controller.t("powered by")}),n.createElement("i",{class:n.const("dcg-icon-desmos")}));default:return e}})},t}(n.Class);t.default=o}),define("loadcss!main/settings-view",function(){}),define("main/settings-view",["require","exports","tslib","keys","scroll_helpers","lib/tooltip","dcgview","dcgview-helpers/static-mathquill-view","dcgview-helpers/mathquill-view","jquery","graphing/axisarrowmode","lib/evaluate-single-expression","graphing/viewport","dcgview-helpers/checkbox","loadcss!./settings-view"],function(e,t,r,o,n,i,a,s,l,c,u,p,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.Components,g=f.Input,m=f.If,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return a.createElement(l.default,{isFocused:function(){return t.props.parent().getFocusedLimit()===t.props.limit()},latex:function(){return t.props.parent().getLimitLatex(t.props.limit())},capExpressionSize:function(){return t.props.parent().getCapExpressionSize()},config:this.const({}),getAriaLabel:function(){return t.props.ariaLabel()},getAriaPostLabel:this.const(""),onUserChangedLatex:function(e){return t.props.parent().setLimitLatex(t.props.limit(),e)},onFocusedChanged:function(e){return t.props.parent().onFocusedChanged(t.props.limit(),e)},hasError:this.const(!1),selectOnFocus:this.const(!0)},a.createElement("span",{class:function(){return{"dcg-math-field":!0,"dcg-math-input":!0,"dcg-invalid":t.props.parent().isLimitInvalid(t.props.limit()),"dcg-focus":t.props.parent().getFocusedLimit()===t.props.limit()}},"data-dcg-limit":function(){return t.props.limit()}}))},t}(a.Class),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return this.controller=this.props.controller(),a.createElement("div",{class:a.const("dcg-settings-view-container")},a.createElement(i.Tooltip,{tooltip:function(){return t.controller.t("Graph Settings")},gravity:this.const("w")},a.createElement("div",{class:a.const("dcg-btn-flat-gray dcg-settings-pillbox dcg-action-settings"),role:a.const("button"),tabindex:a.const("0"),"aria-haspopup":a.const("true"),"aria-expanded":function(){return t.controller.isGraphSettingsOpen()},"aria-label":function(){return t.controller.t("Graph Settings")},didMount:this.bindFn(this.didMountSettingsButton),onTap:this.bindFn(this.onTapSettingsButton),style:function(){return{background:t.controller.getPillboxBackgroundColor()}}},a.createElement("i",{class:a.const("dcg-icon-wrench"),"aria-hidden":a.const("true")}))),a.createElement(m,{predicate:function(){return t.controller.isGraphSettingsOpen()}},function(){return a.createElement("div",{class:a.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:t.bindFn(t.getContainerStyle),didMount:t.bindFn(t.didMountContainer)},a.createElement("div",{class:a.const("dcg-popover-interior"),role:a.const("complementary"),"aria-label":a.const("Graph Settings")},a.createElement("div",{class:function(){return{"dcg-modern-btn":!0,"dcg-action-projectormode":!0,"dcg-active":t.getProjectorMode()}},role:a.const("button"),tabindex:a.const("0"),"aria-label":function(){return t.controller.t("Projector Mode")},"aria-pressed":t.bindFn(t.getProjectorMode),onTap:t.bindFn(t.toggleProjectorMode),didMount:t.bindFn(t.didMountProjectorMode)},function(){return t.controller.t("Projector Mode")}),a.createElement("div",{class:a.const("dcg-top-section-flex")},a.createElement("div",{class:a.const("dcg-grid-settings")},a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("Grid")},onChange:t.bindFn(t.toggleGrid),checked:t.bindFn(t.getShowGrid),green:t.const(!0)},function(){return t.controller.t("Grid")}),a.createElement(m,{predicate:t.bindFn(t.getShowGrid)},function(){return a.createElement("div",{class:a.const("dcg-circle-icon-group dcg-grid-group")},a.createElement("div",{class:function(){return{"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-active":!t.getPolarMode()}},role:a.const("button"),tabindex:a.const("0"),ariaPressed:function(){return!t.getPolarMode()},"aria-label":function(){return t.controller.t("Cartesian Grid")},onTap:t.bindFn(t.setCartesianMode)}),a.const(""),a.createElement("div",{class:function(){return{"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-active":t.getPolarMode()}},role:a.const("button"),tabindex:a.const("0"),ariaPressed:function(){return t.getPolarMode()},"aria-label":function(){return t.controller.t("Polar Grid")},onTap:t.bindFn(t.setPolarMode)}))}),a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("Arrows")},onChange:t.bindFn(t.toggleArrows),checked:function(){return t.getAxisArrowMode()!==u.NONE},green:t.const(!0)},function(){return t.controller.t("Arrows")}),a.createElement(m,{predicate:function(){return t.getAxisArrowMode()!==u.NONE}},function(){return a.createElement("div",{class:a.const("dcg-circle-icon-group dcg-arrow-group")},a.createElement("div",{role:a.const("button"),tabindex:a.const("0"),class:function(){return{"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-active":t.getAxisArrowMode()===u.BOTH}},"dcg-arrows":a.const("BOTH"),"aria-label":function(){return t.controller.t("Show Both")},"aria-pressed":function(){return t.getAxisArrowMode()===u.BOTH},onTap:function(){return t.setAxisArrowMode(u.BOTH)}},a.createElement("i",{class:a.const("dcg-icon-arrows-two")})),a.const(""),a.createElement("div",{role:a.const("button"),tabindex:a.const("0"),class:function(){return{"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-active":t.getAxisArrowMode()===u.POSITIVE}},"dcg-arrows":a.const("POSITIVE"),"aria-label":function(){return t.controller.t("Show Positive")},"aria-pressed":function(){return t.getAxisArrowMode()===u.POSITIVE},onTap:function(){return t.setAxisArrowMode(u.POSITIVE)}},a.createElement("i",{class:a.const("dcg-icon-arrows-one")})))})),a.createElement("div",{class:a.const("dcg-top-checkboxes-container")},a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("Axis Numbers")},onChange:t.bindFn(t.toggleAxisNumbers),checked:t.bindFn(t.getAxisNumbers),small:t.const(!0),green:t.const(!0)},function(){return t.controller.t("Axis Numbers")}),a.createElement(m,{predicate:function(){return t.getShowGrid()&&!t.getPolarMode()}},function(){return a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("Minor Gridlines")},onChange:t.bindFn(t.toggleMinorGridlines),checked:t.bindFn(t.getMinorGridlines),small:t.const(!0),green:t.const(!0)},function(){return t.controller.t("Minor Gridlines")})}),a.createElement(m,{predicate:function(){return t.controller.canUseAdvancedStyling()&&!t.getPolarMode()}},function(){return a.createElement(h.Checkbox,{checked:function(){return t.controller.getGraphSettings().restrictGridToFirstQuadrant},ariaLabel:t.const("One Quadrant"),onChange:function(e){return t.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e})},small:t.const(!0),green:t.const(!0)},a.const("One Quadrant"))}),a.createElement(m,{predicate:function(){return!t.getSquareAxes()}},function(){return a.createElement("div",{role:a.const("button"),tabindex:a.const("0"),class:a.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:t.bindFn(t.zoomSquare)},function(){return t.controller.t("Zoom Square")})}))),a.createElement("div",{class:a.const("dcg-section-divider"),"aria-hidden":a.const("true")}),a.createElement("div",{class:a.const("dcg-checkbox-title dcg-x-axis-title")},a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("X-Axis")},onChange:t.bindFn(t.toggleXAxis),checked:t.bindFn(t.getShowXAxis),green:t.const(!0)},function(){return t.controller.t("X-Axis")}),a.createElement(g,{class:t.const("dcg-axis-label dcg-x-axis-label"),placeholder:function(){return t.controller.t("add a label")},"aria-label":function(){return t.controller.t("add x-axis label")},disabled:function(){return!t.getShowXAxis()||void 0},"aria-disabled":function(){return!t.getShowXAxis()||void 0},onInput:t.bindFn(t.onXAxisLabelInput),value:t.bindFn(t.getXAxisLabel)})),a.createElement("div",{class:a.const("dcg-editable-mathquill-container dcg-x-axis-options")},a.createElement(y,{limit:t.const("xmin"),ariaLabel:function(){return t.controller.t("X Axis Minimum: ")},parent:t.const(t)}),a.createElement(s.default,{latex:t.const("\\le x\\le")},a.createElement("span",{class:a.const("dcg-interval-interior")})),a.createElement(y,{limit:t.const("xmax"),ariaLabel:function(){return t.controller.t("X Axis Maximum: ")},parent:t.const(t)}),a.createElement(m,{predicate:function(){return!t.getPolarMode()}},function(){return a.createElement("span",{class:a.const("dcg-step-container")},a.createElement("span",{class:a.const("dcg-step-label"),"aria-hidden":a.const("true")},function(){return t.controller.t("Step:")}),a.createElement(y,{limit:t.const("xstep"),ariaLabel:function(){return t.controller.t("X Axis Step Size: ")},parent:t.const(t)}))})),a.createElement("div",{class:a.const("dcg-checkbox-title dcg-y-axis-title")},a.createElement(h.Checkbox,{ariaLabel:function(){return t.controller.t("Y-Axis")},onChange:t.bindFn(t.toggleYAxis),checked:t.bindFn(t.getShowYAxis),green:t.const(!0)},function(){return t.controller.t("Y-Axis")}),a.createElement(g,{class:t.const("dcg-axis-label dcg-y-axis-label"),placeholder:function(){return t.controller.t("add a label")},"aria-label":function(){return t.controller.t("add y-axis label")},disabled:function(){return!t.getShowYAxis()||void 0},"aria-disabled":function(){return!t.getShowYAxis()||void 0},onInput:t.bindFn(t.onYAxisLabelInput),value:t.bindFn(t.getYAxisLabel)})),a.createElement("div",{class:a.const("dcg-editable-mathquill-container dcg-y-axis-options")},a.createElement(y,{limit:t.const("ymin"),ariaLabel:function(){return t.controller.t("Y Axis Minimum: ")},parent:t.const(t)}),a.createElement(s.default,{latex:t.const("\\le y\\le")},a.createElement("span",{class:a.const("dcg-interval-interior")})),a.createElement(y,{limit:t.const("ymax"),ariaLabel:function(){return t.controller.t("Y Axis Maximum: ")},parent:t.const(t)}),a.createElement(m,{predicate:function(){return!t.getPolarMode()}},function(){return a.createElement("span",{class:a.const("dcg-step-container")},a.createElement("span",{class:a.const("dcg-step-label"),"aria-hidden":a.const("true")},function(){return t.controller.t("Step:")}),a.createElement(y,{limit:t.const("ystep"),ariaLabel:function(){return t.controller.t("Y Axis Step Size: ")},parent:t.const(t)}))})),a.createElement("div",{class:a.const("dcg-section-divider"),"aria-hidden":a.const("true")}),a.createElement("div",{class:a.const("dcg-radiangroup"),role:a.const("group"),"aria-label":function(){return t.controller.t("Angle Settings")}},a.createElement("div",{class:function(){return{"dcg-action-radianmode":!0,"dcg-modern-btn":!0,"dcg-active":!t.getDegreeMode()}},"aria-pressed":function(){return!t.getDegreeMode()},role:a.const("button"),tabindex:a.const("0"),"aria-label":function(){return t.controller.t("Radians")},onTap:t.bindFn(t.setRadianMode)},function(){return t.controller.t("Radians")}),a.createElement("div",{class:function(){return{"dcg-action-degreemode":!0,"dcg-modern-btn":!0,"dcg-active":t.getDegreeMode()}},"aria-pressed":t.bindFn(t.getDegreeMode),role:a.const("button"),tabindex:a.const("0"),"aria-label":function(){return t.controller.t("Degrees")},onTap:t.bindFn(t.setDegreeMode)},function(){return t.controller.t("Degrees")})),a.createElement("div",{class:a.const("dcg-arrow")})))}))},t.prototype.didMountSettingsButton=function(e){this.settingsButtonNode=e},t.prototype.didMountContainer=function(e){var i=this;this.node=e,c(document).on("dcg-tapstart.settings-view wheel.settings-view",function(e){i.eventShouldClosePopover(e)&&i.controller.dispatch({type:"close-graph-settings"})}),c(document).on("keydown.settings-view",function(e){if("Esc"===o.lookup(e)&&i.controller.dispatch({type:"close-graph-settings"}),i.controller.isGraphSettingsOpen()&&"Tab"===o.lookup(e)&&!e.altKey&&!e.metaKey&&!e.ctrlKey){var t=document.activeElement,r=c(i.settingsButtonNode),n=c(i.node).find(".dcg-action-degreemode");e.shiftKey||t!==n[0]?e.shiftKey&&t===r[0]&&(n.focus(),e.preventDefault(),e.stopPropagation()):(r.focus(),e.preventDefault(),e.stopPropagation())}})},t.prototype.didMountProjectorMode=function(e){this.controller.getSettingsViewModel().focusOnOpen&&c(e).focus()},t.prototype.didUnmount=function(){c(document).off(".settings-view")},t.prototype.didUpdate=function(){if(this.controller.isGraphSettingsOpen()){var e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&c(document.activeElement).closest(this.node).length&&n.scrollVisible(c(document.activeElement),c(this.node).find(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}},t.prototype.eventShouldClosePopover=function(e){var t=c(e.target),r=!!t.closest(this.node).length,n=!!t.closest(".dcg-action-settings").length,i=this.isMathquillFocused()&&t.closest(".dcg-keypad").length,o=!!t.closest(".dcg-action-undo").length||!!t.closest(".dcg-action-redo").length;return!(r||n||i||o)},t.prototype.onTapSettingsButton=function(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:"keyboard"===e.device})},t.prototype.isMathquillFocused=function(){return void 0!==this.getFocusedLimit()},t.prototype.getLimitLatex=function(e){return this.controller.getSettingsViewModel().limitLatex[e]},t.prototype.setLimitLatex=function(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})},t.prototype.getFocusedLimit=function(){var e=this.controller.getFocusLocation();if(e&&"settings"===e.type)return e.location},t.prototype.getInvalidLimits=function(){var e=!!this.controller.getGraphSettings().degreeMode,t=p.default(this.getLimitLatex("xmin"),e),r=p.default(this.getLimitLatex("xmax"),e),n=p.default(this.getLimitLatex("ymin"),e),i=p.default(this.getLimitLatex("ymax"),e),o=""===this.getLimitLatex("xstep")?0:p.default(this.getLimitLatex("xstep"),e),a=""===this.getLimitLatex("ystep")?0:p.default(this.getLimitLatex("ystep"),e),s={},l=new d.Viewport(t,r,n,i);return isFinite(t)&&isFinite(r)?(s.xmin=!l.isXValid(),s.xmax=s.xmin):(s.xmin=!isFinite(t),s.xmax=!isFinite(r)),isFinite(n)&&isFinite(i)?(s.ymin=!l.isYValid(),s.ymax=s.ymin):(s.ymin=!isFinite(n),s.ymax=!isFinite(i)),s.xstep=!isFinite(o)||o<0,s.ystep=!isFinite(a)||a<0,s},t.prototype.isLimitInvalid=function(e){return this.getInvalidLimits()[e]},t.prototype.onFocusedChanged=function(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})},t.prototype.onXAxisLabelInput=function(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})},t.prototype.onYAxisLabelInput=function(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})},t.prototype.getXAxisLabel=function(){return this.controller.getGraphSettings().xAxisLabel},t.prototype.getYAxisLabel=function(){return this.controller.getGraphSettings().yAxisLabel},t.prototype.getShowXAxis=function(){return!!this.controller.getGraphSettings().showXAxis},t.prototype.toggleXAxis=function(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})},t.prototype.getShowYAxis=function(){return!!this.controller.getGraphSettings().showYAxis},t.prototype.toggleYAxis=function(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})},t.prototype.getAxisNumbers=function(){return!!this.controller.getGraphSettings().xAxisNumbers},t.prototype.toggleAxisNumbers=function(){var e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})},t.prototype.getMinorGridlines=function(){return 0===this.controller.getGraphSettings().xAxisMinorSubdivisions},t.prototype.toggleMinorGridlines=function(){var e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})},t.prototype.getPolarMode=function(){return!!this.controller.getGraphSettings().polarMode},t.prototype.setPolarMode=function(){this.controller.dispatch({type:"set-graph-settings",polarMode:!0})},t.prototype.setCartesianMode=function(){this.controller.dispatch({type:"set-graph-settings",polarMode:!1})},t.prototype.getDegreeMode=function(){return!!this.controller.getGraphSettings().degreeMode},t.prototype.setRadianMode=function(){this.controller.dispatch({type:"set-graph-settings",degreeMode:!1})},t.prototype.setDegreeMode=function(){this.controller.dispatch({type:"set-graph-settings",degreeMode:!0})},t.prototype.getProjectorMode=function(){return!!this.controller.getGraphSettings().config.projectorMode},t.prototype.toggleProjectorMode=function(){this.controller.getGraphSettings().config.setProperty("projectorMode",!this.getProjectorMode())},t.prototype.getAxisArrowMode=function(){return this.controller.getGraphSettings().xAxisArrowMode},t.prototype.setAxisArrowMode=function(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})},t.prototype.getShowGrid=function(){return this.controller.getGraphSettings().showGrid},t.prototype.toggleGrid=function(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})},t.prototype.toggleArrows=function(){var e=this.getAxisArrowMode()===u.NONE?u.BOTH:u.NONE;this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})},t.prototype.getSquareAxes=function(){return!!this.controller.getGraphSettings().squareAxes},t.prototype.getContainerStyle=function(){return this.controller.getKeypadHeight()?"bottom: 0":""},t.prototype.zoomSquare=function(){this.controller.dispatch({type:"set-graph-settings",squareAxes:!0})},t.prototype.getCapExpressionSize=function(){return!!this.controller.getGraphSettings().config.capExpressionSize},t}(a.Class);t.default=v}),define("main/zoom-buttons-view",["require","exports","tslib","dcgview","lib/tooltip","loadcss!pillboxes"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.template=function(){var e=this;return n.createElement("div",{class:n.const("dcg-zoom-container")},n.createElement("div",{class:n.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group"),style:function(){return{background:e.controller.getPillboxBackgroundColor()}}},n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Zoom In")},gravity:this.const("w")},n.createElement("div",{class:n.const("dcg-action-zoomin"),role:n.const("button"),tabindex:n.const("0"),"aria-label":function(){return e.controller.t("Zoom In")},onTap:this.bindFn(this.zoomIn),style:function(){return{background:e.controller.getPillboxBackgroundColor()}}},n.createElement("i",{class:n.const("dcg-icon dcg-icon-plus"),"aria-hidden":n.const("true")}))),n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Zoom Out")},gravity:this.const("w")},n.createElement("div",{class:n.const("dcg-option dcg-action-zoomout dcg-tooltip-e"),tooltip:function(){return e.controller.t("Zoom Out")},role:n.const("button"),tabindex:n.const("0"),"aria-label":function(){return e.controller.t("Zoom Out")},onTap:this.bindFn(this.zoomOut),style:function(){return{background:e.controller.getPillboxBackgroundColor()}}},n.createElement("i",{class:n.const("dcg-icon dcg-icon-minus"),"aria-hidden":n.const("true")})))),n.createElement(i.Tooltip,{tooltip:function(){return e.controller.t("Default Zoom")},gravity:this.const("w")},n.createElement("div",{class:function(){return{"dcg-btn-flat-gray":!0,"dcg-option":!0,"dcg-action-zoomrestore":!0,"dcg-disabled":e.getZoomedDefault()}},"aria-disabled":this.bindFn(this.getZoomedDefault),role:n.const("button"),tabindex:n.const("0"),"aria-label":function(){return e.controller.t("Restore Default Zoom")},onTap:this.bindFn(this.zoomRestore),style:function(){return{background:e.controller.getPillboxBackgroundColor()}}},n.createElement("i",{class:n.const("dcg-icon dcg-icon-home"),"aria-hidden":n.const("true")}))))},t.prototype.zoomIn=function(){this.controller.dispatch({type:"zoom",direction:"in"})},t.prototype.zoomOut=function(){this.controller.dispatch({type:"zoom",direction:"out"})},t.prototype.zoomRestore=function(){this.controller.dispatch({type:"zoom",direction:"default"})},t.prototype.getZoomedDefault=function(){return this.controller.getGraphSettings().zoomedDefault},t}(n.Class);t.default=o}),define("main/pillbox-view",["require","exports","tslib","dcgview","./graphpaper-branding-view","./settings-view","./zoom-buttons-view","loadcss!pillboxes"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components.If,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.template=function(){var e=this;return n.createElement("div",null,n.createElement(s,{predicate:this.bindFn(this.shouldShowContainer)},function(){return n.createElement("div",{class:n.const("dcg-pillbox-container"),role:n.const("group"),"aria-label":function(){return e.controller.t("Graph Settings Controls")}},n.createElement("div",{class:n.const("dcg-overgraph-pillbox-elements"),style:e.bindFn(e.getContainerStyle)},n.createElement(s,{predicate:e.bindFn(e.shouldShowSettings)},function(){return n.createElement(o.default,{controller:e.props.controller})}),n.createElement(s,{predicate:e.bindFn(e.shouldShowZoomButtons)},function(){return n.createElement(a.default,{controller:e.props.controller})})))}),n.createElement(i.default,{controller:function(){return e.props.controller()}}))},t.prototype.getContainerStyle=function(){var e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?"bottom: "+e+"px;":"bottom: auto"},t.prototype.shouldShowContainer=function(){return this.shouldShowSettings()||this.shouldShowZoomButtons()},t.prototype.shouldShowSettings=function(){return this.controller.getGraphSettings().config.settingsMenu},t.prototype.shouldShowZoomButtons=function(){return this.controller.getGraphSettings().config.zoomButtons},t}(n.Class);t.default=l}),define("loadcss!main/toast-view",function(){}),define("main/toast-view",["require","exports","tslib","dcgview","loadcss!./toast-view"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.Components.If,o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("span",{class:n.const("dcg-toast")},n.createElement("i",{class:n.const("dcg-icon-error")}),n.createElement(i,{predicate:function(){return!e.props.showUndo()&&(!e.props.showClose||e.props.showClose())}},function(){return n.createElement("i",{class:n.const("dcg-icon-remove"),onTap:function(){return e.props.onClose&&e.props.onClose()},role:n.const("link"),tabindex:n.const(0),"aria-label":n.const("Dismiss Notice")})}),n.createElement("span",{class:n.const("dcg-msg"),"aria-atomic":function(){return!e.props.noAria()},"aria-live":function(){return e.props.noAria()?"":"assertive"}},function(){return e.props.t(e.props.message())}),n.createElement(i,{predicate:this.props.showUndo},function(){return n.createElement("a",{role:n.const("link"),tabindex:n.const(0),class:n.const("dcg-undo"),onTap:function(){return e.props.onUndo&&e.props.onUndo()}},function(){return e.props.t("Undo")})}),n.createElement(i,{predicate:this.props.showLearnMore},function(){return n.createElement("a",{role:n.const("link"),tabindex:n.const(0),class:n.const("dcg-learn-more-link"),target:n.const("_blank"),onTap:function(){return e.props.onLearnMore&&e.props.onLearnMore()}},function(){return e.props.t("Learn more")})}),n.createElement(i,{predicate:function(){return!!e.props.link&&!!e.props.link()}},function(){return n.createElement("a",{role:n.const("link"),tabindex:n.const(0),class:n.const("dcg-learn-more-link"),target:n.const("_blank"),href:function(){return e.props.link().url}},function(){return e.props.link().text})}))},t.prototype.shouldUpdate=function(){return!!this.props.message()},t}(n.Class),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:function(){return{"dcg-toast-view":!0,"dcg-visible":!!e.props.message()}},"toast-style":function(){return e.props.toastStyle&&e.props.toastStyle()}},n.createElement(i,{predicate:function(){return!!e.props.message()}},function(){return n.createElement("div",{class:n.const("dcg-toast-wrapper")},n.createElement("div",{class:n.const("dcg-toast-cover")}),n.createElement(o,r.__assign({},e.props)))}))},t}(n.Class);t.ToastView=a}),define("main/disable-dragdrop-events",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.on("drag dragend dragenter dragover dragleave drop",function(e){e.preventDefault(),e.stopPropagation()})}}),define("graphing-calc/views/main",["require","exports","tslib","touchtracking","ipad.scrollfix","dcgview","jquery","../../expressions/list-view","graphing-calc/keypads/main","main/pillbox-view","main/toast-view","main/disable-dragdrop-events","lib/tooltip"],function(e,t,r,n,i,o,a,s,l,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=o.Components.If,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller()},t.prototype.settings=function(){return this.controller.getGraphSettings()},t.prototype.template=function(){var t=this;return o.createElement("div",{class:function(){return{"dcg-container":!0,"dcg-fullscreen":!t.controller.isListVisible(),"dcg-narrow":t.controller.isNarrow(),"dcg-PROJECTOR-MODE":t.settings().config.projectorMode,"dcg-inverted-colors":!!t.settings().config.invertedColors,"dcg-EDIT-LIST-MODE":t.controller.isInEditListMode(),"dcg-no-graphpaper":!t.settings().config.graphpaper,"dcg-no-branding":!t.settings().config.branding,"dcg-no-expression-topbar":!t.settings().config.expressionsTopbar,"dcg-default-border":!!t.settings().config.border,"dcg-no-hyperlinks":!t.settings().config.links,"dcg-has-background-color":t.controller.hasBackgroundColor()}},style:function(){return{"font-size":t.settings().config.fontSize+"px",background:t.controller.getBackgroundColor(),color:t.controller.getTextColor()}},role:o.const("application"),"aria-label":function(){return t.controller.t("Desmos Graphing Calculator")},"x-ms-format-detection":o.const("none"),didMount:this.bindFn(this.didMountRoot)},o.createElement(h,{predicate:function(){return t.controller.getGraphSettings().config.expressions}},function(){return o.createElement(s.default,{controller:t.props.controller})}),o.createElement(h,{predicate:function(){return t.controller.isListEnabled()&&!t.controller.isListVisible()}},function(){return o.createElement("div",{class:function(){return{"dcg-overgraph-icon-container":!0,"dcg-bottom-right":t.controller.isNarrow()}}},o.createElement(d.Tooltip,{tooltip:function(){return t.controller.t("Show List")},gravity:function(){return t.controller.isNarrow()?"nw":"se"}},o.createElement("div",{class:function(){return{"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":t.controller.isNarrow()}},"aria-label":function(){return t.controller.t("Show List")},role:o.const("button"),tabindex:o.const("0"),onTap:function(){return t.controller.dispatch({type:"show-expressions-list"})}},o.createElement("i",{class:o.const("dcg-icon-show")}))))}),o.createElement(h,{predicate:this.bindFn(this.showHamburger)},function(){return o.createElement("div",{class:o.const("dcg-overgraph-icon-container")},o.createElement(d.Tooltip,{tooltip:function(){return t.controller.t("Open Graph")},gravity:t.const("se")},o.createElement("div",{role:o.const("button"),"aria-label":function(){return t.controller.t("Open Graph")},class:o.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:function(){return t.controller.dispatch({type:"open-drawer"})}},o.createElement("i",{class:o.const("dcg-icon-hamburger")}))))}),o.createElement(c.default,{controller:this.props.controller}),o.createElement(u.ToastView,{message:function(){var e=t.controller.getToastData().message;return e||""},link:function(){return t.controller.getToastData().link||void 0},showUndo:function(){return!!t.controller.getToastData().undoCallback},showLearnMore:function(){return!!t.controller.getToastData().learnMoreCallback},noAria:function(){return!!t.controller.getToastData().noAria},toastStyle:function(){return t.controller.getToastData().toastStyle},t:this.controller.t,onUndo:function(){return t.controller.dispatch({type:"toast/undo"})},onLearnMore:function(){return t.controller.dispatch({type:"toast/learn-more"})},onClose:function(){return t.controller.dispatch({type:"toast/close"})}}),o.createElement("div",{class:o.const("dcg-grapher")}),o.createElement(h,{predicate:function(){return t.controller.getGraphSettings().config.keypad}},function(){return o.createElement(l.default,{controller:t.props.controller})}))},t.prototype.showHamburger=function(){return!!this.controller.getGraphSettings().config.showHamburger&&!this.controller.isInEditListMode()&&this.controller.isNarrow()},t.prototype.didMountRoot=function(e){n.monitor(e),this.controller.getGraphSettings().config.disableScrollFix||i.limitScrollOnElement(e),this.setupFileDragDrop(e)},t.prototype.setupFileDragDrop=function(e){function t(){i=a(),n.off(".filedraggedover"),o.controller.dispatch({type:"file-is-not-dragged-over"})}var r=this,n=a(e);p.default(n);var i=a(),o=this;n.on("dragenter",function(e){r.controller.areImagesEnabled()&&(0===i.length&&n.on("dcg-tapstart.filedraggedover",t),i=i.add(e.target),r.controller.dispatch({type:"file-is-dragged-over"}))}).on("dragleave",function(e){0===(i=i.not(e.target)).length&&t()}).on("drop",t)},t}(o.Class);t.default=f}),define("worker/workerpoolconnection",["require","pjs","underscore_model"],function(e){return e("pjs")(e("underscore_model").UnderscoreModel,function(e,t){e.init=function(e){t.init.call(this),this.workerPool=e,this.worker=e.allocateWorker(),this.worker.__connections[this.guid]=this},e.destroy=function(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]},e.killWorker=function(){this.worker.__isFake||this.workerPool.killWorker(this.worker)},e.onWorkerKilled=function(){},e.onResponse=function(e){},e.sendMessage=function(e){this.worker.__isFake?this.worker.postMessage(e):this.worker.postMessage({connectionId:this.guid,originalMessage:e})}})}),define("text!worker_src_underlying",[],function(){return'var requirejs,require,define;!function(e){function t(e,t){return y.call(e,t)}function r(e,t){var r,n,i,a,s,o,u,c,l,p,f=t&&t.split("/"),h=m.map,d=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),c=0;c<e.length;c+=1)if(p=e[c],"."===p)e.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||d)&&h){for(r=e.split("/"),c=r.length;c>0;c-=1){if(n=r.slice(0,c).join("/"),f)for(l=f.length;l>0;l-=1)if(i=h[f.slice(0,l).join("/")],i&&(i=i[n])){a=i,s=c;break}if(a)break;!o&&d&&d[n]&&(o=d[n],u=c)}!a&&o&&(a=o,s=u),a&&(r.splice(0,s,a),e=r.join("/"))}return e}function n(t,r){return function(){return l.apply(e,v.call(arguments,0).concat([t,r]))}}function i(e){return function(t){return r(t,e)}}function a(e){return function(t){h[e]=t}}function s(r){if(t(d,r)){var n=d[r];delete d[r],g[r]=!0,c.apply(e,n)}if(!t(h,r)&&!t(g,r))throw new Error("No "+r);return h[r]}function o(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function u(e){return function(){return m&&m.config&&m.config[e]||{}}}var c,l,p,f,h={},d={},m={},g={},y=Object.prototype.hasOwnProperty,v=[].slice;p=function(e,t){var n,a=o(e),u=a[0];return e=a[1],u&&(u=r(u,t),n=s(u)),u?e=n&&n.normalize?n.normalize(e,i(t)):r(e,t):(e=r(e,t),a=o(e),u=a[0],e=a[1],u&&(n=s(u))),{f:u?u+"!"+e:e,n:e,pr:u,p:n}},f={require:function(e){return n(e)},exports:function(e){var t=h[e];return"undefined"!=typeof t?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:u(e)}}},c=function(r,i,o,u){var c,l,m,y,v,b,x=[];if(u=u||r,"function"==typeof o){for(i=!i.length&&o.length?["require","exports","module"]:i,v=0;v<i.length;v+=1)if(y=p(i[v],u),l=y.f,"require"===l)x[v]=f.require(r);else if("exports"===l)x[v]=f.exports(r),b=!0;else if("module"===l)c=x[v]=f.module(r);else if(t(h,l)||t(d,l)||t(g,l))x[v]=s(l);else{if(!y.p)throw new Error(r+" missing "+l);y.p.load(y.n,n(u,!0),a(l),{}),x[v]=h[l]}m=o.apply(h[r],x),r&&(c&&c.exports!==e&&c.exports!==h[r]?h[r]=c.exports:m===e&&b||(h[r]=m))}else r&&(h[r]=o)},requirejs=require=l=function(t,r,n,i,a){return"string"==typeof t?f[t]?f[t](r):s(p(t,r).f):(t.splice||(m=t,r.splice?(t=r,r=n,n=null):t=e),r=r||function(){},"function"==typeof n&&(n=i,i=a),i?c(e,t,r,n):setTimeout(function(){c(e,t,r,n)},4),l)},l.config=function(e){return m=e,m.deps&&l(m.deps,m.callback),l},define=function(e,r,n){r.splice||(n=r,r=[]),t(h,e)||t(d,e)||(d[e]=[e,r,n])},define.amd={jQuery:!0}}(),"undefined"!=typeof ALMOND_OVERRIDES&&ALMOND_OVERRIDES&&(define=ALMOND_OVERRIDES.define||define,require=ALMOND_OVERRIDES.require||require,requirejs=ALMOND_OVERRIDES.requirejs||requirejs),define("vendor/almond",function(){}),define("testbridge",["require"],function(e){function t(){window.consoleOverride=!0;var e=window.console.log;window.console.log=function(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);e.apply(window.console,[].concat([t.join(" ")],t))}}var r={ready:function(){try{window.TestBridge=r,parent.USING_SELENIUM&&t()}catch(e){}}};return r}),define("console",["require"],function(e){var t=function(){},r=["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"],n={},i=function(e){"undefined"!=typeof window&&window.console&&window.console[e]?n[e]=function(){Function.prototype.apply.call(window.console[e],window.console,arguments)}:n[e]=t};return r.forEach(i),n}),define("pjs",[],function(){var e=function(e,t,r){function n(e){return"object"==typeof e}function i(e){return"function"==typeof e}function a(){}function s(o,u){function c(){var e=new l;return i(e.init)&&e.init.apply(e,arguments),e}function l(){}u===r&&(u=o,o=Object),c.Bare=l;var p,f=a[e]=o[e],h=l[e]=c[e]=new a;return h.constructor=c,c.mixin=function(t){return l[e]=c[e]=s(c,t)[e],c},(c.open=function(e){if(p={},i(e)?p=e.call(c,h,f,c,o):n(e)&&(p=e),n(p))for(var r in p)t.call(p,r)&&(h[r]=p[r]);return i(h.init)||(h.init=o),c})(u)}return s}("prototype",{}.hasOwnProperty);return e}),function(){function e(e){function t(t,r,n,i,a,s){for(;a>=0&&a<s;a+=e){var o=i?i[a]:a;n=r(n,t[o],o,t)}return n}return function(r,n,i,a){n=b(n,a,4);var s=!T(r)&&v.keys(r),o=(s||r).length,u=e>0?0:o-1;return arguments.length<3&&(i=r[s?s[u]:u],u+=e),t(r,n,i,s,u,o)}}function t(e){return function(t,r,n){r=x(r,n);for(var i=w(t),a=e>0?0:i-1;a>=0&&a<i;a+=e)if(r(t[a],a,t))return a;return-1}}function r(e,t,r){return function(n,i,a){var s=0,o=w(n);if("number"==typeof a)e>0?s=a>=0?a:Math.max(a+o,s):o=a>=0?Math.min(a+1,o):a+o+1;else if(r&&a&&o)return a=r(n,i),n[a]===i?a:-1;if(i!==i)return a=t(l.call(n,s,o),v.isNaN),a>=0?a+s:-1;for(a=e>0?s:o-1;a>=0&&a<o;a+=e)if(n[a]===i)return a;return-1}}function n(e,t){var r=O.length,n=e.constructor,i=v.isFunction(n)&&n.prototype||o,a="constructor";for(v.has(e,a)&&!v.contains(t,a)&&t.push(a);r--;)a=O[r],a in e&&e[a]!==i[a]&&!v.contains(t,a)&&t.push(a)}var i=this,a=i._,s=Array.prototype,o=Object.prototype,u=Function.prototype,c=s.push,l=s.slice,p=o.toString,f=o.hasOwnProperty,h=Array.isArray,d=Object.keys,m=u.bind,g=Object.create,y=function(){},v=function(e){return e instanceof v?e:this instanceof v?void(this._wrapped=e):new v(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=v),exports._=v):i._=v,v.VERSION="1.8.3";var b=function(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,a){return e.call(t,r,n,i,a)}}return function(){return e.apply(t,arguments)}},x=function(e,t,r){return null==e?v.identity:v.isFunction(e)?b(e,t,r):v.isObject(e)?v.matcher(e):v.property(e)};v.iteratee=function(e,t){return x(e,t,1/0)};var _=function(e,t){return function(r){var n=arguments.length;if(n<2||null==r)return r;for(var i=1;i<n;i++)for(var a=arguments[i],s=e(a),o=s.length,u=0;u<o;u++){var c=s[u];t&&void 0!==r[c]||(r[c]=a[c])}return r}},M=function(e){if(!v.isObject(e))return{};if(g)return g(e);y.prototype=e;var t=new y;return y.prototype=null,t},S=function(e){return function(t){return null==t?void 0:t[e]}},E=Math.pow(2,53)-1,w=S("length"),T=function(e){var t=w(e);return"number"==typeof t&&t>=0&&t<=E};v.each=v.forEach=function(e,t,r){t=b(t,r);var n,i;if(T(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var a=v.keys(e);for(n=0,i=a.length;n<i;n++)t(e[a[n]],a[n],e)}return e},v.map=v.collect=function(e,t,r){t=x(t,r);for(var n=!T(e)&&v.keys(e),i=(n||e).length,a=Array(i),s=0;s<i;s++){var o=n?n[s]:s;a[s]=t(e[o],o,e)}return a},v.reduce=v.foldl=v.inject=e(1),v.reduceRight=v.foldr=e(-1),v.find=v.detect=function(e,t,r){var n;if(n=T(e)?v.findIndex(e,t,r):v.findKey(e,t,r),void 0!==n&&n!==-1)return e[n]},v.filter=v.select=function(e,t,r){var n=[];return t=x(t,r),v.each(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n},v.reject=function(e,t,r){return v.filter(e,v.negate(x(t)),r)},v.every=v.all=function(e,t,r){t=x(t,r);for(var n=!T(e)&&v.keys(e),i=(n||e).length,a=0;a<i;a++){var s=n?n[a]:a;if(!t(e[s],s,e))return!1}return!0},v.some=v.any=function(e,t,r){t=x(t,r);for(var n=!T(e)&&v.keys(e),i=(n||e).length,a=0;a<i;a++){var s=n?n[a]:a;if(t(e[s],s,e))return!0}return!1},v.contains=v.includes=v.include=function(e,t,r,n){return T(e)||(e=v.values(e)),("number"!=typeof r||n)&&(r=0),v.indexOf(e,t,r)>=0},v.invoke=function(e,t){var r=l.call(arguments,2),n=v.isFunction(t);return v.map(e,function(e){var i=n?t:e[t];return null==i?i:i.apply(e,r)})},v.pluck=function(e,t){return v.map(e,v.property(t))},v.where=function(e,t){return v.filter(e,v.matcher(t))},v.findWhere=function(e,t){return v.find(e,v.matcher(t))},v.max=function(e,t,r){var n,i,a=-(1/0),s=-(1/0);if(null==t&&null!=e){e=T(e)?e:v.values(e);for(var o=0,u=e.length;o<u;o++)n=e[o],n>a&&(a=n)}else t=x(t,r),v.each(e,function(e,r,n){i=t(e,r,n),(i>s||i===-(1/0)&&a===-(1/0))&&(a=e,s=i)});return a},v.min=function(e,t,r){var n,i,a=1/0,s=1/0;if(null==t&&null!=e){e=T(e)?e:v.values(e);for(var o=0,u=e.length;o<u;o++)n=e[o],n<a&&(a=n)}else t=x(t,r),v.each(e,function(e,r,n){i=t(e,r,n),(i<s||i===1/0&&a===1/0)&&(a=e,s=i)});return a},v.shuffle=function(e){for(var t,r=T(e)?e:v.values(e),n=r.length,i=Array(n),a=0;a<n;a++)t=v.random(0,a),t!==a&&(i[a]=i[t]),i[t]=r[a];return i},v.sample=function(e,t,r){return null==t||r?(T(e)||(e=v.values(e)),e[v.random(e.length-1)]):v.shuffle(e).slice(0,Math.max(0,t))},v.sortBy=function(e,t,r){return t=x(t,r),v.pluck(v.map(e,function(e,r,n){return{value:e,index:r,criteria:t(e,r,n)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")};var D=function(e){return function(t,r,n){var i={};return r=x(r,n),v.each(t,function(n,a){var s=r(n,a,t);e(i,n,s)}),i}};v.groupBy=D(function(e,t,r){v.has(e,r)?e[r].push(t):e[r]=[t]}),v.indexBy=D(function(e,t,r){e[r]=t}),v.countBy=D(function(e,t,r){v.has(e,r)?e[r]++:e[r]=1}),v.toArray=function(e){return e?v.isArray(e)?l.call(e):T(e)?v.map(e,v.identity):v.values(e):[]},v.size=function(e){return null==e?0:T(e)?e.length:v.keys(e).length},v.partition=function(e,t,r){t=x(t,r);var n=[],i=[];return v.each(e,function(e,r,a){(t(e,r,a)?n:i).push(e)}),[n,i]},v.first=v.head=v.take=function(e,t,r){if(null!=e)return null==t||r?e[0]:v.initial(e,e.length-t)},v.initial=function(e,t,r){return l.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))},v.last=function(e,t,r){if(null!=e)return null==t||r?e[e.length-1]:v.rest(e,Math.max(0,e.length-t))},v.rest=v.tail=v.drop=function(e,t,r){return l.call(e,null==t||r?1:t)},v.compact=function(e){return v.filter(e,v.identity)};var I=function(e,t,r,n){for(var i=[],a=0,s=n||0,o=w(e);s<o;s++){var u=e[s];if(T(u)&&(v.isArray(u)||v.isArguments(u))){t||(u=I(u,t,r));var c=0,l=u.length;for(i.length+=l;c<l;)i[a++]=u[c++]}else r||(i[a++]=u)}return i};v.flatten=function(e,t){return I(e,t,!1)},v.without=function(e){return v.difference(e,l.call(arguments,1))},v.uniq=v.unique=function(e,t,r,n){v.isBoolean(t)||(n=r,r=t,t=!1),null!=r&&(r=x(r,n));for(var i=[],a=[],s=0,o=w(e);s<o;s++){var u=e[s],c=r?r(u,s,e):u;t?(s&&a===c||i.push(u),a=c):r?v.contains(a,c)||(a.push(c),i.push(u)):v.contains(i,u)||i.push(u)}return i},v.union=function(){return v.uniq(I(arguments,!0,!0))},v.intersection=function(e){for(var t=[],r=arguments.length,n=0,i=w(e);n<i;n++){var a=e[n];if(!v.contains(t,a)){for(var s=1;s<r&&v.contains(arguments[s],a);s++);s===r&&t.push(a)}}return t},v.difference=function(e){var t=I(arguments,!0,!0,1);return v.filter(e,function(e){return!v.contains(t,e)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(e){for(var t=e&&v.max(e,w).length||0,r=Array(t),n=0;n<t;n++)r[n]=v.pluck(e,n);return r},v.object=function(e,t){for(var r={},n=0,i=w(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},v.findIndex=t(1),v.findLastIndex=t(-1),v.sortedIndex=function(e,t,r,n){r=x(r,n,1);for(var i=r(t),a=0,s=w(e);a<s;){var o=Math.floor((a+s)/2);r(e[o])<i?a=o+1:s=o}return a},v.indexOf=r(1,v.findIndex,v.sortedIndex),v.lastIndexOf=r(-1,v.findLastIndex),v.range=function(e,t,r){null==t&&(t=e||0,e=0),r=r||1;for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),a=0;a<n;a++,e+=r)i[a]=e;return i};var C=function(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var a=M(e.prototype),s=e.apply(a,i);return v.isObject(s)?s:a};v.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,l.call(arguments,1));if(!v.isFunction(e))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),n=function(){return C(e,n,t,this,r.concat(l.call(arguments)))};return n},v.partial=function(e){var t=l.call(arguments,1),r=function(){for(var n=0,i=t.length,a=Array(i),s=0;s<i;s++)a[s]=t[s]===v?arguments[n++]:t[s];for(;n<arguments.length;)a.push(arguments[n++]);return C(e,r,this,this,a)};return r},v.bindAll=function(e){var t,r,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)r=arguments[t],e[r]=v.bind(e[r],e);return e},v.memoize=function(e,t){var r=function(n){var i=r.cache,a=""+(t?t.apply(this,arguments):n);return v.has(i,a)||(i[a]=e.apply(this,arguments)),i[a]};return r.cache={},r},v.delay=function(e,t){var r=l.call(arguments,2);return setTimeout(function(){return e.apply(null,r)},t)},v.defer=v.partial(v.delay,v,1),v.throttle=function(e,t,r){var n,i,a,s=null,o=0;r||(r={});var u=function(){o=r.leading===!1?0:v.now(),s=null,a=e.apply(n,i),s||(n=i=null)};return function(){var c=v.now();o||r.leading!==!1||(o=c);var l=t-(c-o);return n=this,i=arguments,l<=0||l>t?(s&&(clearTimeout(s),s=null),o=c,a=e.apply(n,i),s||(n=i=null)):s||r.trailing===!1||(s=setTimeout(u,l)),a}},v.debounce=function(e,t,r){var n,i,a,s,o,u=function(){var c=v.now()-s;c<t&&c>=0?n=setTimeout(u,t-c):(n=null,r||(o=e.apply(a,i),n||(a=i=null)))};return function(){a=this,i=arguments,s=v.now();var c=r&&!n;return n||(n=setTimeout(u,t)),c&&(o=e.apply(a,i),a=i=null),o}},v.wrap=function(e,t){return v.partial(t,e)},v.negate=function(e){return function(){return!e.apply(this,arguments)}},v.compose=function(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}},v.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},v.before=function(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}},v.once=v.partial(v.before,2);var P=!{toString:null}.propertyIsEnumerable("toString"),O=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(e){if(!v.isObject(e))return[];if(d)return d(e);var t=[];for(var r in e)v.has(e,r)&&t.push(r);return P&&n(e,t),t},v.allKeys=function(e){if(!v.isObject(e))return[];var t=[];for(var r in e)t.push(r);return P&&n(e,t),t},v.values=function(e){for(var t=v.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n},v.mapObject=function(e,t,r){t=x(t,r);for(var n,i=v.keys(e),a=i.length,s={},o=0;o<a;o++)n=i[o],s[n]=t(e[n],n,e);return s},v.pairs=function(e){for(var t=v.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},v.invert=function(e){for(var t={},r=v.keys(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t},v.functions=v.methods=function(e){var t=[];for(var r in e)v.isFunction(e[r])&&t.push(r);return t.sort()},v.extend=_(v.allKeys),v.extendOwn=v.assign=_(v.keys),v.findKey=function(e,t,r){t=x(t,r);for(var n,i=v.keys(e),a=0,s=i.length;a<s;a++)if(n=i[a],t(e[n],n,e))return n},v.pick=function(e,t,r){var n,i,a={},s=e;if(null==s)return a;v.isFunction(t)?(i=v.allKeys(s),n=b(t,r)):(i=I(arguments,!1,!1,1),n=function(e,t,r){return t in r},s=Object(s));for(var o=0,u=i.length;o<u;o++){var c=i[o],l=s[c];n(l,c,s)&&(a[c]=l)}return a},v.omit=function(e,t,r){if(v.isFunction(t))t=v.negate(t);else{var n=v.map(I(arguments,!1,!1,1),String);t=function(e,t){return!v.contains(n,t)}}return v.pick(e,t,r)},v.defaults=_(v.allKeys,!0),v.create=function(e,t){var r=M(e);return t&&v.extendOwn(r,t),r},v.clone=function(e){return v.isObject(e)?v.isArray(e)?e.slice():v.extend({},e):e},v.tap=function(e,t){return t(e),e},v.isMatch=function(e,t){var r=v.keys(t),n=r.length;if(null==e)return!n;for(var i=Object(e),a=0;a<n;a++){var s=r[a];if(t[s]!==i[s]||!(s in i))return!1}return!0};var N=function(e,t,r,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof v&&(e=e._wrapped),t instanceof v&&(t=t._wrapped);var i=p.call(e);if(i!==p.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var a="[object Array]"===i;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,o=t.constructor;if(s!==o&&!(v.isFunction(s)&&s instanceof s&&v.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),a){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!N(e[u],t[u],r,n))return!1}else{var c,l=v.keys(e);if(u=l.length,v.keys(t).length!==u)return!1;for(;u--;)if(c=l[u],!v.has(t,c)||!N(e[c],t[c],r,n))return!1}return r.pop(),n.pop(),!0};v.isEqual=function(e,t){return N(e,t)},v.isEmpty=function(e){return null==e||(T(e)&&(v.isArray(e)||v.isString(e)||v.isArguments(e))?0===e.length:0===v.keys(e).length)},v.isElement=function(e){return!(!e||1!==e.nodeType)},v.isArray=h||function(e){return"[object Array]"===p.call(e)},v.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){v["is"+e]=function(t){return p.call(t)==="[object "+e+"]"}}),v.isArguments(arguments)||(v.isArguments=function(e){return v.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(e){return"function"==typeof e||!1}),v.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},v.isNaN=function(e){return v.isNumber(e)&&e!==+e},v.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===p.call(e)},v.isNull=function(e){return null===e},v.isUndefined=function(e){return void 0===e},v.has=function(e,t){return null!=e&&f.call(e,t)},v.noConflict=function(){return i._=a,this},v.identity=function(e){return e},v.constant=function(e){return function(){return e}},v.noop=function(){},v.property=S,v.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},v.matcher=v.matches=function(e){return e=v.extendOwn({},e),function(t){return v.isMatch(t,e)}},v.times=function(e,t,r){var n=Array(Math.max(0,e));t=b(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n},v.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},v.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#x27;","`":"&#x60;"},L=v.invert(A),q=function(e){var t=function(t){return e[t]},r="(?:"+v.keys(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,t):e}};v.escape=q(A),v.unescape=q(L),v.result=function(e,t,r){var n=null==e?void 0:e[t];return void 0===n&&(n=r),v.isFunction(n)?n.call(e):n};var F=0;v.uniqueId=function(e){var t=++F+"";return e?e+t:t},v.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var k=/(.)^/,V={"\'":"\'","\\\\":"\\\\","\\r":"r","\\n":"n","\\u2028":"u2028","\\u2029":"u2029"},B=/\\\\|\'|\\r|\\n|\\u2028|\\u2029/g,R=function(e){return"\\\\"+V[e]};v.template=function(e,t,r){!t&&r&&(t=r),t=v.defaults({},t,v.templateSettings);var n=RegExp([(t.escape||k).source,(t.interpolate||k).source,(t.evaluate||k).source].join("|")+"|$","g"),i=0,a="__p+=\'";e.replace(n,function(t,r,n,s,o){return a+=e.slice(i,o).replace(B,R),i=o+t.length,r?a+="\'+\\n((__t=("+r+"))==null?\'\':_.escape(__t))+\\n\'":n?a+="\'+\\n((__t=("+n+"))==null?\'\':__t)+\\n\'":s&&(a+="\';\\n"+s+"\\n__p+=\'"),t}),a+="\';\\n",t.variable||(a="with(obj||{}){\\n"+a+"}\\n"),a="var __t,__p=\'\',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,\'\');};\\n"+a+"return __p;\\n";try{var s=new Function(t.variable||"obj","_",a)}catch(e){throw e.source=a,e}var o=function(e){return s.call(this,e,v)},u=t.variable||"obj";return o.source="function("+u+"){\\n"+a+"}",o},v.chain=function(e){var t=v(e);return t._chain=!0,t};var j=function(e,t){return e._chain?v(t).chain():t};v.mixin=function(e){v.each(v.functions(e),function(t){var r=v[t]=e[t];v.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),j(this,r.apply(v,e))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];v.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==e&&"splice"!==e||0!==r.length||delete r[0],j(this,r)}}),v.each(["concat","join","slice"],function(e){var t=s[e];v.prototype[e]=function(){return j(this,t.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return v})}.call(this),define("math/distance",["require","exports"],function(e,t){"use strict";function r(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function n(e,t,r,n){return e*r+t*n}function i(e,r,i,a,s,o){var u=t.hypot(s-i,o-a);if(0===u)return 0;var c=n((e-i)/u,(r-a)/u,(s-i)/u,(o-a)/u);return c}function a(e,t,r,n,a,s){var o=i(e,t,r,n,a,s);return o<=0?[r,n]:o>=1?[a,s]:[r+o*(a-r),n+o*(s-n)]}function s(e,r,n,i,s,o){var u=a(e,r,n,i,s,o);return t.hypot(e-u[0],r-u[1])}function o(e,t,r){if(void 0===r&&(r=1),r>50)throw new Error("Within "+(52-r)+" bits isn\'t really approximate any more");var n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=1===r?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}Object.defineProperty(t,"__esModule",{value:!0}),t.hypot=Math.hypot||function(e,t){if(0===e&&0===t)return 0;if(Math.abs(e)>Math.abs(t)){var r=t/e;return Math.abs(e)*Math.sqrt(r*r+1)}var r=e/t;return Math.abs(t)*Math.sqrt(r*r+1)},t.mean=r,t.pointToSegmentParameter=i,t.closestPointOnSegment=a,t.pointToSegment=s,t.approx=o}),define("lib/console",["require","exports","console"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=r.log,t.warn=r.warn}),define("math/poi-type",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INTERSECTION=1001,t.ZERO=1002,t.INTERCEPT=1003,t.EXTREMUM=1004,t.EDGE=1005,t.DEFINITION=1006,t.TRACE=1007,t.LABEL=1008}),define("math/poi",["require","exports","./distance","lib/console","./poi-type"],function(e,t,r,n,i){"use strict";function a(e,t){var n;e>t&&(n=e,e=t,t=n);var i=e>0,a=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return r.mean(e,t);if(0===e)return t*Math.abs(t);if(0===t)return e*Math.abs(e);if(i!==a)return 0;var u=i?Math.sqrt(e*t):-Math.sqrt(e*t);return u>=e&&t>=u?u:r.mean(e,t)}function s(e,t,r,i,s){if(isNaN(t)||isNaN(i)||t<0==i<0)return void n.log("bisectZero called with bad y values",[t,i]);for(;;){var u=a(e,r),c=s(u);if(!isFinite(c))return;if(u===e||u===r)return Math.abs(t)<=Math.abs(i)?[e,t]:[r,i];if(0===c)return o(e,t,u,c,r,i,s);t<0!=c<0?(r=u,i=c):(e=u,t=c)}}function o(e,t,r,n,i,s,o){var l;if(isFinite(n)){isFinite(t)||(l=u(e,t,r,n,o),l&&(e=l[0],t=l[1])),isFinite(s)||(l=u(r,n,i,s,o),l&&(i=l[0],s=l[1]));var p,f;p=t===n?[e,t]:c(e,t,r,n,o,n),f=s===n?[i,s]:c(r,n,i,s,o,n);var h;return p&&f&&(h=a(p[0],f[0])),void 0!==h?[h,o(h)]:void 0}}function u(e,t,r,i,s){if(isFinite(t)===isFinite(i))return void n.log("bisectFinite called with bad y values",[t,i]);for(;;){var o=a(e,r),u=s(o);if(o===e||o===r)return isFinite(t)?[e,t]:[r,i];isFinite(u)!==isFinite(t)?(r=o,i=u):(e=o,t=u)}}function c(e,t,r,i,s,o){if(t===o==(i===o))return void n.log("bisectConstant called with bad y values",[t,i,o]);for(;;){var u=a(e,r),c=s(u);if(u===e||u===r)return t===o?[e,t]:[r,i];c===o!=(t===o)?(r=u,i=c):(e=u,t=c)}}function l(e,t,r,i,s,u,c){if(!(e<r&&r<s))return void n.log("bisectExtremum called with bad x values",[e,r,s]);if(!(isFinite(t)&&isFinite(i)&&isFinite(u)&&t!==i&&i!==u&&i>t==i>u))return void n.log("bisectExtremum called with bad y values",[t,i,u]);for(;;){var l=a(e,r),p=c(l),f=a(r,s),h=c(f);if(!isFinite(p)||!isFinite(h))return;if(l===e||l===r||f===r||f===s)return p>i==i>t?[l,p]:h>i==i>t?[f,h]:[r,i];if(p===i||h===i)return o(e,t,r,i,s,u,c);p>t==i>t&&p>t==p>i?(s=r,u=i,r=l,i=p):h>u==i>u&&h>i==h>u?(e=r,t=i,r=f,i=h):(e=l,t=p,s=f,u=h)}}function p(e,t,r,n,i,a,s,o){var u=Math.abs(n-t),c=Math.abs(a-n),l=Math.abs(o-a);return u>c&&u>l?[[e,t],[r,n]]:l>c&&l>u?[[i,a],[s,o]]:[[r,n],[i,a]]}function f(e,t,n,i,s,o,c,l){if(l||(l=0),!((n-e)*(s-n)<=0)&&isFinite(e)&&isFinite(n)&&isFinite(s)&&isFinite(t)&&isFinite(o)){if(!isFinite(i)){var f=u(e,t,n,i,c),h=u(n,i,s,o,c);if(!f||!h)return;return[f,h]}if(!(Math.abs(i-((s-n)*t+(n-e)*o)/(s-e))<l))for(;;){var d=a(e,n),m=c(d),g=a(n,s),y=c(g),v=Math.abs(m-r.mean(t,i)),b=Math.abs(i-r.mean(m,y)),x=Math.abs(y-r.mean(i,o));if(v<=l&&b<=l&&x<=l)return;if(!isFinite(m)){var f=u(e,t,d,m,c),h=u(d,m,s,o,c);if(!f||!h)return;return[f,h]}if(!isFinite(y)){var f=u(e,t,g,y,c),h=u(g,y,s,o,c);if(!f||!h)return;return[f,h]}if(!(d!==e&&d!==n||g!==n&&g!==s))return Math.abs(i-t)>Math.abs(o-i)?[[e,t],[n,i]]:[[n,i],[s,o]];if(d===e||d===n)return p(e,t,n,i,g,y,s,o);if(g===n||g===s)return p(e,t,d,m,n,i,s,o);v>x&&v>=b?(s=n,o=i,n=d,i=m):x>v&&x>=b?(e=n,t=i,n=g,i=y):(e=d,t=m,s=g,o=y)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.floatMiddle=a,t.default={bisectJump:f,bisectExtremum:l,bisectFinite:u,bisectZero:s,flatCenter:o,INTERSECTION:i.INTERSECTION,ZERO:i.ZERO,INTERCEPT:i.INTERCEPT,EXTREMUM:i.EXTREMUM,EDGE:i.EDGE,DEFINITION:i.DEFINITION,TRACE:i.TRACE,LABEL:i.LABEL}}),define("math/curve-accumulator",["require","exports","./distance"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){e?(this.xtolerance=e.xtolerance||e.tolerance||0,this.ytolerance=e.ytolerance||e.tolerance||0,this.map=e.map):this.xtolerance=this.ytolerance=0,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}return e.prototype.colinear=function(e,t,n){this.map&&(e=this.map(e),t=this.map(t),n=this.map(n));var i=r.pointToSegmentParameter(n[0],n[1],e[0],e[1],t[0],t[1]);if(i<1)return!1;var a=[e[0]+i*(t[0]-e[0]),e[1]+i*(t[1]-e[1])];return Math.abs(n[0]-a[0])<=this.xtolerance&&Math.abs(n[1]-a[1])<=this.ytolerance},e.prototype.addPoint=function(e){if(this.xtolerance<0&&this.ytolerance<0)return void this.segment.push(e[0],e[1]);if(!this.segment.length)return void this.segment.push(e[0],e[1]);var t=[this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(e[0]!==t[0]||e[1]!==t[1]){if(!this.pivotPoint||!this.pendingPoint)return this.pivotPoint=e,void(this.pendingPoint=e);(!this.colinear(t,this.pivotPoint,e)||r.hypot(t[0]-e[0],t[1]-e[1])<r.hypot(t[0]-this.pendingPoint[0],t[1]-this.pendingPoint[1]))&&(this.flushPending(),this.pivotPoint=e),this.pendingPoint=e}},e.prototype.flushPending=function(){this.pendingPoint&&(this.segment.push(this.pendingPoint[0],this.pendingPoint[1]),this.pivotPoint=void 0,this.pendingPoint=void 0)},e.prototype.breakSegment=function(){this.flushPending(),this.segment.length>2&&this.segments.push(this.segment),this.segment=[]},e.prototype.getSegments=function(){return this.breakSegment(),this.segments},e.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0}},e}();t.default=n}),define("math/implicit-plotter",["require","exports","./distance","./curve-accumulator"],function(e,t,r,n){"use strict";function i(e,t){var r=a(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function a(e,t){var r=Math.pow(2,-W),n=c(t,r),i=c(t,2*r),a=f(e,n,i),s=I(a.root,e,n),o=j(s,e,n);return{paddedDomain:n,rootDomain:i,quadTree:a,triangles:s,contours:o}}function s(e,t,r){return{x:e,y:t,z:r}}function o(e,t,r){return{x:e,y:t,isZero:r}}function u(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function c(e,t){var r=(1+t)*e.xmin-t*e.xmax,n=(1+t)*e.xmax-t*e.xmin,i=(1+t)*e.ymin-t*e.ymax,a=(1+t)*e.ymax-t*e.ymin;return{xmin:r,ymin:i,xmax:n,ymax:a,xtolerance:e.xtolerance,ytolerance:e.ytolerance}}function l(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function p(e,t,r){e.center=E(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function f(e,t,r){var n=h(e,r),i=[],a=[];a.push(n);var s=1,o=!0;e:for(;a.length;){var u=i;i=a,a=u;for(var c=void 0;c=i.pop();)if(m(c,e,t)){if(d(c,e),!c.children){o=!1;break e}if(a.push(c.children[0]),a.push(c.children[1]),a.push(c.children[2]),a.push(c.children[3]),s+=3,s>=Y){o=!1;break e}}else p(c,e,t)}for(var l=0;l<i.length;l++)p(i[l],e,t);for(var l=0;l<a.length;l++)p(a[l],e,t);return{root:n,resolved:o}}function h(e,t){var r=t.xmin,n=t.xmax,i=t.ymin,a=t.ymax;return l(0,[_(r,a,e),_(n,a,e),_(n,i,e),_(r,i,e)])}function d(e,t){var r=e.depth+1,n=e.vertices[0],i=e.vertices[1],a=e.vertices[2],s=e.vertices[3],o=M(n,i,t),u=M(i,a,t),c=M(a,s,t),p=M(s,n,t),f=M(n,a,t);e.children=[l(r,[n,o,f,p]),l(r,[o,i,u,f]),l(r,[f,u,a,c]),l(r,[p,f,c,s])]}function m(e,t,r){if(e.depth<W)return!0;if(b(e,r))return!1;if(v(e,r))return!1;var n=e.vertices[0],i=e.vertices[1],a=e.vertices[2],s=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(a.z)&&isNaN(s.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(a.z)||isNaN(s.z))return!0;var o=E(n,i,a,s,t,r),u=S(n,i,t,r),c=S(i,a,t,r),l=S(a,s,t,r),p=S(s,n,t,r);return y(n,u,t)||y(i,u,t)||y(i,c,t)||y(a,c,t)||y(a,l,t)||y(s,l,t)||y(s,p,t)||y(n,p,t)||g(n,u,o,t,r)||g(u,i,o,t,r)||g(i,c,o,t,r)||g(c,a,o,t,r)||g(a,l,o,t,r)||g(l,s,o,t,r)||g(s,p,o,t,r)||g(p,n,o,t,r)}function g(e,t,n,i,a){if(e.z>0==t.z>0&&t.z>0==n.z>0)return!1;var s,o,u,c;if(e.z>0==t.z>0){if(s=M(e,t,i),s.z>0!=e.z>0)return!0;o=T(e,n,i,a),u=T(t,n,i,a),c=T(s,n,i,a)}else if(t.z>0==n.z>0){if(s=M(t,n,i),s.z>0!=t.z>0)return!0;o=T(t,e,i,a),u=T(n,e,i,a),c=T(s,e,i,a)}else{if(s=M(n,e,i),s.z>0!=n.z>0)return!0;o=T(n,t,i,a),u=T(e,t,i,a),c=T(s,t,i,a)}var l=a.xtolerance,p=a.ytolerance,f=r.pointToSegment(p*c.x,l*c.y,p*o.x,l*o.y,p*u.x,l*u.y);return f>l*p}function y(e,t,r){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;var n=M(e,t,r),i=4*n.z-t.z-3*e.z,a=1e-4,s=(r((1-a)*e.x+a*t.x,(1-a)*e.y+a*t.y)-e.z)/a,o=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(i-s)>.125*o}function v(e,t){return e.vertices[1].x-e.vertices[0].x<10*t.xtolerance||e.vertices[0].y-e.vertices[3].y<10*t.ytolerance}function b(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function x(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function _(e,t,r){return s(e,t,r(e,t))}function M(e,t,r){return _(.5*(e.x+t.x),.5*(e.y+t.y),r)}function S(e,t,r,n){if(x(e,n)||x(t,n))return M(e,t,r);if(isNaN(e.z)||isNaN(t.z))return D(e,t,r,n);if(e.z>0!=t.z>0)return M(e,t,r);var i=.01,a=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,o=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(a)||isNaN(o)?M(e,t,r):a>0==o>0?M(e,t,r):w(s(e.x,e.y,a),s(t.x,t.y,o),r)}function E(e,t,r,n,i,a){var s=S(e,r,i,a);return e.z>0==r.z>0&&s.z>0!=e.z>0?s:(s=S(t,n,i,a),t.z>0==n.z>0&&s.z>0!=t.z>0?s:M(e,r,i))}function w(e,t,r){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(isFinite(e.z)||isFinite(t.z)){if(isFinite(e.z)){if(isFinite(t.z)){var n=1-e.z/t.z,i=1-t.z/e.z;return _(e.x/n+t.x/i,e.y/n+t.y/i,r)}return e}return t}return M(e,t,r)}function T(e,t,r,n){var i=e.x,a=t.x,u=e.y,c=t.y,l=e.z,p=t.z,f=n.xtolerance,h=n.ytolerance;if(x(e,n)||x(t,n)){var d=M(e,t,r);return o(d.x,d.y,!1)}for(;Math.abs(i-a)>f||Math.abs(u-c)>h;){var m=.5*(i+a),g=.5*(u+c),y=r(m,g);y>0==l>0?(i=m,u=g,l=y):(a=m,c=g,p=y)}if(isNaN(l))return o(a,c,!1);if(isNaN(p))return o(i,u,!1);var v=w(s(i,u,l),s(a,c,p),r),b=0===l||0===p||0===v.z||v.z>=l==p>=v.z&&Math.abs(v.z)<1e250;return o(v.x,v.y,b)}function D(e,t,r,n){if(isNaN(e.z)===isNaN(t.z))return M(e,t,r);if(isNaN(e.z)){var i=e;e=t,t=i}for(var a=e.x,o=t.x,u=e.y,c=t.y,l=e.z,p=n.xtolerance,f=n.ytolerance;Math.abs(a-o)>p||Math.abs(u-c)>f;){var h=.5*(a+o),d=.5*(u+c),m=r(h,d);isNaN(m)===isNaN(l)?(a=h,u=d,l=m):(o=h,c=d)}return s(a,u,l)}function I(e,t,r){var n={triangles:[],edgeCache:{},domain:r,fn:t};return C(e,n),n.triangles}function C(e,t){e.children&&(C(e.children[0],t),C(e.children[1],t),C(e.children[2],t),C(e.children[3],t),P(e.children[0],e.children[1],t),P(e.children[3],e.children[2],t),O(e.children[1],e.children[2],t),O(e.children[0],e.children[3],t))}function P(e,t,r){e.children&&t.children?(P(e.children[1],t.children[0],r),P(e.children[2],t.children[3],r)):e.children?(P(e.children[1],t,r),P(e.children[2],t,r)):t.children?(P(e,t.children[0],r),P(e,t.children[3],r)):N(e,t,r)}function O(e,t,r){e.children&&t.children?(O(e.children[2],t.children[1],r),O(e.children[3],t.children[0],r)):e.children?(O(e.children[2],t,r),\nO(e.children[3],t,r)):t.children?(O(e,t.children[1],r),O(e,t.children[0],r)):A(e,t,r)}function N(e,t,r){if(e.center&&t.center){var n,i;e.depth>=t.depth?(n=S(e.vertices[1],e.vertices[2],r.fn,r.domain),i=L(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=S(t.vertices[0],t.vertices[3],r.fn,r.domain),i=L(t.vertices[0],t.center,t.vertices[3],e.center,n)),k(i,r.edgeCache,r.domain);for(var a=0;a<4;a++)r.triangles.push(i[a])}}function A(e,t,r){if(e.center&&t.center){var n,i;e.depth>=t.depth?(n=S(e.vertices[3],e.vertices[2],r.fn,r.domain),i=L(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=S(t.vertices[1],t.vertices[0],r.fn,r.domain),i=L(t.vertices[1],t.center,t.vertices[0],e.center,n)),k(i,r.edgeCache,r.domain);for(var a=0;a<4;a++)r.triangles.push(i[a])}}function L(e,t,r,n,i){return[u(e,i,t),u(t,i,r),u(r,i,n),u(n,i,e)]}function q(e,t,r){return e.z>0&&!x(e,r)&&(!(t.z>0)||x(t,r))}function F(e,t){return""+e.x+","+e.y+","+t.x+","+t.y}function k(e,t,r){V(e[0],e[1],e[2],F(e[1].vertices[2],e[1].vertices[0]),t,r),V(e[1],e[2],e[3],F(e[2].vertices[0],e[2].vertices[2]),t,r),V(e[2],e[3],e[0],F(e[3].vertices[2],e[3].vertices[0]),t,r),V(e[3],e[0],e[1],F(e[0].vertices[0],e[0].vertices[2]),t,r)}function V(e,t,r,n,i,a){var s=t.vertices[0],o=t.vertices[1],u=t.vertices[2];q(o,u,a)&&(t.next=r),q(s,o,a)&&(t.next=e),q(u,s,a)&&R(t,n,i),q(s,u,a)&&B(t,n,i)}function B(e,t,r){r[t]?r[t].next=e:r[t]=e}function R(e,t,r){r[t]?e.next=r[t]:r[t]=e}function j(e,t,r){for(var i={fillAccumulator:new n.default(r),strokeAccumulator:new n.default(r),fn:t,domain:r},a=0;a<e.length;a++){var s=e[a];s.next&&!s.visited&&z(s,i)}return{strokeSegments:i.strokeAccumulator.finish().segments,fillSegments:i.fillAccumulator.finish().segments}}function z(e,t){for(;;){var r=e.vertices[0],n=e.vertices[1],i=e.vertices[2];if(G(r,n,t),G(n,i,t),G(i,r,t),e.visited)break;if(!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function G(e,t,r){if(q(e,t,r.domain)){var n=T(e,t,r.fn,r.domain);r.fillAccumulator.addPoint([n.x,n.y]),n.isZero?r.strokeAccumulator.addPoint([n.x,n.y]):r.strokeAccumulator.breakSegment()}}function U(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push([n.vertices[0].x,n.vertices[0].y,n.vertices[1].x,n.vertices[1].y,n.vertices[2].x,n.vertices[2].y,n.vertices[0].x,n.vertices[0].y])}return t}Object.defineProperty(t,"__esModule",{value:!0});var W=5,Y=Math.pow(2,14);t.sampleImplicit=i,t.sampleImplicitDiagnostic=a,t.buildQuadTree=f,t.triangulate=I,t.traceContours=j,t.displayTriangles=U}),define("worker/workerconfig",[],function(){return{pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0}}),function(){var e,t,r,n,i,a,s,o,u,c,l,p,f,h,d,m,g={};!function(e){function t(e,t){return function(r,n){return e[r]=t?t(r,n):n}}var r="object"==typeof g?g:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(n){e(t(r,t(n)))}):e("object"==typeof module&&"object"==typeof module.exports?t(r,t(module.exports)):t(r))}(function(g){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};e=function(e,t){function r(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r},n=function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=function(e,t){return function(r,n){t(r,n,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{u(n.next(e))}catch(e){a(e)}}function o(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,o)}u((n=n.apply(e,t||[])).next())})},o=function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,a&&(s=a[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(a,r[1])).done)return s;switch(a=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,a=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],a=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,a,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},u=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},c=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},l=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s},p=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e},f=function(e){return this instanceof f?(this.v=e,this):new f(e)},h=function(e,t,r){function n(e){l[e]&&(c[e]=function(t){return new Promise(function(r,n){p.push([e,t,r,n])>1||i(e,t)})})}function i(e,t){try{a(l[e](t))}catch(e){u(p[0][3],e)}}function a(e){e.value instanceof f?Promise.resolve(e.value.v).then(s,o):u(p[0][2],e)}function s(e){i("next",e)}function o(e){i("throw",e)}function u(e,t){e(t),p.shift(),p.length&&i(p[0][0],p[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,l=r.apply(e,t||[]),p=[];return c={},n("next"),n("throw"),n("return"),c[Symbol.asyncIterator]=function(){return this},c},d=function(e){function t(t,i){e[t]&&(r[t]=function(r){return(n=!n)?{value:f(e[t](r)),done:"return"===t}:i?i(r):r})}var r,n;return r={},t("next"),t("throw",function(e){throw e}),t("return"),r[Symbol.iterator]=function(){return this},r},m=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof c?c(e):e[Symbol.iterator]()},g("__extends",e),g("__assign",t),g("__rest",r),g("__decorate",n),g("__param",i),g("__metadata",a),g("__awaiter",s),g("__generator",o),g("__exportStar",u),g("__values",c),g("__read",l),g("__spread",p),g("__await",f),g("__asyncGenerator",h),g("__asyncDelegator",d),g("__asyncValues",m)})}(),define("math/poi-finding-accumulator",["require","exports","worker/workerconfig","tslib","./curve-accumulator","./poi"],function(e,t,r,n,i,a){"use strict";function s(e){return Math.abs(e)<5e-8}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.domain=t,i.fn=r,i.derivative=n,i.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},i.zeroBuffer=[],i.extremumBuffer=[],i}return n.__extends(t,e),t.prototype.getPOI=function(){return r.pointsOfInterest?(void 0!==this.fn&&(this.poiData.intercept=this.findIntercept(this.fn)),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}},t.prototype.addLinearZero=function(e){var t=-e[0]/e[1];this.isOutsideDomain(t)||(this.poiData.zeros={x:[t],y:[0]})},t.prototype.addLinearIntercept=function(e){this.isOutsideDomain(0)||(this.poiData.intercept={x:[0],y:[e[0]]})},t.prototype.isOutsideDomain=function(e){return!this.domain||void 0===this.domain.min||void 0===this.domain.max||(e<this.domain.min||e>this.domain.max||isNaN(e))},t.prototype.addPoint=function(t){0===this.segment.length&&s(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),e.prototype.addPoint.call(this,t)},t.prototype.updateZeroBuffer=function(e){if(this.fn){if(!isFinite(e[0])||!isFinite(e[1]))return void(this.zeroBuffer.length=0);switch(this.zeroBuffer.length){case 0:if(s(e[1]))return;return void this.zeroBuffer.push(e);case 1:if(0===e[1])return void this.zeroBuffer.push(e);if(e[1]>0!=this.zeroBuffer[0][1]>0){var t=a.default.bisectZero(this.zeroBuffer[0][0],this.zeroBuffer[0][1],e[0],e[1],this.fn);return t&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0,void this.zeroBuffer.push(e)}return this.zeroBuffer.length=0,void this.zeroBuffer.push(e);case 2:if(0===e[1])return;if(e[1]>0!=this.zeroBuffer[0][1]>0){var t=a.default.flatCenter(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],e[0],e[1],this.fn);return t&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0,void this.zeroBuffer.push(e)}return this.zeroBuffer.length=0,void this.zeroBuffer.push(e)}}},t.prototype.updateExtremumBuffer=function(e){if(this.fn){if(!isFinite(e[0])||!isFinite(e[1]))return void(this.zeroBuffer.length=0);switch(this.extremumBuffer.length){case 0:return void this.extremumBuffer.push(e);case 1:return e[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),void this.extremumBuffer.push(e);case 2:if(e[1]===this.extremumBuffer[1][1])return void this.extremumBuffer.push(e);if(e[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){var t=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1]);if(t){this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1]);var r=!!a.default.bisectJump(this.extremumBuffer[0][0],this.extremumBuffer[0][1],t[0],t[1],e[0],e[1],this.fn,this.ytolerance);!r&&t[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=t)}return this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}return this.extremumBuffer.shift(),void this.extremumBuffer.push(e);case 3:if(e[1]===this.extremumBuffer[1][1])return;if(e[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){var t=a.default.flatCenter(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1],this.fn);return t&&(this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}return this.extremumBuffer.shift(),this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}}},t.prototype.bisectExtremumUsingDerivative=function(e,t,r,n,i,s){if(this.fn){var o;if(this.derivative){var u=this.derivative(e),c=this.derivative(i);if(!isNaN(u)&&!isNaN(c)&&u<0!=c<0){var l=a.default.bisectZero(e,u,i,c,this.derivative);l&&(o=[l[0],this.fn(l[0])])}}return o||(o=a.default.bisectExtremum(e,t,r,n,i,s,this.fn)),o}},t.prototype.breakSegment=function(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),s(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]},t.prototype.findIntercept=function(e){if(!e)return{x:[],y:[]};var t=e(0);return isFinite(t)?{x:[0],y:[e(0)]}:{x:[],y:[]}},t.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}},t}(i.default);t.default=o}),define("graphing/graphmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.X=1,t.Y=2,t.XYPOINT=3,t.XYPOINT_MOVABLE=4,t.PARAMETRIC=5,t.POLAR=6,t.POLYGONFILL=7,t.IMPLICIT=8,t.NONE=10,t.VISUALIZATION=11}),define("math/domaintypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyDomain=function(){return{type:"empty"}},t.unknownDomain=function(){return{type:"unknown"}},t.knownDomain=function(e){return isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?t.emptyDomain():{type:"known",bounds:e}},t.allReals=function(){return t.knownDomain([-(1/0),1/0])},t.intersectDomains=function(e,r){if("empty"===e.type||"empty"===r.type)return t.emptyDomain();if("unknown"===e.type||"unknown"===r.type)return t.unknownDomain();if(e.bounds&&r.bounds){var n=[Math.max(e.bounds[0],r.bounds[0]),Math.min(e.bounds[1],r.bounds[1])];return t.knownDomain(n)}return t.emptyDomain()}}),define("math/plotter",["require","exports","./distance","./poi","./implicit-plotter","./curve-accumulator","./poi-finding-accumulator","graphing/graphmode","./domaintypes"],function(e,t,r,n,i,a,s,o,u){"use strict";function c(e,t){for(var r,n=new s.default(t,e),i=t.min;i<=t.max+t.step/2;i+=t.step)r=e(i),isFinite(r)?n.addPoint([i,r]):n.breakSegment();return n.finish()}function l(e,t){var r=new s.default(t),n=e[0]+t.min*e[1],i=e[0]+t.max*e[1];return isFinite(n)&&isFinite(i)?(r.addPoint([t.min,n]),r.addPoint([t.max,i]),r.addLinearZero(e),r.addLinearIntercept(e),r.finish()):r.finish()}function p(e,t){var r=l(e[0],t),n=l(e[1],t);return r.segments.length&&n.segments.length&&4===r.segments[0].length&&4===n.segments[0].length?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function f(e,t){var r=e(t),n=r[0],i=r[1];return{segments:[[n,i,n,i]],resolved:!0}}function h(e,t,i){var a=i.fn,s=i.jumpTolerance,o=e[0],u=e[1],c=t[0],l=t[1],p=r.mean(o,c),f=a(p);return n.default.bisectJump(o,u,p,f,c,l,a,s)}function d(e,t,r){var n=t,i=e(n);return isFinite(i)||(n=t+r,i=e(n)),isFinite(i)||(n=t-r,i=e(n)),[n,i]}function m(e,t,r){var i,a,s,o,u,c,l,p=new I(e,t,r),f=t.step/10,h=t.min;i=d(e,h,f),l=i[0],c=i[1];var m=[l,c];isFinite(c)&&p.accumulator.addPoint([l,c]);for(var g=Math.ceil((t.max-t.min)/t.step),y=1;y<=g;y++)h=(g-y)/g*t.min+y/g*t.max,a=d(e,h,f),l=a[0],c=a[1],isFinite(c)&&isFinite(m[1])?(s=D(m,[l,c],p),l=s[0],c=s[1],p.accumulator.addPoint([l,c])):isFinite(c)&&!isFinite(m[1])?(u=n.default.bisectFinite(m[0],m[1],l,c,e),u&&(u[0]!==l&&p.accumulator.addPoint(u),o=D(u,[l,c],p),l=o[0],c=o[1],p.accumulator.addPoint([l,c]))):!isFinite(c)&&isFinite(m[1])&&(u=n.default.bisectFinite(m[0],m[1],l,c,e),u&&(u=D(m,u,p),u[0]!==m[0]&&p.accumulator.addPoint(u),p.accumulator.breakSegment())),m=[l,c];return p.accumulator.finish()}function g(e,t,r,n){function i(e,t){var i=t%2===0?1:-1;if(!n&&i===-1)return!1;for(var a=t*(Math.PI/r),s=[u,u+1,u+2,u+3],o=!1,c=0,p=s.length;c<p;c++){var f=e(s[c]),h=e(s[c]+a);if(isFinite(f)&&isFinite(h)&&(o=!0),isFinite(f)!==isFinite(h)||Math.abs(f-i*h)>l)return!1}return!!o}var a,s,o,u=t.min,c=t.max-t.min,l=t.xtolerance&&t.ytolerance?Math.min(t.xtolerance,t.ytolerance):t.tolerance?t.tolerance:0,p=Math.floor(c/(Math.PI/r));for(a=1;a<=p;a++)if(i(e,a)){for(o=a,s=2;s*a<=p;s++)i(e,s*a)||(o=void 0);if(o)break}return o?o*(Math.PI/r):null}function y(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function v(e,t){return t.map=y,m(e,t)}function b(e,t){for(var r=e.min,n=e.max,i=e.step,a=n-r,s=Math.ceil(a/i),o=a/s,u=0;u<s;u++)t(r+u*o);t(n)}function x(e,t){if(t.max<t.min)return{segments:[],resolved:!0};var r=new a.default(t),n=10,i=t.min,s=e(i);isFinite(s[0])&&isFinite(s[1])&&r.addPoint(s);var o;return b(t,function(t){o=e(t),_(e,i,s,t,o,n,r),i=t,s=o}),r.finish()}function _(e,t,n,i,a,s,o){if(i!==t){var u=o.xtolerance,c=o.ytolerance,l=r.mean(t,i),p=e(l),f=isFinite(n[0])&&isFinite(n[1]),h=isFinite(a[0])&&isFinite(a[1]),d=isFinite(p[0])&&isFinite(p[1]);if(0===s||l===t||l===i)return o.breakSegment(),void(h&&o.addPoint(a));if(f||h){if(f!==h){for(var m=t,g=i,y=n,v=a;t!==l&&l!==i;)d==f?(t=l,n=p,f=d):(i=l,a=p,h=d),l=t+(i-t)/2,p=e(l),d=isFinite(p[0])&&isFinite(p[1]);return void(f?(_(e,m,y,t,n,s-1,o),o.breakSegment()):(o.breakSegment(),o.addPoint(a),_(e,i,a,g,v,s-1,o)))}if(f&&d&&h){var b=r.pointToSegmentParameter(p[0],p[1],n[0],n[1],a[0],a[1]);if(b>.2&&b<.8&&Math.abs(p[0]-(n[0]+b*(a[0]-n[0])))<=u&&Math.abs(p[1]-(n[1]+b*(a[1]-n[1])))<=c)return void o.addPoint(a)}n[0]===p[0]&&n[1]===p[1]||_(e,t,n,l,p,s-1,o),a[0]===p[0]&&a[1]===p[1]||_(e,l,p,i,a,s-1,o)}}}function M(e){if(!e)return!1;var t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t)&&(!(!isFinite(n)||!isFinite(i)||i<=n)&&(!(!isFinite(e.screen.width)||e.screen.width<=0)&&!(!isFinite(e.screen.height)||e.screen.height<=0)))}function S(e,t,r){var n,i,a=e.viewport.xmin,s=e.viewport.xmax,c=e.viewport.ymin,l=e.viewport.ymax,p=e.trigAngleMultiplier||1,f=e.oversample||4,h=1/f*(s-a)/e.screen.width,d=1/f*(l-c)/e.screen.height,m=t.domainBound;switch(t.graphMode){case o.X:switch(n=u.intersectDomains(u.knownDomain([c,l]),m),n.type){case"empty":return!1;case"known":c=n.bounds[0],l=n.bounds[1]}i={min:c,max:l,xtolerance:d,ytolerance:h,step:d};break;case o.Y:switch(n=u.intersectDomains(u.knownDomain([a,s]),m),n.type){case"empty":return!1;case"known":a=n.bounds[0],s=n.bounds[1]}i={min:a,max:s,xtolerance:h,ytolerance:d,step:h};break;case o.POLAR:if(!t.domain)throw new Error("Expected polar graph to have domain");if(i={min:t.domain.min,max:t.domain.max,step:2*Math.PI/p/1e3,tolerance:Math.min(h,d)},!t.domain.isExplicit){var y=g(r,i,p,"="===t.operator);y&&(i.max=i.min+y)}i.step=Math.max(i.step,(i.max-i.min)/11999);break;case o.PARAMETRIC:var v=t.domain?t.domain.min:0,b=t.domain?t.domain.max:1,x=t.domain?t.domain.step:.01;switch(n=u.intersectDomains(u.knownDomain([v,b]),m),n.type){case"empty":return!1;case"known":v=n.bounds[0],b=n.bounds[1]}i={min:v,max:b,step:x,xtolerance:h,ytolerance:d};break;case o.IMPLICIT:i={xmin:a,xmax:s,ymin:c,ymax:l,xtolerance:h,ytolerance:d};break;default:return!1}return i}function E(e,t,r,n){var a,s,u,c=r.fn,h=S(e,t,c),d=t.graphMode;if(h){switch(d){case o.X:case o.Y:var g=n?n.fn:void 0;a=t.isLinear?l(t.linearCoefficients,h):m(c,h,g);break;case o.POLAR:a=v(c,h);break;case o.IMPLICIT:a=i.sampleImplicit(c,h);break;case o.PARAMETRIC:h.step||(h.step=(h.max-h.min)/1e3),a=h.max===h.min?f(c,h.min):t.isLinear?p(t.linearCoefficients,h):x(c,h);break;default:throw new Error("Programming Error: unexpected graphmode "+d)}u=a.poi}else a={segments:[],resolved:!0};if((!u||u.zeros.x.length+u.extrema.x.length+u.intercept.x.length>250)&&(u={zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}),d===o.X)for(var y in u)if(u.hasOwnProperty(y)){var b=y;s=u[b].y,u[b].y=u[b].x,u[b].x=s}var _={segments:a.segments,resolved:a.resolved,graphMode:d,color:t.color,style:t.lineStyle,operator:t.operator,poi:u,compiled:r};if(d===o.POLAR){var M=h;_.sampledDomain={min:M.min,max:M.max,step:M.step}}return a.fillSegments&&(_.fillSegments=a.fillSegments),_}function w(e,t,r){var n,i,a,s,u=[],c=null;switch(r){case o.POLAR:c=y;break;case o.X:c=function(e){return[e[1],e[0]]}}for(n=0;n<e.length;n++)for(s=e[n],i=0;i<s.length;i+=2)a=[s[i],s[i+1]],c&&(a=c(a)),u.push(a[0],a[1]);for(n=t.length-1;n>=0;n--)for(s=t[n],i=s.length-2;i>=0;i-=2)a=[s[i],s[i+1]],c&&(a=c(a)),u.push(a[0],a[1]);return u}function T(e,t,n){for(var i=function(e){var t=e[e.length-1];return t[t.length-2]},a=[],s=0,o=0,u=[],c=[],l=-(1/0),p=-(1/0);;){if(l<=p){if(s>=t.length)break;c.push(t[s++])}if(p<=l){if(o>=e.length)break;u.push(e[o++])}if(l=i(c),p=i(u),r.approx(l,p,4)){a.push(w(u,c,n)),c=[],u=[];var f=Math.max(l,p);l=f,p=f}}return a}Object.defineProperty(t,"__esModule",{value:!0});var D=function(e,t,r){var n=r.fn,i=r.jumpTolerance,a=r.accumulator;if(!isFinite(i)||i<=0)return t;var s=h(e,t,r);if(!s)return t;for(var o=(t[0]-e[0])/10,u=[-o,o],c=t,l=0;l<u.length;l++){var p=e[0]+u[l],f=n(p);isFinite(f)||(p=e[0],f=e[1],p=e[0],f=e[1]);var d=t[0]+u[l],m=n(d);if(isFinite(m)?c=[d,m]:(d=t[0],m=t[1]),h([p,f],[d,m],r)){var g=s[0],y=s[1];return a.addPoint(g),a.breakSegment(),a.addPoint(y),t}}return c},I=function(){function e(e,t,r){this.derivative=r,this.accumulator=new s.default(t,e,r),this.fn=e,this.jumpTolerance=t.ytolerance||t.tolerance||0}return e}();t.default={sampleXYNaive:c,sampleLinear:l,sampleXY:m,findPiPeriod:g,samplePolar:v,sampleParametricRecursive:x,subsampleParametricRecursive:_,validateViewState:M,computeDomain:S,computeGraphData:E,polygonsFromSegments:T}}),define("lib/worker-i18n",["require","exports"],function(e,t){"use strict";function r(e,t){return{msg:e,vars:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.t=r}),define("math/mathshim",["require"],function(e){var t={};return t.cosh=Math.cosh||function(e){return.5*(Math.exp(e)+Math.exp(-e))},t.sinh=Math.sinh&&0!==Math.sinh(1e-20)?Math.sinh:function(e){var r=e>0?1:-1;return e=e>0?e:-e,.5*-r*Math.exp(e)*t.expm1(-2*e)},t.tanh=Math.tanh&&0!==Math.tanh(1e-20)?Math.tanh:function(e){var r=e>0?1:-1;e=e>0?e:-e;var n=t.expm1(-2*e);return-r*n/(2+n)},t.acosh=Math.acosh||function(e){return e<1?NaN:Math.log(e+t.sqrtxsqm1(e))},t.asinh=Math.asinh&&0!==Math.asinh(1e-20)?Math.asinh:function(e){var r=e>0?1:-1;return e=e>0?e:-e,1+e*e===1?r*t.log1p(e):r*Math.log(e+t.sqrtxsqp1(e))},t.atanh=Math.atanh&&0!==Math.atanh(1e-20)?Math.atanh:function(e){return.5*(t.log1p(e)-t.log1p(-e))},t.expm1=Math.expm1||function(e){return e+.5*e*e===e?e:Math.exp(e)-1},t.log1p=Math.log1p||function(e){return e-.5*e*e===e?e:Math.log(1+e)},t.sqrtxsqp1=function(e){var t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},t.sqrtxsqm1=function(e){var t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)},t}),define("math/quadrature",["require","math/mathshim","math/poi"],function(e){"use strict";function t(e,t){for(var r=v;r>0;r--){var n=h/v*r,i=c.sinh(n),a=c.cosh(Math.PI/2*i),s=1/(Math.exp(Math.PI/2*i)*a),o=c.cosh(n)/(a*a);e.push(s),t.push(o)}}function r(e,t,r){return.5*(t*(2-r)+e*r)}function n(e,t,r){var n=.5*(t+r),i=p(t,e(t),n,e(n),r,e(r),e,0);return i?.5*(i[0][0]+i[1][0]):n}function i(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function a(e,t,n){var i=Math.abs(e(r(t,n,m))),a=Math.abs(e(r(t,n,2*m)));return!(i<m||a<m)&&i>1.95*a}function s(e,t,n){var s,o,u=r(n,t,b[0]),c=r(t,n,b[0]),l=e(u),p=e(c),h=r(t,n,1),d=e(h);if(isFinite(d)&&!isFinite(l)){if(s=f(u,l,h,d,e),Math.abs((s[0]-t)/(n-t))>y)return i(t,n,NaN,NaN,NaN);t=s[0],l=s[1]}if(isFinite(d)&&!isFinite(p)){if(o=f(h,d,c,p,e),Math.abs((o[0]-n)/(n-t))>y)return i(t,n,NaN,NaN,NaN);n=o[0],p=o[1]}if(isFinite(l)&&isFinite(p)&&!isFinite(d)){if(s=f(u,l,h,d,e),o=f(h,d,c,p,e),Math.abs((o[0]-s[0])/(n-t))>y)return i(t,n,NaN,NaN,NaN);d=.5*(s[1]+o[1])}if(a(e,t,n)||a(e,n,t))return i(t,n,NaN,NaN,NaN);for(var m=d,g=0,_=0,M=0,E=0,w=0,T=0,D=0;D<v;D+=4)w=e(r(t,n,b[D])),T=e(r(n,t,b[D])),E=Math.max(E,Math.abs(w),Math.abs(T)),g+=x[D]*(w+T),w=e(r(t,n,b[D+1])),T=e(r(n,t,b[D+1])),E=Math.max(E,Math.abs(w),Math.abs(T)),M+=x[D+1]*(w+T),w=e(r(t,n,b[D+2])),T=e(r(n,t,b[D+2])),E=Math.max(E,Math.abs(w),Math.abs(T)),_+=x[D+2]*(w+T),w=e(r(t,n,b[D+3])),T=e(r(n,t,b[D+3])),E=Math.max(E,Math.abs(w),Math.abs(T)),M+=x[D+3]*(w+T);var I,C=m+g,P=C+_,O=P+M,N=Math.abs(_-C),A=Math.abs(M-P),L=S*(n-t)*O,q=S*Math.abs(n-t)*E*x[0];return I=0===N?S*Math.abs(n-t)*A:S*Math.abs(n-t)*A*(A/N)*(A/N),I=Math.max(I,q),i(t,n,L,I,q)}function o(e){for(var t=-(1/0),r=-(1/0),n=-1,i=0,a=0;a<e.length;a++){var s=e[a];i+=s.value,s.error>t&&(t=s.error,n=a),s.minerror>r&&(r=s.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function u(e,t,i,a){if(void 0===a&&(a=32),!isFinite(t)||!isFinite(i))return NaN;for(var u=[s(e,t,i)],c=o(u),l=1;l<a&&!(Math.abs(c.maxerror/c.totalvalue)<=32*g||c.maxerror<=32*g||c.maxerror<=32*c.maxminerror);l++){var p=u[u.length-1];u[u.length-1]=u[c.maxindex],u[c.maxindex]=p;var f=u.pop(),h=n(e,r(f.x2,f.x1,.125),r(f.x1,f.x2,.125));u.push(s(e,f.x1,h)),u.push(s(e,h,f.x2)),c=o(u)}return c.totalvalue}var c=e("math/mathshim"),l=e("math/poi").default,p=l.bisectJump,f=l.bisectFinite,h=3.154019550531224,d=Math.pow(2,-13),m=d*d,g=m*m,y=m,v=32,b=[],x=[];t(b,x);for(var _=0,M=0;M<x.length;M++)_+=x[M];var S=1/(1+2*_);return{quad:u}}),define("math/studentt",["require","math/poi"],function(e){var t=e("math/poi").floatMiddle,r=.5772156649015329,n=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349],a=function(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<.001)return 1/(e*(1+r*e));if(e<12){var t=e,a=0,s=t<1;s?t+=1:(a=Math.floor(t)-1,t-=a);for(var o=0,c=1,l=t-1,p=0;p<8;p++)o=(o+n[p])*l,c=c*l+i[p];var f=o/c+1;if(s)f/=t-1;else for(p=0;p<a;p++)f*=t++;return f}return e>171.624?1/0:Math.exp(u(e))},s=[1/12,-1/360,1/1260,-1/1680,1/1188,-691/360360,1/156,-3617/122400],o=.9189385332046728,u=function(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<12)return Math.log(Math.abs(a(e)));for(var t=1/(e*e),r=s[7],n=6;n>=0;n--)r*=t,r+=s[n];var i=r/e;return(e-.5)*Math.log(e)-e+o+i},c=function(e){if(e<=-1)throw new RangeError("Argument mustbe greater than -1.0");return Math.abs(e)>1e-4?Math.log(1+e):(-.5*e+1)*e},l=function(e,t,r){if(e<0||e>1)throw new RangeError("First argument must be between 0 and 1.");if(1===t&&1===r)return e;if(0===e)return 0;if(1===e)return 1;if(0===t)return 1;if(0===r)return 0;var n=Math.exp(u(t+r)-u(t)-u(r)+t*Math.log(e)+r*c(-e));return e<(t+1)/(t+r+2)?n*p(e,t,r)/t:1-n*p(1-e,r,t)/r},p=function(e,t,r){var n,i,a,s,o,u,c,l,p,f=1e-30,h=1;for(c=t+r,p=t+1,l=t-1,a=1,s=1-c*e/p,Math.abs(s)<f&&(s=f),s=1/s,u=s;h<=100&&(n=2*h,i=h*(r-h)*e/((l+n)*(t+n)),s=1+i*s,Math.abs(s)<f&&(s=f),a=1+i/a,Math.abs(a)<f&&(a=f),s=1/s,u*=s*a,i=-(t+h)*(c+h)*e/((t+n)*(p+n)),s=1+i*s,Math.abs(s)<f&&(s=f),a=1+i/a,Math.abs(a)<f&&(a=f),s=1/s,o=s*a,u*=o,!(Math.abs(o-1)<3e-7));h++);return u},f=function(e,t){var r=a((e+1)/2)/(Math.sqrt(e*Math.PI)*a(e/2));return r*Math.pow(1+t*t/e,-((e+1)/2))},h=function(e,t){var r=Math.sqrt(t*t+e);return l((t+r)/(2*r),e/2,e/2)},d=function(e,t){var r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:var n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return 2*Math.sign(t-.5)*Math.sqrt(n-1);default:throw new Error("studentT.simpleInverse() must be called with 1, 2, or 4 df.")}},m=function(e,r,n,i){for(var a,s,o=n,u=i;;){if(a=t(o,u),s=h(e,a),a===o||a===u)return s>r?o:u;s<r?o=a:u=a}};return{cdf:h,pdf:f,gamma:a,simpleInverse:d,bisectInverse:m}}),define("math/tofraction",["require","exports"],function(e,t){"use strict";function r(e,t){if(void 0===t&&(t=1e6),e===1/0)return{n:1/0,d:1};if(e===-(1/0))return{n:-(1/0),d:1};if(!isFinite(e))return{n:NaN,d:1};for(var r,n,i,a=0,s=1,o=1,u=0;;){if(r=Math.floor(e),n=r*s+a,i=r*u+o,i>t)break;if(a=s,o=u,s=n,u=i,e===r)break;e=1/(e-r)}return{n:s,d:u}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}),define("math/builtin",["require","math/mathshim","math/distance","math/quadrature","math/studentt","math/tofraction"],function(e){function t(e){return!(e>1e12)&&Math.round(l*e)*Math.PI===e}function r(e){if(e>1e12)return!1;var t=Math.round(2*l*e);return t%2===1&&t*Math.PI===2*e}function n(e,t,r){return r<0?c.tcdf(-(1/0),e,t):r>0?c.tcdf(-(1/0),-e,t):2*c.tcdf(-(1/0),-Math.abs(e),t)}var i=e("math/mathshim"),a=e("math/distance"),s=e("math/quadrature"),o=e("math/studentt"),u=e("math/tofraction").default,c={};c.cosh=i.cosh,c.sinh=i.sinh,c.tanh=i.tanh,c.acosh=i.acosh,c.asinh=i.asinh,c.atanh=i.atanh,c.expm1=i.expm1,c.log1p=i.log1p,c.sqrtxsqp1=i.sqrtxsqp1,c.sqrtxsqm1=i.sqrtxsqm1,c.mod=function(e,t){return e-t*Math.floor(e/t)},c.round=function(e,t){if(void 0===t&&(t=0),t=Math.round(t),0===t)return Math.round(e);var r=Math.pow(10,t);return Math.round(e*r)/r},c.sign=Math.sign||function(e){return 0===e?0:e>0?1:e<0?-1:NaN},c.lcm=function(e,t){e=Math.round(e),t=Math.round(t);var r=c.gcd(e,t);return Math.abs(e/r*t)},c.gcd=function(e,t){if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){var r=t;t=e,e=r}if(0===t)return e;for(var n=e%t;n>0;)e=t,t=n,n=e%t;return t},c.listGCD=function(e){if(0===e.length)return NaN;for(var t=e[0],r=1;r<e.length;r++)t=c.gcd(t,e[r]);return t},c.listLCM=function(e){if(0===e.length)return NaN;for(var t=e[0],r=1;r<e.length;r++)t=c.lcm(t,e[r]);return t},c.nCr=function(e,t){if(e=Math.round(e),t=Math.round(t),t>e||e<0||t<0)return 0;for(var r=1,n=0;n<t;n++)r*=(e-n)/(n+1);return r},c.nPr=function(e,t){if(e=Math.round(e),t=Math.round(t),t>e||e<0||t<0)return 0;for(var r=1,n=0;n<t;n++)r*=e-n;return r},c.factorial=function(e){return c.gamma(e+1)},c._integerFactorial=function(e){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e>170)return NaN;if(0===e||1===e)return 1;for(var t=1,r=2;r<=e;r++)t*=r;return t},c.gamma=function(e){return e===Math.floor(e)?c._integerFactorial(e-1):e<0?Math.PI/(Math.sin(Math.PI*e)*c.gamma(1-e)):Math.exp(c.lnGamma(e))},c.lnGamma=function(e){if(e<0)return NaN;for(var t=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],r=.9999999999999971,n=0;n<14;n++)r+=t[n]/(e+n+1);var i=e+5.2421875;return(e+.5)*Math.log(i)-i+Math.log(2.5066282746310007*r/e)},c.bernoulliTable=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870],c.cotDerivative=function(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(0===e)return 1/c.tan(t);var r=c.sin(t);if(1===e)return-1/(r*r);var n=c.cos(t);if(2===e)return 2*n/(r*r*r);var i,a,s,o,u,l=[0,2];for(a=3;a<=e;a++){for(i=[],s=0;s<a;s++)o=0,u=0,s>0&&(o=(a-s+1)*l[s-1]),s+2<a&&(u=(s+1)*l[s+1]),i.push(-(o+u));l=i}var p=0;for(s=e-1;s>=0;s--)p=i[s]+n*p;return p/Math.pow(r,e+1)},c.polyGamma=function(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;var r=e%2===0?-1:1;if(t<0)return-r*c.polyGamma(e,1-t)-Math.pow(Math.PI,e+1)*c.cotDerivative(e,Math.PI*t);for(var n=c.factorial(e),i=0,a=Math.pow(t,-(e+1));t<10;)i+=a,t++,a=Math.pow(t,-(e+1));i+=0===e?-Math.log(t):a*t/e,i+=.5*a;for(var s=c.bernoulliTable,o=e+1,u=2,l=a*t*o/u,p=1/(t*t),f=1;f<=14;f++)l*=p,i+=l*s[f-1],o++,u++,l*=o/u,o++,u++,l*=o/u;return n*r*i},c.toFraction=u,c.log=function(e){var t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t},c.log_base=function(e,t){if(0===t)return NaN;var r=Math.log(e)/Math.log(t);return Math.pow(t,Math.round(r))===e?Math.round(r):r},c.common_log=function(e){return c.log_base(e,10)},c.pow=function(e,t){if(!isFinite(e)&&0===t)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);var r=c.toFraction(t,100);return a.approx(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN},c.nthroot=function(e,t){return c.pow(e,1/t)};var l=1/Math.PI;c.sin=function(e){return t(Math.abs(e))?0:Math.sin(e)},c.cos=function(e){return r(Math.abs(e))?0:Math.cos(e)},c.tan=function(e){var n=Math.abs(e);return t(n)?0:r(n)?1/0:Math.tan(e)},c.sec=function(e){return r(Math.abs(e))?1/0:1/Math.cos(e)},c.csc=function(e){return t(Math.abs(e))?1/0:1/Math.sin(e)},c.cot=function(e){var n=Math.abs(e);return t(n)?1/0:r(n)?0:1/Math.tan(e)},c.acot=function(e){return Math.PI/2-Math.atan(e)},c.acsc=function(e){return Math.asin(1/e);\n},c.asec=function(e){return Math.acos(1/e)},c.sech=function(e){return 1/c.cosh(e)},c.csch=function(e){return 1/c.sinh(e)},c.coth=function(e){return 1/c.tanh(e)},c.asech=function(e){return c.acosh(1/e)},c.acsch=function(e){return c.asinh(1/e)},c.acoth=function(e){return c.atanh(1/e)},c.mean=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length},c.total=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t},c.tpdf=function(e,t){return t<=0?NaN:o.pdf(t,e)},c.tcdf=function(e,t,r){return r<=0?NaN:e===-(1/0)?o.cdf(r,t):e>0&&t>0?o.cdf(r,-e)-o.cdf(r,-t):o.cdf(r,t)-o.cdf(r,e)};var p=function(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))},f=function(e){return e<0?.5*Math.exp(-e*e)*c.erfcx(-e):1-.5*Math.exp(-e*e)*c.erfcx(e)};c.normalcdf=function(e,t,r,n){var i=p(t,r,n);if(e===-(1/0))return f(i);var a=p(e,r,n);return e>0&&t>0?f(-a)-f(-i):f(i)-f(a)},c.normalpdf=function(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))};var h=function(e,t,r){for(var n=r/(1-r),i=Math.pow(1-r,t),a=i,s=1;s<=Math.min(t,e);s++)i*=(t-s+1)/s*n,a+=i;return a};c.binomcdf=function(e,t,r,n){return r!==Math.round(r)?NaN:n<0||n>1?NaN:t<0||r<0?0:(e=Math.floor(e),t=Math.floor(t),e===-(1/0)?h(t,r,n):h(t,r,n)-h(e,r,n))},c.binompdf=function(e,t,r){return t!==Math.round(t)?NaN:(e=Math.round(e),r<0||r>1?NaN:e<0||t<0?0:c.nCr(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e))},c.poissonpdf=function(e,t){return t<=0?NaN:(e=Math.round(e),e<0?0:Math.exp(-t+e*Math.log(t)-c.lnGamma(e+1)))};var d=function(e,t){if(e===1/0)return 1;if(e<=0)return 0;for(var r=1,n=1,i=1;i<=e;i++){r*=t/i;var a=n;if(n+=r,n===a)break}return Math.exp(-t)*n};return c.poissoncdf=function(e,t,r){return r<=0?NaN:(e=Math.floor(e),t=Math.floor(t),t<0?0:e===-(1/0)?d(t,r):d(t,r)-d(e,r))},c.erf=function(e){var t=-e*e;if(t<-750)return e>=0?1:-1;if(e>=.065)return 1-Math.exp(t)*c.erfcx(e);if(e<=-.065)return Math.exp(t)*c.erfcx(-e)-1;var r=1.1283791670955126,n=.37612638903183754,i=.11283791670955126,a=.026866170645131252,s=.005223977625442188;return e*(r+t*(n+t*(i+t*(a+t*s))))},c.erfcx=function(e){var t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,a=.8257463703357973,s=.28647031042892007,o=.07124513844341643,u=.012296749268608364,l=.001347817214557592,p=7263959403471071e-20,f=1,h=3.352953590554884,d=5.227518529742423,m=5.003720878235473,g=3.266590890998987,y=1.5255421920765353,v=.5185887413188858,b=.12747319185915415,x=.02185979575963238,_=.0023889438122503674,M=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-c.erfcx(-e);if(e>50){var S=.5641895835477563,E=e*e;return e>5e7?S/e:S*(E*(E+4.5)+2)/(e*(E*(E+5)+3.75))}var w=t+e*(r+e*(n+e*(i+e*(a+e*(s+e*(o+e*(u+e*(l+e*p)))))))),T=f+e*(h+e*(d+e*(m+e*(g+e*(y+e*(v+e*(b+e*(x+e*(_+e*M)))))))));return w/T},c.invNorm=function(e){var t,r,n,i=-39.6968302866538,a=220.946098424521,s=-275.928510446969,o=138.357751867269,u=-30.6647980661472,l=2.50662827745924,p=-54.4760987982241,f=161.585836858041,h=-155.698979859887,d=66.8013118877197,m=-13.2806815528857,g=-.00778489400243029,y=-.322396458041136,v=-2.40075827716184,b=-2.54973253934373,x=4.37466414146497,_=2.93816398269878,M=.00778469570904146,S=.32246712907004,E=2.445134137143,w=3.75440866190742,T=.02425;return e>.5?-c.invNorm(1-e):.5===e?0:e<0?NaN:0===e?-(1/0):(e<T?(t=Math.sqrt(-2*Math.log(e)),n=(((((g*t+y)*t+v)*t+b)*t+x)*t+_)/((((M*t+S)*t+E)*t+w)*t+1)):(t=e-.5,r=t*t,n=(((((i*r+a)*r+s)*r+o)*r+u)*r+l)*t/(((((p*r+f)*r+h)*r+d)*r+m)*r+1)),n-Math.sqrt(2*Math.PI)*(.5*c.erfcx(-n/Math.SQRT2)-Math.exp(.5*n*n)*e))},c.invPoisson=function(e,t){if(t<=0||e<0||e>1)return NaN;if(0===e)return 0;if(1===e)return 1/0;for(var r=1,n=1,i=1;Math.exp(-t)*n<e;)r*=t/i,n+=r,i+=1;return i-1},c.invBinom=function(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(0===e)return 0;if(1===e)return t;if(0===t)return 0;if(1===r)return t;if(0===r)return 0;for(var n=r/(1-r),i=Math.pow(1-r,t),a=i,s=1;a<e;)i*=(t-s+1)/s*n,a+=i,s+=1;return s-1},c.invT=function(e,t){if(t<=0||e<0||e>1)return NaN;if(0===e)return-(1/0);if(1===e)return 1/0;if(1===t||2===t||4===t)return o.simpleInverse(t,e);var r,n;return.5===e?0:e>.5?(r=t>1?c.invNorm(e):o.simpleInverse(1,e),n=t>1?o.simpleInverse(1,e):Math.pow(c.tpdf(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t),o.bisectInverse(t,e,r,n)):-c.invT(1-e,t)},c.ZScore=function(e,t,r){return r<0?NaN:(e-t)/r},c.TScore=function(e,t){var r=c.stdev(e),n=c.mean(e);return(n-t)*Math.sqrt(e.length)/r},c.IndependentTScore=function(e,t){var r=e.length,n=c.mean(e),i=c.stdev(e),a=t.length,s=c.mean(t),o=c.stdev(t),u=Math.sqrt(((r-1)*i*i+(a-1)*o*o)/(r+a-2));return(n-s)/(u*Math.sqrt(1/r+1/a))},c.TTest=function(e,t){var r=c.TScore(e,0),i=e.length-1;return n(r,i,t)},c.IndependentTTest=function(e,t,r){var i=c.IndependentTScore(e,t),a=e.length+t.length-2;return n(i,a,r)},c.length=function(e){return e.length},c.listMin=function(e){if(e.length<1)return NaN;var t=e[0];if(isNaN(t))return NaN;for(var r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t},c.listMax=function(e){if(e.length<1)return NaN;var t=e[0];if(isNaN(t))return NaN;for(var r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t},c.quantile=function(e,t){if(!isFinite(t)||t<0||t>1)return NaN;var r=e.length,n=c.sortPerm(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]},c.quartile=function(e,t){if(!isFinite(t)||t<0||t>4)return NaN;var r=c.sortPerm(e),n=c.quartileIndex(e,t),i=Math.floor(n),a=Math.ceil(n);return(e[r[i]]+e[r[a]])/2},c.sortPerm=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r.push(n);return r.sort(function(t,r){return e[t]-e[r]}),r},c.quartileIndex=function(e,t){t=Math.round(t);var r,n=e.length,i=n%2===1;return 1===n?0:(0===t&&(r=0),2===t&&(r=(n-1)/2),4===t&&(r=n-1),1===t&&(r=i?(n+1)/4-1:(n+2)/4-1),3===t&&(r=i?(3*n+3)/4-1:(3*n+2)/4-1),r)},c.upperQuantileIndex=function(e,t){return c.sortPerm(e)[Math.ceil(t*(e.length-1))]+1},c.lowerQuantileIndex=function(e,t){return c.sortPerm(e)[Math.floor(t*(e.length-1))]+1},c.upperQuartileIndex=function(e,t){return c.sortPerm(e)[Math.ceil(c.quartileIndex(e,t))]+1},c.lowerQuartileIndex=function(e,t){return c.sortPerm(e)[Math.floor(c.quartileIndex(e,t))]+1},c.median=function(e){return c.quantile(e,.5)},c.argMin=function(e){if(e.length<1)return 0;var t=e[0];if(isNaN(t))return 0;for(var r=0,n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1},c.argMax=function(e){if(e.length<1)return 0;var t=e[0];if(isNaN(t))return 0;for(var r=0,n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1},c.varp=function(e){for(var t=c.mean(e),r=0,n=0;n<e.length;n++){var i=e[n]-t;r+=i*i}return r/e.length},c.mad=function(e){for(var t=c.mean(e),r=0,n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length},c.var=function(e){var t=e.length;return c.varp(e)*t/(t-1)},c.covp=function(e,t){if(e.length!==t.length)return NaN;for(var r=e.length,n=c.mean(e),i=c.mean(t),a=0,s=0;s<r;s++)a+=(e[s]-n)*(t[s]-i);return a/r},c.cov=function(e,t){if(e.length!==t.length)return NaN;var r=e.length;return c.covp(e,t)*r/(r-1)},c.corr=function(e,t){if(e.length!==t.length)return NaN;for(var r,n,i=e.length,a=c.mean(e),s=c.mean(t),o=0,u=0,l=0,p=0;p<i;p++)r=e[p]-a,n=t[p]-s,o+=r*r,u+=n*n,l+=r*n;return l/Math.sqrt(o*u)},c.stdev=function(e){return Math.sqrt(c.var(e))},c.stdevp=function(e){return Math.sqrt(c.varp(e))},c.quad=s.quad,c.distance=function(e,t){return a.hypot(t[0]-e[0],t[1]-e[1])},c.midpoint=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]},c}),define("math/functions",["require","math/builtin"],function(e){function t(e){for(var t=0;t<e.length;t++)e[t].compiled&&delete e[t].compiled.fn}function r(e){for(var t=0;t<e.length;t++){var r=e[t].compiled;r&&(r.fn=i(r.args,r.source))}}function n(e,t){for(var r=[],n=0;n<t;n++)r.push("values["+n+"]");return i(["values"],"return "+e(r))}function i(e,t){var r=e.join(","),n="return (function("+r+"){"+t+"})",i=new Function(["BuiltIn"],n);return i(a)}var a=e("math/builtin");return{dehydrateGraphData:t,rehydrateGraphData:r,closureFunctionWithBuiltIn:i,createEvaluateFunction:n}}),define("math/parser/input-span",["require","exports"],function(e,t){"use strict";function r(e,t,r){return{input:e,start:t,end:r}}function n(e,t){return r(e,t,t)}function i(e,t){if(e.input!==t.input)throw new Error("Programming Error: cannot form a span on different inputs");return r(e.input,e.start,t.end)}function a(e){return e.input.slice(e.start,e.end)}Object.defineProperty(t,"__esModule",{value:!0}),t.Span=r,t.emptySpanAt=n,t.joinSpans=i,t.slice=a}),define("math/parsenode/base",["require","pjs","math/functions","math/parser/input-span"],function(e){var t=e("pjs"),r=e("math/functions"),n=e("math/parser/input-span");return t(function(e,t,i){e.init=function(){this._dependencies=[],this._dummyDependencies=[],this._exports=[]},e.exportPenalty=0;var a=0;e.tmpVar=function(){return"tmp"+a++},e.dependencies=function(){return this.getDependencies()},e.evaluateOnce=function(e){void 0===e&&(e={});var t=this.getConcreteTree(e),r=t.getEvaluationInfo();return r?r[0].val:NaN},e.setInputSpan=function(e){this._inputSpan=e},e.getInputString=function(){return void 0===this._inputSpan?"":n.slice(this._inputSpan)},e.getInputSpan=function(){return this._inputSpan},e.shouldExportAns=function(){return!1},e.getAnsVariable=function(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]},e.addDependency=function(e){this.dependsOn(e)||this._dependencies.push(e)},e.addDependencies=function(e){for(var t=0;t<e.length;t++)this.addDependency(e[t])},e.addDummyDependency=function(e){this._dummyDependencies.indexOf(e)===-1&&this._dummyDependencies.push(e)},e.addDummyDependencies=function(e){for(var t=0;t<e.length;t++)this.addDummyDependency(e[t])},e.mergeDependencies=function(){for(var e=0;e<arguments.length;e++)this.addDependencies(arguments[e].getDependencies()),this.addDummyDependencies(arguments[e].getDummyDependencies())},e.getDependencies=function(){return this._dependencies},e.getDummyDependencies=function(){return this._dummyDependencies},e.removeDependency=function(e){var t=this._dependencies.indexOf(e);t>=0&&this._dependencies.splice(t,1)},e.dependsOn=function(e){return this._dependencies.indexOf(e)>-1},e.getExports=function(){var e=this._exports||[];return e.concat(this.getAnsVariable())},e.getLegalExports=function(e){return this.getExports().filter(function(t){return!e.assignmentForbidden(t)})},e.exportsSymbol=function(e){return this._exports.indexOf(e)>-1},e.exportTo=function(e,t,r){for(var n=this.getLegalExports(e),i=0;i<n.length;i++){var a=n[i];if(r[a])return;r[a]=t.blocksExport?t:this}},e.getOperator=function(){return this.operator||"="},e.isInequality=function(){return!1},e.isShadeBetween=function(){return!1},e.getAllIds=function(){return this.userData?[this.userData.id]:[]},e.getEvaluationInfo=function(){return!1},e.shouldPromoteToSlider=function(e){return!1},e.getSliderVariables=function(e,t){return e.sliderVariables(t.getDependencies())},e.getCompiledFunction=function(e){var t=this.getEvalStrings(),n=t.statements.join(";")+";return "+t.expression;if(void 0===e){e=this.getDependencies();var i=e.indexOf("x");if(i!==-1){var a=e[0];e[0]=e[i],e[i]=a}}return{args:e,source:n,fn:r.closureFunctionWithBuiltIn(e,n)}},e.getCompiledDerivative=function(){var e=this.getDependencies(),t=this.takeDerivative(e[0]||"x");return t.getCompiledFunction()},e.asValue=function(){}})}),define("math/parsenode/error",["require","pjs","./base"],function(e){var t=e("pjs"),r=e("./base");return t(r,function(e,t){e.init=function(e){t.init.call(this),this._msg=e,this._sliderVariables=[],this.blocksExport=!0},e.evaluateOnce=function(e){return this._msg},e.isError=!0,e.getError=function(){return this._msg},e.setDependencies=function(e){return this._dependencies=e,this},e.allowExport=function(){return this.blocksExport=!1,this}})}),define("graphing/label",["require","exports","underscore","math/distance","math/tofraction"],function(e,t,r,n,i){"use strict";function a(e,t){if(void 0===t&&(t=e),isNaN(e)||!isFinite(e))return{ariaString:"undefined",string:"undefined",value:e};if(0===e)return{ariaString:"0",string:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);var r,a,s,o=i.default(e/Math.PI,24);if(h(t)&&n.approx(o.n/o.d*Math.PI,e,3))return r=0===o.n?"0":1===o.n?"":o.n===-1?"-":o.n.toString()+"",a=1===o.d?"":"/"+o.d.toString(),s=r+a,{ariaString:u(s),string:s,value:o.n/o.d*Math.PI};if(h(t))return s=f(l(e.toFixed(d(t)))),{ariaString:u(s),string:s,value:parseFloat(s)};var c=p(e.toExponential(d(t/e))).split("e"),m=c[0]+"10",g=c[1].replace("+","");return s=p(e.toExponential(d(t/e))).replace("+",""),{ariaString:u(s),string:s,mantissa:m,superscript:g,value:parseFloat(s)}}function s(e){return T["["+e+"]"]}function o(e){return e[0]+e.slice(1).split("").join(" ")}function u(e){return e.replace(I,o).replace(D,s).replace(/ +/gi," ").trim()}function c(e,t,r,n){var i=a(e,t),s=a(n(i.value),r);return[i,s]}function l(e){return e.indexOf(".")===-1?e:e.replace(C,"")}function p(e){var t=/\\.?0+e/;return e.replace(t,"e")}function f(e){return"-0"===e?"0":e}function h(e){return e=Math.abs(e),1e-4<e&&e<1e7}function d(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function m(e,t){var r=i.default(e,t);return 1!==r.d&&n.approx(r.n/r.d,e,3)}function g(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:"undefined"};if(0===e||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:"decimal",value:"0"};var r=t.smallCutoff||.001,n=t.bigCutoff||1e6,a=t.digits||10,s=t.denominatorCutoff||1e6,o=p(e.toExponential(a-2)),u=o.match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!u)return{type:"undefined"};var c=parseInt(u[2],10)>=a,f=m(e,s);if(Math.abs(e)>n||Math.abs(e)<r||c)return{type:"scientific",mantissa:u[1],exponent:u[2]};if(f&&t.displayAsFraction){var h=i.default(e,s);return{type:"fraction",numerator:h.n.toString(),denominator:h.d.toString()}}var d=l(e.toPrecision(a));return e!==Number(d)&&t.addEllipses&&(d+="..."),{type:"decimal",value:d}}function y(e,t){var r=g(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"<span class=\'dcg-cross\'></span>10<sup>"+r.exponent+"</sup>";case"fraction":return"1"===r.denominator?r.numerator:r.numerator+"/"+r.denominator;default:var n=r;return n}}function v(e,t){var r=g(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+" * 10^"+r.exponent;case"fraction":return"1"===r.denominator?r.numerator:r.numerator+"/"+r.denominator;default:var n=r;return n}}function b(e,t){var r=g(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"\\\\times10^{"+r.exponent+"}";case"fraction":return"1"===r.denominator?r.numerator:"-"===r.numerator[0]?"-\\\\frac{"+r.numerator.slice(1)+"}{"+r.denominator+"}":"\\\\frac{"+r.numerator+"}{"+r.denominator+"}";default:var n=r;return n}}function x(e,t){var r=g(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return u(r.value);case"scientific":return u(r.mantissa+"e"+r.exponent);case"fraction":return u(r.numerator+"/"+r.denominator);default:var n=r;return n}}function _(e){e=e.replace("\\\\","");var t={pi:"",tau:"",theta:"",phi:""};return t.hasOwnProperty(e)?t[e]:e}function M(e){var t=e.split("_"),r="";return t[0].length>1&&(r+="\\\\"),r+=t[0],t[1]&&(r+=1===t[1].length?"_"+t[1]:"_{"+t[1]+"}"),r}function S(e){if(!e)return"";var t=e.split("_").map(_).map(r.escape),n=t[0];return t[1]&&(n+="<sub>"+t[1]+"</sub>"),n}function E(e){return e=e.replace(/\\\\operatorname\\{(.*)\\}/,"$1"),e.replace(/[{}\\\\]/g,"")}function w(e){return e.replace(/^(\\\\ | |\\\\space)+/,"").replace(/(\\\\ | |\\\\space)+$/,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.value=a;var T={"[e]":" times 10 to the ","[+]":" plus ","[-]":" minus ","[*]":" times ","[/]":" over ","[]":" pi ","[]":" tau ","[]":" theta ","[]":" phi "},D=new RegExp(Object.keys(T).join("|"),"gi"),I=/\\.\\d+/g;t.point=c;var C=/\\.?0+$/;t.canDisplayAsFraction=m,t.numericLabel=g,t.truncatedHTMLLabel=y,t.truncatedPlainmathLabel=v,t.truncatedLatexLabel=b,t.truncatedAriaLabel=x,t.formatSymbol=_,t.identifierToLatex=M,t.identifierToHTML=S,t.latexToIdentifier=E,t.trimLatex=w}),define("math/types",["require","lib/worker-i18n"],function(e){function t(e){switch(e){case u:return"Any";case c:return"Number";case l:return"Bool";case p:return"Point";case f:return"Distribution";case h:return"ListOfAny";case d:return"ListOfNumber";case m:return"ListOfBool";case g:return"ListOfPoint";case y:return"ListOfDistribution";case v:return"ErrorType";default:throw new Error("Invalid type")}}function r(e){switch(e){case u:return o.t("an unknown object");case c:return o.t("a number");case l:return o.t("a true/false value");case p:return o.t("a point");case f:return o.t("a distribution");case h:return o.t("a list of unknown objects");case d:return o.t("a list of numbers");case m:return o.t("a list of true/false values");case g:return o.t("a list of points");case y:return o.t("a list of distributions");case v:return o.t("an error object");default:throw new Error("Invalid type")}}function n(e){switch(e){case h:return!0;case d:return!0;case m:return!0;case g:return!0;case y:return!0;default:return!1}}function i(e){switch(e){case h:return u;case d:return c;case m:return l;case g:return p;case y:return f;default:return u}}function a(e){switch(e){case u:return h;case c:return d;case l:return m;case p:return g;case f:return y;default:throw new Error("Type "+t(e)+" does not implement listType.")}}function s(e){switch(e){case u:return!0;case c:return!0;case l:return!0;case p:return!0;case f:return!0;default:return!1}}var o=e("lib/worker-i18n"),u=0,c=1,l=2,p=3,f=4,h=5,d=6,m=7,g=8,y=9,v=10;return{Any:u,Number:c,Bool:l,Point:p,Distribution:f,ListOfAny:h,ListOfNumber:d,ListOfBool:m,ListOfPoint:g,ListOfDistribution:y,ErrorType:v,repr:t,prettyPrint:r,isList:n,elementType:i,listType:a,hasListType:s}}),define("math/errormsg",["require","lib/worker-i18n","math/parsenode/error","graphing/label","math/types"],function(e){var t=e("lib/worker-i18n"),r=e("math/parsenode/error"),n=e("graphing/label"),i=e("math/types");return{parseError:function(){return r(t.t("Sorry, I don\'t understand this."))},unrecognizedSymbol:function(e){return e=n.formatSymbol(e),r(t.t("Sorry, I don\'t understand the \'__symbol__\' symbol.",{symbol:e}))},unexpectedInequality:function(){return r(t.t("Cannot use an inequality here."))},unexpectedSymbol:function(e){return e=n.formatSymbol(e),r(t.t("Sorry, I don\'t understand the way that \'__symbol__\' is used here.",{symbol:e}))},addTypeError:function(e){return r(t.t("Cannot add __symbol1__ and __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},subtractTypeError:function(e){return r(t.t("Cannot subtract __symbol2__ from __symbol1__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},multiplyTypeError:function(e){return r(t.t("Cannot multiply __symbol1__ by __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},divideTypeError:function(e){return r(t.t("Cannot divide __symbol1__ by __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},exponentTypeError:function(e){return r(t.t("Cannot raise __symbol1__ to __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},negativeTypeError:function(e){return r(t.t("Cannot negate __symbol__.",{symbol:e[0]})).allowExport()},comparatorTypeError:function(e){return r(t.t("Cannot compare __symbol1__ to __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},andTypeError:function(e){return r(t.t("Cannot apply __symbol__ to __symbol1__ and __symbol2__.",{symbol:"and",symbol1:e[0],symbol2:e[1]})).allowExport()},listTypeError:function(e){return r(t.t("Cannot store __symbol1__ in a list.",{symbol1:e[0]})).allowExport()},pointTypeError:function(e){return r(t.t("Cannot use __symbol1__ and __symbol2__ as the coordinates of __symbol3__.",{symbol1:e[0],symbol2:e[1],symbol3:i.prettyPrint(i.Point)})).allowExport()},indexTypeError:function(e){return r(t.t("Cannot index __symbol1__ with __symbol2__.",{symbol1:e[0],symbol2:e[1]})).allowExport()},functionTypeError:function(e,i){switch(i.length){case 1:return r(t.t("Function \'__fn__\' cannot be applied to __arg__.",{fn:n.formatSymbol(e),arg:i[0]})).allowExport();case 2:return r(t.t("Function \'__fn__\' cannot be applied to __arg1__ and __arg2__.",{fn:n.formatSymbol(e),arg1:i[0],arg2:i[1]})).allowExport();default:return r(t.t("Function \'__fn__\' cannot be applied to these arguments.",{fn:n.formatSymbol(e)})).allowExport()}},sumLowerBoundTypeError:function(e){return r(t.t("Lower bound of a sum cannot be __symbol__.",{symbol:e[0]})).allowExport()},sumUpperBoundTypeError:function(e){return r(t.t("Upper bound of a sum cannot be __symbol__.",{symbol:e[0]})).allowExport()},sumArgumentTypeError:function(e){return r(t.t("Cannot take the sum of __symbol__.",{symbol:e[0]})).allowExport()},productLowerBoundTypeError:function(e){return r(t.t("Lower bound of a product cannot be __symbol__.",{symbol:e[0]})).allowExport()},productUpperBoundTypeError:function(e){return r(t.t("Upper bound of a product cannot be __symbol__.",{symbol:e[0]})).allowExport()},productArgumentTypeError:function(e){return r(t.t("Cannot take the product of __symbol__.",{symbol:e[0]})).allowExport()},integralLowerBoundTypeError:function(e){return r(t.t("Lower bound of an integral cannot be __symbol__.",{symbol:e[0]})).allowExport()},integralUpperBoundTypeError:function(e){return r(t.t("Upper bound of an integral cannot be __symbol__.",{symbol:e[0]})).allowExport()},integralArgumentTypeError:function(e){return r(t.t("Cannot take the integral of __symbol__.",{symbol:e[0]})).allowExport()},derivativeTypeError:function(e){return r(t.t("Cannot take the derivative of __symbol__.",{symbol:e[0]})).allowExport()},derivativeVariableTypeError:function(e,i){return r(t.t("Cannot take derivative with respect to \'__symbol1__\' because it is __symbol2__.",{symbol1:n.formatSymbol(e),symbol2:i[0]}))},piecewiseConditionTypeError:function(e){return r(t.t("The condition in a piecewise expression must be __symbol1__ but was __symbol2__.",{symbol1:i.prettyPrint(i.Bool),symbol2:e[0]})).allowExport()},piecewiseBranchTypeError:function(e){return r(t.t("Cannot use __symbol__ as a branch of a piecewise expression.",{symbol:e[0]})).allowExport()},tableHeaderTypeError:function(e){return r(t.t("Table header cannot be __symbol__.",{symbol:e[0]}))},tableEntryTypeError:function(e){return r(t.t("Table entry cannot be __symbol__.",{symbol:e[0]}))},regressionTypeError:function(e){return r(t.t("Cannot regress __symbol1__ against __symbol2__.",{symbol1:e[0],symbol2:e[1]}))},heterogeneousList:function(){return r(t.t("All elements of a list must have the same type.")).allowExport()},deeplyNested:function(){return r(t.t("Definitions are nested too deeply.")).allowExport()},polygonListTypeError:function(e){return r(t.t("A single argument to polygon should be a point list, not __type__.",{type:e[0]}))},polygonPointArgsError:function(){return r(t.t("Some of your arguments are not points."))},polygonTwoNumbersError:function(){return r(t.t("Cannot make a polygon from two numbers."))},histogramListTypeError:function(e){return r(t.t("The first argument to \'histogram\' should be a number list, not __type__.",{type:e}))},histogramRequiresArguments:function(){return r(t.t("The first argument to \'histogram\' should be a number list."))},histogramTooManyArguments:function(){return r(t.t("\'histogram\' can only take 3 arguments."))},histogramBinWidthTypeError:function(e){return r(t.t("The \'binwidth\' argument to \'histogram\' should be a number, not __type__.",{type:e}))},histogramBinOffsetTypeError:function(e){return r(t.t("The \'binoffset\' argument to \'histogram\' should be a number, not __type__.",{type:e}))},dotplotListTypeError:function(e){return r(t.t("The first argument to \'dotplot\' should be a number list, not __type__.",{type:e}))},dotplotRequiresArguments:function(){return r(t.t("The first argument to \'dotplot\' should be a number list."))},dotplotTooManyArguments:function(){return r(t.t("\'dotplot\' can only take 3 arguments."))},dotplotBinWidthTypeError:function(e){return r(t.t("The \'binwidth\' argument to \'dotplot\' should be a number, not __type__.",{type:e}))},dotplotBinOffsetTypeError:function(e){return r(t.t("The \'binoffset\' argument to \'dotplot\' should be a number, not __type__.",{type:e}))},boxplotListTypeError:function(e){return r(t.t("The first argument to \'boxplot\' should be a number list, not __type__.",{type:e}))},boxplotRequiresArguments:function(){return r(t.t("The first argument to \'boxplot\' should be a number list."))},boxplotTooManyArguments:function(){return r(t.t("\'boxplot\' can only take 3 arguments."))},boxplotOffsetTypeError:function(e){return r(t.t("The \'offset\' argument to \'boxplot\' should be a number, not __type__.",{type:e}))},boxplotHeightTypeError:function(e){return r(t.t("The \'height\' argument to \'boxplot\' should be a number, not __type__.",{type:e}))},wrongArity:function(e,i,a){e=n.formatSymbol(e);var s,o;if(1===i)o=t.t("For example, try typing: __dependency__(x).",{dependency:e}),s=a>1?t.t("Function \'__dependency__\' requires only 1 argument. __supplement__",{dependency:e,supplement:o}):t.t("Function \'__dependency__\' requires an argument. __supplement__",{dependency:e,supplement:o});else{for(var u=[],c=0;c<i;c++)u[c]=c+1;var l=n.formatSymbol(e)+"("+u.join(", ")+")";o=t.t("For example, try typing: __recommendation__.",{recommendation:l}),s=t.t("Function \'__dependency__\' requires __assignment_arity__ arguments. __supplement__",{dependency:e,assignment_arity:i,supplement:o})}return r(s)},wrongParametrizedReducerArity:function(e){return r(t.t("Function \'__symbol__\' requires 2 arguments. For example, try typing: __recommendation__.",{symbol:n.formatSymbol(e),recommendation:n.formatSymbol(e)+"([1,2,3], 1)"}))},wrongDoubleReducerArity:function(e){return r(t.t("Function \'__symbol__\' requires 2 arguments. For example, try typing: __recommendation__.",{symbol:n.formatSymbol(e),recommendation:n.formatSymbol(e)+"([1,2,3], [3,2,1])"}))},primedFunctionArity:function(){return r(t.t("Prime notation can only be used for functions of a single argument."))},zeroArgReducer:function(e){return r(t.t("Function \'__symbol__\' requires at least one argument. For example, try typing: __symbol__(1, 2).",{symbol:n.formatSymbol(e)}))},missingRHS:function(e){return e=n.formatSymbol(e),r(t.t("What do you want \'__symbol__\' to equal?",{symbol:e}))},malformedPoint:function(){return r(t.t("Points are written like this: (1, 2)."))},nonPairTuple:function(){return r(t.t("Points may only have 2 coordinates."))},badImplicitCall:function(e){return e=n.formatSymbol(e),r(t.t("Use parentheses around the argument of \'__symbol__\'.",{symbol:e}))},badImplicitMultiply:function(){return r(t.t("Confusing implicit multiplication. Use parentheses or a \'*\' symbol."))},binaryOperatorMissingOperand:function(e){return r(t.t("You need something on both sides of the \'__symbol__\' symbol.",{symbol:e}))},unaryOperatorMissingLeft:function(e){return r(t.t("You need something before the \'__symbol__\' symbol.",{symbol:e}))},unaryOperatorMissingRight:function(e){return r(t.t("You need something after the \'__symbol__\' symbol.",{symbol:e}))},fractionMissingNumerator:function(){return r(t.t("You need a numerator for the top of your fraction."))},fractionMissingDenominator:function(){return r(t.t("You need a denominator for the bottom of your fraction."))},fractionEmpty:function(){return r(t.t("You need a numerator and denominator for your fraction."))},emptySubscript:function(){return r(t.t("Subscripts cannot be empty."))},emptySuperscript:function(){return r(t.t("Superscripts cannot be empty."))},invalidSubscript:function(e){return e=n.formatSymbol(e),r(t.t("Subscripts may only contain letters and digits. \'__symbol__\' is not allowed.",{symbol:e}))},invalidOperatorName:function(){return r(t.t("Operator names may only contain letters."))},unexpectedSubscript:function(){return r(t.t("Only functions and variables may have subscripts."))},superscriptWithPrime:function(){return r(t.t("Superscripts and primes cannot be combined."))},unexpectedPrime:function(){return r(t.t("Sorry, I don\'t understand this use of prime notation."))},primeWithoutParen:function(){return r(t.t("Primed function calls must use parentheses."))},emptyRadical:function(){return r(t.t("Radical cannot be empty."))},emptyRadicand:function(){return r(t.t("Radicand cannot be empty."))},emptyParen:function(){return r(t.t("Parentheses cannot be empty."))},emptySquareBracket:function(){return r(t.t("Square brackets cannot be empty."))},emptyPipe:function(){return r(t.t("Absolute value symbol cannot be empty."))},badTrigExponent:function(e){var n=e+"^2",i=e+"^-1";return r(t.t("Only __form1__ and __form2__ are supported. Otherwise, use parens.",{form1:n,form2:i}))},badLogExponent:function(e){var n=e+"^2";return r(t.t("Only __form__ is supported. Otherwise, use parens.",{form:n}))},inequalityChainTooLong:function(){return r(t.t("Cannot chain more than 2 inequalities."))},piecewiseMissingCondition:function(){return r(t.t("A piecewise expression must have at least one condition."))},piecewisePartMissingCondition:function(){return r(t.t("Every part of a piecewise expression must have a condition except the last."))},colonMissingCondition:function(){return r(t.t("The left side of a \':\' must be a condition, like \'x>1\'."))},blankExpression:function(){return r(t.t("You haven\'t written anything yet."))},functionNotDefined:function(e){return e=n.formatSymbol(e),r(t.t("Function \'__dependency__\' is not defined.",{dependency:e}))},parameterAlreadyDefined:function(e){return e=n.formatSymbol(e),r(t.t("You can\'t use \'__dependency__\' as a parameter of this function because \'__dependency__\' is already defined.",{dependency:e}))},cannotRedefine:function(e,i){return e=n.formatSymbol(e),r(void 0===i?t.t("You can\'t redefine \'__symbol__\' because it\'s already defined.",{symbol:e}):t.t("You can\'t define \'__symbol__\' because \'__symbolRoot__\' is already defined.",{symbol:e,symbolRoot:i}))},cannotSubscript:function(e){return e=n.formatSymbol(e),r(t.t("\'__symbol__\' cannot have a subscript.",{symbol:e}))},multiplyDefined:function(e){return e=n.formatSymbol(e),r(t.t("You\'ve defined \'__dependency__\' in more than one place. Try deleting some of the definitions of \'__dependency__\'.",{dependency:e}))},shadowedIndex:function(e){return e=n.formatSymbol(e),r(t.t("You can\'t use \'__symbol__\' as an index because it\'s already defined.",{symbol:e}))},cycle:function(e){e=e.map(n.formatSymbol);var i=e.pop();return r(t.t("\'__symbols__\' and \'__lastSymbol__\' can\'t be defined in terms of each other.",{symbols:e.join("\', \'"),lastSymbol:i}))},selfReferentialFunction:function(e){return r(t.t("The definition of function \'__symbol__\' cannot depend on \'__symbol__\'.",{symbol:n.formatSymbol(e)}))},sliderLimitReferencesExport:function(e){return r(t.t("Slider limits cannot depend on the slider variable \'__symbol__\'.",{symbol:n.formatSymbol(e)}))},sliderMinInvalid:function(){return r(t.t("Invalid slider min. Try using any number."))},sliderMaxInvalid:function(){return r(t.t("Invalid slider max. Try using any number."))},sliderMaxLessThanMin:function(){return r(t.t("Invalid slider limits. Min should be less than max."))},sliderStepInvalid:function(){return r(t.t("Invalid slider step. Try using any number."))},domainMinInvalid:function(){return r(t.t("Invalid domain min. Try using any number."))},domainMaxInvalid:function(){return r(t.t("Invalid domain max. Try using any number."))},domainMaxLessThanMin:function(){return r(t.t("Invalid domain limits. Min should be less than max."))},cdfMinInvalid:function(){return r(t.t("Invalid cdf min. Try using any number."))},cdfMaxInvalid:function(){return r(t.t("Invalid cdf max. Try using any number."))},cdfMaxLessThanMin:function(){return r(t.t("Invalid cdf limits. Min should be less than max."));\n},tooManyVariables:function(e){if(e=e.map(n.formatSymbol),0===e.length)return r(t.t("Too many variables, I don\'t know what to do with this."));var i=e.pop();return r(t.t("Too many variables. Try defining \'__variables__\'.",{variables:(e.length?e.join("\', \'")+"\' or \'":"")+i}))},addArgumentsToDefinition:function(e,i,a){e=e.map(n.formatSymbol),i=n.formatSymbol(i),a=a.map(n.formatSymbol);var s=i+"("+a.join(",")+","+e.join(",")+")",o=e.pop(),u={symbols:e.join("\', \'"),lastSymbol:o,newSignature:s};return r(e.length?t.t("Try including \'__symbols__\' and \'__lastSymbol__\' as arguments by defining the function as \'__newSignature__\'.",u):t.t("Try including \'__lastSymbol__\' as an argument by defining the function as \'__newSignature__\'.",u))},invalidLHS:function(e){return e=n.formatSymbol(e),r(t.t("Sorry, you can\'t graph __symbol__ as a function of anything yet.",{symbol:e}))},unplottablePolarFunction:function(){return r(t.t("We can\'t plot  as a function of r. Try plotting r() instead."))},invalidInequalityVariables:function(){return r(t.t("We only plot inequalities of x and y, or r and ."))},invalidImplicitVariables:function(){return r(t.t("We only support implicit equations of x and y."))},singleVariableImplicitEquationsDisabled:function(){return r(t.t("Plotting single-variable implicit equations is disabled."))},complicatedImplicitInequality:function(){return r(t.t("We can only plot inequalities when one variable is quadratic or linear."))},complicatedPolarImplicit:function(){return r(t.t("Polar equations must be linear in r."))},invalidDoubleInequalityVariables:function(){return r(t.t("We only plot double inequalities of x and y."))},mismatchedDoubleInequality:function(){return r(t.t("Double inequalities must both go the same way, e.g. 1 < y < 2."))},complicatedDoubleInequality:function(){return r(t.t("We only support solved double inequalities. Try deleting one side of the inequality."))},equationRequired:function(e){return e?(e=n.formatSymbol(e),r(t.t("Try adding \'__lhs__\' to the beginning of this equation.",{lhs:e+"="}))):r(t.t("Try adding an equals sign to turn this into an equation."))},variableAsFunction:function(e){return e=n.formatSymbol(e),r(t.t("Variable \'__dependency__\' can\'t be used as a function.",{dependency:e}))},emptyList:function(){return r(t.t("Empty lists are not allowed."))},invalidTableHeader:function(e){return r(t.t("Table headers must be simple expressions. __supplement__",{supplement:e}))},invalidTableEntry:function(e){return r(t.t("Table entries must be simple expressions. __supplement__",{supplement:e}))},invalidFirstTableColumn:function(){return r(t.t("First column may not be __most__ or __last__.",{most:"\'y\', \'r\',",last:"\'\'"}))},invalidDependentFirstTableColumn:function(){return r(t.t("This column header can\'t be defined elsewhere in the calculator."))},invalidRegressionParameter:function(e){return r(t.t("\'__symbol__\' may not be used as a regression parameter.",{symbol:n.formatSymbol(e)}))},optimizationError:function(){return r(t.t("We couldn\'t find any region where this model is defined."))},badListInReducer:function(e){return r(t.t("When __symbol__ is called with more than two arguments, no argument can be a list.",{symbol:n.formatSymbol(e)})).allowExport()},nonListDoubleReducer:function(e){return r(t.t("Both arguments of \'__symbol__\' must be lists. For example, try typing: __recommendation__.",{symbol:n.formatSymbol(e),recommendation:n.formatSymbol(e)+"([1,2,3], [3,2,1])"})).allowExport()},nonListParametrizedReducer:function(e){return r(t.t("The first argument of \'__symbol__\' must be a list. For example, try typing: __recommendation__.",{symbol:n.formatSymbol(e),recommendation:n.formatSymbol(e)+"([1,2,3], 1)"})).allowExport()},variableRange:function(e){return r(t.t("Range cannot depend on free variable \'__symbol__\'.",{symbol:n.formatSymbol(e[0])})).allowExport()},nonArithmeticRange:function(e){return r(t.t("Ranges must be arithmetic sequences.")).allowExport()},sumMissingBound:function(){return r(t.t("Sums must have upper and lower bounds."))},productMissingBound:function(){return r(t.t("Products must have upper and lower bounds."))},incorrectSumLowerBound:function(){return r(t.t("Lower bound of a sum must set a variable equal to a number. Try n=1."))},incorrectProductLowerBound:function(){return r(t.t("Lower bound of a product must set a variable equal to a number. Try n=1."))},integralMissingBound:function(){return r(t.t("Integrals must have upper and lower bounds."))},integralMissingDifferential:function(){return r(t.t("Integrand must end with an integration variable, like dx."))},differentialWithSuperscript:function(){return r(t.t("Integration variable cannot have a superscript."))},sumMissingBody:function(){return r(t.t("What do you want to take the sum of?"))},productMissingBody:function(){return r(t.t("What do you want to take the product of?"))},integralMissingBody:function(){return r(t.t("What do you want to take the integral of?"))},derivativeMissingBody:function(){return r(t.t("What do you want to take the derivative of?"))},mismatchedBraces:function(e,i){return e=n.formatSymbol(e),i=n.formatSymbol(i),r(t.t("Expected \'__symbol1__\' to match \'__symbol2__\'.",{symbol1:e,symbol2:i}))},shadowedIntegrationVariable:function(e){return r(t.t("You can\'t use \'__symbol__\' as an integration variable because it\'s already defined.",{symbol:n.formatSymbol(e)}))},badIntegralBoundDependency:function(e){return r(t.t("Integration bounds can\'t depend on integration variable \'__symbol__\'.",{symbol:n.formatSymbol(e)}))},percentMissingOf:function(){return r(t.t("\'%\' must be used with \'of\'. Try \'25% of 12\'."))},badAnsContext:function(){return r(t.t("You can\'t use \'ans\' in this context."))},ansUndefined:function(){return r(t.t("The previous expression didn\'t define any value for ans."))},variablesUnsupported:function(e){return r(t.t("This calculator does not support variables like \'__variable__\'.",{variable:n.formatSymbol(e)}))},functionUnsupported:function(e){return r(t.t("This calculator does not support the \'__symbol__\' function.",{symbol:n.formatSymbol(e)}))},constantUnsupported:function(e){return r(t.t("This calculator does not support the constant \'__symbol__\'.",{symbol:n.formatSymbol(e)}))},assignmentsUnsupported:function(){return r(t.t("This calculator does not support defining variables."))},functionDefinitionsUnsupported:function(){return r(t.t("This calculator does not support function definitions."))},equationsUnsupported:function(){return r(t.t("This calculator does not support this type of equation."))},inequalitiesUnsupported:function(){return r(t.t("This calculator does not support inequalities."))},regressionsUnsupported:function(){return r(t.t("This calculator does not support regressions."))},pointsUnsupported:function(){return r(t.t("This calculator does not support points."))},featureUnavailable:function(){return r(t.t("This feature is not available in the current calculator."))},nonSquareDeterminant:function(){return r(t.t("Only square matrices have a determinant."))},nonSquareInverse:function(){return r(t.t("Only square matrices have an inverse."))},singularInverse:function(){return r(t.t("Singular matrices do not have an inverse."))},matrixAssignment:function(){return r(t.t("This calculator does not support this type of variable definition. Try using \'New Matrix\'."))},matrixAddDimensions:function(){return r(t.t("Cannot add matrices with different dimensions."))},matrixSubtractDimensions:function(){return r(t.t("Cannot subtract matrices with different dimensions."))},matrixMultiplyDimensions:function(){return r(t.t("Cannot multiply matrices with incompatible dimensions."))},matrixFractionalPower:function(){return r(t.t("A matrix can only be raised to integer powers."))},matrixPowerDimensions:function(){return r(t.t("Only square matrices can be raised to a power."))},matrixElementTypeError:function(e){return r(t.t("Cannot use __arg__ as an element of a matrix.",{arg:e[0]}))},matrixInvalidVariable:function(e){return r(t.t("Cannot use \'__symbol__\' as a variable.",{symbol:n.formatSymbol(e)}))}}}),define("math/parsenode/expression",["require","pjs","./base","math/errormsg","math/types"],function(e){var t=e("pjs"),r=e("./base"),n=e("math/errormsg"),i=e("math/types");return t(r,function(e,t){e.init=function(e){if(!Array.isArray(e))throw new TypeError("Argument to expression constructor must be an Array.");t.init.call(this),this.args=e,this.valueType=this._getValueType(e),this.registerDependencies(),this.computeTreeSize()},e._getValueType=function(e){return i.Any},e.shouldExportAns=function(){return!0},e.registerDependencies=function(){for(var e=0;e<this.args.length;e++)this.mergeDependencies(this.args[e])},e.computeTreeSize=function(){for(var e=0,t=0;t<this.args.length;t++)this.args[t].treeSize&&(e+=this.args[t].treeSize);if(this.treeSize=e+1,e>1e4)throw n.deeplyNested()},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/scalarexpression",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();e=e.concat(n.statements),t.push(n.expression)}return{statements:e,expression:this.scalarEvalExpression(t)}}})}),define("math/parsenode/expressionTypes",["require","pjs","./scalarexpression"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n={Add:t(r,{}),Subtract:t(r,{}),Multiply:t(r,{}),Divide:t(r,{}),Exponent:t(r,{}),Negative:t(r,{}),And:t(r,{isInequality:function(){return this.args[0].isInequality()&&this.args[1].isInequality()}}),PercentOf:t(r,{})};return n.RawExponent=t(n.Exponent,{}),n}),define("math/maybe-rational",["require","exports","math/builtin"],function(e,t,r){"use strict";function n(e,t){return{n:e,d:t}}function i(e){return"object"==typeof e&&"number"==typeof e.n&&"number"==typeof e.d}function a(e){var t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;var r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;var a=!!r;if(i){var s=i.replace(/0+$/,""),u=s.length,c=Math.pow(10,u),l=parseInt(n||"0",10)*c+parseInt(s||"0",10);return l>_||c>_?parseFloat(e):o(a?-l:l,c)}var l=parseInt(n,10);return l>_?parseFloat(e):o(a?-l:l,1)}function s(e){return i(e)?e.n/e.d:e}function o(e,t){if(!isFinite(e)||!isFinite(t)||0===t||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>_||Math.abs(t)>_)return e/t;t<0&&(e=-e,t=-t);var i=r.gcd(e,t);return n(e/i,t/i)}function u(e){return i(e)?n(-e.n,e.d):-e}function c(e){return i(e)?n(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function l(e){return i(e)?0===e.n?e.d/e.n:n(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function p(e,t){if(!i(e)||!i(t))return s(e)+s(t);var n=r.gcd(e.d,t.d);return o(e.n*(t.d/n)+t.n*(e.d/n),e.d/n*t.d)}function f(e,t){if(!i(e)||!i(t))return s(e)*s(t);var n=r.gcd(e.n,t.d),a=r.gcd(t.n,e.d);return o(e.n/n*(t.n/a),e.d/a*(t.d/n))}function h(e,t){return p(e,u(t))}function d(e,t){return i(e)&&i(t)?f(e,l(t)):s(e)/s(t)}function m(e,t){var n=e,a=t;if(t.n<0&&(a=u(t),n=l(e)),!i(n)||!i(a))return r.pow(s(e),s(t));if(e=n,t=a,1===t.d)return o(Math.pow(e.n,t.n),Math.pow(e.d,t.n));var c=e.n<0;if(c&&t.d%2!==1)return NaN;var p=c?-1:1,f=p*Math.round(Math.pow(Math.abs(e.n),1/t.d)),h=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(f,t.d)!==e.n||Math.pow(h,t.d)!==e.d?r.pow(s(e),s(t)):o(Math.pow(f,t.n),Math.pow(h,t.n))}function g(e,t){if(!i(e)||!i(t))return r.pow(s(e),s(t));var n=m(e,t);return i(n)?n:r.pow(s(e),s(t))}function y(e){if(!i(e))return Math.sqrt(e);var t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(s(e)):o(t,r)}function v(e,t){return g(e,l(t))}function b(e,t){if(!i(e)||!i(t)){var r=s(e),a=s(t);return r-a*Math.floor(r/a)}return h(e,f(t,n(Math.floor(s(d(e,t))),1)))}function x(e){for(var t=n(0,1),r=0,i=e;r<i.length;r++){var a=i[r];t=p(t,a)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.isRational=i;var _=Math.pow(2,53)-1;t.fromDecimalString=a,t.asFloat=s,t.maybeRational=o,t.neg=u,t.abs=c,t.reciprocal=l,t.add=p,t.mul=f,t.sub=h,t.div=d,t.pow=g,t.sqrt=y,t.nthroot=v,t.mod=b,t.total=x}),define("math/parsenode/constant",["require","pjs","./scalarexpression","math/maybe-rational"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("math/maybe-rational");return t(r,function(e,t){e.init=function(e){"number"==typeof e&&(e=n.maybeRational(e,1)),this._constantValue=e,t.init.call(this,[])},e.isConstant=!0,e.getEvalStrings=function(){return{statements:[],expression:this.scalarExprString()}},e.asValue=function(){return"boolean"==typeof this._constantValue?this._constantValue:n.asFloat(this._constantValue)},e.asMaybeRationalValue=function(){return"boolean"==typeof this._constantValue?NaN:this._constantValue},e.scalarExprString=function(){return this.asValue()>0?String(this.asValue()):"("+String(this.asValue())+")"},e.getEvaluationInfo=function(){return[{val:this.asValue()}]},e.isNaN=function(){return"number"==typeof this.asValue()&&isNaN(this.asValue())}})}),define("math/parsenode/mixednumber",["require","pjs","./constant"],function(e){var t=e("pjs"),r=e("./constant");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.is_mixed_number=!0})}),define("math/parsenode/identifier",["require","pjs","./expression","graphing/label","math/parser/input-span"],function(e){var t=e("pjs"),r=e("./expression"),n=e("graphing/label"),i=e("math/parser/input-span");return t(r,function(e,t,r){e.init=function(e){t.init.call(this,[]),this._symbol=n.latexToIdentifier(e),this.setInputSpan(new i.Span(e,0,e.length)),this.addDependency(this._symbol)},e.evaluate=function(){throw"Cannot evaluate undefined variable "+this._symbol}})}),define("math/parsenode/ans",["require","pjs","./identifier"],function(e){var t=e("pjs"),r=e("./identifier");return t(r,function(e,t,r){})}),define("math/parsenode/freevariable",["require","pjs","./scalarexpression"],function(e){var t=e("pjs"),r=e("./scalarexpression");return t(r,function(e,t){e.init=function(e){t.init.call(this,[]),this.addDependency(e),this._symbol=e},e.isFreeVariable=!0,e.scalarEvalExpression=function(e){return this._symbol},e.copyWithArgs=function(e){return this}})}),define("math/parsenode/dummyindex",["require","pjs","./freevariable"],function(e){var t=e("pjs"),r=e("./freevariable");return t(r,function(){})}),define("math/parsenode/list",["require","pjs","./expression","math/errormsg","math/types"],function(e){var t=e("pjs"),r=e("./expression"),n=e("math/errormsg"),i=e("math/types");return t(r,function(e,t,r){function a(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}e.init=function(e){if(t.init.call(this,e),this.length=e.length,0===this.length)throw n.emptyList()},e.isList=!0,e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();Array.prototype.push.apply(e,n.statements),t.push(n.expression)}return{statements:e,expression:"["+t.join(",")+"]"}},e.asValue=function(){for(var e=[],t=0;t<this.args.length;t++)e.push(this.args[t].asValue());return e},e.asMaybeRationalValue=function(){for(var e=[],t=0;t<this.args.length;t++)e.push(this.args[t].asMaybeRationalValue());return e},e.getEvaluationInfo=function(){if(this.args.every(function(e){return e.isConstant}))return[{val:this.args.map(function(e){return e.asValue()})}]},r.eachArgs=function(e,t){var r=a(e);if(!isFinite(r))return void t(e);for(var n=0;n<r;n++){for(var s=[],o=0;o<e.length;o++)s.push(e[o].isList||i.isList(e[o].valueType)?e[o].elementAt(n):e[o]);t(s)}},r.mapArgs=function(e,t){var n=[];return r.eachArgs(e,function(e){n.push(t(e))}),n},r.wrap=function(e){return e.isList||i.isList(e.valueType)?e:r([e])}})}),define("math/parsenode/range",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t,r){e.init=function(e){t.init.call(this,e),this.beginning=e[0],this.end=e[1]}})}),define("math/parsenode/broadcast",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t,r){e.init=function(e,r){if(t.init.call(this,r),this._replacedSymbols=e,this._expression=r[0],this._lists=r.slice(1),!e.length)throw new Error("Cannot construct a broadcast node with no replaced symbols");for(var n=0;n<e.length;n++)this.removeDependency(e[n]);for(var i=1/0,a=0;a<this._lists.length;a++){if(!this._lists[a].isList)throw new Error("List arguments of broadcast must be list literals");i=Math.min(i,this._lists[a].length)}this.length=i},e.isBroadcast=!0,e.copyWithArgs=function(e){return new this.constructor(this._replacedSymbols,e)},e.evaluate=function(e){for(var t=this._expression.getCompiledFunction(this._replacedSymbols).fn,r=[],n=0;n<this.length;n++){for(var i=[],a=0;a<e.length;a++)i.push(e[a][n]);r.push(t.apply(void 0,i))}return r},e.getEvalStrings=function(){var e=[],t=this._expression.getEvalStrings();Array.prototype.push.apply(e,t.statements);var r,n=[],i=[];for(r=0;r<this._lists.length;r++){var a=this._lists[r].getEvalStrings();Array.prototype.push.apply(e,a.statements);var s=this.tmpVar();i.push(s),n.push("var "+s+" = "+a.expression)}var o=this.tmpVar(),u=this.tmpVar();n.push("var "+o+" = []");var c=[];for(r=0;r<i.length;r++)c.push("var "+this._replacedSymbols[r]+" = "+i[r]+"["+u+"]");return n.push("for (var "+u+" = 0; "+u+" < "+this.length+"; "+u+"++) {\\n  "+c.join(";\\n  ")+";\\n  "+o+".push("+t.expression+");\\n}"),{statements:e.concat(n),expression:o}}})}),define("math/parsenode/listaccess",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this.list=e[0],this.index=e[1]},e.getEvalStrings=function(){var e=this.index.getEvalStrings(),t=this.list.getEvalStrings(),r=e.statements.concat(t.statements),n=this.tmpVar();r.push(n+" = "+t.expression);var i=this.tmpVar();return r.push(i+" = Math.floor("+e.expression+") - 1"),{statements:r,expression:"("+i+" >= 0 && "+i+" < "+n+".length ? "+n+"["+i+"] : NaN)"}}})}),define("math/parsenode/orderedpair",["require","pjs","./scalarexpression"],function(e){var t=e("pjs"),r=e("./scalarexpression");return t(r,function(e,t,r){e.asArray=function(){return[+this.args[0].asValue(),+this.args[1].asValue()]},e.asValue=e.asArray,e.getSliderVariables=function(e,t){return e.sliderVariables(t.getDependencies()).filter(function(t){return!e.validParametricVariable(t)})},e.getEvalStrings=function(){for(var e=[],t=[],r=0;r<this.args.length;r++){var n=this.args[r].getEvalStrings();e=e.concat(n.statements),t.push(n.expression)}return{statements:e,expression:"["+t.join(",")+"]"}}})}),define("math/parsenode/movablepoint",["require","pjs","./orderedpair"],function(e){var t=e("pjs"),r=e("./orderedpair");return t(r,function(e,t){e.init=function(e,r,n){t.init.call(this,e),this.moveStrategy=r,this.defaultDragMode=n},e.isMovablePoint=!0})}),define("math/parsenode/orderedpairaccess",["require","pjs","./scalarexpression"],function(e){var t=e("pjs"),r=e("./scalarexpression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this.point=e[0],this.index=e[1]},e.getEvalStrings=function(){var e=this.index.getEvalStrings(),t=this.point.getEvalStrings(),r=[];Array.prototype.push.apply(r,e.statements),Array.prototype.push.apply(r,t.statements);var n=t.expression+"["+e.expression+"-1]";return{statements:r,expression:n}}})}),define("math/parsenode/polygon",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/comparators",["require","exports"],function(e,t){"use strict";function r(e,t){switch(t){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}Object.defineProperty(t,"__esModule",{value:!0}),t.table={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}},t.get=r}),define("math/parsenode/basecomparator",["require","pjs","./scalarexpression","./expressionTypes","math/comparators","math/functions"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./expressionTypes").Subtract,i=e("math/comparators").table,a=e("math/functions");return t(r,function(e,r,s){s.create=function(e,r){return r=r||e,t(s,function(t,n){t.operator=e,t.isInequality=function(){return 0!==i[e].direction},t.compiledOperator=r,t.scalarEvalExpression=function(e){return e.join(r)},t.evaluate=a.createEvaluateFunction(t.scalarEvalExpression,2)})},e.init=function(e){r.init.call(this,e),this._difference=n(i[this.operator].direction===-1?[e[1],e[0]]:[e[0],e[1]])}})}),define("math/parsenode/comparator",["require","math/parsenode/basecomparator"],function(e){var t=e("math/parsenode/basecomparator");return{"<":t.create("<"),">":t.create(">"),"<=":t.create("<="),">=":t.create(">="),"=":t.create("=","===")}}),define("math/parsenode/doubleinequality",["require","pjs","./base","math/comparators","./comparator"],function(e){var t=e("pjs"),r=e("./base"),n=e("math/comparators"),i=e("./comparator");return t(r,function(e,t){e.init=function(e){t.init.call(this),this.args=e,this._symbol=e[2]._symbol,this._operators=[e[1],e[3]],this._expressions=[e[0],e[4]];var r=n.get(n.table[e[1]].inclusive&&n.table[e[3]].inclusive,n.table[e[1]].direction);this._indicator=i[r]([e[0],e[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])},e.isInequality=function(){return!0},e.isShadeBetween=function(){return!0}})}),define("math/parsenode/repeatedoperator",["require","pjs","./scalarexpression","./dummyindex"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./dummyindex");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this._index=e[0],this.addDummyDependency(this._index._symbol),this._index instanceof n&&this.removeDependency(this._index._symbol)},e.getEvalStrings=function(){var e=[],t=this.tmpVar(),r=this._index._symbol,n=this.tmpVar(),i=this.tmpVar(),a=this.args[1].getEvalStrings(),s=this.args[2].getEvalStrings(),o=this.args[3].getEvalStrings();Array.prototype.push.apply(e,a.statements),e.push("var "+n+" = Math.round("+a.expression+")"),Array.prototype.push.apply(e,s.statements),e.push("var "+i+" = Math.round("+s.expression+")"),e.push("var "+t+"="+this.starting_value);var u="for (var "+r+"="+n+";"+r+"<="+i+";"+r+"++) {"+o.statements.join(";")+";"+t+this.in_place_operator+o.expression+"};",c="if(!isFinite("+i+"-"+n+")) {"+t+"=("+i+"<"+n+"?"+this.starting_value+":NaN);}else{"+u+"}";return e.push(c),{statements:e,expression:t}},e.evaluate=function(e,t,r){var n=r.getCompiledFunction([this._index._symbol]).fn;if(t=Math.round(t),e=Math.round(e),!isFinite(t-e))return t<e?this.starting_value:NaN;for(var i=this.starting_value,a=e;a<=t;a++)i=this.update(i,n(a));return i}})}),define("math/parsenode/sum",["require","pjs","./repeatedoperator"],function(e){var t=e("pjs"),r=e("./repeatedoperator");return t(r,function(e,t){e.in_place_operator="+=",e.starting_value=0,e.evaluateConstant=function(e){var t=1+Math.round(e[1])-Math.round(e[0]);return t<=0?this.starting_value:t*e[2]},e.update=function(e,t){return e+t}})}),define("math/parsenode/product",["require","pjs","./repeatedoperator"],function(e){var t=e("pjs"),r=e("./repeatedoperator");return t(r,function(e,t){e.in_place_operator="*=",e.starting_value=1,e.evaluateConstant=function(e){var t=1+Math.round(e[1])-Math.round(e[0]);return t<=0?this.starting_value:Math.pow(e[2],t)},e.update=function(e,t){return e*t}})}),define("math/parsenode/integral",["require","pjs","./scalarexpression","./dummyindex","math/builtin"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./dummyindex"),i=e("math/builtin");return t(r,function(e,t){e.init=function(e){t.init.call(this,e),this._differential=e[0],this.addDummyDependency(this._differential._symbol),this._differential instanceof n&&this.removeDependency(this._differential._symbol)},e.getEvalStrings=function(){var e=this.args[0],t=this.args[1],r=this.args[2],n=this.args[3],i=[],a=this.tmpVar(),s=e._symbol,o=this.tmpVar(),u=this.tmpVar(),c=t.getEvalStrings(),l=r.getEvalStrings(),p=n.getEvalStrings();Array.prototype.push.apply(i,c.statements),Array.prototype.push.apply(i,l.statements),i.push("var "+o+" = "+c.expression),i.push("var "+u+" = "+l.expression),i.push("var "+a+" = function ("+s+") { "+p.statements.join("; ")+"; return "+p.expression+";}");var f="BuiltIn.quad("+[a,o,u].join(", ")+")";return{statements:i,expression:f}},e.evaluate=function(e,t,r){var n=this.args[0],a=r.getCompiledFunction([n._symbol]).fn;return i.quad(a,e,t)}})}),define("math/parsenode/functioncall",["require","pjs","./expression","./identifier"],function(e){var t=e("pjs"),r=e("./expression"),n=e("./identifier");return t(r,function(e,t){e.init=function(e,r){"string"==typeof e&&(e=n(e)),this._identifier=e,this._symbol=e._symbol,t.init.call(this,r),this.addDependency(this._symbol)},e.copyWithArgs=function(e){return new this.constructor(n(this._symbol),e)}})}),define("math/parsenode/functionexponent",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){})}),define("math/parsenode/functionfactorial",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){})}),define("math/parsenode/prime",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e,r){t.init.call(this,r),this.order=e},e.copyWithArgs=function(e){return new this.constructor(this.order,e)}})}),define("math/parsenode/piecewise",["require","pjs","./scalarexpression","./constant","math/maybe-rational"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./constant"),i=e("math/maybe-rational").maybeRational,a=t(r,{});return a.chain=function(e){for(var t,r=n(NaN);e.length;)t=e.pop(),r=a([t.condition,t.if_expr,r]);return r},a.empty=function(){return a([n(!0),n(i(1,1)),n(NaN)])},a}),define("math/parsenode/derivative",["require","pjs","./scalarexpression","./identifier"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("./identifier");return t(r,function(e,t){e.init=function(e,r){e instanceof n?this._symbol=e._symbol:this._symbol=n(e)._symbol,t.init.call(this,r)}})}),define("math/parsenode/nativefunction",["require","pjs","./scalarexpression","math/errormsg","math/functions"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("math/errormsg"),i=e("math/functions");return t(r,function(e,r,a){e.init=function(e){var t=e.length,i="logbase"===this._symbol?"log":this._symbol,a="logbase"===this._symbol?1:0;if(t<this._requiredArity)throw n.wrongArity(i,this._requiredArity-a,t-a);if(t>this._maxArity)throw n.wrongArity(i,this._maxArity-a,t-a);for(;e.length<this._maxArity;)e.push(this._optionalArguments[t-this._requiredArity]);r.init.call(this,e)},e.scalarEvalExpression=function(e){return this.head+"("+e.join(",")+")"},a.create=function(e,r,n,a){return t(this,function(t,s,o){o.isFunction=!0,t._symbol=e,t.head=r,t._requiredArity=n,t._optionalArguments=a||[],t._maxArity=t._requiredArity+t._optionalArguments.length,t.evaluate=i.createEvaluateFunction(t.scalarEvalExpression.bind(t),t._maxArity),o.getConcreteInvocationTree=function(e,t,r){return o(t).getConcreteTree(e,r)},o.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/typedfunction",["require","pjs","./nativefunction"],function(e){var t=e("pjs"),r=e("./nativefunction");return t(r,function(e,t,r,n){r.create=function(e,t,r,i){var a=r.length,s=n.create.call(this,e,t,a);return s.prototype._inputTypes=r,s.prototype._outputType=i,s}})}),define("math/parsenode/trigfunction",["require","pjs","./nativefunction","./expressionTypes","math/errormsg"],function(e){var t=e("pjs"),r=e("./nativefunction"),n=e("./expressionTypes").Multiply,i=e("math/errormsg");return t(r,function(e,t,r,a){r.create=function(e,t){var r=1,s=a.create(e,t,r);return s.getConcreteInvocationTree=function(t,a,o){if(a.length<r)throw i.wrongArity(e,r,a.length);var u=t.trigAngleMultiplier?[n([a[0],t.trigAngleMultiplier])].concat(a.slice(1)):a;return s(u).getConcreteTree(t,o)},s.getCacheKeys=function(){return["trigAngleMultiplier"]},s}})}),define("math/parsenode/inversetrigfunction",["require","pjs","./nativefunction","./expressionTypes"],function(e){var t=e("pjs"),r=e("./nativefunction"),n=e("./expressionTypes").Divide;return t(r,function(e,t,r,i){r.create=function(e,t,r){var a=1,s=i.create(e,t,a,r);return s.getConcreteInvocationTree=function(e,t,r){var i=s(t),a=e.trigAngleMultiplier?n([i,e.trigAngleMultiplier]):i;return a.getConcreteTree(e,r)},s.getCacheKeys=function(){return["trigAngleMultiplier"]},s}})}),define("math/parsenode/reducerfunction",["require","pjs","./expression","math/functions"],function(e){var t=e("pjs"),r=e("./expression"),n=e("math/functions");return t(r,function(e,r,i){e.evalExpression=function(e){return this.head+"("+e+")"},e.getEvalStrings=function(){var e=this.args[0].getEvalStrings();return{statements:e.statements,expression:this.evalExpression(e.expression)}},i.create=function(e,r){return t(i,function(t,i,a){t._symbol=e,t.head=r,t._arity=1,a.isFunction=!0,t.evaluate=n.createEvaluateFunction(t.evalExpression.bind(t),t._arity),a.getConcreteInvocationTree=function(e,t,r){return a(t).getConcreteTree(e,r)},a.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/doublereducerfunction",["require","pjs","./expression","math/functions","math/errormsg"],function(e){var t=e("pjs"),r=e("./expression"),n=e("math/functions"),i=e("math/errormsg");return t(r,function(e,r,a){e.init=function(){if(r.init.apply(this,arguments),2!==this.args.length)throw i.wrongDoubleReducerArity(this._symbol)},e.evalExpression=function(e){return this.head+"("+e.join(",")+")"},e.getEvalStrings=function(){for(var e=[],t=[],r=Math.min(this.args[0].length,this.args[1].length),n=0;n<this.args.length;n++){var i=this.args[n],a=i.getEvalStrings();Array.prototype.push.apply(e,a.statements),t.push(i.length===r?a.expression:a.expression+".slice(0,"+r+")")}return{statements:e,expression:this.evalExpression(t)}},a.create=function(e,r){return t(a,function(t,i,a){t._symbol=e,t.head=r,t._arity=2,a.isFunction=!0,t.evaluate=n.createEvaluateFunction(t.evalExpression.bind(t),t._arity),a.getConcreteInvocationTree=function(e,t,r){return a(t).getConcreteTree(e,r)},a.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/parametrizedreducerfunction",["require","pjs","./expression","math/functions","math/errormsg"],function(e){var t=e("pjs"),r=e("./expression"),n=e("math/functions"),i=e("math/errormsg");return t(r,function(e,r,a){e.init=function(){if(r.init.apply(this,arguments),2!==this.args.length)throw i.wrongParametrizedReducerArity(this._symbol)},e.evalExpression=function(e){return this.head+"("+e.join(",")+")"},e.getEvalStrings=function(){var e=[],t=this.args[0].getEvalStrings(),r=this.args[1].getEvalStrings();Array.prototype.push.apply(e,t.statements),Array.prototype.push.apply(e,r.statements);var n=this.evalExpression([t.expression,r.expression]);return{statements:e,expression:n}},a.create=function(e,r){return t(a,function(t,i,a){t._symbol=e,t.head=r,t._arity=2,a.isFunction=!0,t.evaluate=n.createEvaluateFunction(t.evalExpression.bind(t),t._arity),a.getConcreteInvocationTree=function(e,t,r){return a(t).getConcreteTree(e,r)},a.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/distribution",["require","pjs","./scalarexpression","math/errormsg"],function(e){var t=e("pjs"),r=e("./scalarexpression"),n=e("math/errormsg");return t(r,function(e,r,i){e.init=function(e){if(e.length<this._requiredArity)throw n.wrongArity(this._symbol,this._requiredArity,e.length);if(e.length>this._maxArity)throw n.wrongArity(this._symbol,this._maxArity,e.length);for(;e.length<this._maxArity;)e.push(this._optionalArguments[e.length-this._requiredArity]);\nr.init.call(this,e)},e.scalarEvalExpression=function(e){return this.head+"("+e.join(",")+")"},i.create=function(e,r,n){return t(this,function(t,i,a){a.isFunction=!0,t._symbol=e,t._requiredArity=r,t._optionalArguments=n||[],t._maxArity=t._requiredArity+t._optionalArguments.length,a.getConcreteInvocationTree=function(e,t,r){return a(t)},a.getCacheKeys=function(){return[]}})}})}),define("math/parsenode/toplevelfunction",["require","pjs","./nativefunction","math/errormsg"],function(e){var t=e("pjs"),r=e("./nativefunction"),n=e("math/errormsg");return t(r,function(e,r,i,a){i.create=function(e){return t(i,function(t,r,i){i.isFunction=!0,i.getConcreteInvocationTree=function(t,r,i){throw n.unexpectedSymbol(e)}})}})}),define("math/parsenode/builtinfunction",["require","math/parsenode/nativefunction","math/parsenode/typedfunction","math/parsenode/trigfunction","math/parsenode/inversetrigfunction","math/parsenode/reducerfunction","math/parsenode/doublereducerfunction","math/parsenode/parametrizedreducerfunction","math/parsenode/distribution","math/parsenode/toplevelfunction","math/types","math/maybe-rational","math/parsenode/constant","math/parsenode/identifier"],function(e){var t=e("math/parsenode/nativefunction"),r=e("math/parsenode/typedfunction"),n=e("math/parsenode/trigfunction"),i=e("math/parsenode/inversetrigfunction"),a=e("math/parsenode/reducerfunction"),s=e("math/parsenode/doublereducerfunction"),o=e("math/parsenode/parametrizedreducerfunction"),u=e("math/parsenode/distribution"),c=e("math/parsenode/toplevelfunction"),l=e("math/types"),p=e("math/maybe-rational").maybeRational,f=e("math/parsenode/constant"),h=e("math/parsenode/identifier"),d=f(p(1,1)),m=f(p(0,1)),g=f(p(1,2)),y=f(-(1/0)),v={sin:n.create("sin","BuiltIn.sin"),cos:n.create("cos","BuiltIn.cos"),tan:n.create("tan","BuiltIn.tan"),cot:n.create("cot","BuiltIn.cot"),sec:n.create("sec","BuiltIn.sec"),csc:n.create("csc","BuiltIn.csc"),arcsin:i.create("arcsin","Math.asin"),arccos:i.create("arccos","Math.acos"),arctan:i.create("arctan","Math.atan2",[d]),arccot:i.create("arccot","BuiltIn.acot"),arcsec:i.create("arcsec","BuiltIn.asec"),arccsc:i.create("arccsc","BuiltIn.acsc"),sinh:t.create("sinh","BuiltIn.sinh",1),cosh:t.create("cosh","BuiltIn.cosh",1),tanh:t.create("tanh","BuiltIn.tanh",1),coth:t.create("coth","BuiltIn.coth",1),sech:t.create("sech","BuiltIn.sech",1),csch:t.create("csch","BuiltIn.csch",1),arcsinh:t.create("arcsinh","BuiltIn.asinh",1),arccosh:t.create("arccosh","BuiltIn.acosh",1),arctanh:t.create("arctanh","BuiltIn.atanh",1),arccoth:t.create("arccoth","BuiltIn.acoth",1),arcsech:t.create("arcsech","BuiltIn.asech",1),arccsch:t.create("arccsch","BuiltIn.acsch",1),sqrt:t.create("sqrt","Math.sqrt",1),rtxsqpone:t.create("rtxsqpone","BuiltIn.sqrtxsqp1",1),rtxsqmone:t.create("rtxsqmone","BuiltIn.sqrtxsqm1",1),nthroot:t.create("nthroot","BuiltIn.nthroot",2),log:t.create("log","BuiltIn.common_log",1),logbase:t.create("logbase","BuiltIn.log_base",2),ln:t.create("ln","BuiltIn.log",1),exp:t.create("exp","Math.exp",1),floor:t.create("floor","Math.floor",1),ceil:t.create("ceil","Math.ceil",1),round:t.create("round","BuiltIn.round",1,[m]),abs:t.create("abs","Math.abs",1),sign:t.create("sign","BuiltIn.sign",1),mod:t.create("mod","BuiltIn.mod",2),nCr:t.create("nCr","BuiltIn.nCr",2),nPr:t.create("nPr","BuiltIn.nPr",2),factorial:t.create("factorial","BuiltIn.factorial",1),polyGamma:t.create("polyGamma","BuiltIn.polyGamma",2),lcm:a.create("lcm","BuiltIn.listLCM"),gcd:a.create("gcd","BuiltIn.listGCD"),mean:a.create("mean","BuiltIn.mean"),total:a.create("total","BuiltIn.total"),stdev:a.create("stdev","BuiltIn.stdev"),stdevp:a.create("stdevp","BuiltIn.stdevp"),mad:a.create("mad","BuiltIn.mad"),length:a.create("length","BuiltIn.length"),min:a.create("min","BuiltIn.listMin"),max:a.create("max","BuiltIn.listMax"),argmin:a.create("argmin","BuiltIn.argMin"),argmax:a.create("argmax","BuiltIn.argMax"),median:a.create("median","BuiltIn.median"),var:a.create("var","BuiltIn.var"),varp:a.create("varp","BuiltIn.varp"),cov:s.create("cov","BuiltIn.cov"),covp:s.create("covp","BuiltIn.covp"),corr:s.create("corr","BuiltIn.corr"),quantile:o.create("quantile","BuiltIn.quantile"),quartile:o.create("quartile","BuiltIn.quartile"),upperQuantileIndex:o.create("upperQuantileIndex","BuiltIn.upperQuantileIndex"),lowerQuantileIndex:o.create("lowerQuantileIndex","BuiltIn.lowerQuantileIndex"),quartileIndex:o.create("quartileIndex","BuiltIn.quartileIndex"),upperQuartileIndex:o.create("upperQuartileIndex","BuiltIn.upperQuartileIndex"),lowerQuartileIndex:o.create("lowerQuartileIndex","BuiltIn.lowerQuartileIndex"),normalcdf:t.create("normalcdf","BuiltIn.normalcdf",2,[m,d]),normalpdf:t.create("normalpdf","BuiltIn.normalpdf",1,[m,d]),binomcdf:t.create("binomcdf","BuiltIn.binomcdf",3,[g]),binompdf:t.create("binompdf","BuiltIn.binompdf",2,[g]),poissoncdf:t.create("poissoncdf","BuiltIn.poissoncdf",3),poissonpdf:t.create("poissonpdf","BuiltIn.poissonpdf",2),invNorm:t.create("invNorm","BuiltIn.invNorm",1),invT:t.create("invT","BuiltIn.invT",2),invPoisson:t.create("invPoisson","BuiltIn.invPoisson",2),invBinom:t.create("invBinom","BuiltIn.invBinom",3),ZScore:t.create("ZScore","BuiltIn.ZScore",3),erf:t.create("erf","BuiltIn.erf",1),tpdf:t.create("tpdf","BuiltIn.tpdf",2),tcdf:t.create("tcdf","BuiltIn.tcdf",3),TTest:o.create("TTest","BuiltIn.TTest"),TScore:o.create("TScore","BuiltIn.TScore"),distance:r.create("distance","BuiltIn.distance",[l.Point,l.Point],l.Number),midpoint:r.create("midpoint","BuiltIn.midpoint",[l.Point,l.Point],l.Point),normdist:u.create("normdist",0,[m,d]),tdist:u.create("tdist",1),binomdist:u.create("binomdist",1,[g]),poissondist:u.create("poissondist",1),pdf:t.create("pdf","BuiltIn.normpdf",1,[h("x")]),cdf:t.create("cdf","BuiltIn.normcdf",1,[h("x"),y]),polygon:c.create("polygon"),histogram:c.create("histogram"),dotplot:c.create("dotplot"),boxplot:c.create("boxplot")};return v}),define("math/parsenode/histogram",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/dotplot",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/boxplot",["require","pjs","./expression"],function(e){var t=e("pjs"),r=e("./expression");return t(r,function(e,t){e.init=function(e){t.init.call(this,e)},e.copyWithArgs=function(e){return new this.constructor(e)}})}),define("math/parsenode/equation",["require","./base","pjs","./expressionTypes","math/parsenode/comparator"],function(e){var t=e("./base"),r=e("pjs"),n=e("./expressionTypes").Subtract,i=e("math/parsenode/comparator");return r(t,function(e,t){e.init=function(e,r){t.init.call(this),this.mergeDependencies(e,r),this._lhs=e,this._rhs=r,this._difference=n([this._lhs,this._rhs])},e.asComparator=function(){return i["="]([this._lhs,this._rhs])}})}),define("math/parsenode/assignment",["require","./base","./equation","./identifier","pjs"],function(e){var t=e("./base"),r=e("./equation"),n=e("./identifier"),i=e("pjs");return i(t,function(e,t){e.init=function(e,r){t.init.call(this),e=e._symbol,this.mergeDependencies(r),this._expression=r,this._symbol=e,this._exports=this.computeExports()},e.shouldExportAns=function(){return!0},e.computeExports=function(){for(var e=this._symbol,t=this.getDependencies(),r=0;r<t.length;r++)if(t[r]===e)return[];return[e]},e.isEquation=function(e){return e.getDependencies().indexOf(this._symbol)!==-1},e.asEquation=function(){var e=r(n(this._symbol),this._expression);return e.userData=this.userData,e.metaData=this.metaData,e},e.shouldPromoteToSlider=function(e){return!!this._expression.isConstant&&(!this._expression.is_mixed_number&&("number"==typeof this._expression.asValue()&&(!!isFinite(this._expression.asValue())&&e.isValidSlider(this._symbol))))}})}),define("math/parsenode/functiondefinition",["require","pjs","./base","math/errormsg","./equation","./identifier","./functioncall"],function(e){var t=e("pjs"),r=e("./base"),n=e("math/errormsg"),i=e("./equation"),a=e("./identifier"),s=e("./functioncall");return t(r,function(e,t){e.init=function(e,r,n){t.init.call(this),e=e._symbol,this._argSymbols=r.map(function(e){return e._symbol}),this._symbol=e,this._exports=[e],this._expression=n,this.addDependencies(this._argSymbols),this.addDummyDependencies(this._argSymbols),this.mergeDependencies(this._expression)},e.isFunction=!0,e.getConcreteInvocationTree=function(e,t,r){if(t.length!==this._argSymbols.length)throw n.wrongArity(this._symbol,this._argSymbols.length,t.length);for(var i=Object.create(e),a=0;a<this._argSymbols.length;a++)i[this._argSymbols[a]]=t[a];return this._expression.getConcreteTree(i,r)},e.getSliderVariables=function(e,t){var r=this._argSymbols;return e.sliderVariables(t.getDependencies()).filter(function(e){return r.indexOf(e)===-1})},e.asEquation=function(){var e=this._argSymbols.map(function(e){return a(e)}),t=i(s(a(this._symbol),e),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}})}),define("numeric",[],function(){"use strict";var e="undefined"==typeof exports?function(){}:exports;return"undefined"!=typeof global&&(global.numeric=e),e.version="1.2.6",e._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},e.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:e._myIndexOf,e.precision=4,e.largeArray=50,e.compile=function(){var t=Array.prototype.slice.call(arguments),r=t.pop();return r="return function ("+t.join(",")+") {"+r+"}",new Function(["numeric"],r)(e)},e._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},e.dim=function(t){var r,n;return"object"==typeof t?(r=t[0],"object"==typeof r?(n=r[0],"object"==typeof n?e._dim(t):[t.length,r.length]):[t.length]):[]},e.mapreduce=function(t,r){return e.compile("x","accum","_s","_k",\'if(typeof accum === "undefined") accum = \'+r+\';\\nif(typeof x === "number") { var xi = x; \'+t+\'; return accum; }\\nif(typeof _s === "undefined") _s = numeric.dim(x);\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i,xi;\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) {\\n        accum = arguments.callee(x[i],accum,_s,_k+1);\\n    }    return accum;\\n}\\nfor(i=_n-1;i>=1;i-=2) { \\n    xi = x[i];\\n    \'+t+";\\n    xi = x[i-1];\\n    "+t+";\\n}\\nif(i === 0) {\\n    xi = x[i];\\n    "+t+"\\n}\\nreturn accum;")},e.mapreduce2=function(t,r){return e.compile("x","var n = x.length;\\nvar i,xi;\\n"+r+"\\nfor(i=n-1;i!==-1;--i) { \\n    xi = x[i];\\n    "+t+"\\n}\\nreturn accum;")},e.rep=function(t,r,n){"undefined"==typeof n&&(n=0);var i,a=t[n],s=Array(a);if(n===t.length-1){for(i=a-2;i>=0;i-=2)s[i+1]=r,s[i]=r;return i===-1&&(s[0]=r),s}for(i=a-1;i>=0;i--)s[i]=e.rep(t,r,n+1);return s},e.dotMMsmall=function(e,t){var r,n,i,a,s,o,u,c,l,p,f;for(a=e.length,s=t.length,o=t[0].length,u=Array(a),r=a-1;r>=0;r--){for(c=Array(o),l=e[r],i=o-1;i>=0;i--){for(p=l[s-1]*t[s-1][i],n=s-2;n>=1;n-=2)f=n-1,p+=l[n]*t[n][i]+l[f]*t[f][i];0===n&&(p+=l[0]*t[0][i]),c[i]=p}u[r]=c}return u},e._getCol=function(e,t,r){var n,i=e.length;for(n=i-1;n>0;--n)r[n]=e[n][t],--n,r[n]=e[n][t];0===n&&(r[0]=e[0][t])},e.dotMMbig=function(t,r){var n,i,a,s,o=e._getCol,u=r.length,c=Array(u),l=t.length,p=r[0].length,f=new Array(l),h=e.dotVV;for(--u,--l,i=l;i!==-1;--i)f[i]=Array(p);for(--p,i=p;i!==-1;--i)for(o(r,i,c),a=l;a!==-1;--a)s=0,n=t[a],f[a][i]=h(n,c);return f},e.dotMV=function(t,r){var n,i=t.length,a=(r.length,Array(i)),s=e.dotVV;for(n=i-1;n>=0;n--)a[n]=s(t[n],r);return a},e.dotVM=function(e,t){var r,n,i,a,s,o,u;for(i=e.length,a=t[0].length,s=Array(a),n=a-1;n>=0;n--){for(o=e[i-1]*t[i-1][n],r=i-2;r>=1;r-=2)u=r-1,o+=e[r]*t[r][n]+e[u]*t[u][n];0===r&&(o+=e[0]*t[0][n]),s[n]=o}return s},e.dotVV=function(e,t){var r,n,i=e.length,a=e[i-1]*t[i-1];for(r=i-2;r>=1;r-=2)n=r-1,a+=e[r]*t[r]+e[n]*t[n];return 0===r&&(a+=e[0]*t[0]),a},e.dot=function(t,r){var n=e.dim;switch(1e3*n(t).length+n(r).length){case 2002:return r.length<10?e.dotMMsmall(t,r):e.dotMMbig(t,r);case 2001:return e.dotMV(t,r);case 1002:return e.dotVM(t,r);case 1001:return e.dotVV(t,r);case 1e3:return e.mulVS(t,r);case 1:return e.mulSV(t,r);case 0:return t*r;default:throw new Error("numeric.dot only works on vectors and matrices")}},e.diag=function(e){var t,r,n,i,a=e.length,s=Array(a);for(t=a-1;t>=0;t--){for(i=Array(a),r=t+2,n=a-1;n>=r;n-=2)i[n]=0,i[n-1]=0;for(n>t&&(i[n]=0),i[t]=e[t],n=t-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),s[t]=i}return s},e.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;t>=1;--t)n[t]=e[t][t],--t,n[t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},e.identity=function(t){return e.diag(e.rep([t],1))},e.pointwise=function(t,r,n){"undefined"==typeof n&&(n="");var i,a,s=[],o=/\\[i\\]$/,u="",c=!1;for(i=0;i<t.length;i++)o.test(t[i])?(a=t[i].substring(0,t[i].length-3),u=a):a=t[i],"ret"===a&&(c=!0),s.push(a);return s[t.length]="_s",s[t.length+1]="_k",s[t.length+2]=\'if(typeof _s === "undefined") _s = numeric.dim(\'+u+\');\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i\'+(c?"":", ret = Array(_n)")+";\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\\n    return ret;\\n}\\n"+n+"\\nfor(i=_n-1;i!==-1;--i) {\\n    "+r+"\\n}\\nreturn ret;",e.compile.apply(null,s)},e.pointwise2=function(t,r,n){"undefined"==typeof n&&(n="");var i,a,s=[],o=/\\[i\\]$/,u="",c=!1;for(i=0;i<t.length;i++)o.test(t[i])?(a=t[i].substring(0,t[i].length-3),u=a):a=t[i],"ret"===a&&(c=!0),s.push(a);return s[t.length]="var _n = "+u+".length;\\nvar i"+(c?"":", ret = Array(_n)")+";\\n"+n+"\\nfor(i=_n-1;i!==-1;--i) {\\n"+r+"\\n}\\nreturn ret;",e.compile.apply(null,s)},e._biforeach=function e(t,r,n,i,a){if(i===n.length-1)return void a(t,r);var s,o=n[i];for(s=o-1;s>=0;s--)e("object"==typeof t?t[s]:t,"object"==typeof r?r[s]:r,n,i+1,a)},e._biforeach2=function e(t,r,n,i,a){if(i===n.length-1)return a(t,r);var s,o=n[i],u=Array(o);for(s=o-1;s>=0;--s)u[s]=e("object"==typeof t?t[s]:t,"object"==typeof r?r[s]:r,n,i+1,a);return u},e._foreach=function e(t,r,n,i){if(n===r.length-1)return void i(t);var a,s=r[n];for(a=s-1;a>=0;a--)e(t[a],r,n+1,i)},e._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var a,s=r[n],o=Array(s);for(a=s-1;a>=0;a--)o[a]=e(t[a],r,n+1,i);return o},e.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},e.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},e.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],e.mathfuns2=["atan2","pow","max","min"],e.ops1={neg:"-",not:"!",bnot:"~",clone:""},e.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,r;for(t=0;t<e.mathfuns2.length;++t)r=e.mathfuns2[t],e.ops2[r]=r;for(t in e.ops2)if(e.ops2.hasOwnProperty(t)){r=e.ops2[t];var n,i,a="";e.myIndexOf.call(e.mathfuns2,t)!==-1?(a="var "+r+" = Math."+r+";\\n",n=function(e,t,n){return e+" = "+r+"("+t+","+n+")"},i=function(e,t){return e+" = "+r+"("+e+","+t+")"}):(n=function(e,t,n){return e+" = "+t+" "+r+" "+n},i=e.opseq.hasOwnProperty(t+"eq")?function(e,t){return e+" "+r+"= "+t}:function(e,t){return e+" = "+e+" "+r+" "+t}),e[t+"VV"]=e.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),a),e[t+"SV"]=e.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),a),e[t+"VS"]=e.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),a),e[t]=e.compile("var n = arguments.length, i, x = arguments[0], y;\\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+\'SV;\\nvar dim = numeric.dim;\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof x === "object") {\\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\\n  else \'+i("x","y")+"\\n}\\nreturn x;\\n"),e[r]=e[t],e[t+"eqV"]=e.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),a),e[t+"eqS"]=e.pointwise2(["ret[i]","x"],i("ret[i]","x"),a),e[t+"eq"]=e.compile("var n = arguments.length, i, x = arguments[0], y;\\nvar V = numeric."+t+"eqV, S = numeric."+t+\'eqS\\nvar s = numeric.dim(x);\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\\n  else numeric._biforeach(x,y,s,0,S);\\n}\\nreturn x;\\n\')}for(t=0;t<e.mathfuns2.length;++t)r=e.mathfuns2[t],delete e.ops2[r];for(t=0;t<e.mathfuns.length;++t)r=e.mathfuns[t],e.ops1[r]=r;for(t in e.ops1)e.ops1.hasOwnProperty(t)&&(a="",r=e.ops1[t],e.myIndexOf.call(e.mathfuns,t)!==-1&&Math.hasOwnProperty(r)&&(a="var "+r+" = Math."+r+";\\n"),e[t+"eqV"]=e.pointwise2(["ret[i]"],"ret[i] = "+r+"(ret[i]);",a),e[t+"eq"]=e.compile("x",\'if(typeof x !== "object") return \'+r+"x\\nvar i;\\nvar V = numeric."+t+"eqV;\\nvar s = numeric.dim(x);\\nnumeric._foreach(x,s,0,V);\\nreturn x;\\n"),e[t+"V"]=e.pointwise2(["x[i]"],"ret[i] = "+r+"(x[i]);",a),e[t]=e.compile("x",\'if(typeof x !== "object") return \'+r+"(x)\\nvar i;\\nvar V = numeric."+t+"V;\\nvar s = numeric.dim(x);\\nreturn numeric._foreach2(x,s,0,V);\\n"));for(t=0;t<e.mathfuns.length;++t)r=e.mathfuns[t],delete e.ops1[r];for(t in e.mapreducers)e.mapreducers.hasOwnProperty(t)&&(r=e.mapreducers[t],e[t+"V"]=e.mapreduce2(r[0],r[1]),e[t]=e.compile("x","s","k",r[1]+\'if(typeof x !== "object") {    xi = x;\\n\'+r[0]+\'\\n    return accum;\\n}if(typeof s === "undefined") s = numeric.dim(x);\\nif(typeof k === "undefined") k = 0;\\nif(k === s.length-1) return numeric.\'+t+"V(x);\\nvar xi;\\nvar n = x.length, i;\\nfor(i=n-1;i!==-1;--i) {\\n   xi = arguments.callee(x[i]);\\n"+r[0]+"\\n}\\nreturn accum;\\n"))}(),e.inv=function(t){var r,n,i,a,s,o,u,t,c=e.dim(t),l=Math.abs,p=c[0],f=c[1],h=e.clone(t),d=e.identity(p);for(o=0;o<f;++o){var m=-1,g=-1;for(s=o;s!==p;++s)u=l(h[s][o]),u>g&&(m=s,g=u);for(n=h[m],h[m]=h[o],h[o]=n,a=d[m],d[m]=d[o],d[o]=a,t=n[o],u=o;u!==f;++u)n[u]/=t;for(u=f-1;u!==-1;--u)a[u]/=t;for(s=p-1;s!==-1;--s)if(s!==o){for(r=h[s],i=d[s],t=r[o],u=o+1;u!==f;++u)r[u]-=n[u]*t;for(u=f-1;u>0;--u)i[u]-=a[u]*t,--u,i[u]-=a[u]*t;0===u&&(i[0]-=a[0]*t)}}return d},e.det=function(t){var r=e.dim(t);if(2!==r.length||r[0]!==r[1])throw new Error("numeric: det() only works on square matrices");var n,i,a,s,o,u,c,l,p=r[0],f=1,h=e.clone(t);for(i=0;i<p-1;i++){for(a=i,n=i+1;n<p;n++)Math.abs(h[n][i])>Math.abs(h[a][i])&&(a=n);for(a!==i&&(c=h[a],h[a]=h[i],h[i]=c,f*=-1),s=h[i],n=i+1;n<p;n++){for(o=h[n],u=o[i]/s[i],a=i+1;a<p-1;a+=2)l=a+1,o[a]-=s[a]*u,o[l]-=s[l]*u;a!==p&&(o[a]-=s[a]*u)}if(0===s[i])return 0;f*=s[i]}return f*h[i][i]},e.transpose=function(e){var t,r,n,i,a,s=e.length,o=e[0].length,u=Array(o);for(r=0;r<o;r++)u[r]=Array(s);for(t=s-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=o-1;r>=1;--r)a=u[r],a[t]=i[r],a[t-1]=n[r],--r,a=u[r],a[t]=i[r],a[t-1]=n[r];0===r&&(a=u[0],a[t]=i[0],a[t-1]=n[0])}if(0===t){for(n=e[0],r=o-1;r>=1;--r)u[r][0]=n[r],--r,u[r][0]=n[r];0===r&&(u[0][0]=n[0])}return u},e.negtranspose=function(e){var t,r,n,i,a,s=e.length,o=e[0].length,u=Array(o);for(r=0;r<o;r++)u[r]=Array(s);for(t=s-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=o-1;r>=1;--r)a=u[r],a[t]=-i[r],a[t-1]=-n[r],--r,a=u[r],a[t]=-i[r],a[t-1]=-n[r];0===r&&(a=u[0],a[t]=-i[0],a[t-1]=-n[0])}if(0===t){for(n=e[0],r=o-1;r>=1;--r)u[r][0]=-n[r],--r,u[r][0]=-n[r];0===r&&(u[0][0]=-n[0])}return u},e.norm2=function(t){return Math.sqrt(e.norm2Squared(t))},e.linspace=function(e,t,r){if("undefined"==typeof r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,i=Array(r);for(r--,n=r;n>=0;n--)i[n]=(n*t+(r-n)*e)/r;return i},e.getBlock=function(t,r,n){function i(e,t){var s,o=r[t],u=n[t]-o,c=Array(u);if(t===a.length-1){for(s=u;s>=0;s--)c[s]=e[s+o];return c}for(s=u;s>=0;s--)c[s]=i(e[s+o],t+1);return c}var a=e.dim(t);return i(t,0)},e.setBlock=function(t,r,n,i){function a(e,t,i){var o,u=r[i],c=n[i]-u;if(i===s.length-1)for(o=c;o>=0;o--)e[o+u]=t[o];for(o=c;o>=0;o--)a(e[o+u],t[o],i+1)}var s=e.dim(t);return a(t,i,0),t},e.getRange=function(e,t,r){var n,i,a,s,o=t.length,u=r.length,c=Array(o);for(n=o-1;n!==-1;--n)for(c[n]=Array(u),a=c[n],s=e[t[n]],i=u-1;i!==-1;--i)a[i]=s[r[i]];return c},e.blockMatrix=function(t){var r=e.dim(t);if(r.length<4)return e.blockMatrix([t]);var n,i,a,s,o,u=r[0],c=r[1];for(n=0,i=0,a=0;a<u;++a)n+=t[a][0].length;for(s=0;s<c;++s)i+=t[0][s][0].length;var l=Array(n);for(a=0;a<n;++a)l[a]=Array(i);var p,f,h,d,m,g=0;for(a=0;a<u;++a){for(p=i,s=c-1;s!==-1;--s)for(o=t[a][s],p-=o[0].length,h=o.length-1;h!==-1;--h)for(m=o[h],f=l[g+h],d=m.length-1;d!==-1;--d)f[p+d]=m[d];g+=t[a][0].length}return l},e.tensor=function(t,r){if("number"==typeof t||"number"==typeof r)return e.mul(t,r);var n=e.dim(t),i=e.dim(r);if(1!==n.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var a,s,o,u,c=n[0],l=i[0],p=Array(c);for(s=c-1;s>=0;s--){for(a=Array(l),u=t[s],o=l-1;o>=3;--o)a[o]=u*r[o],--o,a[o]=u*r[o],--o,a[o]=u*r[o],--o,a[o]=u*r[o];for(;o>=0;)a[o]=u*r[o],--o;p[s]=a}return p},e.epsilon=2.220446049250313e-16,e.LU=function(t,r){r=r||!1;var n,i,a,s,o,u,c,l,p,f=Math.abs,h=t.length,d=h-1,m=new Array(h);for(r||(t=e.clone(t)),a=0;a<h;++a){for(c=a,u=t[a],p=f(u[a]),i=a+1;i<h;++i)s=f(t[i][a]),p<s&&(p=s,c=i);for(m[a]=c,c!=a&&(t[a]=t[c],t[c]=u,u=t[a]),o=u[a],n=a+1;n<h;++n)t[n][a]/=o;for(n=a+1;n<h;++n){for(l=t[n],i=a+1;i<d;++i)l[i]-=l[a]*u[i],++i,l[i]-=l[a]*u[i];i===d&&(l[i]-=l[a]*u[i])}}return{LU:t,P:m}},e.LUsolve=function(t,r){var n,i,a,s,o,u=t.LU,c=u.length,l=e.clone(r),p=t.P;for(n=c-1;n!==-1;--n)l[n]=r[n];for(n=0;n<c;++n)for(a=p[n],p[n]!==n&&(o=l[n],l[n]=l[a],l[a]=o),s=u[n],i=0;i<n;++i)l[n]-=l[i]*s[i];for(n=c-1;n>=0;--n){for(s=u[n],i=n+1;i<c;++i)l[n]-=l[i]*s[i];l[n]/=s[n]}return l},e.solve=function(t,r,n){return e.LUsolve(e.LU(t,n),r)},e.svd=function(t){function r(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var n,i=e.epsilon,a=1e-64/i,s=50,o=0,u=0,c=0,l=0,p=0,f=e.clone(t),h=f.length,d=f[0].length;if(h<d)throw"Need more rows than columns";var m=new Array(d),g=new Array(d);for(u=0;u<d;u++)m[u]=g[u]=0;var y=e.rep([d,d],0),v=0,b=0,x=0,_=0,M=0,S=0,E=0;for(u=0;u<d;u++){for(m[u]=b,E=0,p=u+1,c=u;c<h;c++)E+=f[c][u]*f[c][u];if(E<=a)b=0;else for(v=f[u][u],b=Math.sqrt(E),v>=0&&(b=-b),x=v*b-E,f[u][u]=v-b,c=p;c<d;c++){for(E=0,l=u;l<h;l++)E+=f[l][u]*f[l][c];for(v=E/x,l=u;l<h;l++)f[l][c]+=v*f[l][u]}for(g[u]=b,E=0,c=p;c<d;c++)E+=f[u][c]*f[u][c];if(E<=a)b=0;else{for(v=f[u][u+1],b=Math.sqrt(E),v>=0&&(b=-b),x=v*b-E,f[u][u+1]=v-b,c=p;c<d;c++)m[c]=f[u][c]/x;for(c=p;c<h;c++){for(E=0,l=p;l<d;l++)E+=f[c][l]*f[u][l];for(l=p;l<d;l++)f[c][l]+=E*m[l]}}M=Math.abs(g[u])+Math.abs(m[u]),M>_&&(_=M)}for(u=d-1;u!=-1;u+=-1){if(0!=b){for(x=b*f[u][u+1],c=p;c<d;c++)y[c][u]=f[u][c]/x;for(c=p;c<d;c++){for(E=0,l=p;l<d;l++)E+=f[u][l]*y[l][c];for(l=p;l<d;l++)y[l][c]+=E*y[l][u]}}for(c=p;c<d;c++)y[u][c]=0,y[c][u]=0;y[u][u]=1,b=m[u],p=u}for(u=d-1;u!=-1;u+=-1){for(p=u+1,b=g[u],c=p;c<d;c++)f[u][c]=0;if(0!=b){for(x=f[u][u]*b,c=p;c<d;c++){for(E=0,l=p;l<h;l++)E+=f[l][u]*f[l][c];for(v=E/x,l=u;l<h;l++)f[l][c]+=v*f[l][u]}for(c=u;c<h;c++)f[c][u]=f[c][u]/b}else for(c=u;c<h;c++)f[c][u]=0;f[u][u]+=1}for(i*=_,l=d-1;l!=-1;l+=-1)for(var w=0;w<s;w++){var T=!1;for(p=l;p!=-1;p+=-1){if(Math.abs(m[p])<=i){T=!0;break}if(Math.abs(g[p-1])<=i)break}if(!T){o=0,E=1;var D=p-1;for(u=p;u<l+1&&(v=E*m[u],m[u]=o*m[u],!(Math.abs(v)<=i));u++)for(b=g[u],x=r(v,b),g[u]=x,o=b/x,E=-v/x,c=0;c<h;c++)M=f[c][D],S=f[c][u],f[c][D]=M*o+S*E,f[c][u]=-M*E+S*o}if(S=g[l],p==l){if(S<0)for(g[l]=-S,c=0;c<d;c++)y[c][l]=-y[c][l];break}if(w>=s-1)throw"Error: no convergence.";for(_=g[p],M=g[l-1],b=m[l-1],x=m[l],v=((M-S)*(M+S)+(b-x)*(b+x))/(2*x*M),b=r(v,1),v=v<0?((_-S)*(_+S)+x*(M/(v-b)-x))/_:((_-S)*(_+S)+x*(M/(v+b)-x))/_,o=1,E=1,u=p+1;u<l+1;u++){for(b=m[u],M=g[u],x=E*b,b*=o,S=r(v,x),m[u-1]=S,o=v/S,E=x/S,v=_*o+b*E,b=-_*E+b*o,x=M*E,M*=o,c=0;c<d;c++)_=y[c][u-1],S=y[c][u],y[c][u-1]=_*o+S*E,y[c][u]=-_*E+S*o;for(S=r(v,x),g[u-1]=S,o=v/S,E=x/S,v=o*b+E*M,_=-E*b+o*M,c=0;c<h;c++)M=f[c][u-1],S=f[c][u],f[c][u-1]=M*o+S*E,f[c][u]=-M*E+S*o}m[p]=0,m[l]=v,g[l]=_}for(u=0;u<g.length;u++)g[u]<i&&(g[u]=0);for(u=0;u<d;u++)for(c=u-1;c>=0;c--)if(g[c]<g[u]){for(o=g[c],g[c]=g[u],g[u]=o,l=0;l<f.length;l++)n=f[l][u],f[l][u]=f[l][c],f[l][c]=n;for(l=0;l<y.length;l++)n=y[l][u],y[l][u]=y[l][c],y[l][c]=n;u=c}return{U:f,S:g,V:y}},e}),define("math/parsenode/optimizedregression",["require","pjs","./base"],function(e){var t=e("pjs"),r=e("./base");return t(r,function(e,t){e.init=function(e,r,n,i,a){t.init.call(this),this.parameters=e,this.residuals=r,this.statistics=n,this.model=i,this.isModelValid=a.isModelValid,this.residualVariable=a.residualVariable,this.residualSuggestionId=a.residualSuggestionId,this.shouldSuggestLogMode=a.shouldSuggestLogMode,this._exports=[this.residualVariable];for(var s in e)e.hasOwnProperty(s)&&this._exports.push(s);this.mergeDependencies(i)},e.getCompiledFunction=function(){return this.model.getCompiledFunction.apply(this.model,arguments)},e.getCompiledDerivative=function(){return this.model.getCompiledDerivative.apply(this.model,arguments)},e.evaluate=function(){return this.model.evaluate.apply(this.model,arguments)}})}),define("math/parsenode/regression",["require","pjs","./base","numeric","math/distance","math/builtin","graphing/label","math/errormsg","./error","./optimizedregression","./list","./functioncall","./identifier","./constant","./freevariable","./expressionTypes","math/types"],function(e){var t=e("pjs"),r=e("./base"),n=e("numeric"),i=e("math/distance"),a=e("math/builtin"),s=e("graphing/label"),o=e("math/errormsg"),u=e("./error"),c=e("./optimizedregression"),l=e("./list"),p=e("./functioncall"),f=e("./identifier"),h=e("./constant"),d=e("./freevariable"),m=e("./expressionTypes"),g=e("math/types"),y=m.Subtract;return t(r,function(e,t,r){function m(e,t){for(var r=0,n=e.fn.apply(void 0,t),i=0;i<n.length;i++){var a=n[i];r+=a*a}return r/n.length}function v(e,t){return e.fn.apply(void 0,t)}function b(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n].fn.apply(void 0,t);r.push(i)}return r}function x(e,t,r,i,a){for(var s=[],o=0;o<t.length;o++)s.push(0);for(var u=b(t,s),c=n.LU(n.dot(u,n.transpose(u)),!0),l=s,p=0;p<2;p++){var f=v(e,s),h=n.neg(n.LUsolve(c,n.dot(u,f)));if(!n.all(n.isFinite(h)))return M(e,t,r,i,a);s=n.add(l,h),l=s}return{solution:s,MSE:m(e,s)}}function _(e,t,r,i){for(var a=r,s=m(e,a),o=.001,u=2,c=.1,l=[],p=0;p<t.length;p++)l.push(1);for(var f=0,h=!1,d=b(t,a),g=a,y=s;f<i&&!h;){var x=v(e,a),_=n.transpose(d),M=n.dot(d,_);if(!n.all(n.isFinite(x)))break;if(!n.all(n.isFinite(M)))break;for(var S=!1;f<i&&!h&&!S;){f+=1;var E=n.LU(n.add(M,n.diag(n.mul(o,l))),!0),w=n.neg(n.LUsolve(E,n.dot(d,x))),T=w;if(a=n.add(g,T),s=m(e,a),h=n.all(n.eq(a,g))){g=a,y=s;break}var D;if(isFinite(s)&&s<=y&&(D=b(t,a),S=n.all(n.isFinite(D))),S){d=D,g=a,y=s,o*=c,o=Math.max(1e-64,o);break}o*=u}}return{solution:g,MSE:m(e,g)}}function M(e,t,r,n,a){var s,o=[];for(n||(n={}),a||(a={}),s=0;s<r.length;s++){var u=r[s];a[u]&&isFinite(a[u].asValue())?o.push(+a[u].asValue()):n.hasOwnProperty(u)&&isFinite(n[u])?o.push(+n[u]):o.push(1)}var c=I(30,r),l=C(e,t,c,3,5),p=C(e,t,l,60,1),f=_(e,t,p[0],250),h=_(e,t,o,100);return isFinite(h.MSE)?h.MSE<f.MSE?h:i.approx(h.MSE,f.MSE,8)?h:f:f}function S(e,t,r,n){var i,a,s=t.getDependencies();for(a=0;a<s.length;a++)if(!e.validRegressionParameter(s[a]))throw o.invalidRegressionParameter(s[a]);var u=t.getCompiledFunction(s);if(s.length){var c={};for(a=1;a<s.length;a++)c[s[a]]=d(s[0]);var l=t.substitute(c).isLinear(s[0]),p=[];for(a=0;a<s.length;a++)p.push(t.takeDerivative(s[a]).getCompiledFunction(s));i=l?x(u,p,s,r,n):M(u,p,s,r,n)}else i={solution:[],MSE:m(u,[])};var f={};for(a=0;a<s.length;a++)f[s[a]]=h(i.solution[a]);return f}function E(e,t){var r=e.length,n=e[0],a=t[0],s=e[r-1],o=t[r-1];if(!(isFinite(n)&&isFinite(s)&&isFinite(a)&&isFinite(o)))return!1;if(o-a===0)return!1;var u=s-n;if(0===u)return!1;for(var c=1;c<r-1;c++){var l=e[c],p=t[c],f=(o*(l-n)+a*(s-l))/u;if(!i.approx(p,f,5))return!1}return!0}function w(e,t,r){var n=Object.create(t);for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i]);return l.wrap(e.getConcreteTree(n))}e.init=function(e,r){t.init.call(this),this._lhs=e,this.isLhsSimple=e instanceof f||e instanceof l,this._logLhs=p("ln",[e]),this._rhs=r,this._difference=y([e,r]),this._logDifference=y([p("ln",[e]),p("ln",[r])]),this.mergeDependencies(e,r)},e.isRegression=!0,e.chooseResidualVariable=function(e){if(this.userData&&this.userData.residualVariable){var t=s.latexToIdentifier(this.userData.residualVariable);if(!e[t])return t}for(var r,n=this.getDependencies(),i=0;i<n.length;i++){var a=n[i].match(/_(.*)/);if(a&&(r="e_"+a[1],!e[r]))return r}for(var o=1;;){if(r="e_"+o,!e[r])return r;o++}},e.getRHSModel=function(e,t){function r(e,t){for(var r=0;r<n.length;r++)if(n[r].node===this)return n[r].tmpVar;var a=d(this.tmpVar()),s=this.getConcreteTree(e);return s.getDependencies().length&&(i=!1),n.push({node:this,tmpVar:a,symbol:a._symbol,concrete:s}),a}var n=[],i=!0,a={List:r,TableColumn:r,Range:r},s=this._rhs.tryGetConcreteTree(e,a);return{node:s,substituted:s.isError?s:s.substitute(t),replacedNodes:n,isValid:i}};var T=[18.9,.105,.0113,.089,4.414,34.32,8.61,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1.89,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777],D=function(e){var t=503*e%T.length;return T[t]},I=function(e,t){for(var r,n=[],i=t.length,a=0;a<e;a++){r=[];for(var s=0;s<i;s++)0===a?r[s]=0:1===a?r[s]=1:r[s]=D(a*i+s);n.push(r)}return n},C=function(e,t,r,n,i){for(var a=[],s=0;s<r.length;s++)a.push({soln:_(e,t,r[s],n),startingVals:r[s]});a.sort(function(e,t){return isNaN(e.soln.MSE)?1:isNaN(t.soln.MSE)?-1:e.soln.MSE-t.soln.MSE});for(var o=[],u=0;u<i;u++)o.push(a[u].startingVals);return o};e.computeStatistics=function(e,t,r,n,s){if(r.getDependencies().length)throw o.optimizationError();var u=0;r.eachElement(function(e){var t=e.asValue();u+=t*t});var c=u/r.length;if(!isFinite(c))throw o.optimizationError();if(e.getDependencies().length>0)return{RMSE:Math.sqrt(c)};var p=g.isList(e.valueType)?a.varp(e.asValue()):0;if(e.getDependencies().length||!isFinite(p)||p<=0||!this.isLhsSimple)return{RMSE:Math.sqrt(c)};var f=1-c/p;if(t.isValid&&1===t.replacedNodes.length){var h=[],d=[],m=n&&(s===P.LINLOG||s===P.LOGLOG);l.eachArgs([t.replacedNodes[0].concrete,e],function(e){h.push(m?Math.log(e[0].asValue()):+e[0].asValue()),d.push(+e[1].asValue())});var y=a.corr(h,d);if(i.approx(y*y,f,8))return{r:y,rsquared:y*y}}return{Rsquared:f}},e.getResidualSuggestionId=function(e,t){var r,n=this._rhs.getDependencies();for(var i in t)if(t.hasOwnProperty(i)&&t[i].concreteTree.isTable&&t[i].concreteTree.columns[0]){var a=t[i].rawTree.columns;if(a&&a.length){var s=a[0].getExports();if(1===s.length&&n.indexOf(s[0])!==-1){for(var o=1;o<a.length;o++)if(a[o].getDependencies().indexOf(e)!==-1)return;r=r?r:i}}}return r?r:void 0};var P={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};e.linearizingTransformation=function(e,t){if(!this.isLhsSimple)return P.NONE;var r=t.substituted;if(r.isError)return P.NONE;if(r.valueType!==g.Number)return P.NONE;var n=r.getDependencies();if(1!==n.length)return P.NONE;if(isFinite(t.node.polynomialOrder(n[0])))return P.NONE;var i=r.getCompiledFunction(n).fn,a=t.replacedNodes[0].concrete;if(r.valueType!==g.Number)return P.NONE;var s=a.mapElements(function(e){return+e.asValue()});if(s.length<3)return P.NONE;s.sort(function(e,t){\nreturn e-t});var o=s.map(i),u=o.map(Math.log),c=s.map(Math.log),p=!0;return l.wrap(e).eachElement(function(e){isFinite(Math.log(+e.asValue()))||(p=!1)}),E(s,u)&&p?P.LOGLIN:E(c,u)&&p?P.LOGLOG:E(c,o)?P.LINLOG:P.NONE},e.optimize=function(e,t,r,n,i){var a=this._lhs.getConcreteTree(t),o=this._rhs.getConcreteTree(t);this.typeCheck([a,o]);var u,p=l.wrap(this._difference.getConcreteTree(t)),f=S(e,p,this.userData.regressionParameters,n),h=this.getRHSModel(t,f),d=w(this._difference,t,f),m=this.linearizingTransformation(a,h);if(!this.userData.isLogModeRegression||m!==P.LOGLIN&&m!==P.LOGLOG)u=this.computeStatistics(a,h,d,this.userData.isLogModeRegression,m);else{var g=this._logDifference.getConcreteTree(t),y=this._logLhs.getConcreteTree(t);f=S(e,g,this.userData.regressionParamters,n),h=this.getRHSModel(t,f),d=w(this._difference,t,f);var v=w(this._logDifference,t,f);u=this.computeStatistics(y,h,v,this.userData.isLogModeRegression,m)}var b=this.chooseResidualVariable(r),x=this.getResidualSuggestionId(b,i);return this.userData.residualVariable=s.identifierToLatex(b),c(f,d,u,h.substituted,{isModelValid:h.isValid,residualVariable:b,residualSuggestionId:x,shouldSuggestLogMode:m!==P.NONE})},e.tryOptimize=function(){try{return this.optimize.apply(this,arguments)}catch(e){if(e instanceof u)return e;throw e}},e.exportTo=function(e,t,r){if(!t.isError){for(var n in t.parameters)t.parameters.hasOwnProperty(n)&&(e.assignmentForbidden(n)||(r[n]=r[n]?o.multiplyDefined(n):t.parameters[n]));e.assignmentForbidden(t.residualVariable)||(r[t.residualVariable]=t.residuals)}},e.getSliderVariables=function(){return[]}})}),define("math/parsenode/image",["require","pjs","./base"],function(e){var t=e("pjs"),r=e("./base");return t(r,function(e,t,r,n){e.isImage=!0,e.init=function(e,r){t.init.call(this),this.center=e.center,this.radianAngle=e.radianAngle,this.width=e.width,this.height=e.height,this.moveStrategy=r,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height)}})}),define("math/parsenode/slider",["require","pjs","./assignment","./identifier"],function(e){var t=e("pjs"),r=e("./assignment"),n=e("./identifier");return t(r,function(e,t,r,i){e.isSlider=!0,e.init=function(e,r){t.init.call(this,n(e._symbol),e._expression),this.setInputSpan(e._inputSpan),this.sliderAssignment=e,this.sliderMin=r.sliderMin,this.sliderMax=r.sliderMax,this.sliderStep=r.sliderStep,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)},e.shouldPromoteToSlider=function(e){return!1}})}),define("math/parsenode/table",["require","pjs","./base"],function(e){var t=e("pjs"),r=e("./base");return t(r,function(e,t){e.init=function(e){t.init.call(this),this.columns=e,this._exports=[],this.mergeDependencies.apply(this,e);for(var r=0;r<e.length;r++)Array.prototype.push.apply(this._exports,e[r].getExports())},e.exportPenalty=1,e.isTable=!0,e.exportTo=function(e,t,r){for(var n=0;n<this.columns.length;n++){var i=this.columns[n].getExports();if(i.length){var a=i[0];e.assignmentForbidden(a)||r[a]||(t.isError?r[a]=t:this.columns[n].exportTo(e,t.columns[n],r))}}},e.getAllIds=function(){return this.columns.map(function(e){return e.header.userData.id})}})}),define("math/parsenode/tablecolumn",["require","pjs","./base","./list","./constant","./identifier"],function(e){var t=e("pjs"),r=e("./base"),n=e("./list"),i=e("./constant"),a=e("./identifier");return t(r,function(e,t){function s(e){return e.isError?i(NaN):e}e.init=function(e,r,n){t.init.call(this),this.header=e,this.length=r,this.values=n,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()},e.registerDependencies=function(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)},e.computeExports=function(){return this.header instanceof a?[this.header._symbol]:[]},e.isDiscrete=function(e){return 1!==this.header.getDependencies().length||1!==e.header.getDependencies().length||this.header.getDependencies()[0]!==e.header.getDependencies()[0]},e._exportSymbolsTo=function(e,t,i){if(e.length){var a=e[0];if(t.isError)i[a]=t;else try{i[a]=n(t.values.map(s))}catch(e){if(!(e instanceof r))throw e;i[a]=e}}},e.exportTo=function(e,t,r){var n=this.getLegalExports(e);this._exportSymbolsTo(n,t,r)},e.exportToLocal=function(e,t){this._exportSymbolsTo(this.getExports(),e,t)}})}),define("math/parsenode/solvedequation",["require","pjs","./base"],function(e){var t=e("pjs"),r=e("./base");return t(r,function(e,t){e.init=function(e,r){t.init.call(this),this._symbol=e,this._expression=r,this.mergeDependencies(r)},e.getCompiledFunction=function(){return this._expression.getCompiledFunction.apply(this._expression,arguments)},e.getCompiledDerivative=function(){return this._expression.getCompiledDerivative.apply(this._expression,arguments)},e.evaluate=function(){return this._expression.evaluate.apply(this._expression,arguments)}})}),define("parsenodes",["require","math/parsenode/expressionTypes","math/parsenode/base","math/parsenode/expression","math/parsenode/scalarexpression","math/parsenode/error","math/parsenode/constant","math/parsenode/mixednumber","math/parsenode/identifier","math/parsenode/ans","math/parsenode/freevariable","math/parsenode/dummyindex","math/parsenode/list","math/parsenode/range","math/parsenode/broadcast","math/parsenode/listaccess","math/parsenode/orderedpair","math/parsenode/movablepoint","math/parsenode/orderedpairaccess","math/parsenode/polygon","math/parsenode/basecomparator","math/parsenode/comparator","math/parsenode/doubleinequality","math/parsenode/repeatedoperator","math/parsenode/sum","math/parsenode/product","math/parsenode/integral","math/parsenode/functioncall","math/parsenode/functionexponent","math/parsenode/functionfactorial","math/parsenode/prime","math/parsenode/piecewise","math/parsenode/derivative","math/parsenode/builtinfunction","math/parsenode/nativefunction","math/parsenode/typedfunction","math/parsenode/reducerfunction","math/parsenode/parametrizedreducerfunction","math/parsenode/doublereducerfunction","math/parsenode/toplevelfunction","math/parsenode/distribution","math/parsenode/histogram","math/parsenode/dotplot","math/parsenode/boxplot","math/parsenode/assignment","math/parsenode/functiondefinition","math/parsenode/equation","math/parsenode/regression","math/parsenode/image","math/parsenode/slider","math/parsenode/table","math/parsenode/tablecolumn","math/parsenode/solvedequation","math/parsenode/optimizedregression"],function(e){var t=e("math/parsenode/expressionTypes"),r={Base:e("math/parsenode/base"),Expression:e("math/parsenode/expression"),ScalarExpression:e("math/parsenode/scalarexpression"),Error:e("math/parsenode/error"),Constant:e("math/parsenode/constant"),MixedNumber:e("math/parsenode/mixednumber"),Identifier:e("math/parsenode/identifier"),Ans:e("math/parsenode/ans"),FreeVariable:e("math/parsenode/freevariable"),DummyIndex:e("math/parsenode/dummyindex"),List:e("math/parsenode/list"),Range:e("math/parsenode/range"),Broadcast:e("math/parsenode/broadcast"),ListAccess:e("math/parsenode/listaccess"),OrderedPair:e("math/parsenode/orderedpair"),MovablePoint:e("math/parsenode/movablepoint"),OrderedPairAccess:e("math/parsenode/orderedpairaccess"),Polygon:e("math/parsenode/polygon"),BaseComparator:e("math/parsenode/basecomparator"),Comparator:e("math/parsenode/comparator"),DoubleInequality:e("math/parsenode/doubleinequality"),RepeatedOperator:e("math/parsenode/repeatedoperator"),Sum:e("math/parsenode/sum"),Product:e("math/parsenode/product"),Integral:e("math/parsenode/integral"),FunctionCall:e("math/parsenode/functioncall"),FunctionExponent:e("math/parsenode/functionexponent"),FunctionFactorial:e("math/parsenode/functionfactorial"),Prime:e("math/parsenode/prime"),Piecewise:e("math/parsenode/piecewise"),Derivative:e("math/parsenode/derivative"),BuiltInFunction:e("math/parsenode/builtinfunction"),NativeFunction:e("math/parsenode/nativefunction"),TypedFunction:e("math/parsenode/typedfunction"),ReducerFunction:e("math/parsenode/reducerfunction"),ParametrizedReducerFunction:e("math/parsenode/parametrizedreducerfunction"),DoubleReducerFunction:e("math/parsenode/doublereducerfunction"),TopLevelFunction:e("math/parsenode/toplevelfunction"),Distribution:e("math/parsenode/distribution"),Histogram:e("math/parsenode/histogram"),DotPlot:e("math/parsenode/dotplot"),BoxPlot:e("math/parsenode/boxplot"),Assignment:e("math/parsenode/assignment"),FunctionDefinition:e("math/parsenode/functiondefinition"),Equation:e("math/parsenode/equation"),Regression:e("math/parsenode/regression"),Image:e("math/parsenode/image"),Slider:e("math/parsenode/slider"),Table:e("math/parsenode/table"),TableColumn:e("math/parsenode/tablecolumn"),SolvedEquation:e("math/parsenode/solvedequation"),OptimizedRegression:e("math/parsenode/optimizedregression")};for(var n in t)r[n]=t[n];for(var i in r)r.hasOwnProperty(i)&&"Comparator"!==i&&"BuiltInFunction"!==i&&(r[i].prototype.type=i);for(var a in r.Comparator)r.Comparator.hasOwnProperty(a)&&(r.Comparator[a].prototype.type="Comparator[\'"+a+"\']");for(var s in r.BuiltInFunction)r.BuiltInFunction.hasOwnProperty(s)&&(r.BuiltInFunction[s].prototype.type="BuiltInFunction[\'"+s+"\']");return r}),define("math/parser/char-codes",["require","exports"],function(e,t){"use strict";function r(e){return 48<=e&&e<=57}function n(e){return 97<=e&&e<=122}function i(e){return 65<=e&&e<=90}function a(e){return n(e)||i(e)}function s(e){return 92===e}function o(e){return 46===e}function u(e){return 39===e}function c(e){if(9<=e&&e<=13)return!0;if(8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isDigit=r,t.isLowerCaseLetter=n,t.isUpperCaseLetter=i,t.isLetter=a,t.isBackslash=s,t.isDot=o,t.isSingleQuote=u,t.isWhitespace=c}),define("math/parser/latex-lexer",["require","exports","./char-codes","./input-span"],function(e,t,r,n){"use strict";function i(e,t){return n.joinSpans(e.token.span,t.prevSpan)}function a(e,t,r){return{type:e,span:t,val:r}}function s(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function o(e){return u(e,0,n.emptySpanAt(e,0))}function u(e,t,n){for(;r.isWhitespace(e.charCodeAt(t));)t+=1;var i=d(e,t);return s(e,n,t,i)}function c(e){return u(e.input,e.token.span.end,e.token.span)}function l(e){return e.token}function p(e,t){if(l(e).type!==t)throw"Parse Error: expected "+t+".";return c(e)}function f(e,t){return l(e).type===t}function h(e){return e.pos>=e.input.length}function d(e,t){var i=t;if(t>=e.length)return a("End",n.emptySpanAt(e,t),"");var s=e.charCodeAt(t);if(r.isDigit(s)){var o=n.Span(e,i,t+1);return a("Digit",o,e.charAt(i))}if(r.isLetter(s)){var o=n.Span(e,i,t+1);return a("Letter",o,e.charAt(i))}if(r.isBackslash(s)){if(t+=1,r.isLetter(e.charCodeAt(t))){for(;r.isLetter(e.charCodeAt(t));)t+=1;var o=n.Span(e,i,t),u=n.slice(o),c=m[u]||"Cmd";return a(c,o,u)}t+=1;var o=n.Span(e,i,t),u=n.slice(o);return a("EscapedSymbol",o,u)}if(r.isSingleQuote(s)){for(t+=1;r.isSingleQuote(e.charCodeAt(t));)t+=1;if("^"===e.charAt(t)){t+=1;var o=n.Span(e,i,t),u=n.slice(o);return a("Primes^",o,u)}var o=n.Span(e,i,t),u=n.slice(o);return a("Primes",o,u)}var o=n.Span(e,i,t+1),u=e.charAt(i),c=g[u]||"Symbol";return a(c,o,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.spanStates=i,t.LatexToken=a,t.lex=o,t.advance=c,t.peek=l,t.eat=p,t.isAt=f,t.isDone=h;var m={"\\\\left":"Left","\\\\right":"Right","\\\\sqrt":"Sqrt","\\\\frac":"Frac","\\\\operatorname":"OperatorName"},g={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"}}),define("math/parser/latex-node",["require","exports"],function(e,t){"use strict";function r(e,t){return{type:"Group",span:e,args:t}}function n(e,t,r){return{type:"Sqrt",span:e,optArg:t,arg:r}}function i(e,t,r){return{type:"Frac",span:e,num:t,den:r}}function a(e,t,r,n){return{type:"SupSub",span:e,sup:t,sub:r,nprimes:n}}function s(e,t,r,n){return{type:"LeftRight",span:e,left:t,right:r,arg:n}}function o(e,t){return{type:"OperatorName",span:e,arg:t}}function u(e,t){return{type:"Symbol",span:e,val:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.Group=r,t.Sqrt=n,t.Frac=i,t.SupSub=a,t.LeftRight=s,t.OperatorName=o,t.Symbol=u}),define("math/parser/latex-parser",["require","exports","./latex-lexer","./input-span","./latex-node"],function(e,t,r,n,i){"use strict";function a(e){switch(e){case"Frac":return 2;case"^":case"_":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":return 1;default:return 0}}function s(e){var t=u(r.lex(e),!1),i=t.state,a=t.tree;if(!r.isDone(i))throw"Parse error: unexpected "+n.slice(r.peek(i).span)+".";return a}function o(e,t){return{state:e,tree:t}}function u(e,t){var n,a=e,s=[];e:for(;!r.isDone(e);){var u=r.peek(e);switch(u.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":case"]":if("]"===u.type&&t)break e;var l=void 0;if(n=c(e),e=n.state,l=n.tree,"Group"===l.type)for(var p=0,f=l.args;p<f.length;p++){var h=f[p];s.push(h)}else s.push(l);break;case"}":case"Right":case"End":break e;default:var d=u.type;throw"Unexpected token type "+d+"."}}var m=r.spanStates(a,e);return o(e,i.Group(m,s))}function c(e){var t,n=r.peek(e);switch(n.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return e=r.advance(e),o(e,n);case"[":case"]":return e=r.advance(e),o(e,i.Symbol(n.span,n.val));case"{":e=r.advance(e);var a=void 0;return t=u(e,!1),e=t.state,a=t.tree,e=r.eat(e,"}"),o(e,a);case"^":case"_":case"Primes":case"Primes^":return d(e);case"Left":return h(e);case"Frac":return f(e);case"Sqrt":return p(e);case"OperatorName":return l(e);case"}":case"Right":throw"Parse Error: unexpected "+n.val+".";case"End":throw"Parse Error: unexpected end.";default:var s=n.type;throw"Unexpected token type "+s+"."}}function l(e){var t,n=e,a=r.peek(e);e=r.eat(e,"OperatorName");var s;t=m(e,a),e=t.state,s=t.tree;var u=r.spanStates(n,e);return o(e,i.OperatorName(u,s))}function p(e){var t,n,a=e,s=r.peek(e);e=r.eat(e,"Sqrt");var u;r.isAt(e,"[")&&(t=g(e),e=t.state,u=t.tree);var c;n=m(e,s),e=n.state,c=n.tree;var l=r.spanStates(a,e);return o(e,i.Sqrt(l,u,c))}function f(e){var t,n,a=e,s=r.peek(e);e=r.eat(e,"Frac");var u;t=m(e,s),e=t.state,u=t.tree;var c;n=m(e,s),e=n.state,c=n.tree;var l=r.spanStates(a,e);return o(e,i.Frac(l,u,c))}function h(e){var t,n=e;e=r.eat(e,"Left");var a=r.peek(e);e=r.advance(e);var s;t=u(e,!1),e=t.state,s=t.tree,e=r.eat(e,"Right");var c=r.peek(e);e=r.advance(e);var l=r.spanStates(n,e);return o(e,i.LeftRight(l,a,c,s))}function d(e){var t,n,a,s,u,c=e,l=0;e:for(;!r.isDone(e);){var p=r.peek(e);switch(p.type){case"^":if(e=r.advance(e),s)throw"Parse Error: double superscript.";t=m(e,p),e=t.state,s=t.tree;break;case"_":if(e=r.advance(e),u)throw"Parse Error: double subscript.";n=m(e,p),e=n.state,u=n.tree;break;case"Primes":if(e=r.advance(e),l>0)throw"Parse Error: double primes.";l=p.val.length;break;case"Primes^":if(e=r.advance(e),l>0)throw"Parse Error: double primes.";if(s)throw"Parse Error: double superscript";l=p.val.length-1,a=m(e,p),e=a.state,s=a.tree;break;default:break e}}var f=r.spanStates(c,e);return o(e,i.SupSub(f,s,u,l))}function m(e,t){var s,u,l=a(t.type);if(l<=0)throw new Error("Programming Error: greediness must be greater than 0.");var p=a(r.peek(e).type);if(p>0&&p<=l){var f=n.slice(t.span),h=n.slice(r.peek(e).span);throw"Parse Error: can\'t use "+h+" as argument of "+f+". Use {}."}return s=c(e),e=s.state,u=s.tree,"Group"!==u.type&&(u=i.Group(u.span,[u])),o(e,u)}function g(e){var t;e=r.eat(e,"[");var n;return t=u(e,!0),e=t.state,n=t.tree,e=r.eat(e,"]"),o(e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=s}),define("math/parser/command-aliases",["require","exports","./char-codes"],function(e,t,r){"use strict";function n(e){for(var t=0;r.isBackslash(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),i[e]||e}Object.defineProperty(t,"__esModule",{value:!0});var i={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",ttest:"TTest",Ttest:"TTest",tscore:"TScore",Tscore:"TScore",zscore:"ZScore",Zscore:"ZScore"};t.translateCmd=n}),define("math/parser/surface-node",["require","exports","./command-aliases"],function(e,t,r){"use strict";function n(e,t){return{type:"Equals",span:e,args:t}}function i(e,t,r){return{type:"Inequality",span:e,symbol:t,args:r}}function a(e,t,r){return{type:"TrailingInequalityPiece",span:e,symbol:t,args:r}}function s(e,t,r){return{type:"InequalityChain",span:e,first:t,chain:r}}function o(e,t){return{type:"Tilde",span:e,args:t}}function u(e,t){return{type:"Pos",span:e,args:t}}function c(e,t){return{type:"Neg",span:e,args:t}}function l(e,t){return{type:"Add",span:e,args:t}}function p(e,t){return{type:"Sub",span:e,args:t}}function f(e,t){return{type:"Mul",span:e,args:t}}function h(e,t){return{type:"Div",span:e,args:t}}function d(e,t){return{type:"Bang",span:e,args:t}}function m(e,t){return{type:"Call",span:e,args:t}}function g(e,t){return{type:"ImplicitCall",span:e,args:t}}function y(e,t){return{type:"Index",span:e,args:t}}function v(e,t){return{type:"Paren",span:e,args:t}}function b(e,t){return{type:"List",span:e,args:t}}function x(e,t){return{type:"Pipes",span:e,args:t}}function _(e,t){return{type:"Subscript",span:e,args:t}}function M(e,t){return{type:"Superscript",span:e,args:t}}function S(e,t,r){return{type:"Prime",span:e,nprimes:t,args:r}}function E(e,t){return{type:"Seq",span:e,args:t}}function w(e,t){return{type:"Sqrt",span:e,args:t}}function T(e,t){return{type:"Nthroot",span:e,args:t}}function D(e,t){return{type:"Frac",span:e,args:t}}function I(e,t){return{type:"Derivative",span:e,args:t}}function C(e,t){return{type:"Integral",span:e,args:t}}function P(e,t){return{type:"EmptyIntegral",span:e,args:t}}function O(e,t){return{type:"Sum",span:e,args:t}}function N(e,t){return{type:"Product",span:e,args:t}}function A(e,t){return{type:"Piecewise",span:e,args:t}}function L(e){return{type:"EmptyPiecewise",span:e}}function q(e,t){return{type:"Colon",span:e,args:t}}function F(e,t){return{type:"Ellipsis",span:e,args:t}}function k(e,t){return{type:"PercentOf",span:e,args:t}}function V(e,t){return{type:"Juxt",span:e,args:t}}function B(e,t){return{type:"Letter",span:e,val:t}}function R(e,t){return{type:"Decimal",span:e,val:t}}function j(e,t){return{type:"Cmd",span:e,val:r.translateCmd(t)}}function z(e,t){return{type:"Alphanumeric",span:e,val:t}}function G(e,t,r,n){return{type:"MixedNumber",span:e,whole:t,num:r,den:n}}function U(e){if("Subscript"===e.type){if("Alphanumeric"!==e.args[1].type)return!1;e=e.args[0]}switch(e.type){case"Cmd":return!0;case"Letter":return!0;default:return!1}}function W(e){return"Superscript"===e.type&&U(e.args[0])}function Y(e,t){if("Letter"!==e.type||"d"!==e.val)return!1;if("Juxt"!==t.type)return!1;var r=t.args,n=r[0],i=r[1];return"Letter"===n.type&&"d"===n.val&&U(i)}function X(e){return"Seq"===e.type?e.args:[e]}Object.defineProperty(t,"__esModule",{value:!0}),t.Equals=n,t.Inequality=i,t.TrailingInequalityPiece=a,t.InequalityChain=s,t.Tilde=o,t.Pos=u,t.Neg=c,t.Add=l,t.Sub=p,t.Mul=f,t.Div=h,t.Bang=d,t.Call=m,t.ImplicitCall=g,t.Index=y,t.Paren=v,t.List=b,t.Pipes=x,t.Subscript=_,t.Superscript=M,t.Prime=S,t.Seq=E,t.Sqrt=w,t.Nthroot=T,t.Frac=D,t.Derivative=I,t.Integral=C,t.EmptyIntegral=P,t.Sum=O,t.Product=N,t.Piecewise=A,t.EmptyPiecewise=L,t.Colon=q,t.Ellipsis=F,t.PercentOf=k,t.Juxt=V,t.Letter=B,t.Decimal=R,t.Cmd=j,t.Alphanumeric=z,t.MixedNumber=G,t.isIdentifier=U,t.isSuperscriptedIdentifier=W,t.isDerivative=Y,t.unwrapSeq=X}),define("math/parser/surface-node-error",["require","exports"],function(e,t){"use strict";function r(e,t){return{type:"Err",span:e,error:t}}function n(){return{type:"UnexpectedParseError"}}function i(){return{type:"EmptyInput"}}function a(){return{type:"EmptyGroup"}}function s(){return{type:"EmptySubscript"}}function o(){return{type:"EmptySuperscript"}}function u(){return{type:"EmptyRadical"}}function c(){return{type:"EmptySquareBracket"}}function l(){return{type:"EmptyPipe"}}function p(){return{type:"EmptyRadicand"}}function f(){return{type:"UnexpectedEnd"}}function h(e){return{type:"BinaryOperatorMissingRight",val:e}}function d(e){return{type:"BinaryOperatorMissingLeft",val:e}}function m(e){return{type:"UnaryOperatorMissingRight",val:e}}function g(e){return{type:"UnaryOperatorMissingLeft",val:e}}function y(e,t){return{type:"MissingCloseDelimiter",open:e,close:t}}function v(e,t){return{type:"UnexpectedCloseDelimiter",open:e,close:t}}function b(){return{type:"UnexpectedDifferential"}}function x(e){return{type:"UnrecognizedSymbol",val:e}}function _(e){return{type:"InvalidOperatorName",val:e}}function M(e){return{type:"InvalidSubscript",val:e}}function S(e){return{type:"UnexpectedSubscript",base:e}}function E(e){return{type:"FunctionMissingArgument",val:e}}function w(){return{type:"PercentMissingOf"}}function T(){return{type:"PrimeWithoutParen"}}function D(){return{type:"SuperscriptWithPrime"}}function I(){return{type:"UnexpectedPrime"}}function C(){return{type:"SumMissingBound"}}function P(){return{type:"ProductMissingBound"}}function O(){return{type:"MissingBound"}}function N(){return{type:"IntegralMissingBound"}}function A(){return{type:"SumMissingBody"}}function L(){return{type:"ProductMissingBody"}}function q(){return{type:"IntegralMissingBody"}}function F(){return{type:"DerivativeMissingBody"}}function k(){return{type:"IntegralMissingDifferential"}}function V(){return{type:"DifferentialWithSuperscript"}}function B(){return{type:"FractionMissingNumerator"}}function R(){return{type:"FractionMissingDenominator"}}function j(){return{type:"FractionEmpty"}}Object.defineProperty(t,"__esModule",{value:!0}),t.Err=r,t.UnexpectedParseError=n,t.EmptyInput=i,t.EmptyGroup=a,t.EmptySubscript=s,t.EmptySuperscript=o,t.EmptyRadical=u,t.EmptySquareBracket=c,t.EmptyPipe=l,t.EmptyRadicand=p,t.UnexpectedEnd=f,t.BinaryOperatorMissingRight=h,t.BinaryOperatorMissingLeft=d,t.UnaryOperatorMissingRight=m,t.UnaryOperatorMissingLeft=g,t.MissingCloseDelimiter=y,t.UnexpectedCloseDelimiter=v,t.UnexpectedDifferential=b,t.UnrecognizedSymbol=x,t.InvalidOperatorName=_,t.InvalidSubscript=M,t.UnexpectedSubscript=S,t.FunctionMissingArgument=E,t.PercentMissingOf=w,t.PrimeWithoutParen=T,t.SuperscriptWithPrime=D,t.UnexpectedPrime=I,t.SumMissingBound=C,t.ProductMissingBound=P,t.MissingBound=O,t.IntegralMissingBound=N,t.SumMissingBody=A,t.ProductMissingBody=L,t.IntegralMissingBody=q,t.DerivativeMissingBody=F,t.IntegralMissingDifferential=k,t.DifferentialWithSuperscript=V,t.FractionMissingNumerator=B,t.FractionMissingDenominator=R,t.FractionEmpty=j}),define("math/parser/expression-token-tables",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={"+":!0,"-":!0,"*":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\\\{":!0,"\\\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"~":!0,"%":!0,Letter:!0,Decimal:!0,Cmd:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0};t.commandTable={"\\\\lt":"<","\\\\gt":">","\\\\le":"<=","\\\\ge":">=","\\\\ldots":"...","\\\\sim":"~","\\\\cdot":"*","\\\\times":"*","\\\\div":"/","\\\\ln":"Ln","\\\\log":"Log","\\\\int":"Int","\\\\sum":"Sum","\\\\prod":"Prod","\\\\backslash":"Err"};for(var n=["sin","cos","tan","cot","sec","csc"],i=0,a=n;i<a.length;i++){var s=a[i];t.commandTable["\\\\"+s]="Trig",t.commandTable["\\\\"+s+"h"]="Trig",t.commandTable["\\\\arc"+s]="Trig",t.commandTable["\\\\arc"+s+"h"]="Trig"}t.symbolTable={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~"},t.escapedSymbolTable={"\\\\{":"\\\\{","\\\\}":"\\\\}","\\\\%":"%"},t.leftTable={"|":"(|","\\\\{":"\\\\{","[":"[","(":"("},t.rightTable={"|":"|)","\\\\}":"\\\\}","]":"]",")":")"},t.allTokenTypes=Object.keys(r)}),define("math/parser/expression-lexer",["require","exports","./expression-token-tables","./input-span","./input-span","./surface-node"],function(e,t,r,n,i,a){"use strict";function s(e,t,r,n,i,a,s){return{input:e,prevSpan:t,startIndex:r,endIndex:n,token:i,mode:a,parent:s}}function o(e,t){return n.joinSpans(e.token.span,t.prevSpan)}function u(e,t){return n.joinSpans(e,t.prevSpan)}function c(e){return n.emptySpanAt(e.token.span.input,e.token.span.start)}function l(e,t){return{type:"Differential",span:e,val:t}}function p(e,t,r){return{type:e,span:t,val:r}}function f(e){var t=n.emptySpanAt(e.span.input,e.span.start),r=void 0,i=void 0;return h(e,0,t,i,r)}function h(e,t,n,i,a){var o=e.args;if(t>o.length&&a)return m(a,n);t=I(o,t);var u=S(e,t,i),c=u.token,l=u.endIndex;if("End"===c.type&&a){var f=a.input.args[a.startIndex];if("LeftRight"===f.type){var h=f.right,d=r.rightTable[h.val]||"Err",g=p(d,h.span,h.val);return s(e,n,t,l,g,i,a)}}else"Int"===c.type?i=y(i):"Differential"===c.type&&(i=v(i));return s(e,n,t,l,c,i,a)}function d(e){var t=e.input.args[e.startIndex],r=e.token.span;return t&&"LeftRight"===t.type?h(t.arg,0,r,e.mode,e):m(e,r)}function m(e,t){var r=e.input,n=e.endIndex,i=e.mode,a=e.parent;return h(r,n+1,t,i,a)}function g(e){return e.token}function y(e){return{type:"integral",parent:e}}function v(e){if(!e||"integral"!==e.type)throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function b(e,t){return g(e).type===t}function x(e){return e.startIndex>=e.input.args.length}function _(e,t){return t.token.span.start>e.token.span.start}function M(e,t){return{token:t,endIndex:e}}function S(e,t,i){var a=e.args;if(t>=a.length){var s=n.emptySpanAt(e.span.input,e.span.end);return M(t,p("End",s,""))}var o=e.args[t];switch(o.type){case"Sqrt":case"Frac":case"SupSub":return M(t,o);case"Letter":if(!i||"integral"!==i.type)return M(t,o);if("d"!=o.val)return M(t,o);var u=S(e,t+1,i),c=u.endIndex,f=u.token;if("Letter"===f.type||"Cmd"===f.type){var h=l(n.joinSpans(o.span,f.span),f.val);return M(c,h)}return M(t,o);case"LeftRight":var d=o.left,m=r.leftTable[d.val]||"Err",g=n.joinSpans(o.span,d.span);return M(t,p(m,g,d.val));case"OperatorName":for(var y=[],v=0,b=o.arg.args;v<b.length;v++){var x=b[v];if("Letter"!==x.type)return M(t,p("Err",o.span,n.slice(o.arg.span)));y.push(x.val)}var _="\\\\"+y.join(""),T=r.commandTable[_]||"Cmd";return M(t,p(T,o.span,_));case"Cmd":var D=r.commandTable[o.val]||"Cmd";return M(t,p(D,o.span,o.val));case"EscapedSymbol":var I=r.escapedSymbolTable[o.val]||"Err";return M(t,p(I,o.span,o.val));case"Symbol":if(C(o))return E(e,t);var P=r.symbolTable[o.val]||"Err";return M(t,p(P,o.span,o.val));case"Digit":return w(e,t);default:var O=o;throw"Unexpected atom "+O.type+"."}}function E(e,t){var i=e.args[t];if("Symbol"!==i.type||"."!==i.val)throw new Error("Programming Error: expected \'.\'");if(t+2<e.args.length&&C(e.args[t+1])&&C(e.args[t+2])){var a=n.joinSpans(i.span,e.args[t+2].span);return M(t+2,p("...",a,n.slice(a)))}if(t+1<e.args.length&&"Digit"===e.args[t+1].type)return w(e,t);var s=r.symbolTable[i.val]||"Err";return M(t,p(s,i.span,i.val))}function w(e,t){var r=T(e,t);if(r)return r;for(var i=e.args,a=e.args[t].span,s=[],o=!1,u=!1;t<i.length;t++){var c=i[t];if("Digit"===c.type)o=!0,s.push(c.val);else{if(u||!C(c))break;if(t+1<i.length&&C(e.args[t+1]))break;u=!0,s.push(".")}}if(!o)throw new Error("Programming Error: decimals must have at least one digit.");var l=n.joinSpans(a,e.args[t-1].span);return M(t-1,p("Decimal",l,s.join("")))}function T(e,t){for(var r=e.args,i=r[t].span,s=[];t<r.length;t++){var o=r[t];if("Digit"!==o.type)break;s.push(o.val)}if(t=I(r,t),!(t>=r.length)){var u=r[t];if("Frac"===u.type){for(var c=[],l=[],p=0,f=u.num.args;p<f.length;p++){var o=f[p];if("Digit"!==o.type)return;c.push(o.val)}for(var h=0,d=u.den.args;h<d.length;h++){var o=d[h];if("Digit"!==o.type)return;l.push(o.val)}var m=n.joinSpans(i,u.span);return M(t,a.MixedNumber(m,s.join(""),c.join(""),l.join("")))}}}function D(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return"\\\\space"===e.val;case"EscapedSymbol":return"\\\\ "===e.val||"\\\\:"===e.val||"\\\\,"===e.val||"\\\\;"===e.val;default:var t=e;throw"Unexpected atom "+t.type+"."}}function I(e,t){for(;t<e.length&&D(e[t]);)t+=1;return t}function C(e){return"Symbol"===e.type&&"."===e.val}Object.defineProperty(t,"__esModule",{value:!0}),t.Span=i.Span,t.spanStates=o,t.joinState=u,t.emptySpanAtState=c,t.lex=f,t.lexAt=h,t.advance=d,t.peek=g,t.beginIntegral=y,t.endIntegral=v,t.isAt=b,t.isDone=x,t.didAdvance=_}),define("math/parser/precspec",["require","exports","./expression-token-tables"],function(e,t,r){"use strict";function n(e){return{type:"initial",tokenType:e}}function i(e){return{type:"l",tokenType:e}}function a(e){return{type:"r",tokenType:e}}function s(e){return{type:"la",tokenType:e}}function o(e){return{type:"ra",tokenType:e}}function u(e,t){for(var n=0,i=r.allTokenTypes;n<i.length;n++){var a=i[n];if(void 0===t[a])throw new Error("Programming Error: token "+a+" must be a assigned a "+(e+" precedence"))}}function c(e,t,r,n){if(void 0!==t[r])throw new Error("Programming Error: duplicate "+e+" entry for token "+r+".");t[r]=n}function l(e){function t(e){return s[e]}function r(e){return a[e]}function n(e){var r=i[e];return void 0===r?t(e):r}for(var i={},a={},s={},o=0;o<e.length;o++)for(var l=e[o],p=0,f=l;p<f.length;p++){var h=f[p],d=h.type,m=h.tokenType;switch(d){case"initial":c("initial",i,m,o);break;case"l":c("left",a,m,o);break;case"r":c("right",s,m,o);break;case"la":c("left",a,m,o),c("right",s,m,o);break;case"ra":c("left",a,m,o),c("right",s,m,o-1)}}return u("left",a),u("right",s),{rightPrec:t,leftPrec:r,initialPrec:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.initial=n,t.l=i,t.r=a,t.la=s,t.ra=o,t.precSpec=l}),define("math/parser/expression-parser",["require","exports","./surface-node","./surface-node-error","./input-span","./expression-lexer","./precspec"],function(e,t,r,n,i,a,s){"use strict";function o(e){var t=u(e);return"Err"===t.type&&"EmptyGroup"===t.error.type?n.Err(t.span,n.EmptyInput()):t}function u(e){var t=a.lex(e);if(a.isDone(t))return n.Err(a.spanStates(t,t),n.EmptyGroup());var r=l(t,0),i=r.state,s=r.tree;return"Err"===s.type||a.isDone(i)?s:E(i).tree}function c(e,t){return{state:e,tree:t}}function l(e,t){var r,n,i,s=e;if(r=f(e),e=r.state,i=r.tree,"Err"===i.type)return c(e,i);if(!a.didAdvance(s,e))throw new Error("Programming Error: parseInitial did not advance state.");for(;!a.isDone(e);){var o=void 0;if(o=a.isAt(e,"(")&&!d(i)?I("("):D(a.peek(e).type),t>=o)break;var u=e;if(n=h(e,i),e=n.state,i=n.tree,"Err"===i.type)return c(e,i);if(!a.didAdvance(u,e))throw new Error("Programming Error: parseSuccessor did not advance state.")}return c(e,i)}function p(e){return"UnexpectedDifferential"===e.type||"UnexpectedCloseDelimiter"===e.type||"UnexpectedEnd"===e.type||"BinaryOperatorMissingLeft"===e.type}function f(e){var t,i,s,o,f,h,d,m,g,v,w,T,I,P,O,N,A,L,q,F=e,k=a.peek(e),V=C(k.type);switch(k.type){case"+":if(e=a.advance(e),t=l(e,V),e=t.state,q=t.tree,"Err"===q.type){if(!p(q.error))return c(e,q);var B=a.spanStates(F,e),R=n.Err(B,n.UnaryOperatorMissingRight(k.type));return c(e,R)}return c(e,r.Pos(a.spanStates(F,e),[q]));case"-":if(e=a.advance(e),i=l(e,V),e=i.state,q=i.tree,"Err"===q.type){if(!p(q.error))return c(e,q);var B=a.spanStates(F,e),R=n.Err(B,n.UnaryOperatorMissingRight(k.type));return c(e,R)}return c(e,r.Neg(a.spanStates(F,e),[q]));case"(":return _(e);case"\\\\{":return e=a.advance(e),a.isAt(e,"\\\\}")?(e=a.advance(e),c(e,r.EmptyPiecewise(a.spanStates(F,e)))):(s=l(e,V),e=s.state,q=s.tree,o=S(F,e,q,"\\\\{","\\\\}"),e=o.state,q=o.tree,"Err"===q.type?c(e,q):c(e,r.Piecewise(a.spanStates(F,e),[q])));case"[":if(e=a.advance(e),a.isAt(e,"]")){e=a.advance(e);var B=a.spanStates(F,e);return c(e,n.Err(B,n.EmptySquareBracket()))}return f=l(e,V),e=f.state,q=f.tree,h=S(F,e,q,"[","]"),e=h.state,q=h.tree,"Err"===q.type?c(e,q):c(e,r.List(a.spanStates(F,e),[q]));\ncase"(|":if(e=a.advance(e),a.isAt(e,"|)")){e=a.advance(e);var B=a.spanStates(F,e);return c(e,n.Err(B,n.EmptyPipe()))}return d=l(e,V),e=d.state,q=d.tree,m=S(F,e,q,"(|","|)"),e=m.state,q=m.tree,"Err"===q.type?c(e,q):c(e,r.Pipes(a.spanStates(F,e),[q]));case"Frac":e=a.advance(e);var j=u(k.num),z=u(k.den);if("Err"===j.type&&"EmptyGroup"===j.error.type&&"Err"===z.type&&"EmptyGroup"===z.error.type){var B=a.spanStates(F,e),R=n.Err(B,n.FractionEmpty());return c(e,R)}if("Err"===j.type&&"EmptyGroup"===j.error.type){var B=a.spanStates(F,e),R=n.Err(B,n.FractionMissingNumerator());return c(e,R)}if("Err"===z.type&&"EmptyGroup"===z.error.type){var B=a.spanStates(F,e),R=n.Err(B,n.FractionMissingDenominator());return c(e,R)}if("Err"===j.type)return c(e,j);if("Err"===z.type)return c(e,z);if(r.isDerivative(j,z)&&"Juxt"===z.type){var G=z.args[1],U=void 0;if(g=l(e,D("*")-1),e=g.state,U=g.tree,"Err"===U.type){if(p(U.error)){var B=a.spanStates(F,e);return c(e,n.Err(B,n.DerivativeMissingBody()))}return c(e,U)}return c(e,r.Derivative(a.spanStates(F,e),[G,U]))}return c(e,r.Frac(a.spanStates(F,e),[j,z]));case"Sqrt":if(e=a.advance(e),k.optArg){var W=u(k.optArg);if("Err"===W.type)return"EmptyGroup"===W.error.type?c(e,n.Err(W.span,n.EmptyRadicand())):c(e,W);var Y=u(k.arg);return"Err"===Y.type?"EmptyGroup"===Y.error.type?c(e,n.Err(Y.span,n.EmptyRadical())):c(e,Y):c(e,r.Nthroot(a.spanStates(F,e),[W,Y]))}var Y=u(k.arg);return"Err"===Y.type?"EmptyGroup"===Y.error.type?c(e,n.Err(Y.span,n.EmptyRadical())):c(e,Y):c(e,r.Sqrt(a.spanStates(F,e),[Y]));case"Trig":case"Ln":e=a.advance(e);var X=r.Cmd(a.spanStates(F,e),k.val),Q=0,H=a.peek(e);if("SupSub"===H.type){if(e=a.advance(e),H.sub){var B=a.spanStates(F,e),R=n.Err(B,n.UnexpectedSubscript(X.val));return c(e,R)}var Z=b(H);if(Z){if("Err"===Z.type)return c(e,Z);X=r.Superscript(a.spanStates(F,e),[X,Z])}Q=H.nprimes}var J=a.isAt(e,"(");if(J){if(v=_(e),e=v.state,q=v.tree,"Err"===q.type)return c(e,q);q=r.Call(a.spanStates(F,e),[X,q.args[0]])}else{if(w=l(e,V-1),e=w.state,q=w.tree,"Err"===q.type)return p(q.error)?c(e,n.Err(a.spanStates(F,e),n.FunctionMissingArgument(k.val))):c(e,q);q=r.ImplicitCall(a.spanStates(F,e),[X,q])}if(Q>0){var B=a.spanStates(F,e);if(!J){var R=n.Err(B,n.PrimeWithoutParen());return c(e,R)}q=r.Prime(B,Q,[q])}return c(e,q);case"Log":e=a.advance(e);var X=r.Cmd(a.spanStates(F,e),k.val),Q=0,$=void 0,Z=void 0,H=a.peek(e);if("SupSub"===H.type&&(e=a.advance(e),$=y(H),Z=b(H),Q=H.nprimes),$&&"Err"===$.type)return c(e,$);if(Z&&"Err"===Z.type)return c(e,Z);var J=a.isAt(e,"(");if(J){if(T=_(e),e=T.state,q=T.tree,"Err"===q.type)return c(e,q);q=q.args[0]}else if(I=l(e,V-1),e=I.state,q=I.tree,"Err"===q.type)return p(q.error)?c(e,n.Err(a.spanStates(F,e),n.FunctionMissingArgument(k.val))):c(e,q);var K=$?r.Seq(a.spanStates(F,e),r.unwrapSeq(q).concat($)):q,ee=$?r.Cmd(a.spanStates(F,e),"\\\\logbase"):X;if(Z&&(ee=r.Superscript(a.spanStates(F,e),[ee,Z])),q=J?r.Call(a.spanStates(F,e),[ee,K]):r.ImplicitCall(a.spanStates(F,e),[ee,K]),Q>0){var B=a.spanStates(F,e);if(!J){var R=n.Err(B,n.PrimeWithoutParen());return c(e,R)}q=r.Prime(B,Q,[q])}return c(e,q);case"Int":e=a.advance(e);var H=a.peek(e);e=a.advance(e);var te=x(H,F,e);if("Err"===te.type)return"MissingBound"===te.error.type?c(e,n.Err(te.span,n.IntegralMissingBound())):c(e,te);var Z=te.sup,$=te.sub,G=void 0;if(a.isAt(e,"Differential"))return P=M(e),e=P.state,G=P.tree,"Err"===G.type?c(e,G):c(e,r.EmptyIntegral(a.spanStates(F,e),[G,$,Z]));if(O=l(e,V),e=O.state,q=O.tree,"Err"===q.type)return p(q.error)?c(e,n.Err(q.span,n.IntegralMissingBody())):c(e,q);var re=q;return a.isAt(e,"Differential")?(N=M(e),e=N.state,G=N.tree,"Err"===G.type?c(e,G):c(e,r.Integral(a.spanStates(F,e),[G,$,Z,re]))):c(e,n.Err(a.spanStates(F,e),n.IntegralMissingDifferential()));case"Sum":e=a.advance(e);var H=a.peek(e);e=a.advance(e);var te=x(H,F,e);if("Err"===te.type)return"MissingBound"===te.error.type?c(e,n.Err(te.span,n.SumMissingBound())):c(e,te);var Z=te.sup,$=te.sub;return A=l(e,V),e=A.state,q=A.tree,"Err"===q.type?p(q.error)?c(e,n.Err(q.span,n.SumMissingBody())):c(e,q):c(e,r.Sum(a.spanStates(F,e),[q,$,Z]));case"Prod":e=a.advance(e);var H=a.peek(e);e=a.advance(e);var te=x(H,F,e);if("Err"===te.type)return"MissingBound"===te.error.type?c(e,n.Err(te.span,n.ProductMissingBound())):c(e,te);var Z=te.sup,$=te.sub;return L=l(e,V),e=L.state,q=L.tree,"Err"===q.type?p(q.error)?c(e,n.Err(q.span,n.ProductMissingBody())):c(e,q):c(e,r.Product(a.spanStates(F,e),[q,$,Z]));case"Cmd":return e=a.advance(e),q=r.Cmd(a.spanStates(F,e),k.val),c(e,q);case"Letter":return e=a.advance(e),q=r.Letter(a.spanStates(F,e),k.val),c(e,q);case"Decimal":return e=a.advance(e),c(e,r.Decimal(a.spanStates(F,e),k.val));case"MixedNumber":return e=a.advance(e),c(e,k);case"*":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"~":case":":case"...":case"%":e=a.advance(e);var B=a.spanStates(F,e),R=n.Err(B,n.BinaryOperatorMissingLeft(k.type));return c(e,R);case"!":case"SupSub":e=a.advance(e);var B=a.spanStates(F,e),R=n.Err(B,n.UnaryOperatorMissingLeft(k.type));return c(e,R);case")":case"\\\\}":case"]":case"|)":case"Differential":return E(e);case"Err":e=a.advance(e);var B=a.spanStates(F,e),R=n.Err(B,n.UnrecognizedSymbol(k.val));return c(e,R);case"End":var B=a.spanStates(F,e),R=n.Err(B,n.UnexpectedEnd());return c(e,R);default:var ne=k;throw"Unexpected token type "+ne.type+"."}}function h(e,t){var i,s,o,u,f,h,d,y,x,M,w,T,D,C,P,O=a.peek(e),N=I(O.type);switch(O.type){case"+":case"-":case"*":case"/":case"=":case"~":case":":if(e=a.advance(e),i=l(e,N),e=i.state,P=i.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}return c(e,m(O.type,a.joinState(t.span,e),[t,P]));case"%":e=a.advance(e);var q=a.peek(e);if("Cmd"!==q.type||"of"!==q.val&&"\\\\of"!==q.val){var L=n.Err(O.span,n.PercentMissingOf());return c(e,L)}if(e=a.advance(e),s=l(e,N),e=s.state,P=s.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}return c(e,r.PercentOf(a.joinState(t.span,e),[t,P]));case">=":case"<=":case">":case"<":var F=O.type;if(e=a.advance(e),o=g(e,F),e=o.state,F=o.symbol,u=l(e,N),e=u.state,P=u.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}for(var k=r.Inequality(a.joinState(t.span,e),F,[t,P]),V=[],B=a.peek(e).type;">="===B||"<="===B||">"===B||"<"===B;){var R=e;if(F=B,e=a.advance(e),f=g(e,F),e=f.state,F=f.symbol,h=l(e,N),e=h.state,P=h.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}V.push(r.TrailingInequalityPiece(a.spanStates(R,e),F,[P])),B=a.peek(e).type}return V.length?c(e,r.InequalityChain(a.joinState(t.span,e),k,V)):c(e,k);case"!":return e=a.advance(e),c(e,r.Bang(a.joinState(t.span,e),[t]));case"[":var R=e;if(e=a.advance(e),a.isAt(e,"]")){e=a.advance(e);var A=a.spanStates(R,e);return c(e,n.Err(A,n.EmptySquareBracket()))}return d=l(e,N),e=d.state,P=d.tree,y=S(R,e,P,"[","]"),e=y.state,P=y.tree,"Err"===P.type?c(e,P):c(e,r.Index(a.joinState(t.span,e),[t,P]));case"Sqrt":case"Frac":case"Letter":case"Cmd":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\\\{":case"(|":return x=l(e,N),e=x.state,P=x.tree,"Err"===P.type?c(e,P):c(e,r.Juxt(a.joinState(t.span,e),[t,P]));case"(":if(r.isIdentifier(t)){if(M=_(e),e=M.state,P=M.tree,"Err"===P.type)return c(e,P);var A=a.joinState(t.span,e);return c(e,r.Call(A,[t,P.args[0]]))}if("Prime"===t.type&&r.isIdentifier(t.args[0])){if(w=_(e),e=w.state,P=w.tree,"Err"===P.type)return c(e,P);var A=a.joinState(t.span,e);return c(e,r.Prime(A,t.nprimes,[r.Call(A,[t.args[0],P.args[0]])]))}return T=l(e,N),e=T.state,P=T.tree,"Err"===P.type?c(e,P):c(e,r.Juxt(a.joinState(t.span,e),[t,P]));case"SupSub":e=a.advance(e);var j=v(O),z=b(O);if(j&&"Err"===j.type)return c(e,j);if(z&&"Err"===z.type)return c(e,z);if(j&&(t=r.Subscript(a.joinState(t.span,e),[t,j])),z&&(t=r.Superscript(a.joinState(t.span,e),[t,z])),O.nprimes>0){var A=a.joinState(t.span,e);if(!r.isIdentifier(t)){var L=n.Err(A,n.UnexpectedPrime());return c(e,L)}t=r.Prime(A,O.nprimes,[t])}return c(e,t);case",":for(var G=[t];a.isAt(e,",")&&(e=a.advance(e),!a.isAt(e,"..."));){if(D=l(e,N),e=D.state,P=D.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}G.push(P)}return c(e,r.Seq(a.joinState(t.span,e),G));case"...":if(e=a.advance(e),a.isAt(e,",")&&(e=a.advance(e)),C=l(e,N),e=C.state,P=C.tree,"Err"===P.type){if(p(P.error)){var A=a.joinState(t.span,e),L=n.Err(A,n.BinaryOperatorMissingRight(O.type));return c(e,L)}return c(e,P)}return c(e,r.Ellipsis(a.joinState(t.span,e),[t,P]));case"]":case")":case"\\\\}":case"|)":case"Differential":return E(e);case"Err":return l(e,N);case"End":var A=a.spanStates(e,e),L=n.Err(A,n.UnexpectedEnd());return c(e,L);default:var U=O;throw"Unexpected token type "+U.type+"."}}function d(e){return!!r.isIdentifier(e)||!("Prime"!==e.type||!r.isIdentifier(e.args[0]))}function m(e,t,n){switch(e){case"+":return r.Add(t,n);case"-":return r.Sub(t,n);case"*":return r.Mul(t,n);case"/":return r.Div(t,n);case"=":return r.Equals(t,n);case"~":return r.Tilde(t,n);case":":return r.Colon(t,n);default:var i=e;throw"Unexpected token type "+i+"."}}function g(e,t){if(!a.isAt(e,"="))return{state:e,symbol:t};switch(t){case">":e=a.advance(e),t=">=";break;case"<":e=a.advance(e),t="<="}return{state:e,symbol:t}}function y(e){if(e.sub){var t=e.sub,r=u(t);return"Err"===r.type&&"EmptyGroup"===r.error.type?n.Err(r.span,n.EmptySubscript()):r}}function v(e){if(e.sub){var t=e.sub;if(0===t.args.length)return n.Err(t.span,n.EmptySubscript());for(var a=[],s=0,o=t.args;s<o.length;s++){var u=o[s];if("Digit"!==u.type&&"Letter"!==u.type){var c=u.span,l=n.Err(c,n.InvalidSubscript(i.slice(c)));return l}a.push(u.val)}return r.Alphanumeric(t.span,a.join(""))}}function b(e){if(e.sup){var t=u(e.sup);return"Err"===t.type?"EmptyGroup"===t.error.type?n.Err(t.span,n.EmptySuperscript()):t:e.nprimes>0?n.Err(e.span,n.SuperscriptWithPrime()):t}}function x(e,t,r){if("SupSub"!==e.type){var i=a.spanStates(t,r);return n.Err(i,n.MissingBound())}if(e.nprimes>0){var i=a.spanStates(t,r);return n.Err(i,n.UnexpectedPrime())}var s=y(e),o=b(e);if(!s||"Err"===s.type&&"EmptySubscript"===s.error.type||!o||"Err"===o.type&&"EmptySuperscript"===o.error.type){var i=a.spanStates(t,r);return n.Err(i,n.MissingBound())}return"Err"===s.type?s:"Err"===o.type?o:{type:"Bounds",sup:o,sub:s}}function _(e){var t,n,i=e,s=a.peek(e),o=C(s.type);if(!a.isAt(e,"("))throw new Error("Programming Error: expected \'(\' at start of parseParen.");if(e=a.advance(e),a.isAt(e,")")){var u=r.Seq(a.emptySpanAtState(e),[]);e=a.advance(e);var p=a.spanStates(i,e);return c(e,r.Paren(p,[u]))}var f;return t=l(e,o),e=t.state,f=t.tree,n=S(i,e,f,"(",")"),e=n.state,f=n.tree,"Err"===f.type?c(e,f):c(e,r.Paren(a.spanStates(i,e),[f]))}function M(e){var t=e,i=a.peek(e);if("Differential"!==i.type)throw new Error("Programming Error: expected differential");e=a.advance(e);var s=r.Cmd(i.span,i.val),o=a.peek(e);if("SupSub"===o.type){e=a.advance(e);var u=a.spanStates(t,e),l=v(o);if(l){if("Err"===l.type)return c(e,l);s=r.Subscript(u,[s,l])}if(o.sup)return c(e,n.Err(u,n.DifferentialWithSuperscript()));if(o.nprimes>0)return c(e,n.Err(u,n.UnexpectedPrime()))}return c(e,s)}function S(e,t,r,i,s){if("Err"===r.type&&"UnexpectedEnd"!==r.error.type)return c(t,r);if("Err"===r.type||!a.isAt(t,s)){var o=a.spanStates(e,t),u=n.Err(o,n.MissingCloseDelimiter(i,s));return c(t,u)}return t=a.advance(t),c(t,r)}function E(e){var t=e,r=a.peek(e);switch(r.type){case")":e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedCloseDelimiter("(",")")));case"]":e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedCloseDelimiter("[","]")));case"\\\\}":e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedCloseDelimiter("\\\\{","\\\\}")));case"|)":e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedCloseDelimiter("|","|")));case"Differential":e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedDifferential()));default:e=a.advance(e);var i=a.spanStates(t,e);return c(e,n.Err(i,n.UnexpectedParseError()))}}Object.defineProperty(t,"__esModule",{value:!0});var w=[[s.initial("("),s.la(")"),s.initial("\\\\{"),s.la("\\\\}"),s.r("["),s.la("]"),s.initial("(|"),s.la("|)"),s.la("Differential"),s.la("End")],[s.ra("...")],[s.la(",")],[s.ra(":")],[s.la("="),s.la(">"),s.la("<"),s.la(">="),s.la("<="),s.la("~")],[s.la("+"),s.la("-")],[s.la("*"),s.la("/"),s.la("Decimal"),s.la("MixedNumber"),s.la("Letter"),s.la("Cmd"),s.la("%"),s.r("("),s.la("\\\\{"),s.la("(|"),s.la("Frac"),s.la("Sqrt"),s.la("Trig"),s.la("Ln"),s.la("Log"),s.ra("Int"),s.ra("Sum"),s.ra("Prod")],[s.initial("+"),s.initial("-")],[s.l("("),s.l("[")],[s.la("!")],[s.la("SupSub")],[s.la("Err")]],T=s.precSpec(w),D=T.leftPrec,I=T.rightPrec,C=T.initialPrec;t.parse=o}),define("math/inverses",[],function(){var e={},t=["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"];return t.forEach(function(t){e[t]="arc"+t,e["arc"+t]=t}),e}),define("math/parser/lower",["require","exports","math/inverses","math/errormsg","./input-span","./surface-node","../maybe-rational"],function(e,t,r,n,i,a,s){"use strict";function o(e,t){return c(e,t)}function u(e,t){for(var r=[],n=0;n<t.length;n++)r.push(f(e,t[n]));return r}function c(e,t){return e.setInput(l(e,t),t.span)}function l(e,t){var r=e.nodes;switch(t.type){case"Equals":var i=t.args,s=i[0],o=i[1];if("Call"===s.type){var c=s.args,l=c[0],d=c[1],m=a.unwrapSeq(d);if(a.isIdentifier(l)&&m.every(a.isIdentifier))return r.FunctionDefinition(f(e,l),u(e,m),f(e,o))}else if(a.isIdentifier(s))return r.Assignment(f(e,s),f(e,o));return r.Equation(f(e,s),f(e,o));case"Tilde":var g=u(e,t.args),s=g[0],o=g[1];return r.Regression(s,o);case"Inequality":return M(e,t);case"InequalityChain":if(t.chain.length>1)throw n.inequalityChainTooLong();var y=t.first,v=y.symbol,b=y.args,x=b[0],_=b[1],S=t.chain[0],E=S.symbol,w=S.args[0];return a.isIdentifier(_)?r.DoubleInequality([f(e,x),v,f(e,_),E,f(e,w)]):M(e,t);case"Seq":if(!t.args.every(p))throw n.malformedPoint();return r.List(u(e,t.args));case"Call":var P=t.args,O=P[0],N=P[1];return T(O)?r.Polygon(u(e,a.unwrapSeq(N))):D(O)?r.Histogram(u(e,a.unwrapSeq(N))):I(O)?r.DotPlot(u(e,a.unwrapSeq(N))):C(O)?r.BoxPlot(u(e,a.unwrapSeq(N))):h(e,t);default:return h(e,t)}}function p(e){if("Paren"!==e.type)return!1;var t=e.args[0];return"Seq"===t.type&&2===t.args.length}function f(e,t){return e.setInput(h(e,t),t.span)}function h(e,t){var r=e.nodes;switch(t.type){case"Pos":return h(e,t.args[0]);case"Neg":for(var i=-1,o=t.args[0];;)if("Pos"===o.type||"Paren"===o.type)o=o.args[0];else{if("Neg"!==o.type)break;o=o.args[0],i*=-1}switch(o.type){case"Decimal":var c=E(o);return r.Constant(i===-1?s.neg(c):c);case"MixedNumber":var c=w(o);return r.MixedNumber(i===-1?s.neg(c):c);default:return i===-1?r.Negative([f(e,o)]):h(e,o)}case"Add":return r.Add(u(e,t.args));case"Sub":return r.Subtract(u(e,t.args));case"Mul":return r.Multiply(u(e,t.args));case"Div":return r.Divide(u(e,t.args));case"Bang":var l=t.args[0];return"Call"===l.type?r.FunctionFactorial(u(e,l.args)):r.FunctionCall("\\\\factorial",u(e,t.args));case"PercentOf":return r.PercentOf(u(e,t.args));case"Call":return v(e,t);case"ImplicitCall":return S(t),v(e,t);case"Prime":var p=t.args[0];if("Call"===p.type){var d=p.args,m=d[0],g=d[1],y=a.unwrapSeq(g).length;if("Cmd"===m.type&&"logbase"===m.val){if(2!==y)throw n.primedFunctionArity()}else if(1!==y)throw n.primedFunctionArity();return r.Prime(t.nprimes,u(e,t.args))}throw"ImplicitCall"===p.type?n.primeWithoutParen():n.unexpectedPrime();case"Index":return r.ListAccess(u(e,t.args));case"Paren":var _=t.args[0];if("Seq"===_.type){if(2===_.args.length)return r.OrderedPair(u(e,_.args));throw 0===_.args.length?n.emptyParen():n.nonPairTuple()}return h(e,_);case"List":var M=t.args[0];if("Ellipsis"===M.type){var T=M.args,D=T[0],I=T[1];return r.Range([r.List(u(e,a.unwrapSeq(D))),r.List(u(e,a.unwrapSeq(I)))])}return r.List(u(e,a.unwrapSeq(M)));case"Pipes":return r.FunctionCall("\\\\abs",u(e,t.args));case"Subscript":var C=t.args,N=C[0],A=C[1];if(0===A.val.length)throw n.emptySubscript();var L=void 0;switch(N.type){case"Letter":L=N.val;break;case"Cmd":L=N.val;break;default:throw n.unexpectedSubscript()}return r.Identifier(L+"_"+A.val);case"Superscript":var q=t.args,N=q[0],F=q[1];return"Call"!==N.type||"Seq"===N.args[1].type||P(N)?r.Exponent(u(e,t.args)):r.FunctionExponent(u(e,[N.args[0],N.args[1],F]));case"Sqrt":return r.FunctionCall("sqrt",u(e,t.args));case"Nthroot":return r.FunctionCall("nthroot",u(e,[t.args[1],t.args[0]]));case"Frac":return r.Divide(u(e,t.args));case"Derivative":var k=u(e,t.args);if(!a.isIdentifier(t.args[0]))throw n.parseError();return r.Derivative(k[0],[k[1]]);case"Integral":var V=t.args,B=V[0],R=V[1],j=V[2],z=V[3],k=u(e,[B,R,j,z]);return r.Integral(k);case"EmptyIntegral":var G=u(e,t.args),B=G[0],U=G[1],j=G[2],z=r.Constant(s.maybeRational(1,1));return r.Integral([B,U,j,z]);case"Sum":var W=t.args,Y=W[0],X=W[1],j=W[2];if("Equals"!=X.type)throw n.incorrectSumLowerBound();if(!a.isIdentifier(X.args[0]))throw n.incorrectSumLowerBound();var k=u(e,[X.args[0],X.args[1],j,Y]);return r.Sum(k);case"Product":var Q=t.args,H=Q[0],Z=Q[1],j=Q[2];if("Equals"!=Z.type)throw n.incorrectProductLowerBound();if(!a.isIdentifier(Z.args[0]))throw n.incorrectProductLowerBound();var k=u(e,[Z.args[0],Z.args[1],j,H]);return r.Product(k);case"Juxt":return b(e,t);case"Letter":return r.Identifier(t.val);case"Cmd":var J=t.val;if("ans"===J){if(void 0===e.currentIndex)throw n.badAnsContext();return r.Ans("ans_{"+(e.currentIndex-1)+"}")}return r.Identifier(J);case"Decimal":return r.Constant(E(t));case"MixedNumber":return r.MixedNumber(w(t));case"Piecewise":return x(e,t);case"EmptyPiecewise":if(!r.Piecewise.empty)throw n.featureUnavailable();return r.Piecewise.empty();case"Equals":throw n.unexpectedSymbol("=");case"Inequality":case"InequalityChain":throw n.unexpectedInequality();case"Tilde":throw n.unexpectedSymbol("~");case"Seq":throw n.unexpectedSymbol(",");case"Colon":throw n.unexpectedSymbol(":");case"Ellipsis":throw n.unexpectedSymbol("...");case"Err":throw O(t.error);default:var $=t;throw"Unexpected surface node "+$.type+"."}}function d(e){return r.hasOwnProperty(e)}function m(e){return"ln"===e||"log"===e||"logbase"===e}function g(e){return"Decimal"===e.type&&"2"===e.val}function y(e){return"Neg"===e.type&&(e=e.args[0],"Decimal"===e.type&&"1"===e.val)}function v(e,t){var i=e.nodes,s=t.args,o=s[0],c=s[1],l=f(e,o),p=a.unwrapSeq(c),h=u(e,p);if(a.isIdentifier(o))return i.FunctionCall(l,h);if("Superscript"===o.type){var v=o.args,b=v[0],x=v[1];if("Cmd"===b.type){var _=b.val;if(d(_)||m(_)){if(g(x))return i.Exponent([i.FunctionCall(_,h),f(e,x)]);if(y(x)&&void 0!==r[_])return i.FunctionCall(r[_],h);throw d(_)?n.badTrigExponent(_):n.badLogExponent("logbase"===_?"log":_)}}}return i.Multiply([l,f(e,c)])}function b(e,t){var r=e.nodes,i=r.Multiply(u(e,t.args));if(!N(t.args[1]))throw n.badImplicitMultiply();return i}function x(e,t){var r,i=e.nodes,o=t.args[0],u=a.unwrapSeq(o),c=[];e:for(r=0;r<u.length;r++){var l=u[r];switch(l.type){case"Colon":var p=l.args,h=p[0],d=p[1];if(!_(h))throw n.colonMissingCondition();c.push({condition:M(e,h),if_expr:f(e,d)});break;case"Equals":case"Inequality":case"InequalityChain":c.push({condition:M(e,l),if_expr:i.Constant(s.maybeRational(1,1))});break;default:break e}}if(0===r)throw n.piecewiseMissingCondition();if(r<u.length-1)throw n.piecewisePartMissingCondition();if(r===u.length-1&&c.push({condition:i.Constant(!0),if_expr:f(e,u[r])}),!i.Piecewise.chain)throw n.featureUnavailable();return i.Piecewise.chain(c)}function _(e){return"Equals"===e.type||"Inequality"===e.type||"InequalityChain"===e.type}function M(e,t){var r=e.nodes;switch(t.type){case"Equals":return r.Comparator["="](u(e,t.args));case"Inequality":return r.Comparator[t.symbol](u(e,t.args));case"InequalityChain":if(t.chain.length>1)throw n.inequalityChainTooLong();var s=t.first,o=s.symbol,c=s.args,l=c[0],p=c[1],f=t.chain[0],h=f.symbol,d=f.args[0],m=i.emptySpanAt(t.span.input,t.span.start);return r.And([M(e,a.Inequality(m,o,[l,p])),M(e,a.Inequality(m,h,[p,d]))]);default:throw n.parseError()}}function S(e){var t=e.args,r=t[0],i=t[1];if("Superscript"===r.type&&(r=r.args[0]),"Cmd"===r.type&&"logbase"===r.val&&"Seq"===i.type&&2===i.args.length){if(!A(i.args[0]))throw n.badImplicitCall("log")}else if(!A(i)){if("Cmd"===r.type)throw n.badImplicitCall(r.val);throw n.parseError()}}function E(e){return s.fromDecimalString(e.val)}function w(e){var t=s.fromDecimalString(e.whole),r=s.fromDecimalString(e.num),n=s.fromDecimalString(e.den);return s.add(t,s.div(r,n))}function T(e){return"Cmd"===e.type&&"polygon"===e.val}function D(e){return"Cmd"===e.type&&"histogram"===e.val}function I(e){return"Cmd"===e.type&&"dotplot"===e.val}function C(e){return"Cmd"===e.type&&"boxplot"===e.val}function P(e){if("Call"!==e.type)return!1;for(var t=e.args[0];"Superscript"===t.type||"Subscript"===t.type||"Prime"===t.type;)t=t.args[0];return"Cmd"===t.type&&(d(t.val)||m(t.val))}function O(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return n.parseError();case"InvalidOperatorName":return n.invalidOperatorName();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return n.mismatchedBraces(e.open,e.close);case"UnrecognizedSymbol":return"."===e.val?n.unexpectedSymbol(e.val):n.unrecognizedSymbol(e.val);case"EmptyInput":return n.blankExpression();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return n.binaryOperatorMissingOperand("%"===e.val?"% of":e.val);case"UnaryOperatorMissingLeft":return n.unaryOperatorMissingLeft(e.val);case"UnaryOperatorMissingRight":return n.unaryOperatorMissingRight(e.val);case"UnexpectedSubscript":return n.cannotSubscript(e.base);case"PercentMissingOf":return n.percentMissingOf();case"SumMissingBound":return n.sumMissingBound();case"ProductMissingBound":return n.productMissingBound();case"IntegralMissingBound":return n.integralMissingBound();case"SumMissingBody":return n.sumMissingBody();case"ProductMissingBody":return n.productMissingBody();case"IntegralMissingBody":return n.integralMissingBody();case"DerivativeMissingBody":return n.derivativeMissingBody();case"IntegralMissingDifferential":return n.integralMissingDifferential();case"DifferentialWithSuperscript":return n.differentialWithSuperscript();case"FractionMissingNumerator":return n.fractionMissingNumerator();case"FractionMissingDenominator":return n.fractionMissingDenominator();case"FractionEmpty":return n.fractionEmpty();case"EmptySuperscript":return n.emptySuperscript();case"EmptySubscript":return n.emptySubscript();case"InvalidSubscript":return n.invalidSubscript(e.val);case"SuperscriptWithPrime":return n.superscriptWithPrime();case"PrimeWithoutParen":return n.primeWithoutParen();case"UnexpectedPrime":return n.unexpectedPrime();case"EmptyRadical":return n.emptyRadical();case"EmptyRadicand":return n.emptyRadicand();case"EmptySquareBracket":return n.emptySquareBracket();case"EmptyPipe":return n.emptyPipe();case"FunctionMissingArgument":return n.wrongArity(e.val,1,0);default:var t=e;throw"Unexpected surface node "+t.type+"."}}function N(e){switch(e.type){case"Letter":case"Cmd":case"Mul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"EmptyPiecewise":case"Paren":case"Juxt":return!0;case"Subscript":case"Superscript":case"Bang":case"Index":return N(e.args[0]);case"Decimal":case"MixedNumber":case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":return!1;default:var t=e;throw"Unexpected surface node "+t.type+"."}}function A(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":for(var t=e.args[0];;)if("Pos"===t.type||"Paren"===t.type)t=t.args[0];else{if("Neg"!==t.type)break;t=t.args[0]}return"Decimal"===t.type||"MixedNumber"===t.type;case"Pos":return A(e.args[0]);case"Paren":return A(e.args[0]);case"Juxt":case"Mul":case"Div":return A(e.args[0])&&A(e.args[1]);case"Subscript":return A(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return A(e.args[0])&&A(e.args[1]);case"Piecewise":var t=e.args[0];return"Equals"===t.type||"Inequality"===t.type||"InequalityChain"===t.type;case"Call":var r=e.args,n=r[0],i=r[1];return!a.isIdentifier(n)&&!a.isSuperscriptedIdentifier(n)&&(A(n)&&A(i));case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Neg":case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"PercentOf":case"Prime":return!1;default:var s=e;throw"Unexpected surface node "+s.type+"."}}Object.defineProperty(t,"__esModule",{value:!0}),t.lower=o}),define("math/baseparser",["require","exports","math/errormsg","parsenodes","math/parser/latex-parser","math/parser/expression-parser","math/parser/lower"],function(e,t,r,n,i,a,s){"use strict";function o(){throw r.featureUnavailable()}function u(e,t){return e.setInputSpan(t),e}function c(e,t){if("string"!=typeof e)throw new Error("Type Error: parse can only be called with strings");t=t||{};var c=n;if(t.disabledFeatures){c=Object.create(c);for(var l=0,p=t.disabledFeatures;l<p.length;l++){var f=p[l];if(!c[f])throw new Error("Programming Error: "+f+" cannot be disabled because it is not a parsenode.");c[f]=o}}var h={nodes:c,currentIndex:t.index,setInput:u};try{var d=i.parse(e),m=a.parse(d);return s.lower(h,m)}catch(e){return e instanceof n.Error?e:"string"==typeof e?n.Error(e):r.parseError()}}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=c}),define("math/rational-arithmetic-sequence",["require","math/distance","math/builtin"],function(e){function t(e,t){var i=n.toFraction(e),a=n.toFraction(t);if(r.approx(i.n/i.d,e)&&r.approx(a.n/a.d,t)){var s=n.lcm(i.d,a.d),o=i.n*(s/i.d),u=a.n*(s/a.d),c=u-o;return{nstart:o,nstep:c,lcm:s}}}var r=e("math/distance"),n=e("math/builtin");return t}),define("math/sliders",["require","exports"],function(e,t){"use strict";function r(e,t){var r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function n(e){var t=!0,r=!0,n=!0;if(void 0!==e.hardMin&&e.target<e.hardMin&&(t=!1),void 0!==e.hardMax&&e.target>e.hardMax&&(r=!1),e.step){var a=i({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0});a!==e.target&&(n=!1)}return{min:t,max:r,step:n}}function i(e){var t=e.target,n=e.hardMin,i=e.hardMax,a=e.step,s=1e-10;if(void 0!==n&&void 0!==i&&(s=Math.min(s,Math.abs(i-n)/1e3)),a&&(s=Math.min(s,a/10)),void 0!==n&&(n=r(n,s)),void 0!==i&&(i=r(i,s)),n>i)return n;if(t<=n)return n;if(t>=i)return i;if(a){var o=void 0!==n?n:0,u=Math.round((t-o)/a);t=a*u+o}var c=r(t,s);return a?t=c:n===c?t=c:i===c&&(t=c),t<=n?n:t>=i?i:t}Object.defineProperty(t,"__esModule",{value:!0}),t.roundToReasonableDecimal=r,t.determineWhichLimitsAreCompatibleWithValue=n,t.constrainSliderValueLikeEvaluator=i}),define("math/features/getConcreteTree",["require","parsenodes","math/errormsg","math/types","graphing/label","math/distance","math/maybe-rational","math/rational-arithmetic-sequence","math/sliders"],function(e){function t(e,t,r){if(!t)return void(r.valids[e]=!0);var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function r(e,t,r,n,i){if(r<e.length&&!l.approx(i,e.elementAt(r).asValue(),10))throw o.nonArithmeticRange();if(n-r<=t.length&&n-r>1&&!l.approx(i,t.elementAt(t.length-n+r).asValue(),10))throw o.nonArithmeticRange()}function n(e,t){for(var r=!1,n=!1,i=0;i<e.length;i++){var a=e[i];(a.isList||a.isBroadcast)&&(n=!0);for(var s=a.getDependencies(),o=0;o<s.length;o++)if(t.indexOf(s[o])!==-1){if(a.isList||a.isBroadcast)return"list"}else r=!0}return n?r?"broadcast":"list":"none"}function i(e){var t,r=[],n=[],i=[];for(t=0;t<e.length;t++){var a,o=e[t];if(o.isList){for(var c=!1,l=0;l<i.length;l++)if(o===i[l]){c=!0,a=s.DummyIndex(n[l]),a.valueType=u.elementType(o.valueType),r.push(a);break}if(!c){var p=s.Base.prototype.tmpVar();n.push(p),i.push(o),a=s.DummyIndex(p),a.valueType=u.elementType(o.valueType),r.push(a)}}else o.isBroadcast?(Array.prototype.push.apply(n,o._replacedSymbols),Array.prototype.push.apply(i,o._lists),r.push(o._expression)):r.push(o)}return{replacedArgs:i,concreteArgs:r,replacedSymbols:n}}function a(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args.map(function(t){return t.getConcreteTree(e)});return this.typeCheck(r),new this.constructor(r)}var s=e("parsenodes"),o=e("math/errormsg"),u=e("math/types"),c=e("graphing/label"),l=e("math/distance"),p=e("math/maybe-rational"),f=p.maybeRational,h=e("math/rational-arithmetic-sequence"),d=s.List,m=s.OrderedPair,g=s.ScalarExpression,y=s.Constant,v=s.Multiply,b=s.Identifier,x=s.DummyIndex,_=s.BuiltInFunction,M=e("math/sliders");s.Base.prototype.tryGetConcreteTree=function(){var e;try{e=this.getConcreteTree.apply(this,arguments)}catch(t){e=t instanceof s.Base?t:o.parseError()}return e},s.Base.prototype.getConcreteTree=function(e,t){if(t)return this._getConcreteTree(e,t);if(this.isConcreteTreeCacheValid(e))return this.__cachedConcreteTree.value;for(var r=this._getConcreteTree(e,t),n={},i=this.getCacheKeys().slice();;){if(!i.length)break;var a=i.pop();if(!n.hasOwnProperty(a)){var s=e[a];n[a]=s,s&&Array.prototype.push.apply(i,s.getCacheKeys())}}return this.__cachedConcreteTree={keys:n,value:r},r},s.Base.prototype.getCacheKeys=function(){return this.getDependencies()},s.Base.prototype.isConcreteTreeCacheValid=function(e){if(!this.__cachedConcreteTree)return!1;for(var t in this.__cachedConcreteTree.keys)if(this.__cachedConcreteTree.keys.hasOwnProperty(t)&&e[t]!==this.__cachedConcreteTree.keys[t])return!1;return!0},s.PercentOf.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):s.Divide([s.Multiply(this.args),s.Constant(f(100,1))]).getConcreteTree(e,t)},s.Assignment.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this._expression.getConcreteTree(e,t)},s.Identifier.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=e[this._symbol];if(r){if(r.isError)throw r;return r.isFunction?r.getConcreteInvocationTree(e,[],t):r.getConcreteTree(e,t)}if(_.hasOwnProperty(this._symbol))throw o.functionUnsupported(c.latexToIdentifier(this.getInputString()));return s.FreeVariable(this._symbol)},s.Ans.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(void 0===e[this._symbol])throw o.ansUndefined();return b.prototype._getConcreteTree.call(this,e,t)},s.Equation.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this.asComparator().getConcreteTree(e,t)},s.Constant.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._constantValue)},s.Derivative.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r;if(e[this._symbol]){var n=Object.create(e);n[this._symbol]=s.FreeVariable(this._symbol);var i=e[this._symbol].getConcreteTree(e,t);if(i.valueType!==u.Number&&i.valueType!==u.ListOfNumber)throw o.derivativeVariableTypeError(this._symbol,[u.prettyPrint(i.valueType)]);\nvar a={};return a[this._symbol]=i,r=this.args[0].getConcreteTree(n,t),this.typeCheck([r]),r.takeDerivative(this._symbol).substitute(a).getConcreteTree(e,t)}return r=this.args[0].getConcreteTree(e,t),this.typeCheck([r]),r.takeDerivative(this._symbol).getConcreteTree(e,t)},s.DoubleInequality.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor([s.Piecewise([this._indicator,this._expressions[0],y(NaN)]).getConcreteTree(e,t),this._operators[0],b(this._symbol),this._operators[1],s.Piecewise([this._indicator,this._expressions[1],y(NaN)]).getConcreteTree(e,t)])},s.Expression.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].getConcreteTree(e,t));return this.typeCheck(r),this._constantCollapsedCopy(r)},s.Error.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this},s.FreeVariable.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):this},s.FunctionCall.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=e[this._symbol];if(r&&r.isError)throw r;if(!r||!r.isFunction){if(_.hasOwnProperty(this._symbol))throw o.functionUnsupported(c.latexToIdentifier(this._identifier.getInputString()));if(1==this.args.length){var n=[b(this._symbol),this.args[0]];return v(n).getConcreteTree(e,t)}if(r)throw o.variableAsFunction(this._symbol);throw o.functionNotDefined(this._symbol)}for(var i=[],a=0;a<this.args.length;a++){var s=this.args[a].getConcreteTree(e,t);i.push(s)}return r.getConcreteInvocationTree(e,i,t)},s.FunctionExponent.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0]._symbol;return e[r]&&e[r].isFunction?s.Exponent([s.FunctionCall(r,[this.args[1]]),this.args[2]]).getConcreteTree(e,t):v([this.args[0],s.Exponent([this.args[1],this.args[2]])]).getConcreteTree(e,t)},s.FunctionFactorial.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0]._symbol;return e[r]&&e[r].isFunction?s.FunctionCall("\\\\factorial",[s.FunctionCall(r,[this.args[1]])]).getConcreteTree(e,t):v([this.args[0],s.FunctionCall("\\\\factorial",[this.args[1]])]).getConcreteTree(e,t)},s.FunctionDefinition.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=0;r<this._argSymbols.length;r++){if(e[this._argSymbols[r]])throw o.parameterAlreadyDefined(this._argSymbols[r]);if(this._argSymbols[r]===this._symbol)throw o.parameterAlreadyDefined(this._argSymbols[r])}return this._expression.getConcreteTree(e,t)},s.Image.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):s.Image({center:this.center.tryGetConcreteTree(e,t),radianAngle:this.radianAngle.tryGetConcreteTree(e,t),width:this.width.tryGetConcreteTree(e,t),height:this.height.tryGetConcreteTree(e,t)},this.moveStrategy)},s.Slider.prototype._getConcreteTree=function(e,r){if(r&&r[this.type])return r[this.type].call(this,e,r);var n=this._expression.getConcreteTree(e,r),i=this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,r),a=this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,r),s=this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,r),u={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(t("min",i,u),t("max",a,u),t("step",s,u),s&&u.valids.step&&(0===u.values.step?delete u.values.step:u.values.step=Math.abs(u.values.step)),u.errors.cycle?n=o.sliderLimitReferencesExport(u.exportedSymbol):(u.errors.min||!u.valids.min?u.errMsg=o.sliderMinInvalid():u.errors.max||!u.valids.max?u.errMsg=o.sliderMaxInvalid():!u.errors.step&&u.valids.step||(u.errMsg=o.sliderStepInvalid()),u.values.min>u.values.max&&(u.valids.min=!1,u.valids.max=!1,u.errMsg||(u.errMsg=o.sliderMaxLessThanMin()))),n.isConstant){var c=M.constrainSliderValueLikeEvaluator({target:n.asValue(),hardMin:u.values.min,hardMax:u.values.max,step:u.values.step}),l=p.fromDecimalString(c.toString()),f=isFinite(p.asFloat(l))?l:c;n=y(f)}return n.sliderInfo=u,n},s.Integral.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(e[this._differential._symbol])throw o.shadowedIntegrationVariable(this._differential._symbol);var r=this.args[0],n=this.args[1],i=this.args[2];if(n.dependsOn(r._symbol)||i.dependsOn(r._symbol))throw o.badIntegralBoundDependency(r._symbol);var a=Object.create(e);a[this._differential._symbol]=x(this._differential._symbol);var s=g.prototype._getConcreteTree.call(this,a,t);return s},s.ListAccess.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.index.getConcreteTree(e,t),n=this.list.getConcreteTree(e,t),i=[n,r];return this.typeCheck(i),this._constantCollapsedCopy(i)},s.List.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=0;n<this.args.length;n++){var i=this.args[n].getConcreteTree(e,t);r.push(i)}return this.typeCheck(r),new this.constructor(r)},s.ParametrizedReducerFunction.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(this.args[0]instanceof s.Distribution){if(this.args[0][this._symbol])return this.args[0][this._symbol](this.args.slice(1)).getConcreteTree(e,t);throw o.functionTypeError(this._symbol,[u.prettyPrint(this.args[0].valueType)])}for(var r=[],a=0;a<this.args.length;a++)r.push(this.args[a].getConcreteTree(e,t));switch(n([r[1]],this.getDummyDependencies())){case"none":return this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return s.List(s.List.mapArgs([r[1]],function(e){return e=[r[0]].concat(e),this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var c=i([r[1]]),l=[r[0]].concat(c.concreteArgs);return this.typeCheck(l),s.Broadcast(c.replacedSymbols,[this.copyWithArgs(l)].concat(c.replacedArgs))}},s.Prime.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args[0],n=r.args[0];if(!e[r._symbol])throw o.functionNotDefined(r._symbol);var i,a=this.tmpVar();if("logbase"===r._symbol){if(2!==r.args.length)throw o.primedFunctionArity();i=[b(a),r.args[1]]}else{if(1!==r.args.length)throw o.primedFunctionArity();i=[b(a)]}for(var s=r.copyWithArgs(i).getConcreteTree(e,t),u=0;u<this.order;u++)s=s.takeDerivative(a);var c={};return c[a]=n,s.substitute(c).getConcreteTree(e,t)},s.Range.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var n=this.beginning.getConcreteTree(e,t),i=this.end.getConcreteTree(e,t);if(n.getDependencies().length)throw o.variableRange(n.getDependencies());if(i.getDependencies().length)throw o.variableRange(i.getDependencies());if(!n.isList||!i.isList)throw new Error("Programming Error: range bounds must be List nodes.");var a,s,u=n.elementAt(0).asValue(),c=i.elementAt(i.length-1).asValue(),l=c-u;if(1===n.length)a=l>=0?1:-1;else{var p=n.elementAt(1).asValue();s=h(u,p),a=n.elementAt(1).asValue()-u}var m=Math.round(l/a)+1;if(!isFinite(m)||m<n.length||m<i.length)throw o.nonArithmeticRange();var g,v,b=[];if(s){var x=s.nstart;for(g=0;g<m;g++)r(n,i,g,m,x/s.lcm),b.push(y(f(x,s.lcm))),x+=s.nstep}else for(b.push(y(u)),g=1;g<m;g++)v=u+g*a,r(n,i,g,m,v),b.push(y(f(v,1)));return d(b)},s.ReducerFunction.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(0===this.args.length)throw o.zeroArgReducer(this._symbol);if(this.args[0]instanceof s.Distribution){if(this.args[0][this._symbol])return this.args[0][this._symbol]().getConcreteTree(e,t);throw o.functionTypeError(this._symbol,[u.prettyPrint(this.args[0].valueType)])}for(var r=[],a=0;a<this.args.length;a++)r.push(this.args[a].getConcreteTree(e,t));if(1===this.args.length)return r=[s.List.wrap(r[0])],this.typeCheck(r),this._constantCollapsedCopy(r);switch(n(r,this.getDummyDependencies())){case"none":return r=[s.List(r)],this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return s.List(s.List.mapArgs(r,function(e){return e=[s.List(e)],this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var c=i(r);return r=[s.List(c.concreteArgs)],this.typeCheck(r),s.Broadcast(c.replacedSymbols,[this.copyWithArgs(r)].concat(c.replacedArgs))}},s.RepeatedOperator.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(e[this._index._symbol])throw o.shadowedIndex(this._index._symbol);var r=Object.create(e);r[this._index._symbol]=x(this._index._symbol);var n=g.prototype._getConcreteTree.call(this,r,t);return n},s.ScalarExpression.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],a=0;a<this.args.length;a++)r.push(this.args[a].getConcreteTree(e,t));switch(n(r,this.getDummyDependencies())){case"none":return this.typeCheck(r),this._constantCollapsedCopy(r);case"list":return s.List(s.List.mapArgs(r,function(e){return this.typeCheck(e),this._constantCollapsedCopy(e)}.bind(this)));case"broadcast":var o=i(r);return this.typeCheck(o.concreteArgs),s.Broadcast(o.replacedSymbols,[this.copyWithArgs(o.concreteArgs)].concat(o.replacedArgs))}},s.Regression.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._lhs,this._rhs)},s.Polygon.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);var r=this.args.map(function(t){return t.getConcreteTree(e)});return this.typeCheck(r),1===r.length&&r[0].valueType===u.ListOfPoint?new this.constructor(r):r.every(function(e){return e.valueType===u.Point})?new this.constructor([d(r)]):2===r.length?new this.constructor([m(this.args).getConcreteTree(e)]):o.parseError()},s.Histogram.prototype._getConcreteTree=a,s.DotPlot.prototype._getConcreteTree=a,s.BoxPlot.prototype._getConcreteTree=a,s.SolvedEquation.prototype._getConcreteTree=function(e,t){return t&&t[this.type]?t[this.type].call(this,e,t):new this.constructor(this._symbol,this._expression.getConcreteTree(e,t))},s.Table.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);for(var r=[],n=Object.create(e),i=0;i<this.columns.length;i++){var a=this.columns[i].getConcreteTree(n,e,t);a.isIndependent&&this.columns[i].exportToLocal(a,n),r.push(a)}return new this.constructor(r)},s.TableColumn.prototype._getConcreteTree=function(e,t){var r,n,i=this.header.getConcreteTree(e);if(i.isFreeVariable){r=[];for(var a=0;a<this.values.length;a++)if(this.values[a].tableError())r.push(o.invalidTableEntry(this.values[a].tableError()));else{var s=this.values[a].tryGetConcreteTree(e);s.isError?r.push(s):s.tableError()?r.push(o.invalidTableEntry(s.tableError())):s.valueType===u.Number?r.push(s):r.push(o.tableEntryTypeError([u.prettyPrint(s.valueType)]))}return n=new this.constructor(i,this.length,r),n.isIndependent=!0,n}if(i.isConstant){for(var c=[],l=0;l<this.length;l++)c.push(i);r=c}else r=i.isList?i.args:[];return i=this.header.getConcreteTree(t),i.isError||i.valueType===u.Number||i.valueType===u.ListOfNumber||(i=o.tableHeaderTypeError([u.prettyPrint(i.valueType)])),n=new this.constructor(i,this.length,r)},s.BuiltInFunction.pdf.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(!(this.args[0]instanceof s.Distribution))throw o.functionTypeError(this._symbol,[u.prettyPrint(this.args[0].valueType)]);return this.args[0].pdf([this.args[1]]).getConcreteTree(e,t)},s.BuiltInFunction.cdf.prototype._getConcreteTree=function(e,t){if(t&&t[this.type])return t[this.type].call(this,e,t);if(!(this.args[0]instanceof s.Distribution))throw o.functionTypeError(this._symbol,[u.prettyPrint(this.args[0].valueType)]);var r,n;return this.args[2].asValue()===-(1/0)?(r=s.Constant(-(1/0)),n=this.args[1]):(r=this.args[1],n=this.args[2]),this.args[0].cdf([r,n]).getConcreteTree(e,t)}}),define("math/features/getValueType",["require","parsenodes","math/types"],function(e){function t(){return o.Number}function r(){return o.Bool}function n(){return o.Point}function i(){return o.Distribution}function a(){return o.Any}var s=e("parsenodes"),o=e("math/types"),u={Add:t,Multiply:t,Divide:t,Subtract:t,Exponent:t,Negative:t,And:r,Piecewise:function(e){return e[1].valueType},BaseComparator:r,RepeatedOperator:t,List:function(e){if(0===e.length)return o.ListOfAny;for(var t=e[0].valueType,r=1;r<e.length;r++)if(e[r].valueType!==t)return o.ListOfAny;return o.hasListType(t)?o.listType(t):o.ListOfAny},ListAccess:function(e){return o.elementType(e[0].valueType)},Broadcast:function(e){return o.listType(e[0].valueType)},OrderedPairAccess:t,OrderedPair:n,NativeFunction:t,ReducerFunction:t,DoubleReducerFunction:t,ParametrizedReducerFunction:t,Distribution:i,DummyIndex:t,FreeVariable:t,Constant:function(){switch(typeof this.asValue()){case"number":return o.Number;case"boolean":return o.Bool;default:throw new Error("Constant node expects value of type number or boolean, but saw "+typeof value)}},TypedFunction:function(){return this._outputType},Derivative:t,Integral:t,Identifier:a};for(var c in u)s[c].prototype._getValueType=u[c]}),define("math/features/typeCheck",["require","parsenodes","math/types","math/errormsg"],function(e){function t(e){for(var t=[],r=0;r<e.length;r++)t.push(i.prettyPrint(e[r].valueType));return t}function r(e,r){return function(n){for(var i=0;i<n.length;i++)if(n[i].valueType!==e[i])throw r(t(n))}}var n=e("parsenodes"),i=e("math/types"),a=e("math/errormsg"),s={Add:r([i.Number,i.Number],a.addTypeError),Multiply:r([i.Number,i.Number],a.multiplyTypeError),Divide:r([i.Number,i.Number],a.divideTypeError),Subtract:r([i.Number,i.Number],a.subtractTypeError),Exponent:r([i.Number,i.Number],a.exponentTypeError),Negative:r([i.Number],a.negativeTypeError),BaseComparator:r([i.Number,i.Number],a.comparatorTypeError),And:r([i.Bool,i.Bool],a.andTypeError),List:function(e){if(0!==e.length){var t=e[0].valueType;if(!i.hasListType(t))throw a.listTypeError([i.prettyPrint(t)]);for(var r=0;r<e.length;r++){var n=e[r].valueType;if(!i.hasListType(n))throw a.listTypeError([i.prettyPrint(n)]);if(n!==t)throw a.heterogeneousList()}}},Broadcast:function(e){},OrderedPair:r([i.Number,i.Number],a.pointTypeError),Piecewise:function(e){if(e[0].valueType!==i.Bool)throw a.piecewiseConditionTypeError(t(e));if(e[1].valueType!==i.Number)throw a.piecewiseBranchTypeError([i.prettyPrint(e[1].valueType)]);if(e[2].valueType!==i.Number)throw a.piecewiseBranchTypeError([i.prettyPrint(e[2].valueType)])},ListAccess:function(e){if(!i.isList(e[0].valueType)||e[1].valueType!==i.Number)throw a.indexTypeError(t(e))},OrderedPairAccess:r([i.Point,i.Number],a.indexTypeError),Sum:function(e){if(e[1].valueType!==i.Number)throw a.sumLowerBoundTypeError([i.prettyPrint(e[1].valueType)]);if(e[2].valueType!==i.Number)throw a.sumUpperBoundTypeError([i.prettyPrint(e[2].valueType)]);if(e[3].valueType!==i.Number)throw a.sumArgumentTypeError([i.prettyPrint(e[3].valueType)])},Product:function(e){if(e[1].valueType!==i.Number)throw a.productLowerBoundTypeError([i.prettyPrint(e[1].valueType)]);if(e[2].valueType!==i.Number)throw a.productUpperBoundTypeError([i.prettyPrint(e[2].valueType)]);if(e[3].valueType!==i.Number)throw a.productArgumentTypeError([i.prettyPrint(e[3].valueType)])},Integral:function(e){if(e[1].valueType!==i.Number)throw a.integralLowerBoundTypeError([i.prettyPrint(e[1].valueType)]);if(e[2].valueType!==i.Number)throw a.integralUpperBoundTypeError([i.prettyPrint(e[2].valueType)]);if(e[3].valueType!==i.Number)throw a.integralArgumentTypeError([i.prettyPrint(e[3].valueType)])},NativeFunction:function(e){for(var r=0;r<e.length;r++)if(e[r].valueType!==i.Number)throw a.functionTypeError(this._symbol,t(e))},ReducerFunction:function(e){if(e[0].valueType!==i.ListOfNumber)throw a.functionTypeError(this._symbol,t(e))},DoubleReducerFunction:function(e){if(!i.isList(e[0].valueType)||!i.isList(e[1].valueType))throw a.nonListDoubleReducer(this._symbol);if(e[0].valueType!==i.ListOfNumber||e[1].valueType!==i.ListOfNumber)throw a.functionTypeError(this._symbol,t(e))},ParametrizedReducerFunction:function(e){if(e[0].valueType!==i.ListOfNumber)throw a.nonListParametrizedReducer(this._symbol);if(e[1].valueType!==i.Number)throw a.functionTypeError(this._symbol,t(e))},TypedFunction:function(e){for(var r=0;r<e.length;r++)if(e[r].valueType!==this._inputTypes[r])throw a.functionTypeError(this._symbol,t(e))},Derivative:function(e){if(e[0].valueType!==i.Number&&e[0].valueType!==i.ListOfNumber)throw a.derivativeTypeError(t(e))},Regression:function(e){if(e[0].valueType!==i.Number&&e[0].valueType!==i.ListOfNumber||e[1].valueType!==i.Number&&e[1].valueType!==i.ListOfNumber)throw a.regressionTypeError(t(e))},Polygon:function(e){if(1===e.length&&e[0].valueType!==i.ListOfPoint)throw a.polygonListTypeError(t(e));if(2===e.length&&e[0].valueType===i.Number&&e[1].valueType===i.Number)throw a.polygonTwoNumbersError();if(e.length>2&&!e.every(function(e){return e.valueType===i.Point}))throw a.polygonPointArgsError()},Histogram:function(e){if(0===e.length)throw a.histogramRequiresArguments();if(e.length>3)throw a.histogramTooManyArguments();if(e[0].valueType!==i.ListOfNumber)throw a.histogramListTypeError(t(e)[0]);if(e.length>=2&&e[1].valueType!==i.Number)throw a.histogramBinWidthTypeError(t(e)[1]);if(e.length>=3&&e[2].valueType!==i.Number)throw a.histogramBinOffsetTypeError(t(e)[2])},DotPlot:function(e){if(0===e.length)throw a.dotplotRequiresArguments();if(e.length>3)throw a.dotplotTooManyArguments();if(e[0].valueType!==i.ListOfNumber)throw a.dotplotListTypeError(t(e)[0]);if(e.length>=2&&e[1].valueType!==i.Number)throw a.dotplotBinWidthTypeError(t(e)[1]);if(e.length>=3&&e[2].valueType!==i.Number)throw a.dotplotBinOffsetTypeError(t(e)[2])},BoxPlot:function(e){if(0===e.length)throw a.boxplotRequiresArguments();if(e.length>3)throw a.boxplotTooManyArguments();if(e[0].valueType!==i.ListOfNumber)throw a.boxplotListTypeError(t(e)[0]);if(e.length>=2&&e[1].valueType!==i.Number)throw a.boxplotOffsetTypeError(t(e)[1]);if(e.length>=3&&e[2].valueType!==i.Number)throw a.boxplotHeightTypeError(t(e)[2])}};for(var o in s)n[o].prototype.typeCheck=s[o]}),define("math/features/repr",["require","parsenodes"],function(e){var t=e("parsenodes"),r=function(e,t,r){r=r||0;var n=Array(r+1).join("  "),i=n+"  ";return"[\\n"+i+e.map(function(e){return e.repr(t,r+1)}).join(",\\n"+i)+"\\n"+n+"]"},n=function(e,t){return t=t||"",""+t+e};t.Expression.prototype.repr=function(e,t){return n(this.type,e)+"("+r(this.args,e,t)+")"},t.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),i=r+"  ";return n(this.type,e)+"([\\n"+i+this.args[0].repr(e,t+1)+",\\n"+i+"\'"+this.args[1]+"\',\\n"+i+this.args[2].repr(e,t+1)+",\\n"+i+"\'"+this.args[3]+"\',\\n"+i+this.args[4].repr(e,t+1)+"\\n"+r+"])"},t.Identifier.prototype.repr=t.FreeVariable.prototype.repr=function(e){return n(this.type,e)+"(\'"+this._symbol+"\')"},t.Constant.prototype.repr=function(e){return n(this.type,e)+"("+this.asValue()+")"},t.FunctionCall.prototype.repr=function(e,t){return n(this.type,e)+"(\'"+this._symbol+"\', "+r(this.args,e,t)+")"},t.Assignment.prototype.repr=function(e,r){return n(this.type,e)+"("+t.Identifier(this._symbol).repr(e,r)+", "+this._expression.repr(e,r)+")"},t.Regression.prototype.repr=t.Equation.prototype.repr=function(e,t){return n(this.type,e)+"("+this._lhs.repr(e,t)+", "+this._rhs.repr(e,t)+")"},t.FunctionDefinition.prototype.repr=function(e,i){return n(this.type,e)+"("+t.Identifier(this._symbol).repr(e,i)+", "+r(this._argSymbols.map(function(e){return t.Identifier(e)}),e,i)+", "+this._expression.repr(e,i)+")"},t.Error.prototype.repr=function(e,t){return n(this.type,e)+"(\'"+this._msg+"\')"},t.Derivative.prototype.repr=function(e,t){return n(this.type,e)+"(\'"+this._symbol+"\', "+r(this.args,e,t)+")"},t.SolvedEquation.prototype.repr=function(e,t){return n(this.type,e)+"(\'"+this._symbol+"\', "+this._expression.repr(e,t)+")"},t.OptimizedRegression.prototype.repr=function(e,t){return n(this.type,e)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(e,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode})+")"},t.Table.prototype.repr=function(e,t){return n(this.type,e)+"("+r(this.columns,e,t)+")"},t.TableColumn.prototype.repr=function(e,t){return n(this.type,e)+"("+this.header.repr(e,t)+", "+this.length+", "+r(this.values,e,t)+")"},t.Image.prototype.repr=function(e,t){var r=Array(t+1).join("  "),i=r+"  ";return n(this.type,e)+"({\\n"+i+"center: "+this.center.repr(e,t+1)+",\\n"+i+"radianAngle: "+this.radianAngle.repr(e,t+1)+",\\n"+i+"width: "+this.width.repr(e,t+1)+",\\n"+i+"height: "+this.height.repr(e,t+1)+"},\\n"+i+JSON.stringify(this.moveStrategy)+"\\n"+r+")"},t.Slider.prototype.repr=function(e,t){var r=Array(t+1).join("  "),i=r+"  ";return n(this.type,e)+"({\\n"+i+"sliderAssignment: "+this.sliderAssignment.repr(e,t+1)+",\\n"+i+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(e,t+1))+",\\n"+i+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(e,t+1))+",\\n"+i+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(e,t+1))+"},\\n"+r+")"},t.Broadcast.prototype.repr=function(e,t){return n(this.type,e)+"([\'"+this._replacedSymbols.join("\', ")+"\'], "+r(this.args,e,t)+")"}}),define("math/features/scalarEvalExpression",["require","parsenodes","math/functions"],function(e){var t=e("parsenodes"),r=e("math/functions"),n={Add:function(e){return"("+e.join("+")+")"},Multiply:function(e){return"("+e.join("*")+")"},Divide:function(e){return"("+e.join("/")+")"},Subtract:function(e){return"("+e.join("-")+")"},Exponent:function(e){return"BuiltIn.pow("+e.join(",")+")"},RawExponent:function(e){return"Math.pow("+e.join(",")+")"},Negative:function(e){return"(-"+e[0]+")"},And:function(e){return e.join("&&")},Piecewise:function(e){return"("+e[0]+"?"+e[1]+":"+e[2]+")"}},i={Add:2,Multiply:2,Divide:2,Subtract:2,Exponent:2,RawExponent:2,Negative:1,And:2,Piecewise:3};for(var a in n){var s=t[a].prototype;s.scalarEvalExpression=n[a],s.evaluate=r.createEvaluateFunction(s.scalarEvalExpression,i[a])}}),define("math/reconstitute-node",["require","parsenodes","math/types"],function(e){function t(e,i){if(n.isList(e)){for(var a=[],s=0;s<i.length;s++)a.push(t(n.elementType(e),i[s]));var o=r.List(a);return o.valueType=e,o}switch(e){case n.Number:case n.Bool:return r.Constant(i);case n.Point:return r.OrderedPair([r.Constant(i[0]),r.Constant(i[1])]);default:throw new Error("Cannot reconstitute value of a "+n.prettyPrint(e)+".")}}var r=e("parsenodes"),n=e("math/types");return t}),define("math/features/constantcollapsedcopy",["require","parsenodes","math/reconstitute-node","math/maybe-rational"],function(e){var t=e("parsenodes"),r=t.Constant,n=t.Multiply,i=t.Subtract,a=t.RawExponent,s=t.BuiltInFunction,o=e("math/reconstitute-node"),u=e("math/maybe-rational"),c={Expression:function(e){return this.copyWithArgs(e)},FreeVariable:function(e){return this},ScalarExpression:function(e){for(var t=[],n=0;n<e.length;n++){if(!e[n].isConstant)return this.copyWithArgs(e);t.push(e[n].asValue())}return r(this.evaluate(t))},OrderedPair:function(e){return this.copyWithArgs(e)},Add:function(e){return e[0].isConstant&&e[1].isConstant?r(u.add(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):0===e[0].asValue()?e[1]:0===e[1].asValue()?e[0]:this.copyWithArgs(e)},Multiply:function(e){return e[0].isConstant&&e[1].isConstant?r(u.mul(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):1===e[0].asValue()?e[1]:1===e[1].asValue()?e[0]:this.copyWithArgs(e)},Subtract:function(e){return e[0].isConstant&&e[1].isConstant?r(u.sub(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):0===e[0].asValue()?t.Negative([e[1]]):0===e[1].asValue()?e[0]:this.copyWithArgs(e)},Divide:function(e){return e[0].isConstant&&e[1].isConstant?r(u.div(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):1===e[1].asValue()?e[0]:this.copyWithArgs(e)},Exponent:function(e){if(e[0].isConstant&&e[1].isConstant)return r(u.pow(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue()));if(e[0].isConstant){if(e[0].asValue()===Math.E)return s.exp([e[1]]);if(e[0].asValue()>0)return a(e)}if(e[1].isConstant){var t=e[1].asValue();if(1===t)return e[0];if(t===Math.floor(t))return a(e);var i=e[1].asMaybeRationalValue();return u.isRational(i)?i.d%2===1?n([i.n%2===0?r(u.maybeRational(1,1)):s.sign([e[0]]),a([s.abs([e[0]]),e[1]])]):a(e):this.copyWithArgs(e)}return this.copyWithArgs(e)},RawExponent:function(e){return e[0].isConstant&&e[1].isConstant?r(u.pow(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},Negative:function(e){return e[0].isConstant?r(u.neg(e[0].asMaybeRationalValue())):e[0]instanceof t.Negative?e[0].args[0]:this.copyWithArgs(e)},And:function(e){return e[0].isConstant&&e[1].isConstant?r(e[0].asValue()&&e[1].asValue()):e[0].isConstant&&e[0]===!0?e[1]:e[0].isConstant&&e[0]===!1?r(!1):e[1].isConstant&&e[1]===!0?e[0]:e[1].isConstant&&e[1]===!1?r(!1):this.copyWithArgs(e)},Piecewise:function(e){return e[0].isConstant&&e[0].asValue()===!0?e[1]:e[0].isConstant&&e[0].asValue()===!1?e[2]:this.copyWithArgs(e)},Integral:function(e){var t=e[0],a=e[1],s=e[2],o=e[3],u=o.getDependencies();if(a.isConstant&&s.isConstant){var c=s.asValue()-a.asValue();if(o.isConstant)return r(o.asValue()*c);if(!o.dependsOn(t._symbol))return n([o,r(c)]);if(1===u.length&&u[0]===t._symbol)return r(this.evaluate(a.asValue(),s.asValue(),o))}else if(!o.dependsOn(t._symbol))return n([o,i([s,a])]);return this.copyWithArgs(e)},ListAccess:function(e){return e[1].isConstant?e[0].elementAt(e[1].asValue()-1):this.copyWithArgs(e)},OrderedPairAccess:function(e){return e[1].isConstant&&e[0]instanceof t.OrderedPair?e[0].elementAt(e[1].asValue()-1):this.copyWithArgs(e)},Broadcast:function(e){var t=e[0].getDependencies();for(r=0;r<t.length;r++)if(this._replacedSymbols.indexOf(t[r])===-1)return this.copyWithArgs(e);for(var r=1;r<e.length;r++)if(0!==e[r].getDependencies().length)return this.copyWithArgs(e);return o(this.valueType,this.evaluate(e.slice(1).map(function(e){return e.asValue()})))},ReducerFunction:function(e){return 0===e[0].getDependencies().length?o(this.valueType,this.evaluate([e[0].asValue()])):this.copyWithArgs(e)},DoubleReducerFunction:function(e){if(0===e[0].getDependencies().length&&0===e[1].getDependencies().length){var t=Math.min(e[0].length,e[1].length);return o(this.valueType,this.evaluate([e[0].asValue().slice(0,t),e[1].asValue().slice(0,t)]))}return this.copyWithArgs(e)},ParametrizedReducerFunction:function(e){var t=e[0],r=e[1];return r.isConstant&&0===t.getDependencies().length?o(this.valueType,this.evaluate([t.asValue(),r.asValue()])):this.copyWithArgs(e)},RepeatedOperator:function(e){if(e[1].isConstant&&e[2].isConstant){var t=e[1].asValue(),n=e[2].asValue(),i=e[3];if(i.isConstant)return r(this.evaluateConstant([t,n,i.asValue()]));var a=i.getDependencies();if(0===a.length||1===a.length&&a[0]===e[0]._symbol)return r(this.evaluate(t,n,i))}return this.copyWithArgs(e)}};for(var l in c)t[l].prototype._constantCollapsedCopy=c[l];s.mod.prototype._constantCollapsedCopy=function(e){return e[0].isConstant&&e[1].isConstant?r(u.mod(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},s.sqrt.prototype._constantCollapsedCopy=function(e){return e[0].isConstant?r(u.sqrt(e[0].asMaybeRationalValue())):this.copyWithArgs(e)},s.nthroot.prototype._constantCollapsedCopy=function(e){return e[0].isConstant&&e[1].isConstant?r(u.nthroot(e[0].asMaybeRationalValue(),e[1].asMaybeRationalValue())):this.copyWithArgs(e)},s.abs.prototype._constantCollapsedCopy=function(e){return e[0].isConstant?r(u.abs(e[0].asMaybeRationalValue())):this.copyWithArgs(e)},s.total.prototype._constantCollapsedCopy=function(e){if(!e[0].isList)return this.copyWithArgs(e);for(var t=e[0].args,n=0;n<t.length;n++)if(!t[n].isConstant)return this.copyWithArgs(e);return r(u.total(e[0].asMaybeRationalValue()))},s.distance.prototype._constantCollapsedCopy=function(e){return 0===e[0].getDependencies().length&&0===e[1].getDependencies().length?r(this.evaluate([e[0].asArray(),e[1].asArray()])):this.copyWithArgs(e)},s.midpoint.prototype._constantCollapsedCopy=function(e){if(0===e[0].getDependencies().length&&0===e[1].getDependencies().length){var n=this.evaluate([e[0].asArray(),e[1].asArray()]);return t.OrderedPair([r(n[0]),r(n[1])])}return this.copyWithArgs(e)}}),define("math/features/polynomialorder",["require","parsenodes"],function(e){var t=e("parsenodes"),r={Expression:"this.dependsOn(symbol) ? Infinity : 0",FreeVariable:"(symbol === this._symbol ? 1 : 0)",Constant:"0",Add:"Math.max(order0, order1)",Subtract:"Math.max(order0, order1)",Multiply:"order0 + order1",Negative:"order0",Divide:"order1 > 0 ? Infinity : order0"},n=function(e){return e=e.replace("order0","this.args[0].polynomialOrder(symbol)"),e=e.replace("order1","this.args[1].polynomialOrder(symbol)"),new Function(["symbol"],"return "+e)};for(var i in r){var a=r[i];t[i].prototype.polynomialOrder=n(a)}t.Exponent.prototype.polynomialOrder=function(e){var t=this.args[0].polynomialOrder(e),r=this.args[1].polynomialOrder(e);if(0===t&&0===r)return 0;var n=this.args[1];return n.isConstant&&n.asValue()===Math.round(n.asValue())&&n.asValue()>0?t*n.asValue():1/0},t.Piecewise.prototype.polynomialOrder=function(e){return this.dependsOn(e)?this.args[2].isConstant&&this.args[2].isNaN()?this.args[1].polynomialOrder(e):1/0:0},t.List.prototype.polynomialOrder=function(e){return 1/0}}),define("math/features/polynomialcoefficients",["require","parsenodes","math/maybe-rational"],function(e){var t=e("parsenodes"),r=e("math/maybe-rational").maybeRational,n=t.Constant(r(0,1)),i=t.Constant(r(1,1));t.FreeVariable.prototype.getPolynomialCoefficients=function(e){return e===this._symbol?[n,i]:[this]},t.Constant.prototype.getPolynomialCoefficients=function(e){return[this]},t.Add.prototype.getPolynomialCoefficients=function(e){for(var r=this.args[0].getPolynomialCoefficients(e),n=this.args[1].getPolynomialCoefficients(e),i=r.length-1,a=n.length-1,s=[],o=0;o<=Math.max(i,a);o++)i>=o&&a>=o?s.push(t.Add([r[o],n[o]])):s.push(i>a?r[o]:n[o]);return s},t.Subtract.prototype.getPolynomialCoefficients=function(e){for(var r=this.args[0].getPolynomialCoefficients(e),n=this.args[1].getPolynomialCoefficients(e),i=r.length-1,a=n.length-1,s=[],o=0;o<=Math.max(i,a);o++)i>=o&&a>=o?s.push(t.Subtract([r[o],n[o]])):s.push(i>a?r[o]:t.Negative([n[o]]));return s},t.Negative.prototype.getPolynomialCoefficients=function(e){for(var r=this.args[0].getPolynomialCoefficients(e),n=[],i=0;i<r.length;i++)n.push(t.Negative([r[i]]));return n},t.Exponent.prototype.getPolynomialCoefficients=function(e){var r=this.args[0].getPolynomialCoefficients(e),i=this.args[1].getPolynomialCoefficients(e),a=r.length-1,s=i.length-1;if(s>0)throw"can\'t solve for variable in exponent";if(0===a)return[t.Exponent([r[0],i[0]])];if(this.args[1].isConstant){var o=this.args[1].asValue();switch(o){case 0:return[n];case 1:return r;case 2:return t.Multiply([this.args[0],this.args[0]]).getPolynomialCoefficients(e)}}throw"Unable to compile polynomial representation"},t.Multiply.prototype.getPolynomialCoefficients=function(e){for(var r=this.args[0].getPolynomialCoefficients(e),n=this.args[1].getPolynomialCoefficients(e),i=r.length-1,a=n.length-1,s=[],o=0;o<=i;o++)for(var u=0;u<=a;u++){var c=t.Multiply([r[o],n[u]]),l=s[o+u];void 0===l?s[o+u]=c:s[o+u]=t.Add([l,c])}return s},t.Divide.prototype.getPolynomialCoefficients=function(e){var r=this.args[0].getPolynomialCoefficients(e),n=this.args[1].getPolynomialCoefficients(e),i=n.length-1,a=[];if(i>0)throw"Can\'t solve for variable in denominator";for(var s=0;s<r.length;s++)a.push(t.Divide([r[s],n[0]]));return a},t.Expression.prototype.getPolynomialCoefficients=function(e){\nif(this.dependsOn(e))throw"Unimplemented polynomialCoefficient call";return[this]},t.Piecewise.prototype.getPolynomialCoefficients=function(e){if(!this.dependsOn(e))return[this];var t=this.args[1].getPolynomialCoefficients(e);return t}}),define("math/features/extractconditions",["require","parsenodes"],function(e){var t=e("parsenodes");t.Expression.prototype.extractConditions=function(e,t){if(!this.dependsOn(e))return t;for(var r=0;r<this.args.length;r++){var n=this.args[r];t=n.extractConditions(e,t)}return t},t.Piecewise.prototype.extractConditions=function(e,r){if(!this.dependsOn(e))return r;if(!this.args[0].dependsOn(e))return r=this.args[1].extractConditions(e,r),r=this.args[2].extractConditions(e,r);var n={};return n[e]=r,t.Piecewise([this.args[0].substitute(n),r,t.Constant(NaN)])}}),define("math/features/piecewiseDependsOn",["require","parsenodes"],function(e){var t=e("parsenodes");t.Expression.prototype.piecewiseDependsOn=function(e){if(!this.dependsOn(e))return!1;for(var t=0;t<this.args.length;t++){var r=this.args[t];if(r.piecewiseDependsOn(e))return!0}return!1},t.Piecewise.prototype.piecewiseDependsOn=function(e){return this.dependsOn(e)}}),define("math/builtinconstants",["require","math/parsenode/constant","math/maybe-rational"],function(e){var t=e("math/parsenode/constant"),r=e("math/maybe-rational").maybeRational;return{pi:t(Math.PI),tau:t(2*Math.PI),e:t(Math.E),trigAngleMultiplier:t(r(1,1))}}),define("math/builtinframe",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){var t,r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i={};for(t in r)r.hasOwnProperty(t)&&(i[t]=r[t]);for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}),define("math/features/bounddomain",["require","parsenodes","math/builtinframe","math/domaintypes","math/comparators","math/maybe-rational"],function(e){var t=e("parsenodes"),r=e("math/builtinframe"),n=e("math/domaintypes"),i=e("math/comparators").table,a=e("math/maybe-rational").maybeRational,s=t.Constant(a(0,1));t.Base.prototype.boundDomain=function(e){return n.unknownDomain()},t.List.prototype.boundDomain=function(e){return n.unknownDomain()},t.Expression.prototype.boundDomain=function(e){for(var t=n.allReals(),r=0;r<this.args.length;r++)t=n.intersectDomains(t,this.args[r].boundDomain(e));return t},t.Constant.prototype.boundDomain=function(e){return this.isNaN()?n.emptyDomain():n.allReals()},t.Piecewise.prototype.boundDomain=function(e){return this.args[2].isConstant&&isNaN(this.args[2].asValue())?n.intersectDomains(this.args[0].boundDomain(e),this.args[1].boundDomain(e)):n.unknownDomain()},t.OrderedPair.prototype.boundDomain=function(e){return n.intersectDomains(this.args[0].boundDomain(e),this.args[1].boundDomain(e))},t.BaseComparator.prototype.boundDomain=function(e){if("="===this.operator)return n.unknownDomain();var t=this._difference,a=this._difference.boundDomain(e),o=t.polynomialOrder(e);if(o>1)return n.unknownDomain();var u=t.getPolynomialCoefficients(e),c=u[1]?u[1].getConcreteTree(r):s,l=u[0]?u[0].getConcreteTree(r):s;if(!c.isConstant||!l.isConstant)return n.unknownDomain();if(isNaN(c.asValue())||isNaN(l.asValue()))return n.emptyDomain();if(0===c.asValue())return i[this.operator].inclusive?l.asValue()>=0?a:n.emptyDomain():l.asValue()>0?a:n.emptyDomain();var p=-l.asValue()/c.asValue(),f=c.asValue()<0?[-(1/0),p]:[p,1/0];return n.intersectDomains(a,n.knownDomain(f))}}),define("math/features/derivative",["require","parsenodes","math/baseparser","math/builtinframe","math/parsenode/builtinfunction","math/maybe-rational"],function(e){var t=e("parsenodes"),r=e("math/baseparser"),n=e("math/builtinframe"),i=e("math/parsenode/builtinfunction"),a=e("math/maybe-rational").maybeRational,s=t.Constant(a(0,1)),o=t.Constant(a(1,1)),u=t.Constant(a(2,1)),c={FreeVariable:function(e){return e===this._symbol?o:s},Constant:function(e){return isFinite(this.asValue())?s:t.Constant(this.asValue())},Negative:function(e){return t.Negative([this.args[0].takeDerivative(e)])},Add:function(e){return t.Add([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},Subtract:function(e){return t.Subtract([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},Multiply:function(e){return t.Add([b(e,this.args[0],t.Multiply([this.args[0].takeDerivative(e),this.args[1]])),b(e,this.args[1],t.Multiply([this.args[0],this.args[1].takeDerivative(e)]))])},Divide:function(e){return t.Subtract([b(e,this.args[0],t.Divide([this.args[0].takeDerivative(e),this.args[1]])),b(e,this.args[1],t.Divide([t.Multiply([this.args[0],this.args[1].takeDerivative(e)]),t.Exponent([this.args[1],u])]))])},Exponent:function(e){return t.Add([b(e,this.args[0],t.Multiply([t.Multiply([this.args[1],t.Exponent([this.args[0],t.Subtract([this.args[1],o])])]),this.args[0].takeDerivative(e)])),b(e,this.args[1],t.Multiply([t.Piecewise([t.Comparator["="]([this.args[0],s]),t.Piecewise([t.Comparator[">"]([this.args[1],s]),s,t.Constant(NaN)]),t.Multiply([t.FunctionCall("\\\\ln",[this.args[0]]),t.Exponent([this.args[0],this.args[1]])])]),this.args[1].takeDerivative(e)]))]).getConcreteTree(n)},Sum:function(e){return this.copyWithArgs([this.args[0],this.args[1],this.args[2],this.args[3].takeDerivative(e)])},Product:function(e){var r=t.Sum([this.args[0],this.args[1],this.args[2],t.Piecewise([t.Comparator["="]([s,this.args[3]]),o,s])]),n=t.Multiply([t.Sum([this.args[0],this.args[1],this.args[2],t.Divide([this.args[3].takeDerivative(e),this.args[3]])]),t.Product(this.args)]),i=t.Product([this.args[0],this.args[1],this.args[2],t.Piecewise([t.Comparator["="]([s,this.args[3]]),this.args[3].takeDerivative(e),this.args[3]])]);return t.Piecewise([t.Comparator["="]([s,r]),n,t.Piecewise([t.Comparator["="]([o,r]),i,s])])},Piecewise:function(e){return 2===this.args.length?t.Piecewise([this.args[0],this.args[1].takeDerivative(e)]):3===this.args.length?t.Piecewise([this.args[0],this.args[1].takeDerivative(e),this.args[2].takeDerivative(e)]):void 0},List:function(e){return t.List(this.args.map(function(t){return t.takeDerivative(e)}))},ListAccess:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1]])},OrderedPair:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1].takeDerivative(e)])},OrderedPairAccess:function(e){return new this.constructor([this.args[0].takeDerivative(e),this.args[1]])},Integral:function(e){var r=this.args[0],n=this.args[1],i=this.args[2],a=this.args[3],s={};s[r._symbol]=i;var o={};return o[r._symbol]=n,t.Add([b(e,a,this.copyWithArgs([r,n,i,a.takeDerivative(e)])),t.Subtract([b(e,i,t.Multiply([a.substitute(s),i.takeDerivative(e)])),b(e,n,t.Multiply([a.substitute(o),n.takeDerivative(e)]))])])},SolvedEquation:function(e){return this._expression.takeDerivative(e)},OptimizedRegression:function(e){return this.model.takeDerivative(e)},Broadcast:function(e){for(var r=this._replacedSymbols.slice(),n=this.args.slice(1),i=this._expression.takeDerivative(e),a=0;a<this._replacedSymbols.length;a++){var s=this._replacedSymbols[a],o=this.args[a+1];if(o.dependsOn(e)){var u=this.tmpVar(),c=t.DummyIndex(u);r.push(u),n.push(o.takeDerivative(e)),i=t.Add([i,t.Multiply([this._expression.takeDerivative(s),c])])}}return t.Broadcast(r,[i].concat(n))}},l={exp:"\\\\exp(x)*x_1",ln:"\\\\{x >= 0: x_1/x \\\\}",log:"\\\\{ x >= 0: x_1/(x*\\\\ln(10)) \\\\}",sqrt:"x_1/(2*\\\\sqrt{x})",rtxsqpone:"x*x_1/\\\\rtxsqpone(x)",rtxsqmone:"x*x_1/\\\\rtxsqmone(x)",sin:"\\\\cos(x)*x_1",cos:"-\\\\sin(x)*x_1",tan:"\\\\sec(x)^2*x_1",arcsin:"x_1/\\\\sqrt{1 - x^2}",arccos:"-x_1/\\\\sqrt{1 - x^2}",sinh:"\\\\cosh(x)*x_1",cosh:"\\\\sinh(x)*x_1",tanh:"(\\\\sech(x))^2*x_1",arcsinh:"x_1/\\\\sqrt{x^2 + 1}",arccosh:"\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}",arctanh:"\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}",csc:"-\\\\cot(x)*\\\\csc(x)*x_1",sec:"\\\\tan(x)*\\\\sec(x)*x_1",cot:"-\\\\csc(x)^2*x_1",arccsc:"-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))",arcsec:"x_1/(\\\\abs(x)*\\\\rtxsqmone(x))",arccot:"-x_1/(1+x^2)",csch:"-\\\\coth(x)*\\\\csch(x)*x_1",sech:"-\\\\tanh(x)*\\\\sech(x)*x_1",coth:"-(\\\\csch(x))^2*x_1",arccsch:"-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))",arcsech:"\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}",arccoth:"\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}",factorial:"(x)!*\\\\polyGamma(0, x + 1)*x_1",floor:"\\\\{ \\\\mod(x, 1) > 0: 0*x_1 \\\\}",ceil:"\\\\{ \\\\mod(x, 1) > 0: 0*x_1 \\\\}",abs:"\\\\{ \\\\abs(x) > 0: \\\\sign(x)*x_1 \\\\}",sign:"\\\\{ \\\\abs(x) > 0: 0*x_1 \\\\}",mean:"\\\\mean(x_1)",total:"\\\\total(x_1)",length:"0",var:"2*\\\\cov(x, x_1)",varp:"2*\\\\cov(x, x_1)*(\\\\length(x)-1)/\\\\length(x)",stdev:"\\\\cov(x, x_1)/\\\\stdev(x)",stdevp:"\\\\covp(x, x_1)/\\\\stdevp(x)",mad:"\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))",min:"x_1[\\\\argmin(x)]",max:"x_1[\\\\argmax(x)]",median:"0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])",argmin:"0/0",argmax:"0/0",gcd:"0/0",lcm:"0/0",erf:"\\\\frac{2}{\\\\sqrt{\\\\pi }}e^{-x^2}",invNorm:"\\\\frac{1}{\\\\pdf(\\\\normdist,\\\\invNorm(x))}"},p={logbase:["\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)}\\\\}","\\\\frac{-\\\\log_{y}(x)*y_1}{y*\\\\ln(y)}"],nthroot:["x^{1/y - 1}/y*x_1","-\\\\frac{x^{1/y}*\\\\ln(x)*y_1}{y^2}"],polyGamma:["0/0","\\\\polyGamma(1 + x, y)*y_1"],mod:["\\\\{ \\\\abs(\\\\mod(x, y)) > 0: x_1 \\\\}","\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*y_1 \\\\}"],round:["\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}","0/0"],cov:["\\\\cov(x_1, y)","\\\\cov(x, y_1)"],covp:["\\\\covp(x_1, y)","\\\\covp(x, y_1)"],corr:["(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))","(\\\\cov(x, y_1) - (\\\\cov(x, y)*\\\\cov(y, y_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))"],quantile:["\\\\{ \\\\floor(y*(\\\\length(x)-1)) = y*(\\\\length(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\length(x)-1)) - y*(\\\\length(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\length(x)-1) - \\\\floor(y*(\\\\length(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}","\\\\{ \\\\floor(y*(\\\\length(x)-1)) < y*(\\\\length(x)-1) :   (x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*y_1\\\\}"],quartile:["0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])","0/0"],TScore:["\\\\frac{\\\\sqrt{\\\\length(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}","-y_1*\\\\sqrt{\\\\length(x)}/\\\\stdev(x)"],TTest:["\\\\{y<0:1,y>0:-1,-2*\\\\sign(\\\\mean(x))\\\\}*\\\\pdf(\\\\tdist(\\\\length(x)-1),\\\\TScore(x, 0))\\\\frac{\\\\sqrt{\\\\length(x)}(\\\\stdev(x)*\\\\mean(x_1)-\\\\mean(x)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}","0/0"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["0/0","0/0"],nPr:["0/0","0/0"],arctan:["x_1*y/(y^2+x^2)","-y_1*x/(y^2+x^2)"],poissonpdf:["0/0","y_1\\\\frac{e^{-y}(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{\\\\floor(x)!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*\\\\pdf(\\\\tdist(y),x)*\\\\frac{-(y+1)*x}{y+x^2}","y_1*\\\\frac{1}{2}\\\\pdf(\\\\tdist(y),x)(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))"],invT:["x_1/\\\\pdf(\\\\tdist(y),\\\\invT(x, y))","0/0"]},f={tcdf:["-x_1*\\\\pdf(\\\\tdist(z),x)","y_1*\\\\pdf(\\\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","z_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{e^{-z}(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\\\frac{x-y}{z^2} \\\\pdf(\\\\normdist(y,z),x)","y_1*\\\\frac{x-y}{z^2} \\\\pdf(\\\\normdist(y,z),x)","z_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) \\\\pdf(\\\\normdist(y,z),x)"],binompdf:["0/0","0/0","z_1*\\\\pdf(\\\\binomdist(y,z),x)*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z})"],invBinom:["0/0","0/0","0/0"],ZScore:["x_1*\\\\frac{1}{z}","0/0","0/0"]},h={normalcdf:["-x_1\\\\pdf(\\\\normdist(z,u), x)","y_1\\\\pdf(\\\\normdist(z,u), y)","-z_1*(\\\\pdf(\\\\normdist(z,u), y) - \\\\pdf(\\\\normdist(z,u), x))","u_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normdist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normdist(z,u),x)\\\\})"],binomcdf:["0/0","0/0","0/0","u_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u}))"]},d=function(e){return function(t){var r=this.args,i={x:r[0],x_1:r[0].takeDerivative(t)};return b(t,r[0],e.substitute(i)).getConcreteTree(n)}},m=function(e,r){return function(i){var a=this.args,s={x:a[0],x_1:a[0].takeDerivative(i),y:a[1],y_1:a[1].takeDerivative(i)};return t.Add([b(i,a[0],e.substitute(s)),b(i,a[1],r.substitute(s))]).getConcreteTree(n)}},g=function(e,r,i){return function(a){var s=this.args,o={x:s[0],x_1:s[0].takeDerivative(a),y:s[1],y_1:s[1].takeDerivative(a),z:s[2],z_1:s[2].takeDerivative(a)};return t.Add([t.Add([b(a,s[0],e.substitute(o)),b(a,s[1],r.substitute(o))]),b(a,s[2],i.substitute(o))]).getConcreteTree(n)}},y=function(e,r,i,a){return function(s){var o=this.args,u={x:o[0],x_1:o[0].takeDerivative(s),y:o[1],y_1:o[1].takeDerivative(s),z:o[2],z_1:o[2].takeDerivative(s),u:o[3],u_1:o[3].takeDerivative(s)};return t.Add([t.Add([b(s,o[0],e.substitute(u)),b(s,o[1],r.substitute(u))]),t.Add([b(s,o[2],i.substitute(u)),b(s,o[3],a.substitute(u))])]).getConcreteTree(n)}};for(var v in l)i[v].prototype.takeDerivative=d(r.parse(l[v]));for(v in p)i[v].prototype.takeDerivative=m(r.parse(p[v][0]),r.parse(p[v][1]));for(v in f)i[v].prototype.takeDerivative=g(r.parse(f[v][0]),r.parse(f[v][1]),r.parse(f[v][2]));for(v in h)i[v].prototype.takeDerivative=y(r.parse(h[v][0]),r.parse(h[v][1]),r.parse(h[v][2]),r.parse(h[v][3]));i.distance.prototype.takeDerivative=function(e){var r=this.args[0],a=this.args[1],s=t.OrderedPairAccess([r,o]),c=t.OrderedPairAccess([r,u]),l=t.OrderedPairAccess([a,o]),p=t.OrderedPairAccess([a,u]),f=b(e,s,s.takeDerivative(e)),h=b(e,c,c.takeDerivative(e)),d=b(e,l,l.takeDerivative(e)),m=b(e,p,p.takeDerivative(e));return b(e,this,t.Divide([t.Add([t.Add([t.Subtract([t.Multiply([f,s]),t.Multiply([f,l])]),t.Subtract([t.Multiply([d,l]),t.Multiply([d,s])])]),t.Add([t.Subtract([t.Multiply([h,c]),t.Multiply([h,p])]),t.Subtract([t.Multiply([m,p]),t.Multiply([m,c])])])]),i.distance([this.args[0],this.args[1]])])).getConcreteTree(n)},i.midpoint.prototype.takeDerivative=function(e){var r=this.args[0],a=this.args[1],s=t.OrderedPairAccess([r,o]),c=t.OrderedPairAccess([r,u]),l=t.OrderedPairAccess([a,o]),p=t.OrderedPairAccess([a,u]),f=b(e,s,s.takeDerivative(e)),h=b(e,c,c.takeDerivative(e)),d=b(e,l,l.takeDerivative(e)),m=b(e,p,p.takeDerivative(e));return t.OrderedPair([i.mean([f,d]),i.mean([h,m])]).getConcreteTree(n)};var b=function(e,t,r){return t.dependsOn(e)?r:s};for(var x in c){var _=c[x];t[x].prototype.takeDerivative=_}}),define("math/features/substitute",["require","parsenodes"],function(e){var t=e("parsenodes"),r={Identifier:function(e){return e[this._symbol]?e[this._symbol]:this},FreeVariable:function(e){return e[this._symbol]?e[this._symbol]:this},Constant:function(e){return this},Expression:function(e){return this.copyWithArgs(this.args.map(function(t){return t.substitute(e)}))},List:function(e){return t.List(this.args.map(function(t){return t.substitute(e)}))},SolvedEquation:function(e){return new this.constructor(this._symbol,this._expression.substitute(e))},OptimizedRegression:function(e){return new this.constructor(this.model.substitute(e),this.parameters,this.residualVariables,this.residuals,this.statistics)}};for(var n in r)t[n].prototype.substitute=r[n]}),define("math/features/solve",["require","math/baseparser","parsenodes","math/errormsg","math/builtinframe","worker/workerconfig","math/maybe-rational"],function(e){function t(e){var t=Object.create(m);return t.a=e[2]?e[2].tryGetConcreteTree(m):v,t.b=e[1]?e[1].tryGetConcreteTree(m):v,t.c=e[0]?e[0].tryGetConcreteTree(m):v,t}function r(e){return 0===e.a.asValue()?0===e.b.asValue()?0:1:2}function n(e,n,i,a){for(var s,o,u=[],c=[],l=0;l<i.length;l++){var p=i[l],f=0;h.eachArgs([n],function(e){var t=e[0];f=Math.max(f,t.polynomialOrder(p))});var d=f>2,m=i.length>1&&!e.validSolvedVariable(p),g=a&&n.piecewiseDependsOn(p);d||m||g?(c[l]={},u[l]=1/0):(c[l]=[],u[l]=0,h.eachArgs([n],function(e){var n=e[0];o=t(n.getPolynomialCoefficients(p)),c[l].push(o),u[l]=Math.max(u[l],r(o))}))}var y;if(1===i.length)o=c[0],s=i[0],y=u[0];else{var v;v=0===u[0]?1:0===u[1]?0:u[0]<u[1]?0:1,o=c[v],s=i[v],y=u[v]}return{localFrame:o,variableOfInterest:s,effectiveOrder:y}}function i(e,t){return t?D.inequality:D.generalEquation}function a(e){e.f=b.getConcreteTree(e),e.g=x.getConcreteTree(e),e.p=_.getConcreteTree(e),e.q=M.getConcreteTree(e),e.m=c(y(1e305,1))}var s=e("math/baseparser"),o=e("parsenodes"),u=o.Base,c=o.Constant,l=o.Equation,p=o.SolvedEquation,f=o.BaseComparator,h=o.List,d=e("math/errormsg"),m=e("math/builtinframe"),g=e("worker/workerconfig"),y=e("math/maybe-rational").maybeRational,v=c(y(0,1)),b=s.parse("b*b"),x=s.parse("4*a*c"),_=s.parse("(-b+\\\\sqrt{b*b-4*a*c})/(2*a)"),M=s.parse("(-b-\\\\sqrt{b*b-4*a*c})/(2*a)"),S=s.parse("[\\\\{\\\\abs(b)>0:-c/b\\\\}]"),E=s.parse("[\\\\{\\\\abs(a)>0:-b/(2*a)\\\\}]"),w=s.parse("[\\\\{a=0:\\\\{b<0:-c/b\\\\},q\\\\},\\\\{a=0:\\\\{b>0:-c/b\\\\},p\\\\}]"),T=s.parse("[\\\\{a=0:\\\\{b<0:-c/b\\\\},a>0:q\\\\},\\\\{a=0:\\\\{b=0:\\\\{c>0:-m\\\\}\\\\},a>0:\\\\{f<g:-m\\\\},p\\\\},\\\\{a=0:\\\\{b=0:\\\\{c>0:m\\\\}\\\\},a>0:\\\\{f<g:m\\\\},q\\\\},\\\\{a=0:\\\\{b>0:-c/b\\\\},a>0:p\\\\}]"),D={inequality:function(e){return a(e),T.getConcreteTree(e)},generalEquation:function(e){return a(e),e.a.isConstant&&0===e.a.asValue()?S.getConcreteTree(e):e.f.isConstant&&e.g.isConstant&&e.f.asValue()-e.g.asValue()===0?E.getConcreteTree(e):w.getConcreteTree(e)}};u.prototype.trySolve=function(e,t){try{return this.solve(e,t)}catch(e){if(e instanceof o.Error)return e;throw e}},l.prototype.solve=function(e,t){return this.asComparator().solve(e,t)},f.prototype.solve=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return r;if(r.isConstant)return r;var a="="!==this.getOperator(),s=this._difference.tryGetConcreteTree(t);s.isBroadcast&&(s=h(s.mapElements(function(e){return e})));var o=s.getDependencies();if(0===o.length)return s.isList?h(s.args.map(function(e){return c(0===e.asValue())})):c(0===s.asValue());if(1===o.length&&s.isList&&!a)return s;if(1===o.length&&!a&&!g.plotSingleVariableImplicitEquations)return d.singleVariableImplicitEquationsDisabled();var u=h.wrap(s);if(o.length>2)return d.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(o);if(a&&!e.validInequalityVariables(o))return d.invalidInequalityVariables().setDependencies(o);var l=n(e,u,o,a),f=l.localFrame,m=l.effectiveOrder,y=l.variableOfInterest;if(e.complicatedPolarImplicit(y,m))return d.complicatedPolarImplicit().setDependencies(o);if(!e.validImplicitVariables(o))return d.invalidImplicitVariables();if(m>2)return s;for(var v=i(o,a),b=[],x=0;x<f.length;x++){var _=v(f[x]);if(_.isError)return _;if(_.isConstant)b.push(_);else for(var M=0;M<_.args.length;M++){var S=_.args[M],E=u.args[x].extractConditions(y,S).getConcreteTree(t);b.push(E)}}return p(y,h(b))}}),define("math/evaluationstate",["require","graphing/graphmode","parsenodes","graphing/label"],function(e){function t(e){return e.isError?e.getError():void 0===e.asValue()?"":+e.asValue()}function r(e,r,n){for(var i=[],a=0;a<r.columns.length;a++){var s=n.columns[a],o={dependent:!s.isIndependent,discrete:s.isIndependent};s.isError?(o.error=s.getError(),o.values=[]):o.values=s.values.map(t),i.push(o)}return{column_data:i}}function n(e,t,r){var n={variables:[],errorMap:{},dimensions:{}};if(r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.center.isError||r.radianAngle.isError||r.width.isError||r.height.isError)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],a.List.eachArgs([r.center,r.radianAngle,r.width,r.height],function(e){n.dimensions.x.push(+e[0].args[0].asValue()),n.dimensions.y.push(+e[0].args[1].asValue()),n.dimensions.radianAngle.push(+e[1].asValue()),n.dimensions.width.push(+e[2].asValue()),n.dimensions.height.push(+e[3].asValue())});var s=e.graphingEnabled()?t.getGraphMode(e,r):i.NONE;return s!==i.NONE&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),n}var i=e("graphing/graphmode"),a=e("parsenodes"),s=e("graphing/label"),o=function(){return{operator:"=",variables:[]}},u=function(e,t,u){if(t.isTable)return r(e,t,u);if(t.isImage)return n(e,t,u);var c=o();if(u.isError&&(!(t instanceof a.FunctionDefinition)||u.blocksExport))return c.error=u.getError(),c.variables=t.getSliderVariables(e,u),c.is_single_identifier=t instanceof a.Identifier,c;u.moveStrategy&&(c.move_strategy=u.moveStrategy,c.default_drag_mode=u.defaultDragMode),t.isInequality()&&(c.is_inequality=!0),c.operator=t.getOperator(),u instanceof a.SolvedEquation?u._expression.asValue()!==!0&&u._expression.asValue()!==!1&&(c.assignment=u._symbol):t instanceof a.Assignment&&(c.assignment=t._symbol);var l=e.graphingEnabled()?t.getGraphMode(e,u):i.NONE;if(l!==i.NONE){c.is_graphable=!0,c.expression_type=t.getExpressionType(l,u.valueType),u.isShadeBetween()&&(c.is_shade_between=!0);var p=t.tableInfo(e,u);p&&(c.is_tableable=!0,c.table_info=p)}c.variables=c.is_graphable?[]:t.getSliderVariables(e,u),c.is_single_identifier=t instanceof a.Identifier,u.isConstant&&(c.constant_value=u.asValue());var f=u.getEvaluationInfo();if(!f||"="!==c.operator||t.isConstant||t.isFunction||(c.is_evaluable=!0,c.zero_values=f),u instanceof a.OptimizedRegression){var h={};for(var d in u.parameters)u.parameters.hasOwnProperty(d)&&(h[s.identifierToLatex(d)]=+u.parameters[d].asValue());c.is_regression=!0,c.regression={parameters:h,residualVariable:s.identifierToLatex(u.residualVariable),residualSuggestionId:u.residualSuggestionId,shouldSuggestLogMode:u.shouldSuggestLogMode,statistics:u.statistics}}return c};return u.default=o,u}),define("math/statementanalysis",["require","math/evaluationstate","pjs","graphing/graphmode","worker/workerconfig"],function(e){var t=e("math/evaluationstate"),r=e("pjs"),n=e("graphing/graphmode"),i=e("worker/workerconfig");return r(function(e){e.init=function(e,r,n){this.policy=e,this.rawTree=r,this.concreteTree=n,this.evaluationState=t(e,r,n)},e.exportTo=function(e,t){this.rawTree.exportTo(e,this.concreteTree,t)},e.graph=function(e){return this.rawTree.graph(this.policy,this.concreteTree,e)},e.getGraphMode=function(){return this.rawTree.getGraphMode(this.policy,this.concreteTree)},e.getGraphInfo=function(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)},e.shouldIntersect=function(){if(!this.evaluationState.is_graphable)return!1;if(!this.rawTree.userData.shouldGraph)return!1;if(!i.pointsOfInterest)return!1;var e=this.getGraphMode();return e===n.X||e===n.Y}})}),define("math/features/analyze",["require","underscore","parsenodes","math/statementanalysis","math/builtinframe","math/parsenode/builtinfunction","math/errormsg","math/comparators","math/types","graphing/graphmode"],function(e){function t(e,t,r,n){var i=n.getDependencies();switch(n.valueType){case p.Distribution:case p.ListOfDistribution:return s(e,r,n);case p.Point:case p.ListOfPoint:return i.length?e.validParametricVariables(i)?s(e,r,n):s(e,r,c.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(i)):s(e,r,n);case p.Number:case p.ListOfNumber:switch(i.length){case 0:return s(e,r,n);case 1:return e.validExpressionVariable(i[0])?s(e,r,n):s(e,r,c.equationRequired(e.implicitDependency(i[0])).setDependencies(i));default:return e.validImplicitVariables(i)?s(e,r,c.equationRequired().setDependencies(i)):s(e,r,c.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(i))}}}function r(e,t){var r=this.tryGetConcreteTree(t),n=r.getDependencies();return n.length?s(e,this,c.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):s(e,this,this.tryGetConcreteTree(t))}function n(e,t){return e.filter(function(e){return!t[e]})}var i=e("underscore"),a=e("parsenodes"),s=e("math/statementanalysis"),o=e("math/builtinframe"),u=e("math/parsenode/builtinfunction"),c=e("math/errormsg"),l=e("math/comparators"),p=e("math/types"),f=e("graphing/graphmode");a.Base.prototype.analyze=function(e,t){return s(e,this,this.tryGetConcreteTree(t))},a.Expression.prototype.analyze=function(e,r){var n=this.tryGetConcreteTree(r),i=function(e){return u.pdf([e,a.Identifier("x")]).tryGetConcreteTree(r)};return n instanceof a.Distribution&&(n=i(n)),n instanceof a.List&&n.valueType===p.ListOfDistribution&&(n=a.List(n.args.map(i))),n.isError?s(e,this,n):t(e,r,this,n)},a.FunctionDefinition.prototype.analyze=function(e,t){if(o[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split("_")[0];if(u[r])return s(e,this,c.cannotRedefine(this._symbol,r));var n=this.tryGetConcreteTree(t);if(n.isError)return s(e,this,n);var i=this._argSymbols,a=n.getDependencies();if(a.indexOf(this._symbol)!==-1)return s(e,this,c.selfReferentialFunction(this._symbol));var l=a.filter(function(e){return i.indexOf(e)===-1});return e.unplottablePolarFunction(this._symbol,a)?s(e,this,c.unplottablePolarFunction()):l.some(e.assignmentForbidden)?s(e,this,c.addArgumentsToDefinition(l,this._symbol,i).setDependencies(a)):l.length?s(e,this,c.tooManyVariables(this.getSliderVariables(e,n)).setDependencies(a)):s(e,this,n)},a.Assignment.prototype.analyze=function(e,t,r){var n=this._symbol;if(!e.validLHS(n))return s(e,this,c.invalidLHS(n));if(o[n])return this.asEquation().analyze(e,t);var i=this.tryGetConcreteTree(t);if(i.isError)return s(e,this,i);var u=i.getDependencies();if(this.isEquation(i))return this.asEquation().analyze(e,t);if(u.length>1){var l=this.getSliderVariables(e,i);return l.length?s(e,this,c.tooManyVariables(l).allowExport().setDependencies(u)):s(e,this,i)}var p=this.getMoveStrategy(t,i,r);if(p){var f=this.getDefaultDragMode(p);return s(e,this,a.MovablePoint(i.args,p,f))}return s(e,this,i)},a.Regression.prototype.analyze=function(e,t,r,n,i){return s(e,this,this.tryOptimize(e,t,r,n,i))},a.Polygon.prototype.analyze=r,a.Histogram.prototype.analyze=r,a.DotPlot.prototype.analyze=r,a.BoxPlot.prototype.analyze=r,a.Equation.prototype.analyze=a.BaseComparator.prototype.analyze=function(e,t){var r=this.trySolve(e,t);if(r.isError)return s(e,this,r);if(r instanceof a.SolvedEquation&&r.getDependencies().length){var n=r.getDependencies().concat(r._symbol);if(!e.validImplicitVariables(n))return s(e,this,c.invalidImplicitVariables().setDependencies(n))}return this.getGraphMode(e,r)!==f.IMPLICIT||e.validImplicitVariables(r.getDependencies())?s(e,this,r):s(e,this,c.invalidImplicitVariables().setDependencies(r.getDependencies()))},a.DoubleInequality.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return s(e,this,r);var n=r.getDependencies();return l.table[this._operators[0]].direction!==l.table[this._operators[1]].direction?s(e,this,c.mismatchedDoubleInequality()):e.validDoubleInequalitySymbol(r._symbol)&&e.validDoubleInequalityVariables(n)?n.length>2?s(e,this,c.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?s(e,this,c.complicatedDoubleInequality().setDependencies(n)):s(e,this,r):s(e,this,c.invalidDoubleInequalityVariables().setDependencies(n))},a.And.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return s(e,this,r);var n=r.getDependencies();return n.length?e.validDoubleInequalityVariables(n)?s(e,this,c.complicatedDoubleInequality().setDependencies(n)):s(e,this,c.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):s(e,this,r)},a.OrderedPair.prototype.analyze=function(e,r,n){var i=this.tryGetConcreteTree(r);if(i.isError)return s(e,this,i);var o=this.getMoveStrategy(r,i,n);if(o){var u=this.getDefaultDragMode(o);return s(e,this,a.MovablePoint(i.args,o,u))}return t(e,r,this,i)},a.Table.prototype.analyze=function(e,t){for(var r,i=Object.create(t),o=[],u=0;u<this.columns.length;u++){var l=this.columns[u].analyze(e,i,t);if(0===u&&(l.concreteTree.isIndependent?e.validFirstColumnVariable(l.concreteTree.header._symbol)?r=l.concreteTree.header._symbol:l=s(e,this.columns[u],c.invalidFirstTableColumn()):l=s(e,this.columns[u],c.invalidDependentFirstTableColumn())),l.concreteTree.isIndependent)l.rawTree.exportToLocal(l.concreteTree,i);else if(!l.concreteTree.isError){var p=l.concreteTree.header.getDependencies(),f=n(p,i);f.length&&(l=s(e,this.columns[u],c.tooManyVariables(f).setDependencies(f)))}o.push(l.concreteTree)}var h=a.Table(o),d=s(e,this,h);return d.evaluationState.is_graphable=!0,d},a.TableColumn.prototype.analyze=function(e,t,r){var n=this.header.tableError();if(n)return s(e,this,c.invalidTableHeader(n));var i=this.tryGetConcreteTree(t,r);if(i.isError)return s(e,this,i);if(i.header.isError)return s(e,this,i.header);if(i.values.isError)return s(e,this,i.values);for(var a=0;a<i.values.length;a++)if(!i.values[a].isError){var o=this.values[a]&&this.values[a].tableError();if(o)i.values[a]=c.invalidTableEntry(o);else{var u=i.values[a].getDependencies();u.length&&(i.values[a]=c.tooManyVariables(u).setDependencies(u))}}return s(e,this,i)},a.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError)return s(e,this,n);var i=n.center.getDependencies(),o=n.radianAngle.getDependencies(),u=n.width.getDependencies(),l=n.height.getDependencies();return"OrderedPair"!==this.center.type?s(e,this,a.Image({center:c.parseError(),radianAngle:n.radianAngle,width:n.width,height:n.height})):i.length||o.length||u.length||l.length?s(e,this,a.Image({center:i.length?c.tooManyVariables(o).setDependencies(i):n.center,radianAngle:o.length?c.tooManyVariables(o).setDependencies(o):n.radianAngle,width:u.length?c.tooManyVariables(u).setDependencies(u):n.width,height:l.length?c.tooManyVariables(l).setDependencies(l):n.height})):(n.moveStrategy=this.getMoveStrategy(t,n,r),s(e,this,n))},a.Slider.prototype.analyze=function(e,t){var r,n=this.tryGetConcreteTree(t),a=n.sliderInfo;if(a.missingVars.length){var o=i.unique(a.missingVars);r=s(e,this,c.tooManyVariables(e.sliderVariables(o)).setDependencies(o).allowExport())}else r=s(e,this,n);var u=r.evaluationState;u.assignment=a.exportedSymbol,u.slider_min_number=a.values.min,u.slider_max_number=a.values.max,u.slider_step_number=a.values.step,u.slider_min_valid=a.valids.min,u.slider_max_valid=a.valids.max,u.slider_step_valid=a.valids.step;var l=u.slider_min_valid&&u.slider_max_valid&&u.slider_step_valid;return u.is_slider=!0,u.raw_slider_latex=this.getInputString(),u.is_slidable=l,u.is_animatable=u.is_slidable&&!u.is_graphable,delete u.is_evaluable,delete u.zero_values,a.errMsg&&(u.error=a.errMsg.getError()),r}}),define("math/features/analyzeFourFunction",["require","parsenodes","math/statementanalysis","math/errormsg","math/parsenode/builtinfunction","math/builtinconstants"],function(e){function t(e,t){return n(e,this,i.inequalitiesUnsupported())}var r=e("parsenodes"),n=e("math/statementanalysis"),i=e("math/errormsg"),a=e("math/parsenode/builtinfunction"),s=e("math/builtinconstants");r.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?n(e,this,r):n(e,this,i.parseError())},r.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return n(e,this,r);var o=r.getDependencies();if(o.length>0){var u,c=o[0];return u=a.hasOwnProperty(c)?i.functionUnsupported(c):s.hasOwnProperty(c)?i.constantUnsupported(c):i.variablesUnsupported(c),n(e,this,u)}return n(e,this,r)},r.Assignment.prototype.analyzeFourFunction=function(e,t){return n(e,this,i.assignmentsUnsupported())},r.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return n(e,this,i.functionDefinitionsUnsupported())},r.Equation.prototype.analyzeFourFunction=function(e,t){return n(e,this,i.equationsUnsupported())},r.And.prototype.analyzeFourFunction=t,r.DoubleInequality.prototype.analyzeFourFunction=t,r.BaseComparator.prototype.analyzeFourFunction=t,r.Regression.prototype.analyzeFourFunction=function(e,t){return n(e,this,i.regressionsUnsupported())},r.OrderedPair.prototype.analyzeFourFunction=function(e,t){return n(e,this,i.pointsUnsupported());\n}}),define("math/features/analyzeScientific",["require","parsenodes","math/statementanalysis","math/errormsg","math/builtinframe"],function(e){function t(e,t){return n(e,this,i.inequalitiesUnsupported())}var r=e("parsenodes"),n=e("math/statementanalysis"),i=e("math/errormsg"),a=e("math/builtinframe");r.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?n(e,this,r):n(e,this,i.parseError())},r.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return n(e,this,r);var a=r.getDependencies();return a.length>0?n(e,this,i.tooManyVariables(a)):n(e,this,r)},r.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(a[r])return n(e,this,i.cannotRedefine(r));var s=this.tryGetConcreteTree(t);if(s.isError)return n(e,this,s);var o=s.getDependencies();return this.isEquation(s)?n(e,this,i.equationsUnsupported()):o.length>0?n(e,this,i.tooManyVariables(o)):n(e,this,s)},r.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(a[this._symbol])return n(e,this,i.cannotRedefine(this._symbol));var r=this.tryGetConcreteTree(t);if(r.isError)return n(e,this,r);var s=this._argSymbols,o=r.getDependencies();if(o.indexOf(this._symbol)!==-1)return n(e,this,i.selfReferentialFunction(this._symbol));var u=o.filter(function(e){return s.indexOf(e)===-1});return u.length?n(e,this,i.addArgumentsToDefinition(u,this._symbol,s)):n(e,this,r)},r.Equation.prototype.analyzeScientific=function(e,t){return n(e,this,i.equationsUnsupported())},r.And.prototype.analyzeScientific=t,r.DoubleInequality.prototype.analyzeScientific=t,r.BaseComparator.prototype.analyzeScientific=t,r.Regression.prototype.analyzeScientific=function(e,t){return n(e,this,i.regressionsUnsupported())},r.OrderedPair.prototype.analyzeScientific=function(e,t){return n(e,this,i.pointsUnsupported())}}),define("math/features/analyzeSingleExpressionScientific",["require","parsenodes","math/statementanalysis","math/errormsg","math/parsenode/builtinfunction","math/builtinconstants"],function(e){function t(e,t){return n(e,this,i.inequalitiesUnsupported())}var r=e("parsenodes"),n=e("math/statementanalysis"),i=e("math/errormsg"),a=e("math/parsenode/builtinfunction"),s=e("math/builtinconstants");r.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(t);return r.isError?n(e,this,r):n(e,this,i.parseError())},r.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(t);if(r.isError)return n(e,this,r);var o=r.getDependencies();if(o.length>0){var u,c=o[0];return u=a.hasOwnProperty(c)?i.functionUnsupported(c):s.hasOwnProperty(c)?i.constantUnsupported(c):i.variablesUnsupported(c),n(e,this,u)}return n(e,this,r)},r.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.assignmentsUnsupported())},r.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.functionDefinitionsUnsupported())},r.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.equationsUnsupported())},r.And.prototype.analyzeSingleExpressionScientific=t,r.DoubleInequality.prototype.analyzeSingleExpressionScientific=t,r.BaseComparator.prototype.analyzeSingleExpressionScientific=t,r.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.regressionsUnsupported())},r.OrderedPair.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.pointsUnsupported())}}),define("graphing/dragmode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NONE="NONE",t.X="X",t.Y="Y",t.XY="XY",t.AUTO="AUTO"}),define("graphing/reconcileDragMode",["require","exports","graphing/dragmode"],function(e,t,r){"use strict";function n(e){return e?"none"===e[0].type&&"none"===e[1].type?r.NONE:"none"===e[1].type?r.X:"none"===e[0].type?r.Y:r.XY:r.NONE}function i(e,t){var i=n(t);switch(e){case r.NONE:return r.NONE;case r.AUTO:return i;case r.XY:return i;case r.X:return i===r.X||i===r.XY?r.X:r.NONE;case r.Y:return i===r.Y||i===r.XY?r.Y:r.NONE;default:return r.NONE}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}),define("math/features/getgraphmode",["require","parsenodes","graphing/graphmode","graphing/reconcileDragMode","graphing/dragmode","math/types"],function(e){function t(e,t){var r;return r=e&&e.hasOwnProperty("dragMode")?e.dragMode===u.AUTO?t.defaultDragMode:e.dragMode:t.defaultDragMode,o(r,t.moveStrategy)}function r(e,r){var n=r.getDependencies();switch(r.valueType){case c.Point:case c.ListOfPoint:return r.isMovablePoint&&t(this.userData,r)!==u.NONE?s.XYPOINT_MOVABLE:0===n.length?s.XYPOINT:e.validParametricVariables(n)?s.PARAMETRIC:s.NONE;case c.Number:case c.ListOfNumber:return 1===n.length?s.Y:s.NONE;default:return s.NONE}}function n(e,t){var r=t._expression.getDependencies();if(r.length>1)return s.NONE;if(t._expression.valueType!==c.Number&&t._expression.valueType!==c.ListOfNumber)return s.NONE;var n=t._symbol,i=r[0];return e.graphMode(n,i)}function i(e,t){return t.isError?s.NONE:s.VISUALIZATION}var a=e("parsenodes"),s=e("graphing/graphmode"),o=e("graphing/reconcileDragMode").default,u=e("graphing/dragmode"),c=e("math/types");a.Base.prototype.getGraphMode=function(e,t){return s.NONE},a.Expression.prototype.getGraphMode=r,a.Equation.prototype.getGraphMode=a.BaseComparator.prototype.getGraphMode=function(e,t){var r=t.getDependencies();return t.isConstant?s.NONE:t instanceof a.SolvedEquation?0===r.length?e.graphableAsConstant(t._symbol)?e.constantGraphMode(t._symbol):s.NONE:n(e,t):r.length<=2?s.IMPLICIT:s.NONE},a.DoubleInequality.prototype.getGraphMode=function(e,t){return e.constantGraphMode(t._symbol)},a.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof a.SolvedEquation)return n(e,t);if(this.isEquation(t))return this.asEquation().getGraphMode(e,t);var i=t.getDependencies();switch(t.valueType){case c.Number:case c.ListOfNumber:switch(i.length){case 0:return e.graphableAsConstant(this._symbol)?e.constantGraphMode(this._symbol):s.NONE;case 1:return t.valueType!==c.ListOfNumber||e.graphableListVariables(this._symbol,i[0])?this.isSlider?s.NONE:e.graphMode(this._symbol,i[0]):s.NONE;default:return s.NONE}break;default:return r.call(this,e,t)}},a.FunctionDefinition.prototype.getGraphMode=function(e,t){if(1!==this._argSymbols.length)return s.NONE;var r=e.graphMode(this._symbol,this._argSymbols[0]),n=t.getDependencies();switch(t.valueType){case c.Number:case c.ListOfNumber:switch(n.length){case 0:return r;case 1:return n[0]!==this._argSymbols[0]?s.NONE:r;default:return s.NONE}break;default:return s.NONE}},a.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple&&t.isModelValid?1!==t.model.getDependencies().length?s.NONE:s.Y:s.NONE},a.Polygon.prototype.getGraphMode=function(e,t){return t.isError?s.NONE:s.POLYGONFILL},a.Histogram.prototype.getGraphMode=i,a.DotPlot.prototype.getGraphMode=i,a.BoxPlot.prototype.getGraphMode=i,a.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError?s.NONE:s.XYPOINT:s.NONE}}),define("math/features/getgraphinfo",["require","parsenodes","math/builtinframe","math/domaintypes"],function(e){var t=e("parsenodes"),r=e("math/builtinframe"),n=e("math/domaintypes");t.Base.prototype.getGraphInfo=function(e,t){var r,i,a=t.getDependencies();switch(a.length){case 0:r=!0,i=t.boundDomain("x");break;case 1:i=t.boundDomain(a[0]),r="known"===i.type&&t.isLinear(a[0]);break;case 2:r=!1,i=n.unknownDomain()}return{graphMode:this.getGraphMode(e,t),color:this.userData.color,pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,operator:this.getOperator(),isLinear:r,linearCoefficients:r?t.getLinearCoefficients():void 0,domainBound:i}},t.Base.prototype.getLinearCoefficients=function(){var e=this.getDependencies();switch(e.length){case 0:return[+this.asValue(),0];case 1:var t=this.getPolynomialCoefficients(e[0]);return[t[0]?+t[0].getConcreteTree(r).asValue():0,t[1]?+t[1].getConcreteTree(r).asValue():0];default:return[NaN,NaN]}},t.OrderedPair.prototype.getLinearCoefficients=function(){return[this.args[0].getLinearCoefficients(),this.args[1].getLinearCoefficients()]}}),define("math/features/getMoveStrategy",["require","parsenodes","math/types","math/maybe-rational"],function(e){function t(e){return{type:"none",inputString:e}}function r(e){return{type:"updateCoordinate",inputString:e}}function n(e,t,r){return{type:"updateSlider",inputString:e,id:t,coefficients:r}}function i(e,t){for(var r in t)if(t[r].evaluationState.assignment===e&&t[r].evaluationState.is_slidable)return r}function a(e,t,r,n){for(var a=e.getDependencies(),o=0;o<a.length;o++)if(n[a[o]])return!1;for(var u=a.length-1;u>=0;u--){var l=a[u],p=i(l,r);if(void 0!==p){var f=Object.create(t);f[l]=s.FreeVariable(l);var h=e.tryGetConcreteTree(f);if(!h.isError){var d=h.polynomialOrder(l);if(1===d){var m=h.getPolynomialCoefficients(l),g=m[1]?m[1].getConcreteTree(f):c,y=m[0]?m[0].getConcreteTree(f):c;if(y.isConstant&&g.isConstant&&isFinite(y.asValue())&&isFinite(g.asValue())&&0!==g.asValue()){var v=[-y.asValue()/g.asValue(),1/g.asValue()];return{symbol:l,id:p,coefficients:v}}}}}}return!1}var s=e("parsenodes"),o=e("math/types"),u=e("math/maybe-rational").maybeRational,c=s.Constant(u(0,1));s.Base.prototype.getMoveStrategy=function(){},s.Assignment.prototype.getMoveStrategy=function(e,t,r){if(this._expression instanceof s.OrderedPair)return this._expression.getMoveStrategy(e,t,r)},s.OrderedPair.prototype.getMoveStrategy=function(e,i,s){if(i.valueType===o.Point&&0===i.getDependencies().length){for(var u=[],c={},l=0;l<2;l++){var p=this.args[l],f=p.getInputString();if(p.isConstant)u[l]=r(f);else{var h=a(p,e,s,c);h&&(u[l]=n(f,h.id,h.coefficients),c[h.symbol]=!0),u[l]||(u[l]=t(f))}}if("none"!==u[0].type||"none"!==u[1].type)return u}},s.Image.prototype.getMoveStrategy=function(e,i,s){if((!this.userData||this.userData.shouldGraph!==!1)&&"OrderedPair"===i.center.type&&i.center.args[0].isConstant&&i.center.args[1].isConstant&&i.width.isConstant&&i.height.isConstant&&i.radianAngle.isConstant){for(var o=[this.width,this.height,this.center.args[0],this.center.args[1]],u=[],c={},l=[2,3,0,1],p=0;p<l.length;p++){var f=l[p],h=o[f];if(h){var d=h.getInputString();if(h.isConstant)u[f]=r(d);else{var m=a(h,e,s,c);m&&(u[f]=n(d,m.id,m.coefficients),c[m.symbol]=!0),u[f]||(u[f]=t(d))}}else u[f]=t("")}if("none"!==u[0].type||"none"!==u[1].type||"none"!==u[2].type||"none"!==u[3].type)return u}}}),define("math/features/getDefaultDragMode",["require","parsenodes","graphing/dragmode"],function(e){var t=e("parsenodes"),r=e("graphing/dragmode");t.Base.prototype.getMoveStrategy=function(){return r.NONE},t.Assignment.prototype.getDefaultDragMode=function(e){return"none"!==e[0].type&&"none"!==e[1].type?r.XY:"none"!==e[0].type?r.X:"none"!==e[1].type?r.Y:r.NONE},t.OrderedPair.prototype.getDefaultDragMode=function(e){return"updateSlider"===e[0].type&&"updateSlider"===e[1].type?r.XY:"updateSlider"===e[0].type?r.X:"updateSlider"===e[1].type?r.Y:r.NONE}}),define("math/features/tableinfo",["require","parsenodes","math/types","graphing/label"],function(e){var t=e("parsenodes"),r=t.List,n=e("math/types"),i=e("graphing/label");t.Base.prototype.tableInfo=function(e,t){return!1},t.Identifier.prototype.tableInfo=function(e,t){return!!e.validFirstColumnVariable(this._symbol)&&{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}},t.Expression.prototype.tableInfo=function(e,t){var i=t.getDependencies();switch(t.valueType){case n.Point:case n.ListOfPoint:if(0!==i.length)return!1;if(t.isMovablePoint&&("updateSlider"===t.moveStrategy[0].type||"updateSlider"===t.moveStrategy[1].type))return!1;var a=r.wrap(t).mapElements(function(e){return e.asArray()});return{independent_variable:"x",dependent_column:"y",by_reference:!1,values:a};case n.Number:if(1!==i.length)return!1;var s=i[0];return!!e.validFirstColumnVariable(s)&&{independent_variable:s,dependent_column:this.getInputString(),by_reference:!1};default:return!1}},t.Assignment.prototype.tableInfo=function(e,r){if(r instanceof t.SolvedEquation)return!1;if(!this.getInputString().length)return!1;var n=r.getDependencies();if(n.length>1)return!1;var a;if(0===n.length){if(!e.tableableAsConstant(this._symbol))return!1;a=e.implicitIndependent(this._symbol)}else a=n[0];if(!e.validFirstColumnVariable(a))return!1;var s=e.assignmentForbidden(this._symbol)?i.trimLatex(this.getInputString().replace(/[^=]*=/,"")):i.trimLatex(this.getInputString().split("=")[0]);return{independent_variable:a,dependent_column:s,by_reference:!e.assignmentForbidden(this._symbol)}},t.FunctionDefinition.prototype.tableInfo=function(e,t){if(1!==this._argSymbols.length)return!1;if(!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var a=e.assignmentForbidden(this._symbol),s=a?i.trimLatex(this.getInputString().replace(/[^=]*=/,"")):i.trimLatex(this.getInputString().split("=")[0]);return{independent_variable:n,dependent_column:s,by_reference:!a}},t.BaseComparator.prototype.tableInfo=function(e,t){return!1},t.DoubleInequality.prototype.tableInfo=function(e,t){return!1},t.Equation.prototype.tableInfo=function(e,t){return!1}}),define("math/features/tableerror",["require","parsenodes","lib/worker-i18n"],function(e){var t=e("parsenodes"),r=e("lib/worker-i18n");t.Base.prototype.tableError=function(){return this.isInequality()?r.t("Inequalities are not allowed."):!(this instanceof t.Expression)&&r.t("This type of expression is not allowed.")},t.List.prototype.tableError=function(){return r.t("Lists are not allowed.")},t.Equation.prototype.tableError=t.Assignment.prototype.tableError=function(){return r.t("Equations are not allowed.")},t.FunctionDefinition.prototype.tableError=function(){return r.t("Function definitions are not allowed.")},t.Regression.prototype.tableError=function(){return r.t("Regressions are not allowed.")}}),define("math/features/islinear",["require","parsenodes"],function(e){var t=e("parsenodes");t.Base.prototype.isLinear=function(e){return!1},t.Expression.prototype.isLinear=function(e){return this.polynomialOrder(e)<=1},t.SolvedEquation.prototype.isLinear=function(e){return this._expression.isLinear(e)},t.OptimizedRegression.prototype.isLinear=function(e){return this.model.isLinear(e)},t.OrderedPair.prototype.isLinear=function(e){return this.args[0].isLinear(e)&&this.args[1].isLinear(e)},t.List.prototype.isLinear=function(e){return this.args.every(function(t){return t.isLinear(e)})},t.Broadcast.prototype.isLinear=function(e){for(var r=this._replacedSymbols,n=this._expression,i=this._lists,a={},s=0;s<i.length;s++)if(i[s].dependsOn(e)){if(!i[s].isLinear(e))return!1;a[r[s]]=t.FreeVariable(e)}return n.substitute(a).isLinear(e)}}),define("math/expression-types",["require","exports"],function(e,t){"use strict";function r(e,r){if(void 0===e)return{points:!1,lines:!1,fill:!1};switch(e){case t.X_OR_Y:case t.SINGLE_POINT:case t.POINT_LIST:case t.PARAMETRIC:case t.POLAR:case t.IMPLICIT:case t.POLYGON:case t.HISTOGRAM:case t.DOTPLOT:case t.BOXPLOT:var n=t.EXPRESSION_PROP_DEFAULTS[e];return{points:void 0===r.points?n.points:r.points,lines:void 0===r.lines?n.lines:r.lines,fill:void 0===r.fill?n.fill:r.fill};default:var i=e;return i}}Object.defineProperty(t,"__esModule",{value:!0}),t.X_OR_Y="X_OR_Y",t.SINGLE_POINT="SINGLE_POINT",t.POINT_LIST="POINT_LIST",t.PARAMETRIC="PARAMETRIC",t.POLAR="POLAR",t.IMPLICIT="IMPLICIT",t.POLYGON="POLYGON",t.HISTOGRAM="HISTOGRAM",t.DOTPLOT="DOTPLOT",t.BOXPLOT="BOXPLOT",t.EXPRESSION_PROP_DEFAULTS={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!1,fill:!1},DOTPLOT:{points:!1,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!1,fill:!1}},t.getReconciledExpressionProps=r}),define("lib/deepCopy",["require","exports"],function(e,t){"use strict";function r(e){var t=e;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),!t)return t;if("object"!=typeof t)return t;if(Array.isArray(t))return t.map(r);var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=r(t[i]));return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}),define("math/features/graph",["require","underscore","parsenodes","math/plotter","graphing/graphmode","math/comparators","graphing/dragmode","math/expression-types","lib/deepCopy","math/domaintypes","math/builtin"],function(e){function t(e){for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}}function r(e){for(var t=1/0,r=-(1/0),n=1/0,i=-(1/0),a=0;a<e.length;a++)for(var s=e[a],o=0;o<s.length;o+=2){var u=s[o],c=s[o+1];u<t&&(t=u),u>r&&(r=u),c<n&&(n=c),c>i&&(i=c)}if(isFinite(t)&&isFinite(n)){if(t===r&&(t=Math.min(0,t),r=Math.max(0,r)),n===i&&(n=Math.min(0,n),i=Math.max(0,i)),t===r||n===i)return;return{xmin:t,ymin:n,xmax:r,ymax:i}}}function n(e){return Array.prototype.concat.apply([],e)}function i(e,t,r){return!!e&&(0===t&&0===r?"none"!==e[2].type||"none"!==e[3].type:0!==t&&0!==r?"none"!==e[0].type&&"none"!==e[1].type:0!==t?"none"!==e[0].type:0!==r&&"none"!==e[1].type)}var a=e("underscore"),s=e("parsenodes"),o=e("math/plotter").default,u=e("graphing/graphmode"),c=e("math/comparators"),l=e("graphing/dragmode"),p=e("math/expression-types"),f=s.List,h=e("lib/deepCopy").default,d=e("math/domaintypes"),m=e("math/builtin");s.Base.prototype._graph=function(e,r,i,c){if(r instanceof s.SolvedEquation)return this._graph(e,r._expression,i,c);var l,m,g,y,v,b=this,x=r.getExpressionType(c.graphMode,r.valueType),_=p.getReconciledExpressionProps(x,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill});switch(c.graphMode){case u.XYPOINT_MOVABLE:return l=[r.asArray()],g=this.userData.shouldGraph&&_.points,v=this.userData.showLabel&&!g,g?[{segments:[l],graphMode:c.graphMode,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,labels:this.computedLabels||[],poi:t(l)}]:v?[{segments:[l],graphMode:u.XYPOINT,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,labels:this.computedLabels||[],poi:t(l)}]:[];case u.XYPOINT:return m=[],l=f.wrap(r).mapElements(function(e){return e.asArray()}),g=this.userData.shouldGraph&&_.points,y=this.userData.shouldGraph&&_.lines,v=this.userData.showLabel&&!g&&!y,(this.userData.showLabel||g)&&m.push({segments:[l],graphMode:c.graphMode,color:this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:g,labelSize:this.userData.labelSize,labelOrientation:this.userData.labelOrientation,verticalLabel:this.userData.verticalLabel,nakedLabel:v,labels:this.computedLabels||[],poi:t(l)}),y&&m.push({segments:[l].map(n),graphMode:u.PARAMETRIC,color:this.userData.color,style:this.userData.lineStyle,poi:[]}),m;case u.PARAMETRIC:var M=this.userData,S=[];if(m=f.wrap(r).mapElements(function(r){var n=r.getDependencies();if(0===n.length)return l=[r.asArray()],{segments:[l],graphMode:u.XYPOINT,color:M.color,style:M.lineStyle,poi:t(l)};var a=r.getCompiledFunction(),s=b.getGraphInfo(e,r);return s.graphMode=c.graphMode,s.domain={min:b.metaData.evaluatedDomainMin,max:b.metaData.evaluatedDomainMax},s.style=b.userData.lineStyle,o.computeGraphData(i,s,a)}),_.fill){if(m.forEach(function(e){S.push({segments:e.segments,color:M.color,fillOpacity:M.fillOpacity,graphMode:u.POLYGONFILL,poi:[]})}),!_.lines)return S;m=m.concat(S)}return m;case u.X:case u.Y:case u.IMPLICIT:case u.POLAR:return m=[],f.wrap(r).eachElement(function(t){var r,n=c.graphMode===u.IMPLICIT?t.getCompiledFunction(["x","y"]):t.getCompiledFunction();try{r=t.getCompiledDerivative()}catch(e){}var s=b.getGraphInfo(e,t);s.graphMode=c.graphMode,s.style=b.userData.lineStyle,c.graphMode===u.POLAR&&(s.domain={min:b.metaData.evaluatedDomainMin,max:b.metaData.evaluatedDomainMax,isExplicit:b.metaData.isExplicitDomain});var l=o.computeGraphData(i,s,n,r);l.fillSegments?m.push(a.omit(l,"fillSegments")):m.push(l),s.graphMode===u.IMPLICIT&&"="!==s.operator&&m.push({graphMode:u.POLYGONFILL,segments:l.fillSegments,poi:{}});var p=b.metaData.evaluatedCDFMin,f=b.metaData.evaluatedCDFMax;if(!isNaN(p)&&!isNaN(f)){var g=h(s);if(g.domainBound=d.intersectDomains(s.domainBound,d.knownDomain([p,f])),"known"===g.domainBound.type){var y=o.computeGraphData(i,g,n,r);if(y.segments.length){var v,x,_,M;for(v=0;v<y.segments.length;v++)if(x=y.segments[v],x.length>=4){_=x[0];break}for(v=y.segments.length-1;v>=0;v--)if(x=y.segments[v],x.length>=4){M=x[x.length-2];break}if(isFinite(_)&&isFinite(M)){var S=o.polygonsFromSegments(y.segments,[[_,0,M,0]],y.graphMode);m.push({graphMode:u.POLYGONFILL,segments:S,poi:{}})}}}}}),m;default:return!1}},s.Base.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t);return this._graph(e,t,r,n)},s.BaseComparator.prototype.graph=function(e,t,r){var n=this,i=this.getGraphInfo(e,t),a=i.graphMode;if(a===u.IMPLICIT||a===u.POLAR)return this._graph(e,t,r,i);if(a===u.NONE)return!1;if(!(t instanceof s.SolvedEquation))return!1;var l=this.getOperator(),p=[],f=[],h=!0;t._expression.eachElement(function(e){p.push(e.getCompiledFunction());try{f.push(e.getCompiledDerivative())}catch(e){h=!1}}),h||(f=void 0);var d,m,g=[],y=[-1,0,0,1],v=p.length;for(m=0;m<v;m++){var b=this.getGraphInfo(e,t._expression.args[m]);b.graphMode=a,b.style=n.userData.lineStyle,d=o.computeGraphData(r,b,p[m],f?f[m]:void 0),d.operator=c.get(c.table[l].inclusive,y[m%4]),g.push(d)}for(m=0;m<v;m+=4){var x=o.polygonsFromSegments(g[m+1].segments,g[m+2].segments,a);g.push({graphMode:u.POLYGONFILL,segments:x,poi:{}})}return g},s.DoubleInequality.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t);if(n.graphMode===u.NONE)return!1;var i=[],a=c.get(c.table[this._operators[0]].inclusive,0),s=c.get(c.table[this._operators[1]].inclusive,0),l=this.userData,p=this.metaData,h=this;return f.eachArgs(t._expressions,function(t){var c,f;t[0].userData=t[1].userData=l,t[0].metaData=t[1].metaData=p,c=h._graph(e,t[0],r,n)[0],c.operator=a,i.push(c),f=h._graph(e,t[1],r,n)[0],f.operator=s,i.push(f);var d=o.polygonsFromSegments(c.segments,f.segments,c.graphMode);i.push({graphMode:u.POLYGONFILL,segments:d,poi:{}})}),i},s.Regression.prototype.graph=function(e,t,r){var n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)},s.Polygon.prototype.graph=function(e,t,r){for(var i=this.getGraphInfo(e,t),a=t.args[0].asValue(),s=[],o=void 0===this.userData.lines||this.userData.lines,c=void 0===this.userData.fill||this.userData.fill,l=[],p=[],f=0;f<a.length;f++){var h=a[f][0],d=a[f][1];isFinite(h)&&isFinite(d)?(o||c)&&p.push([h,d]):(o||c)&&(p.length>1&&l.push(p),p=[])}if(l.length||p.length){p.push([a[0][0],a[0][1]]),l.push(p);var m=l.map(n);c&&s.push({segments:m,graphMode:u.POLYGONFILL,poi:[],color:i.color,fillOpacity:this.userData.fillOpacity,style:i.style}),o&&s.push({segments:m,graphMode:u.PARAMETRIC,poi:[],color:i.color,style:this.userData.lineStyle})}return s},s.Histogram.prototype.graph=function(e,t,n){for(var i,a=this.getGraphInfo(e,t),s={},o=t.args[1]?t.args[1].asValue():1,c=t.args[2]?t.args[2].asValue():0,l=t.args[0].asValue(),p=l.length-1;p>=0;p--){var f=l[p];i=Math.floor((f-c)/o),s[i]?s[i].count+=1:s[i]={id:i,count:1,min:i*o+c,max:i*o+c+o}}var h=[],d=[];for(i in s){var m=s[i];d.push([m.min,0,m.min,m.count,m.max,m.count,m.max,0]);var g=0;s[m.id+1]&&(g=s[m.id+1].count),h.push([m.min,0,m.min,m.count,m.max,m.count,m.max,g])}return[{segments:d,graphMode:u.POLYGONFILL,boundingBox:r(d),poi:[],color:a.color,fillOpacity:.4},{segments:h,graphMode:u.Y,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:a.color}]},s.DotPlot.prototype.graph=function(e,n,i){var a,s,o=this.getGraphInfo(e,n),c={},l=n.args[1]?n.args[1].asValue():1,p=n.args[2]?n.args[2].asValue():0,f=n.args[0].asValue(),h=[];for(a=0;a<f.length;a++){var d=f[a];s=Math.floor((d-p)/l),c[s]?c[s].push(d):c[s]=[d]}for(s in c){var m=c[s];for(m.sort(),a=0;a<m.length;a++)h.push([m[a],a+1])}return[{segments:[h],graphMode:u.XYPOINT,boundingBox:r(h),poi:t(h),color:o.color,showPoint:!0}]},s.BoxPlot.prototype.graph=function(e,t,n){var i=this.getGraphInfo(e,t),a=t.args[1]?t.args[1].asValue():3,s=t.args[2]?t.args[2].asValue():4,o=t.args[0].asValue(),c=Math.min.apply(null,o),l=Math.max.apply(null,o),p=m.quartile(o,1),f=m.quartile(o,2),h=m.quartile(o,3),d=a,g=d-s/2,y=d+s/2,v=s/10,b=[[p,g,h,g,h,y,p,y,p,g],[f,g,f,y],[p,d,c,d],[h,d,l,d],[c,d-v,c,d+v],[l,d-v,l,d+v]];return[{segments:b,graphMode:u.PARAMETRIC,boundingBox:r(b),poi:[],color:i.color}]},s.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;var n=this.columns[t],i=n.values,a=i&&i[r];return!(!a||!isFinite(a.asValue())||0!==a._dependencies.length)},s.Table.prototype.graph=function(e,r,i){var a=[];if(r.columns[0].isError)return a;for(var s=r.columns[0],o=s.values,c=1;c<this.columns.length;c++){var p=r.columns[c];if(!p.isError){var f=this.columns[c].header.userData;if(!f.hidden){for(var h=f.dragMode,d=h===l.X||h===l.XY,m=h===l.Y||h===l.XY,g=!!f.points,y=!!f.lines,v=p.isDiscrete(s),b=y&&v,x=y&&!v,_=[],M=[],S=[],E=[],w=[],T=[],D=0;D<o.length;D++){var I=o[D],C=p.values[D];if(I&&C&&isFinite(I.asValue())&&isFinite(C.asValue())){if(g){var P=d&&this.isValueDraggable(r,0,D),O=m&&this.isValueDraggable(r,c,D);P||O?(S.push([I.asValue(),C.asValue()]),E.push({index:D,dragX:P,dragY:O})):M.push([I.asValue(),C.asValue()])}b&&T.push([I.asValue(),C.asValue()])}else b&&(T.length>1&&w.push(T),T=[])}if(S.length&&_.push({graphMode:u.XYPOINT_MOVABLE,segments:[S],color:f.color,tableId:f.tableId,poi:t(S),movablePointInfo:E}),M.length&&_.push({segments:[M],graphMode:u.XYPOINT,showPoint:!0,poi:t(M),color:f.color,style:f.pointStyle}),(w.length||T.length)&&(w.push(T),_.push({segments:w.map(n),graphMode:u.PARAMETRIC,poi:[],color:f.color,style:f.lineStyle})),x){var N=this.columns[c].header.graph(e,r.columns[c].header,i);N.length&&Array.prototype.push.apply(_,N)}_.length&&(a[f.id]=_)}}}return a},s.Image.prototype.graph=function(e,r,n){var a=[];if(!("OrderedPair"===r.center.type&&r.center.args[0].isConstant&&r.center.args[1].isConstant&&r.radianAngle.isConstant&&r.width.isConstant&&r.height.isConstant))return a;for(var s=[],o=[],c=r.width.asValue()/2,l=r.height.asValue()/2,p=r.radianAngle.asValue(),f=-1;f<=1;f++)for(var h=-1;h<=1;h++){var d=[r.center.args[0].asValue()+f*c*Math.cos(p)+h*l*Math.sin(p),r.center.args[1].asValue()-f*c*Math.sin(p)+h*l*Math.cos(p)],m=i(r.moveStrategy,f,h);m&&(s.push(d),o.push([f,h]))}return a.push({segments:[s],scaleFactors:[o],graphMode:u.XYPOINT_MOVABLE,color:this.userData.color,style:this.userData.style,poi:t(s)}),a}}),define("math/features/elementAt",["require","parsenodes","math/builtinframe"],function(e){function t(e){for(var t=0;t<this.length;t++)e(this.elementAt(t))}function r(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r)));return t}var n=e("parsenodes"),i=e("math/builtinframe");n.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:n.Constant(NaN)},n.Broadcast.prototype.elementAt=function(e){if(e=Math.floor(e),e<0||e>=this.length)return n.Constant(NaN);for(var t={},r=0;r<this._replacedSymbols.length;r++)t[this._replacedSymbols[r]]=this._lists[r].elementAt(e);return this._expression.substitute(t).getConcreteTree(i)},n.List.prototype.eachElement=t,n.Broadcast.prototype.eachElement=t,n.List.prototype.mapElements=r,n.Broadcast.prototype.mapElements=r,n.OrderedPair.prototype.elementAt=function(e){switch(e){case 0:return this.args[0];case 1:return this.args[1];default:return n.Constant(NaN)}}}),define("lib/number-to-latex",["require","exports"],function(e,t){"use strict";function r(e){if("string"==typeof e)return e;if(void 0===e)return"";var t=e+"";return t=t.replace(/1e\\+?([-\\d]+)/,"10^{$1}"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,"$1\\\\cdot 10^{$2}")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}),define("math/features/printLatex",["require","parsenodes","graphing/label","lib/number-to-latex"],function(e){function t(){return u.identifierToLatex(this._symbol)+" "}function r(e){switch(e){case">":return"\\\\gt ";case"<":return"\\\\lt ";case">=":return"\\\\ge ";case"<=":return"\\\\le ";case"=":return"="}}function n(e){return e.printLatex()}function i(){switch(this._symbol){case"sqrt":return"\\\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\\\log_{"+this.args[1].printLatex()+"}\\\\left("+this.args[0].printLatex()+"\\\\right)";default:return u.identifierToLatex(this._symbol)+"\\\\left("+this.args.map(n).join(", ")+"\\\\right)"}}function a(e){return e.isConstant&&e.asValue()===!0}function s(e){return e.isConstant&&e.isNaN()}var o=e("parsenodes"),u=e("graphing/label"),c=e("lib/number-to-latex").default;o.Identifier.prototype.printLatex=t,o.FreeVariable.prototype.printLatex=t,o.Constant.prototype.printLatex=function(){return c(this.asValue())},o.Negative.prototype.printLatex=function(){return"-\\\\left("+this.args[0].printLatex()+"\\\\right)"},o.Add.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)+\\\\left("+this.args[1].printLatex()+"\\\\right)"},o.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\\\% \\\\operatorname{of} "+this.args[1].printLatex()},o.Subtract.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)-\\\\left("+this.args[1].printLatex()+"\\\\right)"},o.Multiply.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)*\\\\left("+this.args[1].printLatex()+"\\\\right)"},o.Divide.prototype.printLatex=function(){return"\\\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"},o.Exponent.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)^{"+this.args[1].printLatex()+"}"},o.Assignment.prototype.printLatex=function(){return u.identifierToLatex(this._symbol)+"="+this._expression.printLatex()},o.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()},o.BaseComparator.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+r(this.operator)+"\\\\left("+this.args[1].printLatex()+"\\\\right)"},o.DoubleInequality.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+r(this.args[1])+this.args[2].printLatex()+r(this.args[3])+"\\\\left("+this.args[4].printLatex()+"\\\\right)"},o.And.prototype.printLatex=function(){if(!(this.args[0]instanceof o.BaseComparator&&this.args[1]instanceof o.BaseComparator))throw new Error("Not implemented");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error("Not implemented");return"\\\\left("+this.args[0].args[0].printLatex()+"\\\\right)"+r(this.args[0].operator)+"\\\\left("+this.args[0].args[1].printLatex()+"\\\\right)"+r(this.args[1].operator)+"\\\\left("+this.args[1].args[1].printLatex()+"\\\\right)"},o.NativeFunction.prototype.printLatex=i,o.TypedFunction.prototype.printLatex=i,o.ReducerFunction.prototype.printLatex=i,o.ParametrizedReducerFunction.prototype.printLatex=i,o.DoubleReducerFunction.prototype.printLatex=i,o.FunctionCall.prototype.printLatex=i,o.Distribution.prototype.printLatex=i,o.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args[0].printLatex()+"\\\\right)";\ndefault:return u.identifierToLatex(this.args[0]._symbol)+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args.map(n).join(", ")+"\\\\right)"}},o.List.prototype.printLatex=function(){return"\\\\left["+this.args.map(n).join(", ")+"\\\\right]"},o.Range.prototype.printLatex=function(){return"\\\\left["+this.args[0].args.map(n).join(", ")+" ... "+this.args[1].args.map(n).join(", ")+"\\\\right]"},o.ListAccess.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)\\\\left["+this.args[1].printLatex()+"\\\\right]"},o.OrderedPair.prototype.printLatex=function(){return"\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},o.Sum.prototype.printLatex=function(){return"\\\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"},o.Product.prototype.printLatex=function(){return"\\\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"},o.Integral.prototype.printLatex=function(){return"\\\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)d"+this.args[0].printLatex()},o.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)^{"+this.args[2].printLatex()+"}"},o.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)!"},o.Piecewise.prototype.printLatex=function(){var e=this;if(a(e.args[0]))return e.args[1].printLatex();for(var t=["\\\\left\\\\{"];;){if(a(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),": "),s(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),", "),!(e.args[2]instanceof o.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push("\\\\right\\\\}"),t.join("")},o.FunctionDefinition.prototype.printLatex=function(){return u.identifierToLatex(this._symbol)+"\\\\left("+this._argSymbols.map(u.identifierToLatex).join(", ")+"\\\\right) = "+this._expression.printLatex()},o.Derivative.prototype.printLatex=function(){return"\\\\frac{d}{d"+u.identifierToLatex(this._symbol)+"}\\\\left("+this.args[0].printLatex()+"\\\\right)"},o.Regression.prototype.printLatex=function(){return"\\\\left("+this._lhs.printLatex()+"\\\\right)\\\\sim\\\\left("+this._rhs.printLatex()+"\\\\right)"},o.Polygon.prototype.printLatex=function(){return"\\\\polygon\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},o.Histogram.prototype.printLatex=function(){return"\\\\histogram\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},o.DotPlot.prototype.printLatex=function(){return"\\\\dotplot\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},o.BoxPlot.prototype.printLatex=function(){return"\\\\boxplot\\\\left("+this.args.map(n).join(", ")+"\\\\right)"}}),define("math/features/statistics",["require","parsenodes","math/maybe-rational"],function(e){var t=e("parsenodes"),r=t.BuiltInFunction,n=e("math/maybe-rational").maybeRational,i=t.Constant(n(0,1)),a=t.Constant(n(1,1)),s=t.Constant(n(2,1)),o=t.Constant(-(1/0));r.normdist.prototype.pdf=function(e){return r.normalpdf([e[0],this.args[0],this.args[1]])},r.normdist.prototype.cdf=function(e){var t,n;return 1===e.length?(t=o,n=e[0]):(t=e[0],n=e[1]),r.normalcdf([t,n,this.args[0],this.args[1]])},r.normdist.prototype.mean=function(){return this.args[0]},r.normdist.prototype.median=function(){return this.args[0]},r.normdist.prototype.stdev=function(){return r.abs([this.args[1]])},r.normdist.prototype.var=function(){return t.Exponent([this.args[1],s])},r.normdist.prototype.quantile=function(e){return t.Divide([t.Add([r.invNorm(e),this.args[0]]),this.args[1]])},r.tdist.prototype.pdf=function(e){return r.tpdf([e[0],this.args[0]])},r.tdist.prototype.cdf=function(e){var t,n;return 1===e.length?(t=o,n=e[0]):(t=e[0],n=e[1]),r.tcdf([t,n,this.args[0]])},r.tdist.prototype.mean=function(){return i},r.tdist.prototype.median=function(){return i},r.tdist.prototype.quantile=function(e){return r.invT([e[0],this.args[0]])},r.tdist.prototype.stdev=function(){return r.sqrt([this.var()])},r.tdist.prototype.var=function(){var e=this.args[0];return t.Piecewise([t.Comparator[">="]([e,s]),t.Divide([e,t.Subtract([e,s])]),t.Constant(NaN)])},r.poissondist.prototype.pdf=function(e){return r.poissonpdf([e[0],this.args[0]])},r.poissondist.prototype.cdf=function(e){var t,n;return 1===e.length?(t=o,n=e[0]):(t=e[0],n=e[1]),r.poissoncdf([t,n,this.args[0]])},r.poissondist.prototype.mean=function(){return this.args[0]},r.poissondist.prototype.stdev=function(){return r.sqrt([this.args[0]])},r.poissondist.prototype.var=function(){return this.args[0]},r.poissondist.prototype.quantile=function(e){return r.invPoisson([e[0],this.args[0]])},r.binomdist.prototype.pdf=function(e){return r.binompdf([e[0],this.args[0],this.args[1]])},r.binomdist.prototype.cdf=function(e){var t,n;return 1===e.length?(t=o,n=e[0]):(t=e[0],n=e[1]),r.binomcdf([t,n,this.args[0],this.args[1]])},r.binomdist.prototype.mean=function(){return t.Multiply([this.args[0],this.args[1]])},r.binomdist.prototype.stdev=function(){return r.sqrt([this.var()])},r.binomdist.prototype.var=function(){var e=this.args[0],r=this.args[1];return t.Multiply([e,t.Multiply([r,t.Subtract([a,r])])])},r.binomdist.prototype.quantile=function(e){return r.invBinom([e[0],this.args[0],this.args[1]])}}),define("math/features/getExpressionType",["require","parsenodes","graphing/graphmode","math/expression-types","math/types"],function(e){var t=e("parsenodes"),r=e("graphing/graphmode"),n=e("math/expression-types"),i=e("math/types");t.Base.prototype.getExpressionType=function(e,t){return e===r.X||e===r.Y?n.X_OR_Y:e===r.XYPOINT||e===r.XYPOINT_MOVABLE?t===i.Point?n.SINGLE_POINT:n.POINT_LIST:e===r.PARAMETRIC?n.PARAMETRIC:e===r.POLAR?n.POLAR:e===r.IMPLICIT?n.IMPLICIT:n.X_OR_Y},t.Polygon.prototype.getExpressionType=function(e,t){return n.POLYGON},t.Histogram.prototype.getExpressionType=function(e,t){return n.HISTOGRAM},t.DotPlot.prototype.getExpressionType=function(e,t){return n.DOTPLOT},t.BoxPlot.prototype.getExpressionType=function(e,t){return n.BOXPLOT}}),define("parser",["require","math/baseparser","math/features/getConcreteTree","math/features/getValueType","math/features/typeCheck","math/features/repr","math/features/scalarEvalExpression","math/features/constantcollapsedcopy","math/features/polynomialorder","math/features/polynomialcoefficients","math/features/extractconditions","math/features/piecewiseDependsOn","math/features/bounddomain","math/features/derivative","math/features/substitute","math/features/solve","math/features/analyze","math/features/analyzeFourFunction","math/features/analyzeScientific","math/features/analyzeSingleExpressionScientific","math/features/getgraphmode","math/features/getgraphinfo","math/features/getMoveStrategy","math/features/getDefaultDragMode","math/features/tableinfo","math/features/tableerror","math/features/islinear","math/features/graph","math/features/elementAt","math/features/printLatex","math/features/statistics","math/features/getExpressionType"],function(e){var t=e("math/baseparser");return e("math/features/getConcreteTree"),e("math/features/getValueType"),e("math/features/typeCheck"),e("math/features/repr"),e("math/features/scalarEvalExpression"),e("math/features/constantcollapsedcopy"),e("math/features/polynomialorder"),e("math/features/polynomialcoefficients"),e("math/features/extractconditions"),e("math/features/piecewiseDependsOn"),e("math/features/bounddomain"),e("math/features/derivative"),e("math/features/substitute"),e("math/features/solve"),e("math/features/analyze"),e("math/features/analyzeFourFunction"),e("math/features/analyzeScientific"),e("math/features/analyzeSingleExpressionScientific"),e("math/features/getgraphmode"),e("math/features/getgraphinfo"),e("math/features/getMoveStrategy"),e("math/features/getDefaultDragMode"),e("math/features/tableinfo"),e("math/features/tableerror"),e("math/features/islinear"),e("math/features/graph"),e("math/features/elementAt"),e("math/features/printLatex"),e("math/features/statistics"),e("math/features/getExpressionType"),t}),define("math/finddependencyorder",["require","math/builtinframe","underscore"],function(e){function t(e,t,i){function a(e){y[e]=y[e]||{};var r,n=y[e];n.id=e,n.index=v,n.lowlink=v,b.push(n),n.instack=!0,v++;for(var i=t[e].getDependencies(),u=0;u<i.length;u++){var c=i[u];if(d.hasOwnProperty(c))for(var l=d[c],p=0;p<l.length;p++){var f=l[p];y.hasOwnProperty(f)?(r=y[f],r.instack&&(n.lowlink=Math.min(n.lowlink,r.index))):(a(f),r=y[f],n.lowlink=Math.min(n.lowlink,r.lowlink))}}if(n.lowlink===n.index)if(r=b.pop(),r.instack=!1,r===n)s(n);else{for(var h=[r];;)if(r=b.pop(),r.instack=!1,h.push(r),r===n)break;o(h)}}function s(e){x.push(e.id)}function o(r){var i,a,s=[];for(a=r.length-1;a>=0;a--){i=r[a];var o=t[i.id].getLegalExports(e);Array.prototype.push.apply(s,o),s.push(o[0]),x.push(i.id)}for(s=n.unique(s),s.sort(),a=0;a<s.length;a++)g[s[a]]=s}var u,c,l,p,f,h=[],d={},m={},g={},y={},v=0,b=[],x=[];if(!i){i=[];for(u in t)t.hasOwnProperty(u)&&i.push(u)}for(u in t)if(t.hasOwnProperty(u)){for(f=t[u].exportPenalty||0;h.length<f+1;)h.push([]);h[f].push(u)}for(f=0;f<h.length;f++){var _={};for(c=0;c<h[f].length;c++){u=h[f][c];var M=t[u].getLegalExports(e);for(l=0;l<M.length;l++)p=M[l],r[p]||d[p]||(_[p]=_[p]||[],_[p].push(u),_[p].length>1&&(m[p]=!0))}for(p in _)d[p]=_[p]}for(c=0;c<i.length;c++)y.hasOwnProperty(i[c])||a(i[c]);return{resolved:x,multiplyDefined:m,cyclicallyDefined:g}}var r=e("math/builtinframe"),n=e("underscore");return t}),define("math/findIntersections",["require","graphing/graphmode","./plotter","parsenodes","./distance"],function(e){function t(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function r(e,t,r,n){return r===l.X&&n===l.X||r===l.Y&&n===l.Y?function(r){return t(r)-e(r)}:(r===l.X&&n===l.Y||r===l.Y&&n===l.X)&&function(r){return r-t(e(r))}}function n(e){e instanceof f.SolvedEquation?e=e._expression:e instanceof f.OptimizedRegression&&(e=e.model);var t=[],r=[];return e instanceof f.DoubleInequality?f.List.eachArgs(e._expressions,function(e){t.push(e[0].getCompiledFunction()),r.push(e[0].isConstant&&e[1].isNaN()),t.push(e[1].getCompiledFunction()),r.push(e[1].isConstant&&e[1].isNaN())}):f.List.wrap(e).eachElement(function(e){t.push(e.getCompiledFunction()),r.push(e.isConstant&&e.isNaN())}),{functions:t,skipIntersecting:r}}function i(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)&&String(i)!==String(t)&&e[i].shouldIntersect()){var a=e[i],s=n(a.concreteTree);r.push({id:i,graphMode:a.getGraphMode(),functions:s.functions,skipIntersecting:s.skipIntersecting})}return r}function a(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function s(e,t){if(t===l.X){var r=e.y;e.y=e.x,e.x=r}}function o(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),Array.prototype.push.apply(e.intersects,t.intersects)}function u(e,t,r){var n=p.sampleXY(e,t),i=n.poi.zeros,a=n.poi.extrema,s=[],o=0,u=0;for(o=0;o<i.x.length;o++){for(;u<a.x.length&&a.x[u]<i.x[o];u++)h.approx(a.y[u],0)&&s.push(a.x[u]);s.push(i.x[o])}for(;u<a.x.length;u++)h.approx(a.y[u],0)&&s.push(a.x[u]);return{x:s,y:s.map(r)}}function c(e,c,l){var f=e[l],h=f.getGraphInfo(),m=f.getGraphMode(),g=n(f.concreteTree),y=t(g.functions.length),v=i(e,l);if(!v)return y;for(var b=0,x=0;x<v.length;x++)for(var _=v[x],M=0;M<g.functions.length;M++)if(!g.skipIntersecting[M])for(var S=g.functions[M].fn,E=p.computeDomain(c,h,S),w=0;w<_.functions.length;w++)if(!v[x].skipIntersecting[w]){var T=_.functions[w].fn,D=r(S,T,m,_.graphMode);if(D){var I=u(D,E,S);if(b+=I.x.length,b>d)return t(g.functions.length);a(I,_.id),s(I,m),o(y[M],I)}}return y}var l=e("graphing/graphmode"),p=e("./plotter").default,f=e("parsenodes"),h=e("./distance"),d=100;return{findIntersections:c,findIndicatorZeros:u}}),define("math/interpolatedlabel",["require","exports","parsenodes","math/types","graphing/label"],function(e,t,r,n,i){"use strict";function a(e){return!(e.length<2)&&("`"===e[0]&&"`"===e[e.length-1])}function s(e){for(var t,r=["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}"],n="\\\\$({"+r.join("})|\\\\$({")+"})",i=new RegExp(n,"g"),a=[],s=0,o=0;t=i.exec(e);){o=t.index,o>s&&a.push(e.substr(s,o-s));var u=t[0],c=u.replace(/[{}\\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");a.push({symbol:c,str:u}),s=t.index+u.length}return s<e.length&&a.push(e.substr(s)),{raw:e,parts:a}}function o(e,t){return t?"{"+i.truncatedLatexLabel(e,{bigCutoff:1e7,digits:8})+"}":i.truncatedPlainmathLabel(e,{bigCutoff:1e7,digits:8})}function u(e,t,i){for(var s=[],u=a(e.raw),c=0,l=e.parts;c<l.length;c++){var p=l[c];if("string"==typeof p)s.push(p);else{var f=r.Identifier(p.symbol).tryGetConcreteTree(t);if(f.valueType===n.Number){var h=f.asValue();if("number"==typeof h){s.push(o(h,u));continue}}else if(f.valueType===n.ListOfNumber&&f.args[i]){var h=f.args[i].asValue();if("number"==typeof h){s.push(o(h,u));continue}}u?s.push("{?}"):s.push("?")}}return s.join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.isMathLabel=a,t.parse=s,t.interpolate=u}),define("math/getCLSymbolMap",["require","exports","underscore"],function(e,t,r){"use strict";function n(){var e={},t={},n={},i=[];for(var a in this.statements)if(this.statements.hasOwnProperty(a)){var s=this.statements[a];switch(s.type){case"Error":break;case"Regression":n[a]=[],i.push(a);break;default:var o=s.getLegalExports(this.policy);if(o){for(var u=0,c=o;u<c.length;u++){var l=c[u];s.exportPenalty>0?t[l]=a:e[l]=a}n[a]=r.difference(s.getDependencies(),s.getDummyDependencies(),o)}}}for(var p=0,f=i;p<f.length;p++){var a=f[p],s=this.statements[a],h=s.userData.residualVariable;h&&(t[h]=a);for(var d=s.getDependencies().slice(),m={},l=void 0;l=d.pop();)if(!m[l]){m[l]=!0;var g=e[l]||t[l];g?(d.push.apply(d,n[g]),n[a].push(l)):t[l]=a}}return{exportMap:e,weakExportMap:t,dependencyMap:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.getCLSymbolMap=n}),define("math/distribution-spec",["require","exports","parser","tslib"],function(e,t,r,n){"use strict";function i(e){var t=r.parse(e),i=s[t.type];if(!i)switch("Assignment"===t.type&&(t=t._expression),t.type){case"Identifier":case"FunctionCall":i=a[t._symbol];break;default:return}if(i){for(var o={},u=i.params,c=t.args,l=0;l<u.length;l++){var p=c[l];o[u[l]]=p&&p.getInputString()||""}return n.__assign({},i,{span:t.getInputSpan(),values:o})}}Object.defineProperty(t,"__esModule",{value:!0});var a={normdist:{type:"distribution",symbol:"normdist",params:["mean","stdev"],defaults:["0","1"]},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0]},binomdist:{type:"distribution",symbol:"binomdist",params:["trials","prob success"],defaults:[void 0,"0.5"]},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0]}},s={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth","binoffset"],defaults:[void 0,"1","0"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth","binoffset"],defaults:[void 0,"1","0"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data","offset","height"],defaults:[void 0,"3","4"]}};t.parseToplevelFunction=i}),define("math/policyFourFunction",["require"],function(e){var t={assignmentForbidden:function(e){return"ans"!==e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!0},disabledFeatures:function(){return["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf"]}};return t}),define("math/policyScientific",["require"],function(e){var t={assignmentForbidden:function(e){return"tmp"===e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!0},disabledFeatures:function(){return["Sum","Product","Integral","Derivative","Piecewise"]}};return t}),define("math/policySingleExpressionScientific",["require"],function(e){var t={assignmentForbidden:function(e){return"ans"!==e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!1},disabledFeatures:function(){return["Sum","Product","Integral","Derivative","Piecewise","PercentOf"]}};return t}),define("math/policyGraphing",["require","graphing/graphmode","math/builtinframe"],function(e){var t=e("graphing/graphmode"),r=e("math/builtinframe"),n={assignmentForbidden:function(e){return"x"===e||"y"===e||"theta"===e||"tmp"===e.slice(0,3)||r.hasOwnProperty(e)},isValidSlider:function(e){return"x"===e||"y"===e||"ans"!==e.slice(0,3)&&!n.assignmentForbidden(e)},sliderVariables:function(e){return e.indexOf("theta")!==-1&&(e=e.filter(function(e){return"r"!==e})),e.filter(function(e){return!n.assignmentForbidden(e)&&"ans"!==e.slice(0,3)})},graphingEnabled:function(){return!0},ansEnabled:function(){return!1},validRegressionParameter:function(e){return"x"!==e&&"y"!==e},validLHS:function(e){return"theta"!==e},unplottablePolarFunction:function(e,t){return"theta"===e&&t.indexOf("r")!==-1},validDoubleInequalitySymbol:function(e){return"x"===e||"y"===e},validDoubleInequalityVariables:function(e){return!(e.length>2)&&e.every(n.validDoubleInequalitySymbol)},validExpressionVariable:function(e){return"x"===e},validSolvedVariable:function(e){return"x"===e||"y"===e||"r"===e},validImplicitVariables:function(e){switch(e.length){case 1:return"x"===e[0]||"y"===e[0]||"r"===e[0];case 2:return"x"===e[0]&&"y"===e[1]||"y"===e[0]&&"x"===e[1]||"r"===e[0]&&"theta"===e[1]||"theta"===e[0]&&"r"===e[1];default:return!1}},graphableListVariables:function(e,t){return"x"===e||"y"===e||"r"===e||"x"===t||"y"===t},validParametricVariable:function(e){return"t"===e},validParametricVariables:function(e){return 1===e.length&&n.validParametricVariable(e[0])},validInequalityVariables:function(e){switch(e.length){case 1:return"x"===e[0]||"y"===e[0]||"r"===e[0];case 2:return n.validImplicitVariables(e);default:return!1}},validFirstColumnVariable:function(e){return"y"!==e&&"r"!==e&&"theta"!==e&&!e.match(/y_(\\d+)/)},complicatedPolarImplicit:function(e,t){return"theta"===e||"r"===e&&1!==t},constantGraphMode:function(e){return"x"===e?t.X:"r"===e?t.POLAR:t.Y},graphMode:function(e,r){return"y"===r?t.X:"x"===e?t.X:"r"===e&&"theta"===r?t.POLAR:t.Y},tableableAsConstant:function(e){return"x"!==e&&("r"!==e&&"theta"!==e)},implicitIndependent:function(e){return"x"},implicitDependency:function(e){return"y"===e?"x":"theta"===e?"r":"y"},graphableAsConstant:function(e){return"y"===e||"x"===e||"r"===e},disabledFeatures:function(){return[]}};return n}),define("math/frameFourFunction",["require"],function(e){return{frame:{},restrictedFunctionsFrame:{}}}),define("math/frameScientific",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){function t(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key \'"+n+"\' does not exist in table. Must be one of:\\n"+Object.keys(t).join("\\n"))}}function r(e,r,n,i){t(r,i),t(n,i);for(var a=0;a<r.length;a++){var s=r[a];n.indexOf(s)===-1&&(e[s]=i[s])}}var n=e("math/builtinconstants"),i=e("math/parsenode/builtinfunction"),a={},s=["pi","e","trigAngleMultiplier"],o=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","mean","round","stdev","stdevp","nCr","nPr","exp","factorial"];return r(a,s,[],n),r(a,o,[],i),{frame:a,restrictedFunctionsFrame:a}}),define("math/frameSingleExpressionScientific",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){function t(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key \'"+n+"\' does not exist in table. Must be one of:\\n"+Object.keys(t).join("\\n"))}}function r(e,r,n,i){t(r,i),t(n,i);for(var a=0;a<r.length;a++){var s=r[a];n.indexOf(s)===-1&&(e[s]=i[s])}}var n=e("math/builtinconstants"),i=e("math/parsenode/builtinfunction"),a={},s=["pi","e","trigAngleMultiplier"],o=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","exp","factorial"];return r(a,s,[],n),r(a,o,[],i),{frame:a,restrictedFunctionsFrame:a}}),define("math/frameGraphing",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){var t,r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i=["csc","sec","cot","arccsc","arcsec","arccot","csch","sech","coth","arccsch","arcsech","arccoth","mad","cov"],a={},s={};for(t in r)r.hasOwnProperty(t)&&(a[t]=r[t],s[t]=r[t]);for(t in n)n.hasOwnProperty(t)&&(a[t]=n[t],i.indexOf(t)===-1&&(s[t]=n[t]));return{frame:a,restrictedFunctionsFrame:s}}),define("math/context",["require","console","pjs","underscore","./plotter","parser","math/parsenode/constant","math/parsenode/functioncall","math/parsenode/image","math/parsenode/slider","math/parsenode/table","math/parsenode/tablecolumn","math/parsenode/freevariable","math/parsenode/builtinfunction","math/finddependencyorder","math/errormsg","graphing/graphmode","worker/workerconfig","./findIntersections","./interpolatedlabel","math/types","math/expression-types","math/getCLSymbolMap","math/distribution-spec","math/maybe-rational","math/policyFourFunction","math/policyScientific","math/policySingleExpressionScientific","math/policyGraphing","math/frameFourFunction","math/frameScientific","math/frameSingleExpressionScientific","math/frameGraphing"],function(e){function t(e,t,r){r||(r=[]);var n;return n=t?I[e].restrictedFunctionsFrame:I[e].frame,r.indexOf("sqrt")!==-1&&(n=Object.create(n),n.sqrt=m.sqrt),n}function r(e){var t=e.rawTree.userData,r=e.rawTree.metaData;return t.cdf&&t.cdf.show&&r.distributionSpec}var n=e("console"),i=e("pjs"),a=e("underscore"),s=e("./plotter").default,o=e("parser"),u=e("math/parsenode/constant"),c=e("math/parsenode/functioncall"),l=e("math/parsenode/image"),p=e("math/parsenode/slider"),f=e("math/parsenode/table"),h=e("math/parsenode/tablecolumn"),d=e("math/parsenode/freevariable"),m=e("math/parsenode/builtinfunction"),g=e("math/finddependencyorder"),y=e("math/errormsg"),v=e("graphing/graphmode"),b=e("worker/workerconfig"),x=e("./findIntersections").findIntersections,_=e("./interpolatedlabel"),M=e("math/types"),S=e("math/expression-types"),E=e("math/getCLSymbolMap").getCLSymbolMap,w=e("math/distribution-spec"),T=e("math/maybe-rational").maybeRational,D={fourFunction:e("math/policyFourFunction"),scientific:e("math/policyScientific"),singleExpressionScientific:e("math/policySingleExpressionScientific"),graphing:e("math/policyGraphing")},I={fourFunction:e("math/frameFourFunction"),scientific:e("math/frameScientific"),singleExpressionScientific:e("math/frameSingleExpressionScientific"),graphing:e("math/frameGraphing")};return i(function(e){function i(e,t){return e?"0"===e?A:"1"===e?L:o.parse(e,t):q}function m(e,t){if(e)return o.parse(e,t)}function I(e){return"ans"!==e.slice(0,3)}function C(e,t){var r,n=e.multiplyDefined,i=e.cyclicallyDefined;for(r in n)n.hasOwnProperty(r)&&(t[r]=y.multiplyDefined(r));for(r in i)i.hasOwnProperty(r)&&(t[r]=y.cycle(i[r].filter(I)))}function P(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];e[i]||(e[i]=[]),e[i].push(t)}}function O(e,t,r){var n,i,a=e.evaluationState,s=e.rawTree,o=s.metaData.cdfMin,l=s.metaData.cdfMax,p=NaN,f=NaN,h={};if(a.variables)for(i=0;i<a.variables.length;i++)h[a.variables[i]]=!0;if(o){var d=o.tryGetConcreteTree(r);for(d.isConstant&&(p=d.asValue()),n=d.getDependencies(),i=0;i<n.length;i++)h[n[i]]=!0}else p=-(1/0);if(l){var m=l.tryGetConcreteTree(r);for(m.isConstant&&(f=m.asValue()),n=m.getDependencies(),i=0;i<n.length;i++)h[n[i]]=!0}else f=1/0;var g=!0,v=!0;if(isNaN(p)&&(g=!1,p=NaN),isNaN(f)&&(v=!1,f=NaN),g?v?p>f&&(g=!1,v=!1,a.error=y.cdfMaxLessThanMin().getError()):a.error=y.cdfMaxInvalid().getError():a.error=y.cdfMinInvalid().getError(),g&&v){var b="Assignment"===s.type?s._expression:s,x=c("cdf",[b,u(p),u(f)]);a.cdf_evaluation=+x.tryGetConcreteTree(r).asValue()}s.metaData.evaluatedCDFMin=p,s.metaData.evaluatedCDFMax=f,a.cdf_min_valid=g,a.cdf_max_valid=v,a.is_single_identifier=!1,a.variables=t.sliderVariables(Object.keys(h))}function N(e,t,r){var n,i,a=e.evaluationState,s=e.rawTree,o=a.expression_type===S.POLAR?s.metaData.polarDomainMin:s.metaData.parametricDomainMin,u=a.expression_type===S.POLAR?s.metaData.polarDomainMax:s.metaData.parametricDomainMax,c=NaN,l=NaN,p=!1,f={};if(o){p=!0;var h=o.tryGetConcreteTree(r);for(h.isConstant&&(c=h.asValue()),n=h.getDependencies(),i=0;i<n.length;i++)f[n[i]]=!0}else c=0;if(u){p=!0;var d=u.tryGetConcreteTree(r);for(d.isConstant&&(l=d.asValue()),n=d.getDependencies(),i=0;i<n.length;i++)f[n[i]]=!0}else a.expression_type===S.PARAMETRIC?l=1:a.expression_type===S.POLAR&&(l=12*Math.PI/r.trigAngleMultiplier.asValue());var m=!0,g=!0;isFinite(c)||(m=!1,c=NaN),isFinite(l)||(g=!1,l=NaN),m?g?c>l&&(m=!1,g=!1,a.error=y.domainMaxLessThanMin().getError()):a.error=y.domainMaxInvalid().getError():a.error=y.domainMinInvalid().getError(),s.metaData.evaluatedDomainMin=c,s.metaData.evaluatedDomainMax=l,a.expression_type===S.POLAR&&(s.metaData.isExplicitDomain=p),a.domain_min_number=c,a.domain_max_number=l,a.domain_min_valid=m,a.domain_max_valid=g,a.expression_type===S.PARAMETRIC&&(delete f.t,a.variables=t.sliderVariables(Object.keys(f)))}e.triggerGraphComputed=function(){},e.triggerStatusChange=function(){},e.triggerRemoveGraph=function(){},e.triggerRender=function(){},e.triggerRenderSlowly=function(){},e.triggerDidAddStatement=function(){},e.triggerDidRemoveStatement=function(){},e.triggerDidUpdateIntersections=function(){},e.init=function(){this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.intersectIds={},this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.setEvaluationMode("graphing"),this.setRestrictedFunctions(!1),this.setFunctionDefinition(!0),this.invalidate()},e.getCLSymbolMap=E,e.processChangeSet=function(e){e.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={}),e.viewState&&this.setViewState(e.viewState),e.hasOwnProperty("degreeMode")&&this.setDegreeMode(e.degreeMode),e.hasOwnProperty("evaluationMode")&&this.setEvaluationMode(e.evaluationMode),e.hasOwnProperty("additionalFunctions")&&this.setAdditionalFunctions(e.additionalFunctions),e.hasOwnProperty("restrictedFunctions")&&this.setRestrictedFunctions(e.restrictedFunctions),e.hasOwnProperty("functionDefinition")&&this.setFunctionDefinition(e.functionDefinition),e.hasOwnProperty("pointsOfInterest")&&this.setPointsOfInterest(e.pointsOfInterest),e.hasOwnProperty("plotSingleVariableImplicitEquations")&&this.setPlotSingleVariableImplicitEquations(e.plotSingleVariableImplicitEquations),e.hasOwnProperty("intersectIds")&&(this.intersectIds=e.intersectIds),this.processStatements(e),this.updateAnalysis(),e.hasOwnProperty("intersectId")&&this._updateIntersections(e.intersectId),this._publishAllStatuses(),this._computeAllLabels(),this._graphAllChanged(),this.unpublishedIds={},e.isCompleteState?this.triggerRenderSlowly():this.triggerRender()},e.processStatements=function(e){var t;if(e.statements)for(var r in e.statements){var n=e.statements[r];if(null===n){if(!e.isCompleteState&&this.statements.hasOwnProperty(r)&&(t=this.statements[r].getAllIds()),this.removeStatement(r),!e.isCompleteState&&t){for(var i=0;i<t.length;i++)this.triggerRemoveGraph(t[i]);this.triggerDidRemoveStatement(r)}}else this.addStatement(n),e.isCompleteState||this.triggerDidAddStatement(n)}},e.setViewState=function(e){if(!a.isEqual(e,this.viewState)){this.viewState=e;for(var t in this.statements)this.statements.hasOwnProperty(t)&&(this.unpublishedIds[t]=!0)}},e.getViewState=function(){if(this.viewState){var e=Object.create(this.viewState);return this.parent_frame&&this.parent_frame.trigAngleMultiplier?e.trigAngleMultiplier=this.parent_frame.trigAngleMultiplier.asValue():e.trigAngleMultiplier=1,e}},e.setDegreeMode=function(e){this.use_degrees=e,this.invalidate()},e.setEvaluationMode=function(e){this.evaluationMode=e,this.policy=D[e],this.invalidate()},e.setAdditionalFunctions=function(e){this.additionalFunctions=e,this.invalidate()},e.setRestrictedFunctions=function(e){this.restrictedFunctions=e,this.invalidate()},e.setFunctionDefinition=function(e){this.functionDefinition=e,this.invalidate()},e.setPointsOfInterest=function(e){e!==b.pointsOfInterest&&(b.pointsOfInterest=e,this.invalidate())},e.setPlotSingleVariableImplicitEquations=function(e){e!==b.plotSingleVariableImplicitEquations&&(b.plotSingleVariableImplicitEquations=e,this.invalidate())},e._publishAllStatuses=function(){var e={},t=this.currentStatus;this.currentStatus={};for(var r in this.unpublishedIds)if(this.analysis.hasOwnProperty(r)){var n=this.analysis[r].evaluationState;JSON.stringify(n)!==JSON.stringify(t[r])&&(e[r]=n),this.currentStatus[r]=n}this.triggerStatusChange(e)},e._computeAllLabels=function(){for(var e in this.currentLabel){var t=this.statements[e];if(t){var r=t.tryGetConcreteTree(this.frame),n=1;r.valueType===M.ListOfPoint&&(n=r.args.length);for(var i=[],s=0;s<n;s++)i.push(_.interpolate(this.currentLabel[e],this.frame,s));a.isEqual(i,t.computedLabels)||(t.computedLabels=i,this.unpublishedIds[e]=!0)}}},e._graphAllChanged=function(){var e=this.getViewState();if(s.validateViewState(e)){for(var t in this.unpublishedIds)if(this.analysis.hasOwnProperty(t)){var r=this.analysis[t],n=r.evaluationState.expression_type,i=n===S.SINGLE_POINT||n===S.POINT_LIST;if(r.rawTree.isTable)for(var o=r.graph(e),u=r.rawTree.getAllIds(),c=0;c<u.length;c++)o[u[c]]?this.triggerGraphComputed(u[c],o[u[c]]):this.triggerRemoveGraph(u[c]);else r.evaluationState.is_graphable&&(r.rawTree.userData.shouldGraph||r.rawTree.userData.showLabel&&i)?(this.triggerGraphComputed(t,r.graph(e)),this.intersectIds.hasOwnProperty(t)&&this._updateIntersections(t)):this.triggerRemoveGraph(t)}if(a.keys(this.unpublishedIds).length)for(var l in this.intersectIds)this.unpublishedIds.hasOwnProperty(l)||this.intersectIds.hasOwnProperty(l)&&this._updateIntersections(l)}},e._updateIntersections=function(e){if(this.viewState){if(!this.analysis[e]||!this.analysis[e].shouldIntersect())return void this.triggerDidUpdateIntersections(e,[]);var t=x(this.analysis,this.viewState,e);this.triggerDidUpdateIntersections(e,t)}},e.getDisabledFeatures=function(){var e,t=this.policy.disabledFeatures();e=this.functionDefinition===!1?t.concat("FunctionDefinition"):t;var r=this.additionalFunctions||[];return e=e.filter(function(e){return("Exponent"!==e||r.indexOf("exponent")===-1)&&("PercentOf"!==e||r.indexOf("percent")===-1)}.bind(this))};var A=u(T(0,1)),L=u(T(1,1)),q=u(NaN);e.addStatement=function(e){if(e){var t=e.id;this.markExportsDirty(t),this.markAsDirtyRoot(t);var r={index:this.policy.ansEnabled()?e.index:void 0,disabledFeatures:this.getDisabledFeatures()},n={};switch(e.type){case"table":var a=[];this.statements.hasOwnProperty(t)&&(a=this.statements[t].getAllIds()),e.shouldGraph=!0;for(var s,c,d,g=e.columns,y=[],v=0,b=0;b<g.length;b++)v=Math.max(g[b].values.length,v);for(var x=0;x<g.length;x++){s=o.parse(g[x].latex,r),c=[];for(var M=-1,S=0;S<g[x].values.length;S++)g[x].values[S].replace(/\\\\space/g,"").match(/\\S/)?(c.push(o.parse(g[x].values[S],r)),M=S):c.push(u(NaN));c=c.slice(0,M+1),d=h(s,v,c),d.id=g[x].id,d.header&&(d.header.userData=g[x]),d.header&&(d.header.metaData={}),y.push(d)}this.statements[t]=f(y);var E=this,T=this.statements[t].getAllIds();a.forEach(function(e){T.indexOf(e)===-1&&E.triggerRemoveGraph(e)});break;case"image":var D="-\\\\trigAngleMultiplier*\\\\arctan(\\\\sin("+e.angle+"),\\\\cos("+e.angle+"))";this.statements[t]=l({center:o.parse(e.center,r),radianAngle:o.parse(D,r),width:o.parse(e.width,r),height:o.parse(e.height,r)});break;default:if(this.statements[t]=o.parse(e.latex,r),this.statements[t].shouldPromoteToSlider(this.policy)){var I=e.slider;this.statements[t]=p(this.statements[t],{\nsliderMin:m(I&&I.min,r),sliderMax:m(I&&I.max,r),sliderStep:m(I&&I.step,r)})}else if(e.polarDomain&&e.polarDomain.min&&(n.polarDomainMin=i(e.polarDomain.min,r)),e.polarDomain&&e.polarDomain.max&&(n.polarDomainMax=i(e.polarDomain.max,r)),e.parametricDomain&&e.parametricDomain.min&&(n.parametricDomainMin=i(e.parametricDomain.min,r)),e.parametricDomain&&e.parametricDomain.max&&(n.parametricDomainMax=i(e.parametricDomain.max,r)),e.cdf&&e.cdf.show){var C=w.parseToplevelFunction(e.latex,r);C&&"distribution"===C.type&&(n.distributionSpec=C,n.cdfMin=m(e.cdf.min,r),n.cdfMax=m(e.cdf.max,r))}}if(this.statements[t].userData=e,this.statements[t].metaData=n,e.label){var P=this.currentLabel[t];P&&P.raw===e.label||(this.currentLabel[t]=_.parse(e.label))}else delete this.currentLabel[t]}},e.removeStatement=function(e){var t=this.statements[e];if(t){if(this.markExportsDirty(e),t.isTable){var r=this;t.getAllIds().forEach(function(e){r.triggerRemoveGraph(e)})}else this.triggerRemoveGraph(e);delete this.currentLabel[e],delete this.statements[e],delete this.analysis[e]}},e.invalidate=function(){for(var e in this.statements)this.statements.hasOwnProperty(e)&&this.markAsDirtyRoot(e);this.currentStatus={},this.analysis={},this.parent_frame=Object.create(t(this.evaluationMode,this.restrictedFunctions,this.additionalFunctions)),this.parent_frame.trigAngleMultiplier=u(this.use_degrees?Math.PI/180:T(1,1)),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)},e.markExportsDirty=function(e){if(this.statements[e]){this.statements[e].isRegression&&(this.markedRegressionDirty=!0);for(var t=this.statements[e].getLegalExports(this.policy),r=0;r<t.length;r++)this.dirtyExportedSymbolRoots[t[r]]=!0}},e.markAsDirtyRoot=function(e){this.dirtyStatementRoots[e]=!0},e.getFrame=function(){return this.updateAnalysis(),this.frame},e.getAnalysis=function(){return this.updateAnalysis(),this.analysis},e.getStatus=function(e){if(this.updateAnalysis(),this.analysis[e])return this.analysis[e].status},e.getEvaluationState=function(e){if(this.updateAnalysis(),this.analysis[e])return this.analysis[e].evaluationState},e._updateRegressions=function(e){var t,r=this.frame,n=this.lastFrame,i=this.regressionFrame,a=[];for(t in e)e.hasOwnProperty(t)&&e[t].isRegression&&a.push(t);var s=this;a.sort(function(e,t){var r=s.statements[e].userData&&s.statements[e].userData.residualVariable,n=s.statements[t].userData&&s.statements[t].userData.residualVariable;return r&&!n?-1:n&&!r?1:0});var o=g(this.policy,e,a);C(o,i);for(var u=o.resolved,c={},l=0;l<u.length;l++)if(t=u[l],this.statements[t].isRegression)this.analysis[t]=e[t].analyze(this.policy,i,r,n,c),this.analysis[t].exportTo(this.policy,r),delete e[t];else{var p=e[t].tryGetConcreteTree(i);e[t].exportTo(this.policy,p,i),c[t]={rawTree:e[t],concreteTree:p}}},e.buildSymbolToExpressionDirtyMap=function(){var e={};for(var t in this.statements)if(this.statements.hasOwnProperty(t)){var r=this.statements[t],n=r.metaData;P(e,t,r.getDependencies()),P(e,t,r.getLegalExports(this.policy)),n.polarDomainMin&&P(e,t,n.polarDomainMin.getDependencies()),n.polarDomainMax&&P(e,t,n.polarDomainMax.getDependencies()),n.parametricDomainMin&&P(e,t,n.parametricDomainMin.getDependencies()),n.parametricDomainMax&&P(e,t,n.parametricDomainMax.getDependencies()),n.cdfMin&&P(e,t,n.cdfMin.getDependencies()),n.cdfMax&&P(e,t,n.cdfMax.getDependencies())}return e},e.getDirtyIdsAndSymbols=function(){var e,t,r,n=this.buildSymbolToExpressionDirtyMap(),i={},a={},s=this.markedRegressionDirty,o=[],u=[];for(e in this.dirtyStatementRoots)this.dirtyStatementRoots[e]&&(a[e]=!0,o.push(e));for(r in this.dirtyExportedSymbolRoots)this.dirtyExportedSymbolRoots[r]&&(i[r]=!0,u.push(r));for(;o.length||u.length;){for(;o.length;){e=o.pop();var c=this.statements[e];if(c){c.isRegression&&(s=!0);var l=c.getLegalExports(this.policy);for(t=0;t<l.length;t++)r=l[t],i[r]||(i[r]=!0,u.push(r))}}for(;u.length;){r=u.pop();var p=n[r];if(p)for(t=0;t<p.length;t++)e=p[t],a[e]||(a[e]=!0,o.push(e))}}return{ids:a,symbols:i,hasDirtyRegression:s}},e.updateAnalysis=function(){var e,t,n,i=this.getDirtyIdsAndSymbols();if(i.hasDirtyRegression){n={};for(e in this.statements)this.statements[e]&&(n[e]=this.statements[e]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{var a=i.ids;n={};for(e in a)this.statements[e]&&(n[e]=this.statements[e]);var s=i.symbols;for(t in s)s[t]&&(delete this.frame[t],delete this.regressionFrame[t])}for(e in n)n[e]&&(this.unpublishedIds[e]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};var o=this.analysis,u=this.frame;"graphing"===this.evaluationMode&&this._updateRegressions(n);var c=g(this.policy,n);C(c,u);for(var l=c.resolved,p=0;p<l.length;p++)switch(e=l[p],this.evaluationMode){case"fourFunction":o[e]=this.statements[e].analyzeFourFunction(this.policy,u,o),o[e].exportTo(this.policy,u);break;case"scientific":o[e]=this.statements[e].analyzeScientific(this.policy,u,o),o[e].exportTo(this.policy,u);break;case"singleExpressionScientific":o[e]=this.statements[e].analyzeSingleExpressionScientific(this.policy,u,o),o[e].exportTo(this.policy,u);break;case"graphing":if(u.r){var f=Object.create(u);if(f.r=d("r"),o[e]=this.statements[e].analyze(this.policy,f,o),o[e].getGraphMode()===v.POLAR){o[e].exportTo(this.policy,u);continue}}o[e]=this.statements[e].analyze(this.policy,u,o),o[e].exportTo(this.policy,u)}if("graphing"===this.evaluationMode)for(p=0;p<l.length;p++){e=l[p];var h=o[e],m=h.evaluationState.expression_type;m===S.PARAMETRIC||m===S.POLAR?N(o[e],this.policy,u):r(o[e])&&O(o[e],this.policy,u)}this.lastFrame=Object.create(this.parent_frame);for(t in u)u.hasOwnProperty(t)&&(this.lastFrame[t]=u[t])},e.evaluateOnce=function(e){return n.log("Deprecated console.evaluateOnce - this should not run in production code"),this.analysis[e].concreteTree.asValue()},e.compile=function(e){return n.log("Deprecated console.compile - this should not run in production code"),this.analysis[e].concreteTree.getCompiledFunction()},e.evalStrings=function(e){return n.log("Deprecated console.evalStrings - this should not run in production code"),this.analysis[e].concreteTree.getEvalStrings()}})}),define("worker/workercore",["require","math/context","math/functions"],function(e){var t=e("math/context"),r=e("math/functions");return function(e){var n=t();return n.triggerGraphComputed=function(t,n){r.dehydrateGraphData(n),e("graphComputed",{id:t,graphData:n})},n.triggerDidUpdateIntersections=function(t,r){e("updateIntersections",{id:t,intersections:r})},n.triggerRender=function(){e("render")},n.triggerRenderSlowly=function(){e("renderSlowly")},n.triggerRemoveGraph=function(t){e("removeGraph",t)},n.triggerStatusChange=function(t){e("statusChange",t)},{processChangeSet:function(t){n.processChangeSet(t),e("processChangeSet",t)}}}}),define("worker/worker",["require","worker/workercore","console"],function(e){var t=e("worker/workercore"),r={},n=e("console");n.log=function(e){self.postMessage({log:JSON.stringify(e)})};var i=self;i.window=i,i.onmessage=function(e){var n=e.data&&e.data.connectionId;if(n)if("destroy"===e.data.originalMessage.type)delete r[n];else{var a=r[n];a||(a=t(function(e,t){i.postMessage({connectionId:n,originalMessage:{type:e,payload:t}})}),r[n]=a),a.processChangeSet(e.data.originalMessage)}},i.loadMessageQueue&&(i.loadMessageQueue.forEach(function(e){i.onmessage(e)}),delete i.loadMessageQueue)}),"undefined"==typeof window&&("undefined"==typeof requirejs&&(importScripts("../vendor/require.js"),importScripts("config.js")),self.loadMessageQueue=[],self.onmessage=function(e){self.loadMessageQueue.push(e)},requirejs(["worker/worker"])),define("toplevel/worker",function(){});'}),define("worker_src",["require","text!worker_src_underlying"],function(e){return e("text!worker_src_underlying")}),define("worker/create_worker_url",["require","worker_src"],function(e){var n=e("worker_src");return function(){if(!n.length)return"/assets/generated/combined/toplevel/worker.js";var t;try{t=new Blob([n],{type:"application/javascript"})}catch(e){try{var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);r.append(n),t=r.getBlob("application/javascript")}catch(t){return null}}return(window.URL||window.webkitURL).createObjectURL(t)}}),define("math/finddependencyorder",["require","math/builtinframe","underscore"],function(e){var u=e("math/builtinframe"),x=e("underscore");return function(p,d,e){function h(e){m[e]=m[e]||{};var t,r,n=m[e];n.id=e,n.index=y,n.lowlink=y,v.push(n),n.instack=!0,y++;for(var i=d[e].getDependencies(),o=0;o<i.length;o++){var a=i[o];if(f.hasOwnProperty(a))for(var s=f[a],l=0;l<s.length;l++){var c=s[l];m.hasOwnProperty(c)?(t=m[c]).instack&&(n.lowlink=Math.min(n.lowlink,t.index)):(h(c),t=m[c],n.lowlink=Math.min(n.lowlink,t.lowlink))}}if(n.lowlink===n.index)if((t=v.pop()).instack=!1,t===n)r=n,b.push(r.id);else{for(var u=[t];(t=v.pop()).instack=!1,u.push(t),t!==n;);!function(e){var t,r,n=[];for(r=e.length-1;0<=r;r--){t=e[r];var i=d[t.id].getLegalExports(p);Array.prototype.push.apply(n,i),n.push(i[0]),b.push(t.id)}for((n=x.unique(n)).sort(),r=0;r<n.length;r++)g[n[r]]=n}(u)}}var t,r,n,i,o,a=[],f={},s={},g={},m={},y=0,v=[],b=[];if(!e)for(t in e=[],d)d.hasOwnProperty(t)&&e.push(t);for(t in d)if(d.hasOwnProperty(t)){for(o=d[t].exportPenalty||0;a.length<o+1;)a.push([]);a[o].push(t)}for(o=0;o<a.length;o++){var l={};for(r=0;r<a[o].length;r++){t=a[o][r];var c=d[t].getLegalExports(p);for(n=0;n<c.length;n++)i=c[n],u[i]||f[i]||(l[i]=l[i]||[],l[i].push(t),1<l[i].length&&(s[i]=!0))}for(i in l)f[i]=l[i]}for(r=0;r<e.length;r++)m.hasOwnProperty(e[r])||h(e[r]);return{resolved:b,multiplyDefined:s,cyclicallyDefined:g}}}),define("math/findIntersections",["require","graphing/graphmode","./plotter","parsenodes","./distance"],function(e){function x(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function w(t,r,e,n){return e===i.X&&n===i.X||e===i.Y&&n===i.Y?function(e){return r(e)-t(e)}:(e===i.X&&n===i.Y||e===i.Y&&n===i.X)&&function(e){return e-r(t(e))}}function _(e){e instanceof n.SolvedEquation?e=e._expression:e instanceof n.OptimizedRegression&&(e=e.model);var t=[],r=[];return e instanceof n.DoubleInequality?n.List.eachArgs(e._expressions,function(e){t.push(e[0].getCompiledFunction()),r.push(e[0].isConstant&&e[1].isNaN()),t.push(e[1].getCompiledFunction()),r.push(e[1].isConstant&&e[1].isNaN())}):n.List.wrap(e).eachElement(function(e){t.push(e.getCompiledFunction()),r.push(e.isConstant&&e.isNaN())}),{functions:t,skipIntersecting:r}}function S(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function E(e,t){if(t===i.X){var r=e.y;e.y=e.x,e.x=r}}function M(e,t,r){var n=I.sampleXY(e,t),i=n.poi.zeros,o=n.poi.extrema,a=[],s=0,l=0;for(s=0;s<i.x.length;s++){for(;l<o.x.length&&o.x[l]<i.x[s];l++)c.approx(o.y[l],0)&&a.push(o.x[l]);a.push(i.x[s])}for(;l<o.x.length;l++)c.approx(o.y[l],0)&&a.push(o.x[l]);return{x:a,y:a.map(r)}}var i=e("graphing/graphmode"),I=e("./plotter").default,n=e("parsenodes"),c=e("./distance");return{findIntersections:function(e,t,r){var n,i,o=e[r],a=o.getGraphInfo(),s=o.getGraphMode(),l=_(o.concreteTree),c=x(l.functions.length),u=function(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)&&String(n)!==String(t)&&e[n].shouldIntersect()){var i=e[n],o=_(i.concreteTree);r.push({id:n,graphMode:i.getGraphMode(),functions:o.functions,skipIntersecting:o.skipIntersecting})}return r}(e,r);if(!u)return c;for(var p=0,d=0;d<u.length;d++)for(var h=u[d],f=0;f<l.functions.length;f++)if(!l.skipIntersecting[f])for(var g=l.functions[f].fn,m=I.computeDomain(t,a,g),y=0;y<h.functions.length;y++)if(!u[d].skipIntersecting[y]){var v=w(g,h.functions[y].fn,s,h.graphMode);if(v){var b=M(v,m,g);if(100<(p+=b.x.length))return x(l.functions.length);S(b,h.id),E(b,s),n=c[f],i=b,Array.prototype.push.apply(n.x,i.x),Array.prototype.push.apply(n.y,i.y),Array.prototype.push.apply(n.intersects,i.intersects)}}return c},findIndicatorZeros:M}}),define("math/interpolatedlabel",["require","exports","parsenodes","math/types","graphing/label"],function(e,t,u,p,r){"use strict";function d(e){return!(e.length<2)&&"`"===e[0]&&"`"===e[e.length-1]}function h(e,t){return t?"{"+r.truncatedLatexLabel(e,{bigCutoff:1e7,digits:8})+"}":r.truncatedPlainmathLabel(e,{bigCutoff:1e7,digits:8})}Object.defineProperty(t,"__esModule",{value:!0}),t.isMathLabel=d,t.parse=function(e){for(var t,r="\\$({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"].join("})|\\$({")+"})",n=new RegExp(r,"g"),i=[],o=0,a=0;t=n.exec(e);){o<(a=t.index)&&i.push(e.substr(o,a-o));var s=t[0],l=s.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");i.push({symbol:l,str:s}),o=t.index+s.length}return o<e.length&&i.push(e.substr(o)),{raw:e,parts:i}},t.interpolate=function(e,t,r){for(var n=[],i=d(e.raw),o=0,a=e.parts;o<a.length;o++){var s=a[o];if("string"==typeof s)n.push(s);else{var l=u.Identifier(s.symbol).tryGetConcreteTree(t);if(l.valueType===p.Number){if("number"==typeof(c=l.asValue())){n.push(h(c,i));continue}}else if(l.valueType===p.ListOfNumber&&l.args[r]){var c;if("number"==typeof(c=l.args[r].asValue())){n.push(h(c,i));continue}}i?n.push("{?}"):n.push("?")}}return n.join("")}}),define("math/getCLSymbolMap",["require","exports","underscore"],function(e,t,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCLSymbolMap=function(){var e={},t={},r={},n=[];for(var i in this.statements)if(this.statements.hasOwnProperty(i))switch((p=this.statements[i]).type){case"Error":break;case"Regression":r[i]=[],n.push(i);break;default:var o=p.getLegalExports(this.policy);if(o){for(var a=0,s=o;a<s.length;a++){var l=s[a];0<p.exportPenalty?t[l]=i:e[l]=i}r[i]=m.difference(p.getDependencies(),p.getDummyDependencies(),o)}}for(var c=0,u=n;c<u.length;c++){i=u[c];var p,d=(p=this.statements[i]).userData.residualVariable;d&&(t[d]=i);var h=p.getDependencies().slice(),f={};for(l=void 0;l=h.pop();)if(!f[l]){f[l]=!0;var g=e[l]||t[l];g?(h.push.apply(h,r[g]),r[i].push(l)):t[l]=i}}return{exportMap:e,weakExportMap:t,dependencyMap:r}}}),define("math/policyFourFunction",["require"],function(e){return{assignmentForbidden:function(e){return"ans"!==e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!0},disabledFeatures:function(){return["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf"]}}}),define("math/policyScientific",["require"],function(e){return{assignmentForbidden:function(e){return"tmp"===e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!0},disabledFeatures:function(){return["Sum","Product","Integral","Derivative","Piecewise"]}}}),define("math/policySingleExpressionScientific",["require"],function(e){return{assignmentForbidden:function(e){return"ans"!==e.slice(0,3)},isValidSlider:function(e){return!1},sliderVariables:function(){return[]},graphingEnabled:function(){return!1},ansEnabled:function(){return!1},disabledFeatures:function(){return["Sum","Product","Integral","Derivative","Piecewise","PercentOf"]}}}),define("math/frameFourFunction",["require"],function(e){return{frame:{},restrictedFunctionsFrame:{}}}),define("math/frameScientific",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){function a(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key '"+n+"' does not exist in table. Must be one of:\n"+Object.keys(t).join("\n"))}}function t(e,t,r,n){a(t,n),a(r,n);for(var i=0;i<t.length;i++){var o=t[i];-1===r.indexOf(o)&&(e[o]=n[o])}}var r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i={};return t(i,["pi","e","trigAngleMultiplier"],[],r),t(i,["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","mean","round","stdev","stdevp","nCr","nPr","exp","factorial"],[],n),{frame:i,restrictedFunctionsFrame:i}}),define("math/frameSingleExpressionScientific",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){function a(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key '"+n+"' does not exist in table. Must be one of:\n"+Object.keys(t).join("\n"))}}function t(e,t,r,n){a(t,n),a(r,n);for(var i=0;i<t.length;i++){var o=t[i];-1===r.indexOf(o)&&(e[o]=n[o])}}var r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i={};return t(i,["pi","e","trigAngleMultiplier"],[],r),t(i,["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","exp","factorial"],[],n),{frame:i,restrictedFunctionsFrame:i}}),define("math/frameGraphing",["require","math/builtinconstants","math/parsenode/builtinfunction"],function(e){var t,r=e("math/builtinconstants"),n=e("math/parsenode/builtinfunction"),i=["csc","sec","cot","arccsc","arcsec","arccot","csch","sech","coth","arccsch","arcsech","arccoth","mad","cov"],o={},a={};for(t in r)r.hasOwnProperty(t)&&(o[t]=r[t],a[t]=r[t]);for(t in n)n.hasOwnProperty(t)&&(o[t]=n[t],-1===i.indexOf(t)&&(a[t]=n[t]));return{frame:o,restrictedFunctionsFrame:a}}),define("math/context",["require","console","pjs","underscore","./plotter","parser","math/parsenode/constant","math/parsenode/functioncall","math/parsenode/image","math/parsenode/slider","math/parsenode/table","math/parsenode/tablecolumn","math/parsenode/freevariable","math/parsenode/builtinfunction","math/finddependencyorder","math/errormsg","graphing/graphmode","worker/workerconfig","./findIntersections","./interpolatedlabel","math/types","math/expression-types","math/getCLSymbolMap","math/distribution-spec","math/maybe-rational","math/policyFourFunction","math/policyScientific","math/policySingleExpressionScientific","math/policyGraphing","math/frameFourFunction","math/frameScientific","math/frameSingleExpressionScientific","math/frameGraphing"],function(e){var t=e("console"),r=e("pjs"),c=e("underscore"),u=e("./plotter").default,S=e("parser"),E=e("math/parsenode/constant"),b=e("math/parsenode/functioncall"),M=e("math/parsenode/image"),I=e("math/parsenode/slider"),T=e("math/parsenode/table"),C=e("math/parsenode/tablecolumn"),x=e("math/parsenode/freevariable"),s=e("math/parsenode/builtinfunction"),k=e("math/finddependencyorder"),P=e("math/errormsg"),D=e("graphing/graphmode"),l=e("worker/workerconfig"),p=e("./findIntersections").findIntersections,A=e("./interpolatedlabel"),d=e("math/types"),L=e("math/expression-types"),h=e("math/getCLSymbolMap").getCLSymbolMap,O=e("math/distribution-spec"),f=e("math/maybe-rational").maybeRational,g={fourFunction:e("math/policyFourFunction"),scientific:e("math/policyScientific"),singleExpressionScientific:e("math/policySingleExpressionScientific"),graphing:e("math/policyGraphing")},q={fourFunction:e("math/frameFourFunction"),scientific:e("math/frameScientific"),singleExpressionScientific:e("math/frameSingleExpressionScientific"),graphing:e("math/frameGraphing")};return r(function(e){function w(e,t){return e?"0"===e?r:"1"===e?n:S.parse(e,t):a}function _(e,t){if(e)return S.parse(e,t)}function o(e){return"ans"!==e.slice(0,3)}function m(e,t){var r,n=e.multiplyDefined,i=e.cyclicallyDefined;for(r in n)n.hasOwnProperty(r)&&(t[r]=P.multiplyDefined(r));for(r in i)i.hasOwnProperty(r)&&(t[r]=P.cycle(i[r].filter(o)))}function i(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];e[i]||(e[i]=[]),e[i].push(t)}}function y(e,t,r){var n,i,o=e.evaluationState,a=e.rawTree,s=a.metaData.cdfMin,l=a.metaData.cdfMax,c=NaN,u=NaN,p={};if(o.variables)for(i=0;i<o.variables.length;i++)p[o.variables[i]]=!0;if(s){var d=s.tryGetConcreteTree(r);for(d.isConstant&&(c=d.asValue()),n=d.getDependencies(),i=0;i<n.length;i++)p[n[i]]=!0}else c=-1/0;if(l){var h=l.tryGetConcreteTree(r);for(h.isConstant&&(u=h.asValue()),n=h.getDependencies(),i=0;i<n.length;i++)p[n[i]]=!0}else u=1/0;var f=!0,g=!0;if(isNaN(c)&&(f=!1,c=NaN),isNaN(u)&&(g=!1,u=NaN),f?g?u<c&&(g=f=!1,o.error=P.cdfMaxLessThanMin().getError()):o.error=P.cdfMaxInvalid().getError():o.error=P.cdfMinInvalid().getError(),f&&g){var m="Assignment"===a.type?a._expression:a,y=b("cdf",[m,E(c),E(u)]);o.cdf_evaluation=+y.tryGetConcreteTree(r).asValue()}a.metaData.evaluatedCDFMin=c,a.metaData.evaluatedCDFMax=u,o.cdf_min_valid=f,o.cdf_max_valid=g,o.is_single_identifier=!1,o.variables=t.sliderVariables(Object.keys(p))}function v(e,t,r){var n,i,o=e.evaluationState,a=e.rawTree,s=o.expression_type===L.POLAR?a.metaData.polarDomainMin:a.metaData.parametricDomainMin,l=o.expression_type===L.POLAR?a.metaData.polarDomainMax:a.metaData.parametricDomainMax,c=NaN,u=NaN,p=!1,d={};if(s){p=!0;var h=s.tryGetConcreteTree(r);for(h.isConstant&&(c=h.asValue()),n=h.getDependencies(),i=0;i<n.length;i++)d[n[i]]=!0}else c=0;if(l){p=!0;var f=l.tryGetConcreteTree(r);for(f.isConstant&&(u=f.asValue()),n=f.getDependencies(),i=0;i<n.length;i++)d[n[i]]=!0}else o.expression_type===L.PARAMETRIC?u=1:o.expression_type===L.POLAR&&(u=12*Math.PI/r.trigAngleMultiplier.asValue());var g=!0,m=!0;isFinite(c)||(g=!1,c=NaN),isFinite(u)||(m=!1,u=NaN),g?m?u<c&&(m=g=!1,o.error=P.domainMaxLessThanMin().getError()):o.error=P.domainMaxInvalid().getError():o.error=P.domainMinInvalid().getError(),a.metaData.evaluatedDomainMin=c,a.metaData.evaluatedDomainMax=u,o.expression_type===L.POLAR&&(a.metaData.isExplicitDomain=p),o.domain_min_number=c,o.domain_max_number=u,o.domain_min_valid=g,o.domain_max_valid=m,o.expression_type===L.PARAMETRIC&&(delete d.t,o.variables=t.sliderVariables(Object.keys(d)))}e.triggerGraphComputed=function(){},e.triggerStatusChange=function(){},e.triggerRemoveGraph=function(){},e.triggerRender=function(){},e.triggerRenderSlowly=function(){},e.triggerDidAddStatement=function(){},e.triggerDidRemoveStatement=function(){},e.triggerDidUpdateIntersections=function(){},e.init=function(){this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.intersectIds={},this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.setEvaluationMode("graphing"),this.setRestrictedFunctions(!1),this.setFunctionDefinition(!0),this.invalidate()},e.getCLSymbolMap=h,e.processChangeSet=function(e){e.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={}),e.viewState&&this.setViewState(e.viewState),e.hasOwnProperty("degreeMode")&&this.setDegreeMode(e.degreeMode),e.hasOwnProperty("evaluationMode")&&this.setEvaluationMode(e.evaluationMode),e.hasOwnProperty("additionalFunctions")&&this.setAdditionalFunctions(e.additionalFunctions),e.hasOwnProperty("restrictedFunctions")&&this.setRestrictedFunctions(e.restrictedFunctions),e.hasOwnProperty("functionDefinition")&&this.setFunctionDefinition(e.functionDefinition),e.hasOwnProperty("pointsOfInterest")&&this.setPointsOfInterest(e.pointsOfInterest),e.hasOwnProperty("plotSingleVariableImplicitEquations")&&this.setPlotSingleVariableImplicitEquations(e.plotSingleVariableImplicitEquations),e.hasOwnProperty("intersectIds")&&(this.intersectIds=e.intersectIds),this.processStatements(e),this.updateAnalysis(),e.hasOwnProperty("intersectId")&&this._updateIntersections(e.intersectId),this._publishAllStatuses(),this._computeAllLabels(),this._graphAllChanged(),this.unpublishedIds={},e.isCompleteState?this.triggerRenderSlowly():this.triggerRender()},e.processStatements=function(e){var t;if(e.statements)for(var r in e.statements){var n=e.statements[r];if(null===n){if(!e.isCompleteState&&this.statements.hasOwnProperty(r)&&(t=this.statements[r].getAllIds()),this.removeStatement(r),!e.isCompleteState&&t){for(var i=0;i<t.length;i++)this.triggerRemoveGraph(t[i]);this.triggerDidRemoveStatement(r)}}else this.addStatement(n),e.isCompleteState||this.triggerDidAddStatement(n)}},e.setViewState=function(e){if(!c.isEqual(e,this.viewState))for(var t in this.viewState=e,this.statements)this.statements.hasOwnProperty(t)&&(this.unpublishedIds[t]=!0)},e.getViewState=function(){if(this.viewState){var e=Object.create(this.viewState);return this.parent_frame&&this.parent_frame.trigAngleMultiplier?e.trigAngleMultiplier=this.parent_frame.trigAngleMultiplier.asValue():e.trigAngleMultiplier=1,e}},e.setDegreeMode=function(e){this.use_degrees=e,this.invalidate()},e.setEvaluationMode=function(e){this.evaluationMode=e,this.policy=g[e],this.invalidate()},e.setAdditionalFunctions=function(e){this.additionalFunctions=e,this.invalidate()},e.setRestrictedFunctions=function(e){this.restrictedFunctions=e,this.invalidate()},e.setFunctionDefinition=function(e){this.functionDefinition=e,this.invalidate()},e.setPointsOfInterest=function(e){e!==l.pointsOfInterest&&(l.pointsOfInterest=e,this.invalidate())},e.setPlotSingleVariableImplicitEquations=function(e){e!==l.plotSingleVariableImplicitEquations&&(l.plotSingleVariableImplicitEquations=e,this.invalidate())},e._publishAllStatuses=function(){var e={},t=this.currentStatus;for(var r in this.currentStatus={},this.unpublishedIds)if(this.analysis.hasOwnProperty(r)){var n=this.analysis[r].evaluationState;JSON.stringify(n)!==JSON.stringify(t[r])&&(e[r]=n),this.currentStatus[r]=n}this.triggerStatusChange(e)},e._computeAllLabels=function(){for(var e in this.currentLabel){var t=this.statements[e];if(t){var r=t.tryGetConcreteTree(this.frame),n=1;r.valueType===d.ListOfPoint&&(n=r.args.length);for(var i=[],o=0;o<n;o++)i.push(A.interpolate(this.currentLabel[e],this.frame,o));c.isEqual(i,t.computedLabels)||(t.computedLabels=i,this.unpublishedIds[e]=!0)}}},e._graphAllChanged=function(){var e=this.getViewState();if(u.validateViewState(e)){for(var t in this.unpublishedIds)if(this.analysis.hasOwnProperty(t)){var r=this.analysis[t],n=r.evaluationState.expression_type,i=n===L.SINGLE_POINT||n===L.POINT_LIST;if(r.rawTree.isTable)for(var o=r.graph(e),a=r.rawTree.getAllIds(),s=0;s<a.length;s++)o[a[s]]?this.triggerGraphComputed(a[s],o[a[s]]):this.triggerRemoveGraph(a[s]);else r.evaluationState.is_graphable&&(r.rawTree.userData.shouldGraph||r.rawTree.userData.showLabel&&i)?(this.triggerGraphComputed(t,r.graph(e)),this.intersectIds.hasOwnProperty(t)&&this._updateIntersections(t)):this.triggerRemoveGraph(t)}if(c.keys(this.unpublishedIds).length)for(var l in this.intersectIds)this.unpublishedIds.hasOwnProperty(l)||this.intersectIds.hasOwnProperty(l)&&this._updateIntersections(l)}},e._updateIntersections=function(e){if(this.viewState){if(!this.analysis[e]||!this.analysis[e].shouldIntersect())return void this.triggerDidUpdateIntersections(e,[]);var t=p(this.analysis,this.viewState,e);this.triggerDidUpdateIntersections(e,t)}},e.getDisabledFeatures=function(){var e,t=this.policy.disabledFeatures();e=!1===this.functionDefinition?t.concat("FunctionDefinition"):t;var r=this.additionalFunctions||[];return e.filter(function(e){return!("Exponent"===e&&-1!==r.indexOf("exponent")||"PercentOf"===e&&-1!==r.indexOf("percent"))}.bind(this))};var r=E(f(0,1)),n=E(f(1,1)),a=E(NaN);e.addStatement=function(e){if(e){var t=e.id;this.markExportsDirty(t),this.markAsDirtyRoot(t);var r={index:this.policy.ansEnabled()?e.index:void 0,disabledFeatures:this.getDisabledFeatures()},n={};switch(e.type){case"table":var i=[];this.statements.hasOwnProperty(t)&&(i=this.statements[t].getAllIds()),e.shouldGraph=!0;for(var o,a,s,l=e.columns,c=[],u=0,p=0;p<l.length;p++)u=Math.max(l[p].values.length,u);for(var d=0;d<l.length;d++){o=S.parse(l[d].latex,r),a=[];for(var h=-1,f=0;f<l[d].values.length;f++)l[d].values[f].replace(/\\space/g,"").match(/\S/)?(a.push(S.parse(l[d].values[f],r)),h=f):a.push(E(NaN));a=a.slice(0,h+1),(s=C(o,u,a)).id=l[d].id,s.header&&(s.header.userData=l[d]),s.header&&(s.header.metaData={}),c.push(s)}this.statements[t]=T(c);var g=this,m=this.statements[t].getAllIds();i.forEach(function(e){-1===m.indexOf(e)&&g.triggerRemoveGraph(e)});break;case"image":var y="-\\trigAngleMultiplier*\\arctan(\\sin("+e.angle+"),\\cos("+e.angle+"))";this.statements[t]=M({center:S.parse(e.center,r),radianAngle:S.parse(y,r),width:S.parse(e.width,r),height:S.parse(e.height,r)});break;default:if(this.statements[t]=S.parse(e.latex,r),this.statements[t].shouldPromoteToSlider(this.policy)){var v=e.slider;this.statements[t]=I(this.statements[t],{sliderMin:_(v&&v.min,r),sliderMax:_(v&&v.max,r),sliderStep:_(v&&v.step,r)})}else if(e.polarDomain&&e.polarDomain.min&&(n.polarDomainMin=w(e.polarDomain.min,r)),e.polarDomain&&e.polarDomain.max&&(n.polarDomainMax=w(e.polarDomain.max,r)),e.parametricDomain&&e.parametricDomain.min&&(n.parametricDomainMin=w(e.parametricDomain.min,r)),e.parametricDomain&&e.parametricDomain.max&&(n.parametricDomainMax=w(e.parametricDomain.max,r)),e.cdf&&e.cdf.show){var b=O.parseToplevelFunction(e.latex,r);b&&"distribution"===b.type&&(n.distributionSpec=b,n.cdfMin=_(e.cdf.min,r),n.cdfMax=_(e.cdf.max,r))}}if(this.statements[t].userData=e,this.statements[t].metaData=n,e.label){var x=this.currentLabel[t];x&&x.raw===e.label||(this.currentLabel[t]=A.parse(e.label))}else delete this.currentLabel[t]}},e.removeStatement=function(e){var t=this.statements[e];if(t){if(this.markExportsDirty(e),t.isTable){var r=this;t.getAllIds().forEach(function(e){r.triggerRemoveGraph(e)})}else this.triggerRemoveGraph(e);delete this.currentLabel[e],delete this.statements[e],delete this.analysis[e]}},e.invalidate=function(){for(var e in this.statements)this.statements.hasOwnProperty(e)&&this.markAsDirtyRoot(e);var t,r,n,i;this.currentStatus={},this.analysis={},this.parent_frame=Object.create((t=this.evaluationMode,r=this.restrictedFunctions,(n=this.additionalFunctions)||(n=[]),i=r?q[t].restrictedFunctionsFrame:q[t].frame,-1!==n.indexOf("sqrt")&&((i=Object.create(i)).sqrt=s.sqrt),i)),this.parent_frame.trigAngleMultiplier=E(this.use_degrees?Math.PI/180:f(1,1)),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)},e.markExportsDirty=function(e){if(this.statements[e]){this.statements[e].isRegression&&(this.markedRegressionDirty=!0);for(var t=this.statements[e].getLegalExports(this.policy),r=0;r<t.length;r++)this.dirtyExportedSymbolRoots[t[r]]=!0}},e.markAsDirtyRoot=function(e){this.dirtyStatementRoots[e]=!0},e.getFrame=function(){return this.updateAnalysis(),this.frame},e.getAnalysis=function(){return this.updateAnalysis(),this.analysis},e.getStatus=function(e){if(this.updateAnalysis(),this.analysis[e])return this.analysis[e].status},e.getEvaluationState=function(e){if(this.updateAnalysis(),this.analysis[e])return this.analysis[e].evaluationState},e._updateRegressions=function(e){var t,r=this.frame,n=this.lastFrame,i=this.regressionFrame,o=[];for(t in e)e.hasOwnProperty(t)&&e[t].isRegression&&o.push(t);var a=this;o.sort(function(e,t){var r=a.statements[e].userData&&a.statements[e].userData.residualVariable,n=a.statements[t].userData&&a.statements[t].userData.residualVariable;return r&&!n?-1:n&&!r?1:0});var s=k(this.policy,e,o);m(s,i);for(var l=s.resolved,c={},u=0;u<l.length;u++)if(t=l[u],this.statements[t].isRegression)this.analysis[t]=e[t].analyze(this.policy,i,r,n,c),this.analysis[t].exportTo(this.policy,r),delete e[t];else{var p=e[t].tryGetConcreteTree(i);e[t].exportTo(this.policy,p,i),c[t]={rawTree:e[t],concreteTree:p}}},e.buildSymbolToExpressionDirtyMap=function(){var e={};for(var t in this.statements)if(this.statements.hasOwnProperty(t)){var r=this.statements[t],n=r.metaData;i(e,t,r.getDependencies()),i(e,t,r.getLegalExports(this.policy)),n.polarDomainMin&&i(e,t,n.polarDomainMin.getDependencies()),n.polarDomainMax&&i(e,t,n.polarDomainMax.getDependencies()),n.parametricDomainMin&&i(e,t,n.parametricDomainMin.getDependencies()),n.parametricDomainMax&&i(e,t,n.parametricDomainMax.getDependencies()),n.cdfMin&&i(e,t,n.cdfMin.getDependencies()),n.cdfMax&&i(e,t,n.cdfMax.getDependencies())}return e},e.getDirtyIdsAndSymbols=function(){var e,t,r,n=this.buildSymbolToExpressionDirtyMap(),i={},o={},a=this.markedRegressionDirty,s=[],l=[];for(e in this.dirtyStatementRoots)this.dirtyStatementRoots[e]&&(o[e]=!0,s.push(e));for(r in this.dirtyExportedSymbolRoots)this.dirtyExportedSymbolRoots[r]&&(i[r]=!0,l.push(r));for(;s.length||l.length;){for(;s.length;){e=s.pop();var c=this.statements[e];if(c){c.isRegression&&(a=!0);var u=c.getLegalExports(this.policy);for(t=0;t<u.length;t++)i[r=u[t]]||(i[r]=!0,l.push(r))}}for(;l.length;){var p=n[r=l.pop()];if(p)for(t=0;t<p.length;t++)o[e=p[t]]||(o[e]=!0,s.push(e))}}return{ids:o,symbols:i,hasDirtyRegression:a}},e.updateAnalysis=function(){var e,t,r,n=this.getDirtyIdsAndSymbols();if(n.hasDirtyRegression){for(e in r={},this.statements)this.statements[e]&&(r[e]=this.statements[e]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{var i=n.ids;for(e in r={},i)this.statements[e]&&(r[e]=this.statements[e]);var o=n.symbols;for(t in o)o[t]&&(delete this.frame[t],delete this.regressionFrame[t])}for(e in r)r[e]&&(this.unpublishedIds[e]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};var a=this.analysis,s=this.frame;"graphing"===this.evaluationMode&&this._updateRegressions(r);var l,c,u,p=k(this.policy,r);m(p,s);for(var d=p.resolved,h=0;h<d.length;h++)switch(e=d[h],this.evaluationMode){case"fourFunction":a[e]=this.statements[e].analyzeFourFunction(this.policy,s,a),a[e].exportTo(this.policy,s);break;case"scientific":a[e]=this.statements[e].analyzeScientific(this.policy,s,a),a[e].exportTo(this.policy,s);break;case"singleExpressionScientific":a[e]=this.statements[e].analyzeSingleExpressionScientific(this.policy,s,a),a[e].exportTo(this.policy,s);break;case"graphing":if(s.r){var f=Object.create(s);if(f.r=x("r"),a[e]=this.statements[e].analyze(this.policy,f,a),a[e].getGraphMode()===D.POLAR){a[e].exportTo(this.policy,s);continue}}a[e]=this.statements[e].analyze(this.policy,s,a),a[e].exportTo(this.policy,s)}if("graphing"===this.evaluationMode)for(h=0;h<d.length;h++){var g=a[e=d[h]].evaluationState.expression_type;g===L.PARAMETRIC||g===L.POLAR?v(a[e],this.policy,s):(l=a[e],void 0,c=l.rawTree.userData,u=l.rawTree.metaData,c.cdf&&c.cdf.show&&u.distributionSpec&&y(a[e],this.policy,s))}for(t in this.lastFrame=Object.create(this.parent_frame),s)s.hasOwnProperty(t)&&(this.lastFrame[t]=s[t])},e.evaluateOnce=function(e){return t.log("Deprecated console.evaluateOnce - this should not run in production code"),this.analysis[e].concreteTree.asValue()},e.compile=function(e){return t.log("Deprecated console.compile - this should not run in production code"),this.analysis[e].concreteTree.getCompiledFunction()},e.evalStrings=function(e){return t.log("Deprecated console.evalStrings - this should not run in production code"),this.analysis[e].concreteTree.getEvalStrings()}})}),define("worker/workercore",["require","math/context","math/functions"],function(e){var n=e("math/context"),i=e("math/functions");return function(r){var t=n();return t.triggerGraphComputed=function(e,t){i.dehydrateGraphData(t),r("graphComputed",{id:e,graphData:t})},t.triggerDidUpdateIntersections=function(e,t){r("updateIntersections",{id:e,intersections:t})},t.triggerRender=function(){r("render")},t.triggerRenderSlowly=function(){r("renderSlowly")},t.triggerRemoveGraph=function(e){r("removeGraph",e)},t.triggerStatusChange=function(e){r("statusChange",e)},{processChangeSet:function(e){t.processChangeSet(e),r("processChangeSet",e)}}}}),define("worker/fakeworker",["require","worker/workercore"],function(e){var n=e("worker/workercore");return function(r){var e={},t=n(function(e,t){r({type:e,payload:t})});return e.postMessage=function(e){setTimeout(function(){t.processChangeSet(e)},0)},e}}),define("lib/urlparser",["require"],function(e){return{getParameter:function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[void 0,""])[1].replace(/\+/g,"%20"))||null}}}),define("worker/workerpool",["require","console","./create_worker_url","pjs","underscore_model","./fakeworker","underscore","lib/urlparser"],function(e){function i(t){return c?function(e){u=Math.max(Date.now(),u)+c,setTimeout(t,u-Date.now(),e)}:t}var r=e("console"),n=e("./create_worker_url"),t=e("pjs"),o=e("underscore_model").UnderscoreModel,a=e("./fakeworker"),s=e("underscore"),l=e("lib/urlparser").getParameter("workerThrottle"),c=parseInt(l,10),u=0;return t(o,function(e,t){e.init=function(e){t.init.call(this),this.workers=[],this.maxWorkers=e,this.workerURL=n()},e.allowedToSpawnWorker=function(){return this.workerURL&&this.workers.length<this.maxWorkers},e.killWorker=function(e){-1!==s.indexOf(this.workers,e)&&(e.terminate(),this.workers=s.without(this.workers,e),s.shuffle(s.values(e.__connections)).forEach(function(e){e&&e.onWorkerKilled&&e.onWorkerKilled()}))},e.spawnWorker=function(){try{var n=new Worker(this.workerURL);return n.__connections={},n.__isFake=!1,n.onerror=function(e){r.log(e)},n.addEventListener("message",i(function(e){var t=e.data;if((!t||!t.log)&&t&&t.connectionId){var r=n.__connections[t.connectionId];r&&r.onResponse(t.originalMessage)}})),this.workers.push(n),n}catch(n){return null}},e.spawnFakeWorker=function(){var r=a(i(function(e){var t=s.values(r.__connections)[0];t&&t.onResponse(e)}));return r.__isFake=!0,r.__connections={},r},e.findLeastUsedWorker=function(){return s.sortBy(this.workers,function(e){return s.size(e.__connections)})[0]},e.allocateWorker=function(){var e=null;return this.allowedToSpawnWorker()&&(e=this.spawnWorker()),e||(e=this.findLeastUsedWorker()),e||(e=this.spawnFakeWorker()),e}})}),define("main/evaluator",["require","exports","worker/workerpoolconnection","worker/workerpool","math/functions","lib/deepCopy"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.listeners={processChangeSet:function(e){for(var t=e.syncId;this.syncRequests.length&&void 0!==t&&this.syncRequests[0].id<=t;){this.syncRequests.shift().callback()}this.resume(),this.__state.droppedMessage=!1,this.clearJobTimer(),this._processChangeSet()},removeGraph:function(e){delete this.__addedGraphsBuffer[e],delete this.__intersectionsBuffer[e],this.__removedGraphsBuffer[e]=!0},graphComputed:function(e){i.rehydrateGraphData(e.graphData),delete this.__removedGraphsBuffer[e.id],this.__addedGraphsBuffer[e.id]=e.graphData},updateIntersections:function(e){this.__intersectionsBuffer[e.id]=e.intersections},statusChange:function(e){this.triggerStatusChange(e)},render:function(){this.triggerGraphData(this.getGraphDataFromBuffer()),this.clearBuffers(),this.triggerRender()},renderSlowly:function(){this.triggerGraphData(this.getGraphDataFromBuffer()),this.clearBuffers(),this.triggerRenderSlowly()}},this.__state={},this.changeSet=null,this.cumulativeChangeSet={},this.__isSuspended=!1,this.clearJobTimer(),this.syncId=1,this.syncRequests=[],this.clearBuffers(),e||(e=n()),this.workerPool=e,this.createWorkerPoolConnection()}return e.prototype.triggerStatusChange=function(e){},e.prototype.triggerGraphData=function(e){},e.prototype.triggerRender=function(){},e.prototype.triggerRenderSlowly=function(){},e.prototype.createWorkerPoolConnection=function(){var t=this;this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=r(this.workerPool),this.workerPoolConnection.onResponse=function(e){t.isSuspended()&&"processChangeSet"!==e.type||t.listeners[e.type].call(t,e.payload)},this.workerPoolConnection.onWorkerKilled=function(){t.createWorkerPoolConnection(),t.resume(),t.hasJobInWorker()?(t.changeSet=o.default(t.cumulativeChangeSet),t.__state.changed=!0,t.__state.droppedMessage=!0,t.clearJobTimer()):(t.changeSet=o.default(t.cumulativeChangeSet),t.__state.changed=!1),t.processChangeSet()}},e.prototype.clearBuffers=function(){this.__addedGraphsBuffer={},this.__removedGraphsBuffer={},this.__intersectionsBuffer={}},e.prototype.getGraphDataFromBuffer=function(){return{addedGraphs:this.__addedGraphsBuffer,removedGraphs:this.__removedGraphsBuffer,intersections:this.__intersectionsBuffer}},e.prototype.destroy=function(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())},e.prototype.isSuspended=function(){return this.__isSuspended},e.prototype.suspend=function(){this.__isSuspended=!0},e.prototype.resume=function(){this.__isSuspended=!1},e.prototype.clearJobTimer=function(){this.__jobStartTime=-1},e.prototype.startJobTimer=function(){this.__jobStartTime=(new Date).getTime()},e.prototype.hasJobInWorker=function(){return-1!==this.__jobStartTime},e.prototype.getJobElapsedTime=function(){return this.hasJobInWorker()?(new Date).getTime()-this.__jobStartTime:NaN},e.prototype.tick=function(){this._processChangeSet()},e.prototype.processChangeSet=function(){this.__processChangeSetRequested=!0},e.prototype._processChangeSet=function(){if(this.__processChangeSetRequested){var e=4e3<=this.getJobElapsedTime();if(this.__state.droppedMessage&&e)return void this.workerPoolConnection.killWorker();if(this.__state.changed&&this.changeSet)if(this.hasJobInWorker())this.changeSet.isCompleteState&&e&&this.workerPoolConnection.killWorker();else{var t=this.changeSet;this.changeSet=null,this.__state.changed=!1,this.startJobTimer(),this.workerPoolConnection.sendMessage(t),this.__processChangeSetRequested=!1}}},e.prototype.notifyWhenSynced=function(e){var t=this;return this.hasJobInWorker()||this.__processChangeSetRequested?(this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),void this.applyToChangeSets(function(e){e.syncId=t.syncId})):void setTimeout(e,0)},e.prototype.applyToChangeSets=function(e){this.__state.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.processChangeSet()},e.prototype.setViewState=function(t){this.applyToChangeSets(function(e){e.viewState=o.default(t)})},e.prototype.clearStatementsAndStartCompleteState=function(){this.clearBuffers(),this.hasJobInWorker()&&this.suspend(),this.applyToChangeSets(function(e){e.isCompleteState=!0,delete e.statements}),this.cumulativeChangeSet=o.default(this.changeSet)},e.prototype.addStatement=function(t){this.applyToChangeSets(function(e){e.statements||(e.statements={}),e.statements[t.id]=o.default(t)})},e.prototype.addStatements=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.addStatement(n)}},e.prototype.removeStatement=function(t){this.applyToChangeSets(function(e){e.statements||(e.statements={}),e.statements[t]=null})},e.prototype.removeStatements=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.removeStatement(n)}},e.prototype.setIntersectIds=function(t){this.applyToChangeSets(function(e){e.intersectIds=o.default(t)})},e.prototype.updateIntersections=function(t){this.applyToChangeSets(function(e){e.intersectId=t})},e.prototype.setDegreeMode=function(t){this.applyToChangeSets(function(e){e.degreeMode=t})},e.prototype.setEvaluationMode=function(t){this.applyToChangeSets(function(e){e.evaluationMode=t})},e.prototype.setAdditionalFunctions=function(t){this.applyToChangeSets(function(e){e.additionalFunctions=t})},e.prototype.setRestrictedFunctions=function(t){this.applyToChangeSets(function(e){e.restrictedFunctions=t})},e.prototype.setFunctionDefinition=function(t){this.applyToChangeSets(function(e){e.functionDefinition=t})},e.prototype.setPointsOfInterest=function(t){this.applyToChangeSets(function(e){e.pointsOfInterest=t})},e.prototype.setPlotSingleVariableImplicitEquations=function(t){this.applyToChangeSets(function(e){e.plotSingleVariableImplicitEquations=t})},e}();t.Evaluator=a}),define("jquery.disabletextselection",["require","jquery"],function(e){var t=e("jquery");t.fn.disableTextSelection=function(e){return e&&this.each(function(){t(this).bind("mousedown touchstart",function(){t(document.activeElement).focusout()})}),this.each(function(){t(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}}),define("graphing/canvaslayer",["require","jquery","pjs","browser","i18n","jquery.disabletextselection"],function(e){var t=e("jquery"),r=e("pjs"),n=e("browser"),i=e("i18n");return e("jquery.disabletextselection"),r(function(e){e.init=function(e){this.grapher=e,this.$=t("<div class='dcg-graph-outer' role='img'></div>").attr("aria-roledescription",this.t("graph paper")).css("position","absolute").css("overflow","hidden").disableTextSelection(n.IS_IE),this.canvas_node=t("<canvas class='dcg-graph-inner'></canvas>").css("position","relative").css("display","block").disableTextSelection(n.IS_IE),this.devicePixelRatio=window.devicePixelRatio||1,this.ctx=this.canvas_node[0].getContext("2d"),this.resize(0,0),this.$.append(this.canvas_node)},e.resize=function(e,t,r){r=r||this.devicePixelRatio,e===this.width&&t===this.height||(this.width=e,this.height=t,this.$.css("width",e+"px").css("height",t+"px"),this.canvas_node.css("width",e+"px").css("height",t+"px").attr("width",e*r).attr("height",t*r),this.ctx=this.canvas_node[0].getContext("2d"),this.ctx.scale(r,r))},e.t=function(e,t){return i.t(e,t,this.grapher.settings.language)},e.getAriaLabel=function(e){var t="";if(0===e)return this.t("Empty graph paper.");t=1===e?this.t("Graph paper showing 1 graph."):this.t("Graph paper showing __count__ graphs.",{count:e});var r=this.grapher.getAudioTrace();r&&!r.getAudioTraceActive()&&(void 0!==r.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})&&(t+=n.IS_APPLE?this.t(" Press OPTION+T for audio trace."):this.t(" Press ALT+T for audio trace.")));return t},e.updateAria=function(e,t){this.$.attr("aria-hidden",!e||!this.grapher.settings.config.graphpaper).attr("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex&&0<t?0:-1).attr("aria-label",this.getAriaLabel(t))},e.redraw=function(){}})}),define("loadcss!poi",function(){}),define("graphing/clipping",[],function(){function c(e){return Math.max(-1e40,Math.min(1e40,e))}var b={TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15,X:12,Y:3,POLAR_RADIAN_EQUALITY:1,POLAR_RADIAN_INEQUALITY:2,POLAR_DEGREE_EQUALITY:3,POLAR_DEGREE_INEQUALITY:4,Y_EQUALS:5,X_EQUALS:6,mapSegmentToCanvas:function(e,t,r,n){var i,o,a,s,l,c=[],u=t.xmin,p=t.ymin,d=t.xmax-t.xmin,h=t.ymax-t.ymin,f=r.width,g=r.height,m=f/d,y=-g/h,v=e.length;if(n===b.Y_EQUALS)for(i=0;i<v;i+=2)o=(e[i]-u)*m-.5,a=(e[i+1]-p)*y+g-.5,c.push(o,a);else if(n===b.X_EQUALS)for(i=0;i<v;i+=2)o=(e[i+1]-u)*m-.5,a=(e[i]-p)*y+g-.5,c.push(o,a);else if(n===b.POLAR_RADIAN_EQUALITY)for(i=0;i<e.length;i+=2)s=e[i],o=((l=e[i+1])*Math.cos(s)-u)*m-.5,a=(l*Math.sin(s)-p)*y+g-.5,c.push(o,a);else if(n===b.POLAR_RADIAN_INEQUALITY)for(i=0;i<e.length;i+=2)s=e[i],(l=e[i+1])<0&&(l=0),o=(l*Math.cos(s)-u)*m-.5,a=(l*Math.sin(s)-p)*y+g-.5,c.push(o,a);else if(n===b.POLAR_DEGREE_EQUALITY)for(i=0;i<e.length;i+=2)s=e[i]*Math.PI/180,o=((l=e[i+1])*Math.cos(s)-u)*m-.5,a=(l*Math.sin(s)-p)*y+g-.5,c.push(o,a);else if(n===b.POLAR_DEGREE_INEQUALITY)for(i=0;i<e.length;i+=2)s=e[i]*Math.PI/180,(l=e[i+1])<0&&(l=0),o=(l*Math.cos(s)-u)*m-.5,a=(l*Math.sin(s)-p)*y+g-.5,c.push(o,a);return c},clipStrokeEdges:function(e,t){return b.clipFillEdges(e,t,b.ALL,!0)},clipFillEdge:function(e,t,r,n){var i,o,a,s,l=[],c=[].push;n?(i=2,(s=t(o=e[0],a=e[1]))&&l.push(o,a)):(i=0,s=t(o=e[e.length-2],a=e[e.length-1]));for(var u=i;u<e.length;u+=2){var p=o,d=a,h=s;((s=t(o=e[u],a=e[u+1]))||h)&&(s&&h&&l.push(o,a),s&&!h&&(c.apply(l,r(o,a,p,d)),l.push(o,a)),!s&&h&&c.apply(l,r(p,d,o,a)))}return l},clipFillEdges:function(e,t,r,n){var i=t.xmin,o=t.xmax,a=t.ymin,s=t.ymax,l=e;return r&b.LEFT&&(l=b.clipFillEdge(e,function(e,t){return i<=e},function(e,t,r,n){return e=c(e),t=c(t),r=c(r),n=c(n),[i,t+(n-t)*(i-e)/(r-e)]},n)),r&b.BOTTOM&&(l=b.clipFillEdge(l,function(e,t){return a<=t},function(e,t,r,n){return e=c(e),t=c(t),r=c(r),n=c(n),[e+(r-e)*(a-t)/(n-t),a]},n)),r&b.RIGHT&&(l=b.clipFillEdge(l,function(e,t){return e<=o},function(e,t,r,n){return e=c(e),t=c(t),r=c(r),n=c(n),[o,t+(n-t)*(o-e)/(r-e)]},n)),r&b.TOP&&(l=b.clipFillEdge(l,function(e,t){return t<=s},function(e,t,r,n){return e=c(e),t=c(t),r=c(r),n=c(n),[e+(r-e)*(s-t)/(n-t),s]},n)),l},clipAllFillEdges:function(e,t){return b.clipFillEdges(e,t,b.ALL,!1)},computePolarFill:function(e,t,r){var n,i=[],o=e[0],a=o+r,s=[];i.push(s);for(var l=0;l<e.length;l+=2){n=e[l];var c=e[l+1];if(c<0&&(c=0),a<=n){for(s=[],i.push(s),a=o=e[l-2];a<=n;)a+=r;l-=4}else s.push(n,c)}if(0===t)for(l=0;l<i.length;l++)i[l].push(0,0);else{var u=r/16,p=t;for(l=0;l<i.length;l++){var d=i[l];for(o=d[0],n=a=d[d.length-2];o<n;n-=u)d.push(n,p);d.push(o,p)}}return i},computeCartesianFill:function(e,t){return(e=e.slice()).push(e[e.length-2],t),e.push(e[0],t),[e]}};return b}),define("graphing/constants",[],function(){return{ANIMATE_ZOOM_DURATION:500,DOUBLETAP_ZOOM:2,ZOOM_FACTOR:1.0625,MAX_DOTTED_SEGMENTS:1e3,FILL_ALPHA:.4,POINT_ALPHA:.9,HIGHLIGHTED_POINT_ALPHA:.6,POLAR_ALPHA:.2,POI_ALPHA:.01,OFFSCREEN_RENDER_MARGIN:20}}),define("graphing/dasheddrawer",["require","./constants","math/distance"],function(e){function t(e,t,r){return this.pattern=r,this.replen=this.pattern[0]+this.pattern[1],null!==t&&t/this.replen>n.MAX_DOTTED_SEGMENTS&&(this.pattern[0]=t*this.pattern[0]/this.replen/n.MAX_DOTTED_SEGMENTS,this.pattern[1]=t*this.pattern[1]/this.replen/n.MAX_DOTTED_SEGMENTS),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e,this}var n=e("./constants"),s=e("math/distance");return t.getTotalSegmentLength=function(e){if(e.length<4)return 0;for(var t=0,r=e[0],n=e[1],i=2;i<e.length;i+=2){var o=e[i],a=e[i+1];t+=s.hypot(o-r,a-n),r=o,n=a}return t},t.prototype.start=function(e,t){this.ctx.desmos_batching||this.ctx.beginPath(),this.px=e,this.py=t},t.prototype.next=function(e,t){var r=this.pattern[this.pstate],n=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(1e-5<n){for(;n+this.dstaccum>=r;){var i=e-this.px,o=t-this.py,a=r-this.dstaccum;i*=a/n,o*=a/n,0===this.pstate&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+i,this.py+o)),this.dstaccum=0,this.px+=i,this.py+=o,this.pstate=1-this.pstate,r=this.pattern[this.pstate],n-=a}0===this.pstate&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=n},t.prototype.skip=function(e,t){this.px=e,this.py=t},t.prototype.close=function(){this.ctx.desmos_batching||this.ctx.stroke(),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null},t}),define("graphing/draw-image-to-ctx",["require","exports","graphing-calc/models/list"],function(e,t,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawImageToCtx=function(e,t,r){if(e.computed_x)for(var n=0;n<e.computed_x.length;n++){var i=e.computed_x[n],o=e.computed_y[n],a=e.computed_width[n],s=e.computed_height[n],l=e.computed_radian_angle[n];if(isFinite(i)&&isFinite(o)&&isFinite(a)&&isFinite(s)&&isFinite(l)){t.save(),t.globalAlpha=e.opacity;var c=r.mapy(s)-r.mapy(0),u=r.mapx(a)-r.mapx(0),p=0===l?1:Math.abs(u/a*(s/c)),d=r.mapx(i),h=r.mapy(o),f=s<0?-1:1,g=a<0?-1:1,m=(d-u/2)*g,y=(h+c*p/2)*f,v=Math.abs(u),b=Math.abs(c);0!==l&&(t.translate(d,h),t.scale(1,1/p),t.rotate(l),t.translate(-d,-h)),t.scale(g,f),t.drawImage(e.imageObj,m,y,v,b*p),x.isItemSelected(e)&&(t.beginPath(),t.rect(m,y,v,b*p),t.restore(),t.save(),t.strokeStyle="#6993C7",t.lineWidth=2,t.stroke()),t.restore()}}}}),define("graphing/graphslayer",["require","pjs","./clipping","./dasheddrawer","./constants","./viewport","graphing/graphmode","expressions/colors","expressions/styles","./draw-image-to-ctx"],function(e){var t=e("pjs"),m=e("./clipping"),p=e("./dasheddrawer"),y=e("./constants"),r=e("./viewport").Viewport,v=e("graphing/graphmode"),n=e("expressions/colors"),g=e("expressions/styles"),b={},s=e("./draw-image-to-ctx").drawImageToCtx,x=function(e){return new r(-3,e.width+3,-3,e.height+3)},d=function(e){return Math.round(e-.5)+.5},w=t(function(e){e.init=function(e){if(e.config.plaidMode)for(var t in n)n.hasOwnProperty(t)&&"string"==typeof n[t]&&(b[n[t]]=document.createElement("img"),b[n[t]].setAttribute("src","/assets/img/april-fools/"+t.toLowerCase()+".png"))},e.redrawToCtx=function(n,i,o,a,e){if(void 0===e)throw new Error("Programming Error: missing drawOrder argument to redrawToCtx");e.forEach(function(e){var t=o[e],r=a[e];void 0!==t&&t.visible&&w.drawSketchToCtx(o[e],n,i),r&&r.shouldGraph&&r.foreground&&s(r,n,i)})}});return w.eachSegment=function(e,t){for(var r=0;r<e.branches.length;r++)for(var n=e.branches[r],i=0;i<n.segments.length;i++){t(n,n.segments[i])}},w.drawSketchToCtx=function(o,a,s){if(o.branches&&o.branches.length){var e=a.lineWidth,t=s.settings.globalCurveColor?s.settings.globalCurveColor:o.color,r=b[t];if(r&&r.complete&&0<r.naturalWidth){var n=a.createPattern(r,"repeat");a.fillStyle=n}else a.fillStyle=t;a.strokeStyle=t,a.lineJoin="round",a.lineCap="round";for(var i=!!s.settings.takingScreenshot,l=0;l<o.branches.length;l++){var c=o.branches[l];if(c.graphMode!==v.XYPOINT&&c.graphMode!==v.XYPOINT_MOVABLE){c.graphMode!==v.POLAR&&(a.desmos_batching=!0,a.beginPath());for(var u=0;u<c.segments.length;u++){var p=c.segments[u],d=v.Y;if(c.flip&&(d=v.X),c.graphMode&&(d=c.graphMode),d===v.POLYGONFILL)w.fillPolygonToCtx(a,s,p,c.fillOpacity);else if(d!==v.IMPLICIT){var h=c.operator,f="<="==h||"<"==h||"\\leq"==h||"\\le"==h;("<"==h||">"==h||"<="==h||">="==h||"\\leq"==h||"\\le"==h||"\\geq"==h||"\\ge"==h)&&w.fillGraphStrokeToCtx(a,s,p,f,d)}}a.globalAlpha=c.fillOpacity||y.FILL_ALPHA,c.graphMode!==v.POLAR&&(a.fill(),a.desmos_batching=!1),a.globalAlpha=1}}a.lineWidth=s.settings.graphLineWidth,o.style===g.DOTTED&&(a.lineWidth=2*s.settings.graphLineWidth),w.eachSegment(o,function(e,t){if(e.graphMode!==v.XYPOINT&&e.graphMode!==v.XYPOINT_MOVABLE){var r=v.Y;e.flip&&(r=v.X),e.graphMode&&(r=e.graphMode);var n=e.operator,i="default";"<"==n||">"==n||"!="==n||o.style===g.DASHED||e.style===g.DASHED?i=g.DASHED:o.style===g.DOTTED||e.style===g.DOTTED?(i=g.DOTTED,a.lineWidth=2*s.settings.graphLineWidth):o.style!==g.SINGLE_PIXEL&&e.style!==g.SINGLE_PIXEL||(i=g.SINGLE_PIXEL,a.lineWidth=1),w.drawGraphStrokeToCtx(a,s,t,i,r,n)}}),a.lineWidth=e,w.eachSegment(o,function(e,t){(e.graphMode===v.XYPOINT&&e.showPoint||e.graphMode===v.XYPOINT_MOVABLE&&i)&&w.drawPointsToCtx(a,s,t,e.style)})}},w.drawGraphStrokeToCtx=function(e,t,r,n,i,o){e.globalAlpha=t.settings.curveOpacity;var a,s,l=w.getClippingGraphType(i,"="!==o,t.settings),c=m.mapSegmentToCanvas(r,t.viewport,t.screen,l),u=m.clipStrokeEdges(c,x(t.screen));if(n==g.DASHED){for((s=new p(e,p.getTotalSegmentLength(u),[11,7])).start(u[0],u[1]),a=2;a<u.length;a+=2)s.next(u[a],u[a+1]);s.close()}else if(n==g.DOTTED){for((s=t.settings.config.projectorMode?new p(e,p.getTotalSegmentLength(u),[.1,16]):new p(e,p.getTotalSegmentLength(u),[.1,8])).start(u[0],u[1]),a=2;a<u.length;a+=2)s.next(u[a],u[a+1]);s.close()}else if(n===g.SINGLE_PIXEL){for(e.desmos_batching||e.beginPath(),e.moveTo(d(u[0]),d(u[1])),a=0;a<u.length;a+=2)e.lineTo(d(u[a]),d(u[a+1]));e.desmos_batching||e.stroke()}else{for(e.desmos_batching||e.beginPath(),e.moveTo(u[0],u[1]),a=0;a<u.length;a+=2)e.lineTo(u[a],u[a+1]);e.desmos_batching||e.stroke()}e.globalAlpha=1},w.mapPointToScreen=function(e,t,r){var n=e.mapx(t)-.5;if(n<-20||n>e.screen.width+20)return null;var i=e.mapy(r)-.5;return i<-20||i>e.screen.height+20?null:{x:n,y:i}},w.drawPointToCtx=function(e,t,r,n,i,o){var a,s=e.lineWidth,l=e.fillStyle,c=w.mapPointToScreen(t,r,n);return!!c&&(e.globalAlpha=t.settings.highlight?y.HIGHLIGHTED_POINT_ALPHA:y.POINT_ALPHA,i&&(e.globalAlpha=i),e.globalAlpha=y.POINT_ALPHA,e.desmos_batching||e.beginPath(),o===g.CROSS?(a=.4*t.settings.pointLineWidth,e.moveTo(c.x-a,c.y-a),e.lineTo(c.x+a,c.y+a),e.moveTo(c.x+a,c.y-a),e.lineTo(c.x-a,c.y+a),e.lineWidth=.3*t.settings.pointLineWidth):o===g.OPEN?(a=.42*t.settings.pointLineWidth,e.moveTo(c.x+a,c.y),e.arc(c.x,c.y,a,0,2*Math.PI,!0),e.closePath(),e.fillStyle="white",e.lineWidth=.25*t.settings.pointLineWidth,e.fill()):(e.moveTo(c.x-.1,c.y-.1),e.lineTo(c.x-.1,c.y+.1),e.lineTo(c.x+.1,c.y+.1),e.lineTo(c.x+.1,c.y-.1)),e.desmos_batching||e.stroke(),e.globalAlpha=1,e.lineWidth=s,e.fillStyle=l,!0)},w.drawPointsToCtx=function(e,t,r,n){var i=e.lineWidth;e.lineWidth=t.settings.pointLineWidth;for(var o=0;o<r.length;o++)w.drawPointToCtx(e,t,r[o][0],r[o][1],!1,n);e.lineWidth=i},w.fillGraphStrokeToCtx=function(e,t,r,n,i){e.globalAlpha=i===v.POLAR?y.POLAR_ALPHA:y.FILL_ALPHA;var o,a=null,s=null;if(i===v.POLAR){s=m.ALL;var l=n?0:t.viewport.polarDiameter(),c=t.settings.degreeMode?180:2*Math.PI;a=m.computePolarFill(r,l,c)}else i===v.Y?(s=m.Y,o=n?t.viewport.ymin:t.viewport.ymax,a=m.computeCartesianFill(r,o)):i===v.X&&(s=m.X,o=n?t.viewport.xmin:t.viewport.xmax,a=m.computeCartesianFill(r,o));for(var u=x(t.screen),p=0;p<a.length;p++){var d=w.getClippingGraphType(i,!0,t.settings),h=m.mapSegmentToCanvas(a[p],t.viewport,t.screen,d),f=m.clipFillEdges(h,u,s);if(6<=f.length){e.desmos_batching||e.beginPath(),e.moveTo(f[0],f[1]);for(var g=2;g<f.length;g+=2)e.lineTo(f[g],f[g+1]);e.lineTo(f[0],f[1]),e.desmos_batching||e.fill()}}e.globalAlpha=1},w.fillPolygonToCtx=function(e,t,r,n){e.globalAlpha=n||y.FILL_ALPHA;var i=x(t.screen),o=m.mapSegmentToCanvas(r,t.viewport,t.screen,m.Y_EQUALS),a=m.clipFillEdges(o,i,m.ALL);if(6<=a.length){e.desmos_batching||e.beginPath(),e.moveTo(a[0],a[1]);for(var s=2;s<a.length;s+=2)e.lineTo(a[s],a[s+1]);e.desmos_batching||e.fill()}e.globalAlpha=1},w.getClippingGraphType=function(e,t,r){switch(e){case v.X:return m.X_EQUALS;case v.IMPLICIT:case v.PARAMETRIC:case v.Y:return m.Y_EQUALS;case v.POLAR:return r.degreeMode?t?m.POLAR_DEGREE_INEQUALITY:m.POLAR_DEGREE_EQUALITY:t?m.POLAR_RADIAN_INEQUALITY:m.POLAR_RADIAN_EQUALITY}},w}),define("graphing/poidotslayer",["require","loadcss!poi","pjs","./graphslayer","./constants"],function(e){e("loadcss!poi");var t=e("pjs"),c=e("./graphslayer"),u=e("./constants"),s=t(function(e){e.init=function(){this.savedPOI=[]},e.redrawToCtx=function(e,t,r){var n=[];for(var i in r){var o=r[i];if(o.visible){o.showHighlight&&s.drawSketchHighlight(o,e,t);var a=o.getPOI();(o.showPOI||a.length&&a[0].isAttachedToPlottedPoint())&&n.push.apply(n,s.drawPOIs(a,e,"#AAAAAA",t))}}this.savedPOI=n},e.getDrawnPOI=function(){return this.savedPOI}});return s.drawSketchHighlight=function(e,t,r){r.settings.setProperty("highlight",!0),c.drawSketchToCtx(e,t,r),r.settings.setProperty("highlight",!1)},s.drawPOIs=function(e,t,r,n){t.lineWidth=n.settings.pointLineWidth,t.strokeStyle=r||"#AAAAAA",t.fillStyle=r||"#AAAAAA",t.lineJoin="round",t.lineCap="round";var i=t.globalAlpha;t.globalAlpha=u.POI_ALPHA;var o,a,s=[],l=e.length;if(l&&e[0].isAttachedToPlottedPoint())for(o=0;o<l;o++)a=e[o],c.mapPointToScreen(n,a.x,a.y)&&s.push(a);else for(o=0;o<l;o++)a=e[o],c.drawPointToCtx(t,n,a.x,a.y,u.POI_ALPHA)&&s.push(a);return t.globalAlpha=i,s},s}),define("graphing/domlayer",["require","pjs","jquery","browser","jquery.disabletextselection"],function(e){var t=e("pjs"),r=e("jquery"),n=e("browser");return e("jquery.disabletextselection"),t(function(e){e.init=function(e){this.$=r("<div class='dcg-graph-outer'></div>").css("position","absolute").css("overflow","hidden").disableTextSelection(n.IS_IE),this.dom_node=r("<div></div>").css("position","relative").css("display","block").disableTextSelection(n.IS_IE),this.$grapher=e,this.$.append(this.dom_node)},e.addGrapherClass=function(e){this.$grapher.hasClass(e)||this.$grapher.addClass(e)},e.removeGrapherClass=function(e){this.$grapher.hasClass(e)&&this.$grapher.removeClass(e)},e.resize=function(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.$.css("width",e+"px").css("height",t+"px"),this.dom_node.css("width",e+"px").css("height",t+"px"))},e.redraw=function(){}})}),define("graphing/poi",["require","exports","math/poi-type","./graphmode"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=1,i=function(){function e(e,t,r,n,i,o,a){this.x=e,this.y=t,this.type=r,this.sketch=n,this.branch=i,this.pointIdxOnBranch=o,this.bareLabel=void 0!==a&&a,this.id=s++}return e.prototype.getLabel=function(){var e=this.sketch&&this.sketch.branches[this.branch];return this.type===r.LABEL&&e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""},e.prototype.getGraphMode=function(){return this.sketch.branches[this.branch].graphMode},e.prototype.getCompiledFunction=function(){var e=this.sketch.branches[this.branch];if("compiled"in e&&e.compiled)return e.compiled.fn},e.prototype.isAttachedToPlottedPoint=function(){return this.type===r.DEFINITION||this.type===r.LABEL},e.prototype.isMovable=function(){return this.getGraphMode()===n.XYPOINT_MOVABLE},e.prototype.isPersistent=function(){return this.type===r.LABEL},e.prototype.getLabelSize=function(){var e=this.sketch&&this.sketch.branches[this.branch];if(this.type===r.LABEL&&e&&"labelSize"in e)return e.labelSize},e.prototype.getVerticalLabel=function(){var e=this.sketch&&this.sketch.branches[this.branch];return!!(this.type===r.LABEL&&e&&"verticalLabel"in e)&&!!e.verticalLabel},e.prototype.isBareLabel=function(){return this.bareLabel},e.prototype.getMovablePoint=function(){return this.sketch.getMovablePoints()[this.pointIdxOnBranch]},e}();t.POI=i}),define("graphing/integral-image",["require","exports"],function(e,t){"use strict";function r(e,t,r){return Math.max(t,Math.min(r,e))}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.data,r=e.width,n=e.height;this.imageData=e;for(var i=1;i<r;i++)t[i]+=t[i-1];for(var o=1;o<n;o++)t[o*r]+=t[o*r-r];for(var a=r*n-r-n+1,s=r-1,l=0;l<a;l++){i=1+l%s;var c=(o=1+Math.floor(l/s))*r,u=i-1+c,p=i+c-r,d=i-1+c-r;t[c+i]+=t[u]+t[p]-t[d]}}return e.prototype.getSumForValidRect=function(e){var t=e.left-1,r=e.right-1,n=e.top-1,i=e.bottom-1,o=this.imageData.width,a=this.imageData.data,s=a[t+n*o],l=a[r+n*o],c=a[t+i*o],u=a[r+i*o];return 0<=t&&0<=n?u-l-c+s:0<=t?u-c:0<=n?u-l:u},e.prototype.getSum=function(e){var t={left:r(Math.floor(e.left),0,this.imageData.width),right:r(Math.ceil(e.right),0,this.imageData.width),top:r(Math.floor(e.top),0,this.imageData.height),bottom:r(Math.ceil(e.bottom),0,this.imageData.height)};return t.right<=t.left||t.bottom<=t.top?0:this.getSumForValidRect(t)},e}();t.default=n}),define("graphing/automatic-label-placer",["require","exports","graphing/integral-image","underscore"],function(e,t,s,D){"use strict";function i(e,t){if(!(0<t.width*t.height))return new s.default({width:0,height:0,data:[]});c.width=0,c.width=Math.round(t.width*f),c.height=Math.round(t.height*f);var r=c.getContext("2d");r.save(),r.scale(c.width/e.canvas.width,c.height/e.canvas.height),r.drawImage(e.canvas,0,0),r.restore();var n=r.getImageData(0,0,c.width,c.height),i=n.data;i.length,u.length;for(var o=u=new Array(i.length/4),a=0;a<o.length;a++)o[a]=i[4*a+3];return new s.default({width:n.width,height:n.height,data:o})}function n(e,t){var r=1/0,n=-1,i=t[e];if(1===i.length)return i[0];for(var o=0;o<i.length;o++){var a=t[e][o].staticScore+l(e,o,t);(-1===n||a<r)&&(r=a,n=o)}return i[n]}function l(e,t,r){for(var n=0,i=r[e][t],o=0;o<r.length;o++)if(o!==e){for(var a=0,s=r[o],l=s.length-1;0<=l;l--){var c=s[l];a+=Math.max(0,Math.min(i.right,c.right)-Math.max(i.left,c.left))*Math.max(0,Math.min(i.bottom,c.bottom)-Math.max(i.top,c.top))}n+=a/s.length}return n}function d(t,e){var r=0;return e.forEach(function(e){r+=h(t,e)}),r}function h(e,t){return Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top))}function A(e,t){if(!(t.length<=1))for(var r=e(),n=0,i=t;n<i.length;n++){var o=i[n];o.staticScore+=(c=o,u=r.viewport,void 0,p=h(c,u),10*(c.width*c.height-p)),o.staticScore+=d(o,r.domObstructions),o.staticScore+=(a=o,s=r.integralImage,l=void 0,l=s.getSum({left:a.left*f,right:a.right*f,top:a.top*f,bottom:a.bottom*f}),(l/=200)/(f*f))}var a,s,l,c,u,p}Object.defineProperty(t,"__esModule",{value:!0});var f=.5,c=document.createElement("canvas"),u=[];t.getIntegralImage=i,t.computePositions=function(e){for(var t=0;t<e.length;t++){var r=n(t,e);e[t]=[r]}return e.map(function(e){return e[0]})},t.buildStaticEnvGetter=function(e,t,r){var n;return function(){return n||(n={domObstructions:r,viewport:{left:0,right:t.width,top:0,bottom:t.height},integralImage:i(e,t)}),n}},t.generateCandidatesForPoint=function(e,o){var t=o.nakedLabel?0:o.pt_radius,r=Math.round(t/Math.sqrt(2)),n=[],a=o.pt_x,s=o.pt_y,l=o.width,c=o.height;n.push({left:a-l/2,top:s-c/2,staticScore:-1/0,orientation:"center"}),n.push({left:a+t+3,top:s-c/2,staticScore:400,orientation:"right"}),n.push({left:a-(t+l)-3,top:s-c/2,staticScore:400,orientation:"left"}),n.push({left:a-l/2,top:s-(c+t),staticScore:400,orientation:"above"}),n.push({left:a-(l+r),top:s-(c+r),staticScore:400,orientation:"tl"}),n.push({left:a+r,top:s-(c+r),staticScore:400,orientation:"tr"}),n.push({left:a-l/2,top:s+t,staticScore:400,orientation:"below"}),n.push({left:a-(l+r),top:s+r,staticScore:400,orientation:"bl"}),n.push({left:a+r,top:s+r,staticScore:400,orientation:"br"});var i=n.map(function(e){var t=Math.round(e.left),r=Math.round(e.left+l),n=Math.round(e.top),i=Math.round(e.top+c);return{pt_x:Math.round(a),pt_y:Math.round(s),left:t,right:r,top:n,bottom:i,width:r-t,height:i-n,staticScore:o.priorOrientation===e.orientation?e.staticScore-20:e.staticScore,orientation:e.orientation}});return A(e,i=o.enforceOrientation&&"default"!==o.enforceOrientation?D.filter(i,function(e){return e.orientation===o.enforceOrientation}):o.nakedLabel?D.filter(i,function(e){return"center"===e.orientation}):o.keepOrientation&&o.priorOrientation?D.filter(i,function(e){return e.orientation===o.priorOrientation}):D.filter(i,function(e){return"center"!==e.orientation})),i},t.generateCandidatesForSegment=function(e,o){for(var t=[],a=o.width,s=o.height,r=a/2,n=s/2,i=o.pt_x1,l=o.pt_y1,c=o.pt_x2,u=o.pt_y2,p=(u-l)/(c-i),d=Math.atan2(u-l,c-i)+Math.PI/2,h=5*Math.cos(d),f=5*Math.sin(d),g=Math.min(l,u)-Math.abs(f)-s,m=Math.max(l,u)+Math.abs(f),y=[],v=0,b=[.5,.33,.66,0,1];v<b.length;v++){var x=b[v];y.push({x:i*(1-x)+c*x,y:l*(1-x)+u*x})}for(var w=0;w<y.length;w++){var _,S,E,M,I=y[w];if(2<=p||p<=-2){E=M=I.y-n;var T=Math.abs((c-i)/(u-l)*n)+Math.abs(h);_=I.x+T,S=I.x-T-a}else if(p<=.05&&-.05<=p){_=S=I.x-r;var C=Math.abs(p*r)+Math.abs(f);E=I.y-C-s,M=I.y+C}else S=0<h?(_=I.x+h,I.x-h-a):(_=I.x+h-a,I.x-h),M=0<f?(E=I.y+f,I.y-f-s):(E=I.y+f-s,I.y-f);E<g?E=g:m<E&&(E=m),M<g?M=g:m<M&&(M=m);var k=0<(c-i)*(E-l)-(u-l)*(_-i);t.push({pt_x:I.x,pt_y:I.y,left:_,top:E,staticScore:0,orientation:w.toString()+(k?"-a":"-b")}),t.push({pt_x:I.x,pt_y:I.y,left:S,top:M,staticScore:0,orientation:w.toString()+(k?"-b":"-a")})}var P=t.map(function(e){var t=Math.round(e.left),r=Math.round(e.left+a),n=Math.round(e.top),i=Math.round(e.top+s);return{pt_x:Math.round(e.pt_x),pt_y:Math.round(e.pt_y),left:t,right:r,top:n,bottom:i,width:r-t,height:i-n,staticScore:o.priorOrientation===e.orientation?e.staticScore-20:e.staticScore,orientation:e.orientation}});return o.keepOrientation&&o.priorOrientation&&(P=D.filter(P,function(e){return e.orientation===o.priorOrientation})),A(e,P),P},t.generateCandidatesForAngle=function(e,o){var t=[],r=o.pt_x,n=o.pt_y,a=o.width,s=o.height,i=o.startAngle,l=o.endAngle;l<i&&(l+=2*Math.PI);var c=(i+l)/2,u=o.isRightAngle?o.radius*Math.sqrt(2):o.radius+4,p=u+Math.sqrt(o.width*o.width/4+o.height*o.height/4),d=[],h=p*Math.sin(c);u+.5*s<h&&(h=u+.5*s),h<-u-.5*s&&(h=-u-.5*s),d.push({x:r+p*Math.cos(c)-a/2,y:n+h-s/2});for(var f=0;f<d.length;f++){var g=d[f];t.push({pt_x:g.x,pt_y:g.y,left:g.x,top:g.y,staticScore:0,orientation:f.toString()+"-a"})}var m=t.map(function(e){var t=Math.round(e.left),r=Math.round(e.left+a),n=Math.round(e.top),i=Math.round(e.top+s);return{pt_x:Math.round(e.pt_x),pt_y:Math.round(e.pt_y),left:t,right:r,top:n,bottom:i,width:r-t,height:i-n,staticScore:o.priorOrientation===e.orientation?e.staticScore-20:e.staticScore,orientation:e.orientation}});return o.keepOrientation&&o.priorOrientation&&(m=D.filter(m,function(e){return e.orientation===o.priorOrientation})),A(e,m),m},t.generateCandidatesForPolygon=function(e,o){for(var t=[],a=o.width,s=o.height,r=Math.round(10/Math.sqrt(2)),n=0,i=0,l=0,c=0;c<o.path.length-2;c+=2)l+=1,n+=o.path[c],i+=o.path[c+1];var u=n/l,p=i/l;t.push({left:u-a/2,top:p-s/2,staticScore:0,orientation:"center"}),t.push({left:u+10+3,top:p-s/2,staticScore:50,orientation:"right"}),t.push({left:u-(10+a)-3,top:p-s/2,staticScore:50,orientation:"left"}),t.push({left:u-a/2,top:p-(s+10),staticScore:50,orientation:"top"}),t.push({left:u-(a+r),top:p-(s+r),staticScore:50,orientation:"tl"}),t.push({left:u+r,top:p-(s+r),staticScore:50,orientation:"tr"}),t.push({left:u-a/2,top:p+10,staticScore:50,orientation:"bottom"}),t.push({left:u-(a+r),top:p+r,staticScore:50,orientation:"bl"}),t.push({left:u+r,top:p+r,staticScore:50,orientation:"br"});var d=t.map(function(e){var t=Math.round(e.left),r=Math.round(e.left+a),n=Math.round(e.top),i=Math.round(e.top+s);return{pt_x:Math.round(u),pt_y:Math.round(p),left:t,right:r,top:n,bottom:i,width:r-t,height:i-n,staticScore:o.priorOrientation===e.orientation?e.staticScore-20:e.staticScore,orientation:e.orientation}});return o.keepOrientation&&o.priorOrientation&&(d=D.filter(d,function(e){return e.orientation===o.priorOrientation})),A(e,d),d}}),define("graphing/poilabelslayer",["require","pjs","jquery","underscore","./domlayer","./label","graphing/graphmode","main/label-sizes","math/poi","./constants","./poi","./automatic-label-placer","lib/color-helpers","mathquill","math/interpolatedlabel"],function(e){function b(e,t,r,n){var i="html."+r;e.hasOwnProperty(i)&&e[i]===n||(t.find(r).html(n),e[i]=n)}function x(e,t,r,n){var i="visible."+r;e.hasOwnProperty(i)&&e[i]===n||(t.find(r).toggle(!!n),e[i]=n)}function w(e,t,r,n){var i="class."+r;e.hasOwnProperty(i)&&e[i]===n||(t.toggleClass(r,!!n),e[i]=n)}var t=e("pjs"),_=e("jquery"),S=e("underscore"),r=e("./domlayer"),d=e("./label"),h=e("graphing/graphmode"),E=e("main/label-sizes"),f=e("math/poi").default,l=e("./constants"),o=e("./poi").POI,c=e("./automatic-label-placer"),M=e("lib/color-helpers"),I=e("mathquill"),T=e("math/interpolatedlabel").isMathLabel,C=t(r,function(e,r){e.init=function(e,t){r.init.call(this,e),this.$labelsLayer=_('<div class="dcg-poi-labels-layer"></div>'),this.$traceLayer=_('<div class="dcg-trace-layer"></div>'),this.cachedLabels={},this.cachedMQLabels={},this.settings=t,this.dom_node.append(this.$labelsLayer),this.dom_node.append(this.$traceLayer),this.hoveredPOI=null,this.openedPOI2Sketch={}},e.renderPOILabels=function(e,n){var t=function(e,t){var r=n[t];return r&&r.visible?r.getPOIById(e):null};for(var r in this.savedPOI=[],n){var i=n[r];if(i.visible){var o=this.drawLabels(i,e);o.length&&this.savedPOI.push.apply(this.savedPOI,o)}}this.hoveredPOI&&!t(this.hoveredPOI.id,this.hoveredPOI.sketch.id)&&(this.hoveredPOI=null);var a={};for(r in this.openedPOI2Sketch){var s=t(r,this.openedPOI2Sketch[r]);s&&(a[r]=s.sketch.id,this.drawOpenedPOI(s,e),this.savedPOI.push(s))}this.openedPOI2Sketch=a,this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.addGrapherClass("dcg-mouse-over-opened-poi"):(this.drawHoveredPOI(this.hoveredPOI,e),this.addGrapherClass("dcg-mouse-over-closed-poi")):(this.removeGrapherClass("dcg-mouse-over-closed-poi"),this.removeGrapherClass("dcg-mouse-over-opened-poi"))},e.renderTracePt=function(e){var t=this.traceInfo?this.traceInfo.pt:null;if(t){var r=e.mapx(t.x),n=e.mapy(t.y);if(e.coordsAreOnscreen(r,n,l.OFFSCREEN_RENDER_MARGIN)){var i=new o(t.x,t.y,f.TRACE,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch);this.drawTracePt(i,e.viewport,{color:i.sketch.color,x:r,y:n})}}},e.drawTracePt=function(e,t,r){var n=C.getPointLabel(e,t),i=n.is_hole?" dcg-hole":"",o=n.x_label.replace("","<span class='dcg-pi'></span>"),a=n.y_label.replace("","<span class='dcg-pi'></span>"),s=this.cachedLabels.tracept;s?s.removeClass("dcg-will-remove"):((s=_('<div class="dcg-poi-label dcg-tracept dcg-temp"><div class="dcg-pt"></div><div class="dcg-label"><span class="dcg-label-paren">(</span><span class="dcg-x-value"></span>, <span class="dcg-y-value"></span><span class="dcg-label-paren">)</span></div></div>')).data("id","tracept"),this.$traceLayer.append(s)),s.find(".dcg-x-value").html(o),s.find(".dcg-y-value").html(a),s.toggleClass("dcg-hole",!!i),s.find(".dcg-pt").css("background-color",r.color),s.find(".dcg-pt").css("border-color",r.color),s.css({left:r.x+"px",top:r.y+"px"})},e.drawSinglePOI=function(e,t,r){var n=C.getPointLabel(e,t),i=n.is_hole,o=e.isPersistent(),a=e.getLabelSize(),s=e.getVerticalLabel(),l=e.isAttachedToPlottedPoint(),c=n.x_label.replace("","<span class='dcg-pi'></span>"),u=n.y_label.replace("","<span class='dcg-pi'></span>"),p=e.getLabel(),d=e.id,h=this.cachedLabels[d];h?h.removeClass("dcg-will-remove"):((h=_('<div class="dcg-poi-label dcg-tracept dcg-poi dcg-attached-to-real-point"><div class="dcg-pt"></div><div class="dcg-label"><span class="dcg-pt-value"><span class="dcg-label-paren">(</span><span class="dcg-x-value"></span>, <span class="dcg-y-value"></span><span class="dcg-label-paren">)</span></span><span class="dcg-text-value"></span></div></div>')).data("__lastRender",{}),h.data("id",d),this.$labelsLayer.append(h));var f=h.data("__lastRender");b(f,h,".dcg-x-value",c),b(f,h,".dcg-y-value",u),function(e,t,r,n,i){var o="text."+r;if(!e.hasOwnProperty(o)||e[o]!==n){var a=t.data("id");if(i.hasOwnProperty(a)&&(i[a].revert(),delete i[a]),T(n)){var s=n.substr(1,n.length-2);t.find(r).text(s),i[a]=I.StaticMath(t.find(r)[0])}else t.find(r).text(n);e[o]=n}}(f,h,".dcg-text-value",p,this.cachedMQLabels),x(f,h,".dcg-pt-value",!p),x(f,h,".dcg-text-value",!!p),w(f,h,"dcg-hole",!!i),w(f,h,"dcg-persistent",!!o),w(f,h,"dcg-size-small",a===E.SMALL),w(f,h,"dcg-size-medium",a===E.MEDIUM),w(f,h,"dcg-size-large",a===E.LARGE),w(f,h,"dcg-attached-to-real-point",!!l),w(f,h,"dcg-vertical-label",!!s),w(f,h,"dcg-opened",!!r.opened),w(f,h,"dcg-mouseover",!!r.hovered);var g,m,y,v={left:r.x+"px",top:r.y+"px"};o&&e&&e.sketch&&e.sketch.color&&(v.color=M.shadeColor(e.sketch.color,.3)),m=h,y=v,(g=f).hasOwnProperty("css")&&S.isEqual(g.css,y)||(m.css(y),g.css=y)},e.drawHoveredPOI=function(e,t){var r=t.mapx(e.x),n=t.mapy(e.y);t.coordsAreOnscreen(r,n,l.OFFSCREEN_RENDER_MARGIN)&&this.drawSinglePOI(e,t.viewport,{hovered:!0,x:r,y:n})},e.drawOpenedPOI=function(e,t){var r=t.mapx(e.x),n=t.mapy(e.y);t.coordsAreOnscreen(r,n,l.OFFSCREEN_RENDER_MARGIN)&&this.drawSinglePOI(e,t.viewport,{opened:!0,x:r,y:n})},e.drawLabels=function(e,t){var r=e.labels;if(!r.length)return[];for(var n=[],i=0;i<r.length;i++){var o=r[i],a=t.mapx(o.x),s=t.mapy(o.y);t.coordsAreOnscreen(a,s,l.OFFSCREEN_RENDER_MARGIN)&&(this.drawSinglePOI(o,t.viewport,{opened:!0,x:a,y:s}),n.push(o))}return n},e.markLabelsDirty=function(){this.labelsDirty=!0},e.positionLabels=function(e,t,r){var u=!this.labelsDirty;this.cachedLabels={},this.labelsDirty=!1;var p=this,d={};S.each(this.savedPOI,function(e){e.sketch&&(d[e.id]=e.sketch)});var h=this.settings.config.projectorMode?14:10,n=this.$.find(".dcg-poi-label").map(function(){var e=_(this),t=e.find(".dcg-label"),r=t[0].getBoundingClientRect(),n=parseFloat(e[0].style.left),i=parseFloat(e[0].style.top),o=r.width,a=r.height,s=e.data("id");s&&(p.cachedLabels[s]=e);var l=d[s]&&d[s].branches[0].nakedLabel,c=d[s]&&d[s].branches[0].labelOrientation;return{$label:t,pt_x:n,pt_y:i,pt_radius:h,nakedLabel:l,width:o,height:a,keepOrientation:u,priorOrientation:t.data("orientation"),enforceOrientation:c}}).get();n=S.filter(n,function(e){return 0<e.width&&0<e.height});var i=e.canvas.getBoundingClientRect(),o={width:i.width,height:i.height},a=c.buildStaticEnvGetter(e,o,r),s=n.map(function(e){return c.generateCandidatesForPoint(a,e)});c.computePositions(s).forEach(function(e,t){var r=n[t].$label;r.css({left:e.left-e.pt_x,top:e.top-e.pt_y}),r.data("orientation",e.orientation)})},e.redraw=function(e,t,r,n){this.resize(e.screen.width,e.screen.height),this.dom_node.find(".dcg-poi-label").addClass("dcg-will-remove"),this.renderPOILabels(e,t),this.renderTracePt(e),this.dom_node.find(".dcg-will-remove").remove(),this.positionLabels(r,t,n)},e.getDrawnPOI=function(){return this.savedPOI||[]},e.clearOpenedPOI=function(){this.openedPOI2Sketch={}},e.closePOI=function(e){delete this.openedPOI2Sketch[e.id]},e.openPOI=function(e){this.openedPOI2Sketch[e.id]=e.sketch.id},e.isOpenPOI=function(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)},e.setHoveredPOI=function(e){this.hoveredPOI=e},e.getHoveredPOI=function(){return this.hoveredPOI}});return C.getPointLabel=function(e,t){var r,n=t.xmax-t.xmin,i=t.ymax-t.ymin,o=e.getGraphMode();if(e.type===f.TRACE){var a=o===h.X,s=a?e.y:e.x,l=e.getCompiledFunction();if(r=d.point(s,n,i,l),a){var c=r[0];r[0]=r[1],r[1]=c}}else r=[d.value(e.x,n),d.value(e.y,i)];var u=r[0].superscript?r[0].mantissa+"<sup>"+r[0].superscript+"</sup>":r[0].string,p=r[1].superscript?r[1].mantissa+"<sup>"+r[1].superscript+"</sup>":r[1].string;return{x:r[0].value,x_label:u,y:r[1].value,y_label:p,is_hole:!isFinite(r[1].value)}},C}),define("graphing/stepnumber",["require","pjs"],function(e){var t=e("pjs"),n=document.createElement("canvas").getContext("2d"),i=t(function(e){e.init=function(e,t){this._label=e,this._fontSize=t,this._layout=this._computeLayout(e,t)},e._computeLayout=function(e,t){var r={};return e.superscript?(r.mantissa_height=t,i.setCtxFontSize(n,r.mantissa_height),r.mantissa_width=n.measureText(e.mantissa).width,r.superscript_height=Math.round(.8*t),i.setCtxFontSize(n,r.superscript_height),r.superscript_width=n.measureText(e.superscript).width,r.mantissa_x=0,r.mantissa_y=t/5,r.superscript_x=r.mantissa_width/2+r.superscript_width/2,r.superscript_y=-t/4,r.top=r.superscript_y-r.superscript_height/2,r.bottom=r.mantissa_y+r.mantissa_height/2,r.left=r.mantissa_x-r.mantissa_width/2,r.right=r.superscript_x+r.superscript_width/2):(r.mantissa_height=t,i.setCtxFontSize(n,t),r.mantissa_width=n.measureText(e.string).width,r.mantissa_x=0,r.mantissa_y=0,r.top=r.mantissa_y-r.mantissa_height/2,r.bottom=r.mantissa_y+r.mantissa_height/2,r.left=r.mantissa_x-r.mantissa_width/2,r.right=r.mantissa_x+r.mantissa_width/2),r},e.getRect=function(){return this.getRectWhenCenteredAt({x:0,y:0})},e.getRectWhenCenteredAt=function(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}},e.getWidth=function(){return this._layout.right-this._layout.left},e.getHeight=function(){return this._layout.bottom-this._layout.top},e.clampBoundsWithinRect=function(e,t){var r={};return e.x+this._layout.left<t.left?r.x=t.left-this._layout.left:e.x+this._layout.right>t.right?r.x=t.right-this._layout.right:r.x=e.x,e.y+this._layout.top<t.top?r.y=t.top-this._layout.top:e.y+this._layout.bottom>t.bottom?r.y=t.bottom-this._layout.bottom:r.y=e.y,r},e.getValue=function(){return this._label.value},e.getMinusWidth=function(){return this.getValue()<0?(i.setCtxFontSize(n,this._fontSize),n.measureText("-1").width-n.measureText("1").width):0},e.getString=function(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string},e.drawCenteredAt=function(e,t){var r=t.x,n=t.y;e.save(),i.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+r,this._layout.mantissa_y+n),e.strokeText(this._label.superscript,this._layout.superscript_x+r,this._layout.superscript_y+n),e.fillText(this._label.mantissa,this._layout.mantissa_x+r,this._layout.mantissa_y+n),e.fillText(this._label.superscript,this._layout.superscript_x+r,this._layout.superscript_y+n)):(e.strokeText(this._label.string,this._layout.mantissa_x+r,this._layout.mantissa_y+n),e.fillText(this._label.string,this._layout.mantissa_x+r,this._layout.mantissa_y+n)),e.restore()}});return i.setCtxFontSize=function(e,t){e.font=t+"px Arial",e.textAlign="center",e.textBaseline="middle"},i}),define("graphing/computestepsizes",["require","./stepnumber","./label"],function(e){function x(e){return e?{base:10,major:[e,2*e,5*e],minor:[4,4,5]}:S.RATIONAL_STEPS}var w=e("./stepnumber"),_=e("./label"),S={},E=function(e,t,r,n){var i=Math.ceil(e/r),o=Math.floor(t/r),a=1/r;if(!(o<i||1e4<o-i))for(var s=i;s<=o;s++)n(s/a)};return S.RATIONAL_STEPS={base:10,major:[1,2,5],minor:[5,4,5]},S.PI_STEPS={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},S.PI_FRAC_STEPS={base:2,major:[Math.PI/3],minor:[3]},S.bestStep=function(e,t){for(var r,n,i,o,a=1/0,s=0;s<t.major.length;s++)r=t.major[s],i=Math.ceil(Math.log(e/r)/Math.log(t.base)),(o=r*Math.pow(t.base,i))<a&&(n=(a=o)/t.minor[s]);return{major:a,minor:n}},S.countStepsInRange=function(e,t,r){return 1+(t-e)/r},S.calculateSpaceBetweenRects=function(e,t){var r,n;return n=e.right<t.left?t.left-e.right:t.right<e.left?e.left-t.right:0,r=e.bottom<t.top?t.top-e.bottom:t.bottom<e.top?e.top-t.bottom:0,Math.max(r,n)},S.estimateMajors=function(e){var t=e.screen.width,r=e.screen.height,n=e.viewport.xmax-e.viewport.xmin,i=e.viewport.ymax-e.viewport.ymin,o=e.settings.pixelsPerLabel;return{majorStepX:o/t*n,majorStepY:o/r*i}},S.cartesian=function(e){var t,r={},n=Math.abs(e.settings.xAxisStep),i=Math.abs(e.settings.yAxisStep),o=e.viewport.xmax-e.viewport.xmin,a=e.viewport.ymax-e.viewport.ymin,s=0<=_.value(n,o).string.indexOf(""),l=0<=_.value(i,a).string.indexOf(""),c=S.countStepsInRange(e.viewport.xmin,e.viewport.xmax,n),u=S.countStepsInRange(e.viewport.ymin,e.viewport.ymax,i),p=S.estimateMajors(e),d=e.settings.labelSize;if(n&&n!==Math.PI&&3<=c&&c<100){var h=0;e.settings.xAxisNumbers&&E(e.viewport.xmin,e.viewport.xmax,n,function(e){var t=w(_.value(e,o),d);h=Math.max(t.getWidth(),h)}),t=h+10,e.settings.xAxisNumbers||(t=1===e.settings.xAxisMinorSubdivisions?8:20),c*t<=e.screen.width&&(r.majorStepX=n,r.minorStepX=3===n||5===n?1:n/4)}if(i&&i!==Math.PI&&3<=u&&u<100){var f=0;e.settings.yAxisNumbers&&E(e.viewport.ymin,e.viewport.ymax,i,function(e){var t=w(_.value(e,a),d);f=Math.max(t.getHeight(),f)}),t=f+10,e.settings.yAxisNumbers||(t=1===e.settings.yAxisMinorSubdivisions?8:20),u*t<=e.screen.height&&(r.majorStepY=i,r.minorStepY=3===i||5===i?1:i/4)}if(!r.majorStepX){var g;g=s?1<=p.majorStepX?S.PI_STEPS:S.PI_FRAC_STEPS:x(n);var m=S.bestStep(p.majorStepX,g);r.majorStepX=m.major,r.minorStepX=m.minor}if(!r.majorStepY){var y;y=l?1<=p.majorStepY?S.PI_STEPS:S.PI_FRAC_STEPS:x(i);var v=S.bestStep(p.majorStepY,y);r.majorStepY=v.major,r.minorStepY=v.minor}if(n===i){var b=e.screen.width/o/(e.screen.height/a);1<=b&&b<=2?(r.majorStepX=r.majorStepY,r.minorStepX=r.minorStepY):b<=1&&.5<=b&&(r.majorStepY=r.majorStepX,r.minorStepY=r.minorStepX)}return 0<e.settings.xAxisMinorSubdivisions&&(r.minorStepX=r.majorStepX/e.settings.xAxisMinorSubdivisions),0<e.settings.yAxisMinorSubdivisions&&(r.minorStepY=r.majorStepY/e.settings.yAxisMinorSubdivisions),r},S.polar=function(e){var t=S.estimateMajors(e),r=S.bestStep(t.majorStepX,S.RATIONAL_STEPS),n=S.bestStep(t.majorStepY,S.RATIONAL_STEPS),i=r.major>n.major?r:n;return{majorStepR:i.major,minorStepR:i.minor}},S}),define("graphing/gridlayer",["require","pjs","./stepnumber","./label","./computestepsizes","./axisarrowmode"],function(e){var t=e("pjs"),j=e("./stepnumber"),V=e("./label"),a=e("./computestepsizes"),v=e("./axisarrowmode"),r=t(function(e){e.redrawToCtx=function(e,t,r){var n,i,o=t.settings.showGrid;i=t.settings.polarMode&&o?(n=a.polar(t),this.drawPolarGrid(e,t,n),this.drawAxes(e,t,r),this.drawPolarStepNumbers(e,t,n)):(n=a.cartesian(t),o&&this.drawCartesianGrid(e,t,n),this.drawAxes(e,t,r),this.drawCartesianStepNumbers(e,t,n)),this.drawLabels(e,t,i)},e.addTextShadow=function(e,t){e.strokeStyle=t.settings.getBackgroundColor(),e.lineWidth=3,e.miterLimit=2},e.drawPolarGrid=function(n,i,e){n.save();var t=i.settings.minorAxisOpacity,r=1-(1-i.settings.majorAxisOpacity)/(1-t),o=Math.round(i.mapx(0))-.5,a=Math.round(i.mapy(0))-.5,s=i.screen.height/(i.viewport.ymax-i.viewport.ymin),l=i.screen.width/(i.viewport.xmax-i.viewport.xmin),c=s/l,u=l/s,p=a/c,d=i.viewport.smallestR(),h=i.viewport.largestR(),f=e.minorStepR*Math.max(1,Math.floor(d/e.minorStepR)),g=e.majorStepR*Math.max(1,Math.floor(d/e.majorStepR));n.lineWidth=1,n.strokeStyle="rgba(0, 0 , 0, "+t+")",n.save(),U(f,h,e.minorStepR,function(e){n.beginPath(),n.scale(1,c);var t=i.mapx(e)-o;n.moveTo(o+t,p),n.arc(o,p,t,0,2*Math.PI),n.scale(1,u),n.stroke()}),n.restore(),U(0,359,0<d?5:15,function(e){if((0!==e&&180!==e||!i.settings.showXAxis)&&(90!==e&&270!==e||!i.settings.showYAxis)){n.beginPath(),n.moveTo(o,a);var t=i.mapx(h*Math.cos(e*Math.PI/180)),r=i.mapy(h*Math.sin(e*Math.PI/180));n.lineTo(Math.round(t)-.5,Math.round(r)-.5),n.stroke()}}),n.lineWidth=1,n.strokeStyle="rgba(0, 0 , 0, "+r+")",n.save(),U(g,h,e.majorStepR,function(e){n.beginPath(),n.scale(1,c);var t=i.mapx(e)-o;n.moveTo(o+t,p),n.arc(o,p,t,0,2*Math.PI),n.scale(1,u),n.stroke()}),n.restore()},e.drawCartesianGrid=function(r,n,e){r.save();var t=n.viewport.xmin,i=n.viewport.ymin,o=n.viewport.xmax,a=n.viewport.ymax,s=n.screen.width,l=n.screen.height,c=l,u=0;n.settings.restrictGridToFirstQuadrant&&(i=t=0,c=n.mapy(0),u=n.mapx(0));var p=n.settings.minorAxisOpacity,d=n.settings.majorAxisOpacity;r.lineWidth=1,r.strokeStyle="rgba(0, 0 , 0, "+p+")",U(t,o,e.minorStepX,function(e){if(0!==e||!n.settings.showYAxis){var t=Math.round(n.mapx(e));t!==s&&(r.beginPath(),r.moveTo(t-.5,0),r.lineTo(t-.5,c),r.stroke())}}),U(i,a,e.minorStepY,function(e){if(0!==e||!n.settings.showXAxis){var t=Math.round(n.mapy(e));t!==l&&(r.beginPath(),r.moveTo(u,t-.5),r.lineTo(s,t-.5),r.stroke())}});var h=1-(1-d)/(1-p);r.strokeStyle="rgba(0, 0 , 0, "+h+")",U(t,o,e.majorStepX,function(e){if(0!==e||!n.settings.showYAxis){var t=Math.round(n.mapx(e));t!==s&&(r.beginPath(),r.moveTo(t-.5,0),r.lineTo(t-.5,c),r.stroke())}}),U(i,a,e.majorStepY,function(e){if(0!==e||!n.settings.showXAxis){var t=Math.round(n.mapy(e));t!==l&&(r.beginPath(),r.moveTo(u,t-.5),r.lineTo(s,t-.5),r.stroke())}}),r.restore()},e.drawAxes=function(o,e,t){function r(e,t,r){o.save();var n=Math.PI/12,i=8*Math.max(o.lineWidth,1.5);o.lineJoin="round",o.fillStyle=s,o.strokeStyle=s,o.beginPath(),o.moveTo(e,t),o.lineTo(e+Math.cos(r-n)*i,t+Math.sin(r-n)*i),o.lineTo(e+Math.cos(r+n)*i,t+Math.sin(r+n)*i),o.lineTo(e,t),o.lineTo(e+Math.cos(r-n)*i,t+Math.sin(r-n)*i),o.stroke(),o.fill(),o.restore()}var n=e.settings.axisLineOffset,i=e.settings.axisOpacity.toString(),a="rgba(127,205,230,"+i+")",s="rgba(0,0,0,"+i+")",l=e.settings.xAxisArrowMode,c=e.settings.yAxisArrowMode,u=e.settings.showXAxis,p=e.settings.showYAxis,d=Math.round(e.mapx(0))-n,h=Math.round(e.mapy(0))-n,f=e.screen.height,g=e.screen.width,m=f,y=0;e.settings.restrictGridToFirstQuadrant&&(m=h,y=d,l===v.BOTH&&(l=v.POSITIVE),c===v.BOTH&&(c=v.POSITIVE)),p&&(o.lineWidth=1*e.settings.axisLineWidth,o.strokeStyle="y"===t?a:s,c===v.BOTH?(o.beginPath(),o.moveTo(d,2*e.settings.axisLineWidth),o.lineTo(d,f-2*e.settings.axisLineWidth),o.stroke(),r(d,f-e.settings.axisLineWidth,3*Math.PI/2),r(d,e.settings.axisLineWidth,Math.PI/2)):c===v.POSITIVE?(o.beginPath(),o.moveTo(d,2*e.settings.axisLineWidth),o.lineTo(d,m),o.stroke(),r(d,e.settings.axisLineWidth,Math.PI/2)):(o.beginPath(),o.moveTo(d,0),o.lineTo(d,m),o.stroke())),u&&(o.lineWidth=1*e.settings.axisLineWidth,o.strokeStyle="x"===t?a:s,l===v.BOTH?(o.beginPath(),o.moveTo(2*e.settings.axisLineWidth,h),o.lineTo(g-2*e.settings.axisLineWidth,h),o.stroke(),r(e.settings.axisLineWidth,h,0),r(g-e.settings.axisLineWidth,h,Math.PI)):l===v.POSITIVE?(o.beginPath(),o.lineTo(y,h),o.lineTo(g-2*e.settings.axisLineWidth,h),o.stroke(),r(g-e.settings.axisLineWidth,h,Math.PI)):(o.beginPath(),o.lineTo(y,h),o.lineTo(g,h),o.stroke()))},e.drawPolarStepNumbers=function(u,p,e){function a(e,t,r){var n=Math.sqrt(e*e-t*t);g<=n&&n<=m&&r.push({x:p.mapx(t),y:p.mapy(n)}),g<=-n&&-n<=m&&r.push({x:p.mapx(t),y:p.mapy(-n)})}function s(e,t,r){var n=Math.sqrt(e*e-t*t);h<=n&&n<=f&&r.push({x:p.mapx(n),y:p.mapy(t)}),h<=-n&&-n<=f&&r.push({x:p.mapx(-n),y:p.mapy(t)})}u.save();var t=p.settings.showGrid,l=p.settings.xAxisNumbers&&p.settings.showXAxis,c=p.settings.yAxisNumbers&&p.settings.showYAxis,r=t&&p.settings.polarNumbers,d=p.viewport.largestR(),n=p.viewport.smallestR(),h=p.viewport.xmin,f=p.viewport.xmax,g=p.viewport.ymin,m=p.viewport.ymax,y=p.screen.width,v=p.screen.height,b={left:3,right:y-3,top:3,bottom:v-3},x=p.settings.labelHangingColor,i=p.settings.getTextColor(),w=p.settings.labelSize,_=w;u.textAlign="center",u.textBaseline="middle",this.addTextShadow(u,p),u.font=w.toString()+"px Arial",u.fillStyle=i;var S=p.mapx(0),E=p.mapy(0),M=g<=0&&0<=m&&l,I=h<=0&&0<=f&&c,T="";if(!M&&!I&&t){var o,C,k,P,D=Math.abs(S),A=Math.abs(S-y),L=Math.abs(E),O=Math.abs(E-v);k=D<=A?(o="left",D):(o="right",A),P=L<=O?(C="top",L):(C="bottom",O),l&&c?T=k<=P?o:C:c?T=o:l&&(T=C)}var q={left:0,right:y,top:E-1,bottom:E+1},F={left:S-1,right:S+1,top:0,bottom:v};if(U(0,d,e.majorStepR,function(e){var t=[],r=[],n=[],i=j(V.value(e,d),w),o=i.getRect();switch(0<e?(I&&g<=e&&e<=m&&r.push({x:S-o.right-5,y:p.mapy(e)}),I&&g<=-e&&-e<=m&&r.push({x:S-o.right-5,y:p.mapy(-e)}),M&&h<=e&&e<=f&&t.push({x:p.mapx(e),y:E-o.top+3}),M&&h<=-e&&-e<=f&&t.push({x:p.mapx(-e),y:E-o.top+3})):I&&!l&&g<=e&&e<=m?r.push({x:S-o.right-5,y:p.mapy(e)}):M&&!c&&h<=e&&e<=f&&t.push({x:p.mapx(e),y:E-o.top+3}),T){case"top":s(e,m,n);break;case"bottom":s(e,g,n);break;case"left":a(e,h,n);break;case"right":a(e,f,n)}t.forEach(function(e){e=i.clampBoundsWithinRect(e,b),i.drawCenteredAt(u,e),G(q,i.getRectWhenCenteredAt(e))}),r.forEach(function(e){e=i.clampBoundsWithinRect(e,b),i.drawCenteredAt(u,e),G(F,i.getRectWhenCenteredAt(e))}),n.forEach(function(e){e=i.clampBoundsWithinRect(e,b),i.drawCenteredAt(u,e)})}),r){var N=Math.ceil(n/e.majorStepR),R=Math.floor(d/e.majorStepR),B=Math.ceil((N+R)/2)*e.majorStepR;U(0,359,0<n?15:30,function(e){var t;t=p.settings.degreeMode?e.toString()+"":V.value(e*Math.PI/180,2*Math.PI).string;var r=u.measureText(t).width/2,n=B/1.05,i=n*Math.cos(e*Math.PI/180),o=n*Math.sin(e*Math.PI/180);if(!(i<h||f<i||o<g||m<o)){var a=p.mapx(i),s=p.mapy(o);0===e||180===e?s-=_:90!==e&&270!==e||(a+=r+3);var l=z(a,3+r,y-3-r),c=z(s,3+_,v-3-_);u.fillStyle=x,u.strokeText(t,l,c),u.fillText(t,l,c)}})}return u.restore(),{x:q,y:F}},e.drawLabels=function(e,t,r){var n=t.viewport.xmin,i=t.viewport.xmax,o=t.viewport.ymin,a=t.viewport.ymax,s=t.screen.width,l=t.screen.height,c=(i-n)/s,u=(a-o)/l,p=t.settings.getTextColor(),d=t.mapx(0),h=t.mapy(0),f=t.settings.labelSize,g=t.settings.showXAxis&&t.settings.xAxisLabel,m=t.settings.showYAxis&&t.settings.yAxisLabel,y=r.x,v=r.y;if(g&&y){var b;if(e.save(),e.fillStyle=p,e.__xLabelOffset&&t.settings.isViewportTransient&&C(e.__xLabelOffset.xscale,c)&&C(e.__xLabelOffset.yscale,u)&&(b={x:e.__xLabelOffset.x+d,y:e.__xLabelOffset.y+h}),this._setAxisLabelFont(e,g,f,t),!b){var x=s-e.measureText(g).width-15,w=f;b=y.bottom+w<l?{x:x,y:y.bottom+w}:{x:x,y:y.top-w/2},e.__xLabelOffset={x:b.x-d,y:b.y-h,xscale:c,yscale:u}}e.strokeText(g,b.x,b.y),e.fillText(g,b.x,b.y),e.restore()}else e.__xLabelPosition=null;if(m&&v){var _;if(e.save(),e.fillStyle=p,e.__yLabelOffset&&t.settings.isViewportTransient&&C(e.__yLabelOffset.xscale,c)&&C(e.__yLabelOffset.yscale,u)&&(_={x:e.__yLabelOffset.x+d,y:e.__yLabelOffset.y+h}),this._setAxisLabelFont(e,m,f,t),!_){var S=e.measureText(m).width,E=f,M=S+5;if(!this._isShortMathyLabel(m)){var I=S;S=E,E=I,M=.5*S}var T=15+E;_=0<v.left-S?{x:v.left-M,y:T}:{x:v.right+S,y:T},e.__yLabelOffset={x:_.x-d,y:_.y-h,xscale:c,yscale:u}}e.translate(_.x,_.y),this._isShortMathyLabel(m)||e.rotate(-Math.PI/2),e.strokeText(m,0,0),e.fillText(m,0,0),e.restore()}else e.__yLabelPosition=null},e._isShortMathyLabel=function(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)},e._setAxisLabelFont=function(e,t,r,n){this.addTextShadow(e,n),this._isShortMathyLabel(t)?e.font="italic "+Math.round(1.4*r.toString())+"px Times":e.font=Math.round(1.2*r.toString())+"px Arial"},e.drawCartesianStepNumbers=function(i,o,e){i.save();var t=o.settings.showXAxis,r=o.settings.showYAxis,n=t&&o.settings.xAxisNumbers,a=r&&o.settings.yAxisNumbers,s=o.viewport.xmin,l=o.viewport.xmax,c=o.viewport.ymin,u=o.viewport.ymax,p=o.screen.width,d=o.screen.height,h={left:3,top:3,right:p-3,bottom:d-3};o.settings.restrictGridToFirstQuadrant&&(c=s=0);var f=o.settings.labelHangingColor,g=o.settings.getTextColor(),m=o.mapx(0),y=o.mapy(0),v=o.settings.labelSize;this.addTextShadow(i,o);var b={left:0,right:p,top:y-1,bottom:y+1},x={left:m-1,right:m+1,top:0,bottom:d},w=!1;if(t&&r&&(n||a)){w=!0,i.fillStyle=g;var _=j(V.value(0,1),v);_.drawCenteredAt(i,{x:m-_.getRect().right-5,y:y-_.getRect().top+3})}return n&&U(s,l,e.majorStepX,function(e){var t=j(V.value(e,l-s),v),r={x:o.mapx(t.getValue())-.5*t.getMinusWidth(),y:y-t.getRect().top+5},n=t.clampBoundsWithinRect(r,h);i.fillStyle=r.y===n.y?g:f,"0"===t.getString()&&w||(t.drawCenteredAt(i,n),G(b,t.getRectWhenCenteredAt(n)))}),a&&U(c,u,e.majorStepY,function(e){var t=j(V.value(e,u-c),v),r={x:m-5-t.getRect().right,y:o.mapy(t.getValue())},n=t.clampBoundsWithinRect(r,h);i.fillStyle=r.x===n.x?g:f,"0"===t.getString()&&w||(t.drawCenteredAt(i,n),G(x,t.getRectWhenCenteredAt(n)))}),i.restore(),{x:b,y:x}}}),U=function(e,t,r,n){var i=Math.ceil(e/r),o=Math.floor(t/r);if(isFinite(o-i)&&!(1e4<o-i))for(var a=i;a<=o;a++)n(a*r)},z=function(e,t,r){return e<t?t:r<e?r:e},G=function(e,t){t.left<e.left&&(e.left=t.left),t.right>e.right&&(e.right=t.right),t.top<e.top&&(e.top=t.top),t.bottom>e.bottom&&(e.bottom=t.bottom)},C=function(e,t){var r=Math.abs(e),n=Math.abs(t);return Math.abs(r-n)<=1e-4*(r<n?n:r)};return r}),define("graphing/imagelayer",["require","pjs","underscore","./draw-image-to-ctx"],function(e){var t=e("pjs"),a=e("underscore"),s=e("./draw-image-to-ctx").drawImageToCtx;return t(function(e){e.redrawToCtx=function(e,t,r,n){(void 0===n||n.length<a.size(r))&&(n=a.keys(r));for(var i=0;i<n.length;i++){var o=r[n[i]];o&&o.shouldGraph&&!o.foreground&&s(o,e,t)}}})}),define("graphing/movablepointslayer",["require","pjs","jquery","./domlayer","browser","./constants","lib/aria","i18n","./label"],function(e){var t=e("pjs"),y=e("jquery"),r=e("./domlayer"),v=e("browser"),b=e("./constants"),n=e("lib/aria"),i=e("i18n"),h=e("./label");return t(r,function(e,r){e.init=function(e,t){r.init.call(this,e),this.graphSettings=t,this.renderedMovablePoints={},this.prevLabels={},this.prevCoordinates={},this.cachedAriaLabels={}},e.t=function(e,t){return i.t(e,t,this.graphSettings.language)},e.redraw=function(e,t){this.resize(e.screen.width,e.screen.height);var r,n,i=null,o=null;for(var a in this.renderedMovablePoints)this.renderedMovablePoints[a].shouldGarbageCollect=!0;for(a in t){var s=t[a];if(s.visible)for(var l=s.getInteractivePoints(),c=0;c<l.length;c++){var u=l[c],p={};u.id===this.hoveredPointId&&(p.hovered=!0,i=u),u.id===this.pressedPointId&&(p.pressed=!0,o=u),this.drawMovablePoint(u,e,p)}}for(a in this.renderedMovablePoints)this.renderedMovablePoints[a].shouldGarbageCollect&&(this.renderedMovablePoints[a].$.off(".mp_listener"),this.renderedMovablePoints[a].$.remove(),delete this.renderedMovablePoints[a]);i?(r=i.tableInfo&&i.tableInfo.dragX,n=i.tableInfo&&i.tableInfo.dragY,r&&n||!r&&!n?this.addGrapherClass("dcg-mouse-over-movable-point"):r?this.addGrapherClass("dcg-mouse-over-movable-point-ew"):this.addGrapherClass("dcg-mouse-over-movable-point-ns")):(this.hoveredPointId=null,this.removeGrapherClass("dcg-mouse-over-movable-point-ew"),this.removeGrapherClass("dcg-mouse-over-movable-point-ns"),this.removeGrapherClass("dcg-mouse-over-movable-point")),o?(r=o.tableInfo&&o.tableInfo.dragX,n=o.tableInfo&&o.tableInfo.dragY,r&&n||!r&&!n?this.addGrapherClass("dcg-dragging-movable-point"):r?this.addGrapherClass("dcg-dragging-movable-point-ew"):this.addGrapherClass("dcg-dragging-movable-point-ns")):(this.pressedPointId=null,this.removeGrapherClass("dcg-dragging-movable-point-ew"),this.removeGrapherClass("dcg-dragging-movable-point-ns"),this.removeGrapherClass("dcg-dragging-movable-point"))},e.drawMovablePoint=function(e,t,r){var n=e.id,i=e.color,o=e.x,a=e.y,s=t.mapx(o),l=t.mapy(a),c=!(n in this.renderedMovablePoints);if(c){var u=e.tableInfo?"dcg-table-movable-point":"",p=e.isMovable?"dcg-movable-point":"dcg-offscreen-point",d=y("<div class='"+p+"' "+u+"'>").append(y("<div class='dcg-background'></div>")).append(y("<div class='dcg-dot'></div></div>"));this.dom_node.append(d),this.renderedMovablePoints[n]={$:d,shouldGarbageCollect:!0}}var h=this.renderedMovablePoints[n].$,f=h[0]===document.activeElement,g=t.coordsAreOnscreen(s,l,b.OFFSCREEN_RENDER_MARGIN);if(g||f){h.attr("aria-hidden",!this.graphSettings.config.graphpaper).attr("role","button").attr("aria-roledescription","point").attr("tabindex",this.graphSettings.config.graphpaper&&this.graphSettings.config.enableTabindex&&(e.isMovable||void 0!==e.label)?0:-1).css({transform:v.translateRule(s,l),backgroundColor:i}).data("movablePoint",e).data("renderedOnScreen",g);var m=this.getAriaLabel(e,g,t,f);""!==m&&(h.attr("aria-label",m),this.speakPointCoordinates(h[0],m)),h.toggleClass("dcg-simulate-hovered",!!r.hovered),h.toggleClass("dcg-simulate-active",!!r.pressed),c&&h.on("blur.mp_listener",function(e){setTimeout(function(){h.attr("aria-label",this.getAriaLabel(h.data("movablePoint"),h.data("renderedOnScreen"),t,!1))}.bind(this),0)}.bind(this)),this.renderedMovablePoints[n].shouldGarbageCollect=!1}},e.getAriaLabel=function(e,t,r,n){if(!e||!r)return"";var i=r.viewport;if(!i)return"";var o=this.getLabelFromMovablePoint(e),a="X: "+h.value(e.x,i.xmax-i.xmin).ariaString+". Y: "+h.value(e.y,i.ymax-i.ymin).ariaString+".",s=e.isMovable?this.t(" is movable. Press Arrows or Shift+Arrows to adjust."):"",l=t?"":this.t(" not visible on screen"),c=this.prevLabels[e.id],u=this.prevCoordinates[e.id],p=!c||c!==o,d=!u||u.x!==e.x||u.y!==e.y;return p&&(this.prevLabels[e.id]=o),d&&(this.prevCoordinates[e.id]={x:e.x,y:e.y}),n?p?o+l:d?a+l:"":o+". "+a+s+l},e.getLabelFromMovablePoint=function(e){return e.label||this.t("Graph point")},e.speakPointCoordinates=function(e,t){document.activeElement===e&&v.IS_APPLE&&n.alert(t)}})}),define("math/recttransformation",["require","exports"],function(e,t){"use strict";function r(e,t){var r=e-1;return 1+r*r*r==1?t*(1+r*(t-1)*(.5+1/6*r*(t-2))):(Math.pow(e,t)-1)/r}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function i(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=1),void 0===n&&(n=r),this.tx=e,this.ty=t,this.sx=r,this.sy=n}return i.prototype.toJSON=function(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}},i.prototype.compose=function(e){return new i(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)},i.prototype.translate=function(e,t){var r=void 0===t?e.x:t.x-e.x,n=void 0===t?e.y:t.y-e.y;return new i(this.tx+r,this.ty+n,this.sx,this.sy)},i.prototype.scale=function(e,t){return i.scale(e,t).compose(this)},i.prototype.scaleAtPoint=function(e,t,r){return void 0===r&&(r=t),i.scaleAtPoint(e,t,r).compose(this)},i.prototype.inverse=function(){return new i(-this.tx/this.sx,-this.ty/this.sy,1/this.sx,1/this.sy)},i.prototype.div=function(e){return new i((this.tx*e.sx-this.sx*e.tx)/e.sx,(this.ty*e.sy-this.sy*e.ty)/e.sy,this.sx/e.sx,this.sy/e.sy)},i.prototype.conjugate=function(e){return new i(this.tx*e.sx+e.tx*(1-this.sx),this.ty*e.sy+e.ty*(1-this.sy),this.sx,this.sy)},i.prototype.pow=function(e){return new i(this.tx*r(this.sx,e),this.ty*r(this.sy,e),Math.pow(this.sx,e),Math.pow(this.sy,e))},i.prototype.mapX=function(e){return this.sx*e+this.tx},i.prototype.mapY=function(e){return this.sy*e+this.ty},i.prototype.mapPoint=function(e){return{x:this.mapX(e.x),y:this.mapY(e.y)}},i.prototype.mapRect=function(e){return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}},i.scale=function(e,t){return void 0===t&&(t=e),new i(0,0,e,t)},i.translate=function(e,t){return(new i).translate(e,t)},i.scaleAtPoint=function(e,t,r){return void 0===r&&(r=t),void 0===r&&(r=t),new i(e.x*(1-t),e.y*(1-r),t,r)},i.fromRects=function(e,t){var r=(t.right-t.left)/(e.right-e.left),n=(t.top-t.bottom)/(e.top-e.bottom);return new i(t.left-r*e.left,t.bottom-n*e.bottom,r,n)},i.fromJSON=function(e){return new i(e.tx,e.ty,e.sx,e.sy)},i}();t.RT=n}),define("graphing/projection",["require","exports","math/recttransformation"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){var n,i;this.screen=e,this.viewport=t,this.settings=r,this.mathCoordinates={left:(i=t).xmin,right:i.xmax,bottom:i.ymin,top:i.ymax},this.pixelCoordinates={left:0,right:(n=e).width,top:0,bottom:n.height},this.mathToPixels=o.RT.fromRects(this.mathCoordinates,this.pixelCoordinates),this.pixelsToMath=o.RT.fromRects(this.pixelCoordinates,this.mathCoordinates)}return e.prototype.mapx=function(e){return this.mathToPixels.mapX(e)},e.prototype.mapy=function(e){return this.mathToPixels.mapY(e)},e.prototype.map_pt=function(e){return this.mathToPixels.mapPoint(e)},e.prototype.reverse_mapx=function(e){return this.pixelsToMath.mapX(e)},e.prototype.reverse_mapy=function(e){return this.pixelsToMath.mapY(e)},e.prototype.reverse_map_pt=function(e){return this.pixelsToMath.mapPoint(e)},e.prototype.coordsAreOnscreen=function(e,t,r){return-(r=void 0===r?0:r)<e&&-r<t&&e<this.screen.width+r&&t<this.screen.height+r},e.prototype.closestPointOnScreen=function(e){var t=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}},e}();t.Projection=r}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(c){function t(e){var t=e||window.event,r=f.call(arguments,1),n=0,i=0,o=0,a=0;if((e=c.event.fix(t)).type="mousewheel","detail"in t&&(o=-1*t.detail),"wheelDelta"in t&&(o=t.wheelDelta),"wheelDeltaY"in t&&(o=t.wheelDeltaY),"wheelDeltaX"in t&&(i=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(i=-1*o,o=0),n=0===o?i:o,"deltaY"in t&&(n=o=-1*t.deltaY),"deltaX"in t&&(i=t.deltaX,0===o&&(n=-1*i)),0!==o||0!==i){if(1===t.deltaMode){var s=c.data(this,"mousewheel-line-height");n*=s,o*=s,i*=s}else if(2===t.deltaMode){var l=c.data(this,"mousewheel-page-height");n*=l,o*=l,i*=l}return a=Math.max(Math.abs(o),Math.abs(i)),(!h||a<h)&&(p(t,h=a)&&(h/=40)),p(t,a)&&(n/=40,i/=40,o/=40),n=Math[1<=n?"floor":"ceil"](n/h),i=Math[1<=i?"floor":"ceil"](i/h),o=Math[1<=o?"floor":"ceil"](o/h),e.deltaX=i,e.deltaY=o,e.deltaFactor=h,e.deltaMode=0,r.unshift(e,n,i,o),d&&clearTimeout(d),d=setTimeout(u,200),(c.event.dispatch||c.event.handle).apply(this,r)}}function u(){h=null}function p(e,t){return i.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var d,h,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(c.event.fixHooks)for(var n=e.length;n;)c.event.fixHooks[e[--n]]=c.event.mouseHooks;var i=c.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var e=r.length;e;)this.addEventListener(r[--e],t,!1);else this.onmousewheel=t;c.data(this,"mousewheel-line-height",i.getLineHeight(this)),c.data(this,"mousewheel-page-height",i.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=r.length;e;)this.removeEventListener(r[--e],t,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(c(e)["offsetParent"in c.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return c(e).height()},settings:{adjustOldDeltas:!0}};c.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("graphing/viewportcontroller",["require","jquery","pjs","lib/aria","i18n","math/recttransformation","./viewport","math/distance","./constants","lib/animation-frame","./projection","keys","jquery.handleevent","vendor/jquery.mousewheel"],function(e){var a=e("jquery"),t=e("pjs"),i=e("lib/aria"),o=e("i18n"),f=e("math/recttransformation").RT,s=e("./viewport").Viewport,l=e("math/distance"),y=e("./constants"),v=e("lib/animation-frame"),c=e("./projection").Projection,b=e("keys");return e("jquery.handleevent"),e("vendor/jquery.mousewheel"),t(function(e){function u(e,t){var r=t.x-e.x,n=t.y-e.y,i=.5*(e.x+t.x),o=.5*(e.y+t.y),a=.5*l.hypot(r,n);return{center:m(i,o),radius:a}}function p(e,t){return u(t,{x:2*e.x-t.x,y:2*e.y-t.y})}function g(e,t){for(var r=[],n=0;n<e.length;n++)r.push(m(e[n].x-t.left,e[n].y-t.top));return r}function m(e,t){return{x:e,y:t}}function r(e){return m(.5*(e.left+e.right),.5*(e.bottom+e.top))}var n=0;e.init=function(e,t){this.grapher=e,this.$=this.grapher.$,this.__id=n++,this.controller=t,this.isScalingEnabled=!1,this.mousePt=m(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()},e.remove=function(){a(window).off("viewportcontroller-"+this.__id)},e.t=function(e,t){return o.t(e,t,this.grapher.settings.language)},e.getViewport=function(){return this.grapher.getProjection().viewport},e.getProjection=function(){return this.grapher.getProjection()},e.updateMouse=function(e){var t=this.$[0].getBoundingClientRect();this.mousePt=m(e.clientX-t.left,e.clientY-t.top)},e.updateScaleAxis=function(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.grapher.redrawAllLayers()},e.updateCursor=function(){this.$.toggleClass("dcg-scale-horizontal","x"===this.grapher.scaleAxis),this.$.toggleClass("dcg-scale-vertical","y"===this.grapher.scaleAxis),this.$.toggleClass("dcg-scale-both","both"===this.grapher.scaleAxis)},e.isMouseNearOrigin=function(){var e=this.getProjection().mathToPixels.mapPoint(m(0,0));return Math.abs(this.mousePt.x-e.x)<50&&Math.abs(this.mousePt.y-e.y)<50},e.isMouseNearXAxis=function(){var e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapY(0);return r=Math.min(Math.max(t.top,r),t.bottom),Math.abs(this.mousePt.y-r)<40&&e.settings.showXAxis},e.isMouseNearYAxis=function(){var e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapX(0);return r=Math.min(Math.max(t.left,r),t.right),Math.abs(this.mousePt.x-r)<40&&e.settings.showYAxis},e.isMouseInViewport=function(){var e=this.getProjection(),t=e.mathCoordinates,r=e.pixelsToMath.mapPoint(this.mousePt);return r.x>=t.left&&r.x<=t.right&&r.y>=t.bottom&&r.y<=t.top},e.getDefaultViewport=function(){return this.controller.getDefaultStateViewport()||this.grapher.getDefaultViewport()},e._setViewportWithoutCancellingAnimation=function(e){if(e.isValid()&&!e.equals(this.getViewport())){var t=this.getProjection();this.grapher._setProjection(new c(t.screen,e,t.settings))}},e.setViewport=function(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)},e.setScreen=function(e){var t=this.getProjection(),r=new c(e,this.getViewportForScreen(t.viewport,e),t.settings);this.grapher._setProjection(r)},e.getTransformedViewport=function(e){var t=this.getProjection(),r=t.pixelsToMath.div(e).mapRect(t.pixelCoordinates);return new s(r.left,r.right,r.bottom,r.top)},e.transformViewport=function(e){this.setViewport(this.getTransformedViewport(e))},e.animateTransformation=function(n){var i=this;this.cancelAnimation();var o,a=this.getTransformedViewport(n),s=0;this.__animationTimeout=v.requestAnimationFrame(function e(t){o||(o=t);var r=(t-o)/y.ANIMATE_ZOOM_DURATION;(s+=r)<1?(i.__animationTimeout=v.requestAnimationFrame(e),i._setViewportWithoutCancellingAnimation(i.getTransformedViewport(n.pow(r)))):i.setViewport(a),i.grapher.debounceUserRequestedViewportChange()})},e.cancelAnimation=function(){v.cancelAnimationFrame(this.__animationTimeout)},e.addMouseWheelEventHandler=function(){var n,i,p=this,d=!1;a(window).on("scroll.viewportcontroller-"+this.__id,function(e){d=!0}),a(window).on("mousewheel.viewportcontroller-"+this.__id,function(e){n=e.originalEvent.clientX,i=e.originalEvent.clientY}),a(window).on("mousemove.viewportcontroller-"+this.__id,function(e){if(d){var t=e.originalEvent.clientX-n,r=e.originalEvent.clientY-i;t*t+r*r<100||(d=!1)}});var h=0;this.$.mousewheel(function(e,t){var r=Date.now();if(p.preventScrollZoom&&50<r-p.lastScrollZoom&&(p.preventScrollZoom=!1),p.lastScrollZoom=r,!p.preventScrollZoom){var n=this.getProjection();if(!n.settings.config.lockViewport){var i=n.mathToPixels;if(!d){e.preventDefault(),p.updateMouse(e);var o=i.mapPoint(m(0,0)),a=p.isMouseNearOrigin()&&0<t?o:p.mousePt;if(!(0<h)){h+=1,v.requestAnimationFrame(function(){h--});var s=0<(t=0<t?1:-1)?y.ZOOM_FACTOR:1/y.ZOOM_FACTOR,l=p.grapher.scaleAxis,c="x"!==l&&"both"!==l&&l?1:s,u="y"!==l&&"both"!==l&&l?1:s;this.transformViewport(f.scaleAtPoint(a,c,u)),this.grapher.debounceUserRequestedViewportChange()}}}}}.bind(this))},e.handleDoubleClick=function(e){var t=this.getProjection();if(!t.settings.config.lockViewport&&!t.settings.config.disable_dblclick_zooming&&!e.wasHandled()){e.preventDefault();var r=this.$[0].getBoundingClientRect(),n=m(e.clientX-r.left,e.clientY-r.top);this.animateTransformation(f.scaleAtPoint(n,y.DOUBLETAP_ZOOM))}},e.applyPanTouchChanges=function(e,t){if(!this.getProjection().settings.config.lockViewport&&!this.isScalingEnabled){var r=m(t[0].x-e[0].x,t[0].y-e[0].y);this.transformViewport(f.translate(r)),this.grapher.debounceUserRequestedViewportChange()}},e.chooseDragScaleCenter=function(){var e=this.getProjection(),t=e.pixelCoordinates,r=e.mathToPixels.mapX(0),n=e.mathToPixels.mapY(0);return m(r=Math.min(Math.max(t.left,r),t.right),n=Math.min(Math.max(t.top,n),t.bottom))},e.applyScaleTouchChanges=function(e,t){if(!this.getProjection().settings.config.lockViewport){var r,n,i=this.grapher.scaleAxis;if(2===e.length&&2===t.length)r=u(e[0],e[1]),n=u(t[0],t[1]);else{if(1!==t.length)return;var o=this.chooseDragScaleCenter();r=p(o,e[0]),n=p(o,t[0])}var a=n.radius/r.radius,s="y"===i?1:a,l="x"===i?1:a,c=f.scaleAtPoint(r.center,s,l).translate(r.center,n.center);this.transformViewport(c),this.grapher.debounceUserRequestedViewportChange()}},e.addTouchEventHandler=function(){var l=this,c=[],u=!1,p=!0,d=!0;a(window).on("mousemove.viewportcontroller-"+this.__id,function(e){var t=l.grapher.getProjection();u||t.settings.config.lockViewport||(l.updateMouse(e),l.isScalingEnabled&&l.updateScaleAxis())});var h=function(e){return l.grapher.scaleAxis||(l.grapher.scaleAxis=function(e){if(!(e.length<2)){var t=l.grapher.getProjection(),r=t.pixelCoordinates,n=t.mathToPixels.mapX(0),i=t.mathToPixels.mapY(0);n=Math.min(Math.max(r.left,n),r.right),i=Math.min(Math.max(r.top,i),r.bottom);var o=e[1].x-e[0].x,a=e[1].y-e[0].y;return Math.abs(e[0].x-n)<40&&Math.abs(e[1].x-n)<40&&Math.abs(a)>3*Math.abs(o)&&t.settings.showYAxis?"y":Math.abs(e[0].y-i)<40&&Math.abs(e[1].y-i)<40&&Math.abs(o)>3*Math.abs(a)&&t.settings.showXAxis?"x":"both"}}(e)),l.grapher.scaleAxis},f=function(){l.grapher.scaleAxis&&(l.grapher.scaleAxis=void 0,l.grapher.redrawAllLayers(),l.updateCursor())},r=function(){l.isScalingEnabled=!1,l.preventScrollZoom=!0,f()},i=function(e){if(u&&!l.getProjection().settings.config.lockViewport){var t=g(e.touches,l.$.offset());if(2===c.length&&2===t.length)h(t),l.applyScaleTouchChanges(c,t);else if(1===c.length&&l.isScalingEnabled){l.updateMouse(e);var r,n,i=l.grapher.scaleAxis,o=l.getProjection().mathToPixels.mapPoint(m(0,0)),a=p?1:-1,s=d?1:-1;if("x"!==i&&"both"!==i||(r=l.mousePt.x>o.x+5*a),"y"!==i&&"both"!==i||(n=l.mousePt.y>o.y+5*s),"x"===i&&p!==r)return;if("y"===i&&d!==n)return;if("both"===i&&p!==r&&d!==n)return;l.applyScaleTouchChanges(c,t)}else f();1===c.length&&l.applyPanTouchChanges(c,t),l.controller.dispatch({type:"grapher/drag-move"}),c=t}},o=function(e){u&&(l.cancelAnimation(),c=g(e.touches,l.$.offset()),0===e.touches.length&&(u=!1,l.grapher.isDragging=!1,a(document).off(".graphdrag"),l.grapher.debounceUserRequestedViewportChange(),l.controller.dispatch({type:"grapher/drag-end"})),(0===e.touches.length||1===e.touches.length&&!l.isScalingEnabled)&&f())};this.$.css("touch-action","none"),this.$.on("dcg-tapstart",function(e){var t=l.getProjection();if(!t.settings.config.lockViewport&&!e.wasHandled()&&!u&&e.touches.length===e.changedTouches.length){u=!0,l.grapher.isDragging=!0,l.updateMouse(e);var r=t.mathToPixels.mapPoint(m(0,0)),n=l.grapher.scaleAxis;"x"!==n&&"both"!==n||(p=l.mousePt.x>r.x),"y"!==n&&"both"!==n||(d=l.mousePt.y>r.y),l.controller.dispatch({type:"grapher/drag-start"}),a(document).on("dcg-tapmove.graphdrag",i),a(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",o)}}),this.$.on("dblclick",this.handleDoubleClick.bind(this)),a(window).on("keydown.viewportcontroller-"+this.__id,function(e){var t;this.getProjection().settings.config.lockViewport||(b.lookup(e)!==b.SHIFT||((t=e).altKey||t.ctrlKey||t.metaKey)?r():(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()))}.bind(this)),a(window).on("keyup.viewportcontroller-"+this.__id+" blur.viewportcontroller-"+this.__id,r)},e.zoom=function(e){var t=this.getProjection().pixelCoordinates;"in"===e?this.animateTransformation(f.scaleAtPoint(r(t),2)):"out"===e?this.animateTransformation(f.scaleAtPoint(r(t),.5)):"default"===e&&this.animateTransformation(this.getDefaultZoomTransform()),i.alert(this.t("Graph zoom __action__",{action:e}))},e.getDefaultZoomTransform=function(){var e=this.getProjection().viewport,t=this.getDefaultViewport(),r=this.getProjection().pixelCoordinates,n=this.getProjection().mathCoordinates,i=(e.xmax-e.xmin)/(t.xmax-t.xmin),o=(e.ymax-e.ymin)/(t.ymax-t.ymin),a=f.fromRects(n,r),s=new f.translate(a.mapPoint({x:0,y:0}),{x:0,y:0}),l=new f.scale(i,o),c=f.fromRects({left:t.xmin,right:t.xmax,bottom:t.ymin,top:t.ymax},r);return new f.translate({x:0,y:0},c.mapPoint({x:0,y:0})).compose(l.compose(s))},e.isZoomRestored=function(){var e=this.getProjection(),t=e.viewport,r=this.getDefaultViewport();return e.settings.squareAxes&&Math.abs((t.xmin-r.xmin)/t.xmin)<.05&&Math.abs((t.xmax-r.xmax)/t.xmax)<.05&&Math.abs((t.ymin-r.ymin)/t.ymin)<.05&&Math.abs((t.ymax-r.ymax)/t.ymax)<.05},e.getViewportForScreen=function(e,t){var r=this.getProjection().settings;return r.squareAxes?"y"==r.lastChangedAxis?e.squareXAxis(t):e.squareYAxis(t):e},e.enforceSquareAxes=function(){var e=this.getProjection();this.setViewport(this.getViewportForScreen(e.viewport,e.screen))}})}),define("graphing/poicontroller",["require","jquery","math/distance","lib/rounding","graphing/graphmode","lib/conditional_blur","keys","lib/aria","./label"],function(e){function v(e,t){this.manager=e,this.controller=e.controller,this.graphSettings=t,this.$=this.manager.$,this.__id=r++,this.graphSettings.config.graphpaper&&!this.graphSettings.config.disableMouseInteractions&&(this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeydownEventHandler())}var s=e("jquery"),E=e("math/distance"),b=e("lib/rounding"),M=e("graphing/graphmode"),a=e("lib/conditional_blur").default,d=e("keys"),i=e("lib/aria"),o=e("./label"),r=0;return v.prototype.remove=function(){this.removeAllGlobalMouseListeners()},v.prototype.addGlobalMouseListener=function(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)s(document).on(r[n]+".dcg-poiController-"+this.__id,t)},v.prototype.removeAllGlobalMouseListeners=function(){s(document).off(".dcg-poiController-"+this.__id)},v.prototype.getToleranceByDevice=function(e){return"touch"===e?20:10},v.prototype.addHoverEventHandler=function(){this.$.on("dcg-tapmove",function(e){if("touch"!==e.device){var t=s(document.elementFromPoint(e.clientX,e.clientY)).closest(".dcg-grapher").length,r=this.getMouseRelativeToGrapher(e),n=this.getToleranceByDevice(e.device),i=t?this.getPOIUnderPoint(r,n):null,o=null;i&&i.isMovable()&&(o=i.getMovablePoint().id);var a=i&&!i.isAttachedToPlottedPoint()?i:null;if(a!==this.manager.poiLabelsLayer.getHoveredPOI()){if(!1===this.graphSettings.config.trace)return;this.manager.poiLabelsLayer.setHoveredPOI(a),this.manager.redrawAllLayers()}o!==this.manager.movablePointsLayer.hoveredPointId&&(this.manager.movablePointsLayer.hoveredPointId=o,this.manager.redrawAllLayers())}}.bind(this))},v.prototype.addTouchEventHandlers=function(){this.$.on("dblclick",function(e){var t=this.getMouseRelativeToGrapher(e),r=this.getToleranceByDevice(e.device);(this.getPOIUnderPoint(t,r)||this.getBranchInfoUnderPoint(t,r))&&(e.preventDefault(),e.handle())}.bind(this)),this.$.css("touch-action","none"),this.$.on("dcg-tapstart",function(e){var n=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device);a();var t=this.getPOIUnderPoint(n,i);if((!t||!t.isMovable()&&!t.isBareLabel())&&this.togglePOIUnderPoint(n,i))return e.handle(),void e.handle("do-not-clear-poi-labels");if(!t||(t.isMovable()&&(this.controller.dispatch({type:"start-moving-point",pointInfo:t.getMovablePoint()}),this.startMovingPoint(t),e.handle()),t.isBareLabel())){var r=this.getBranchInfoUnderPoint(n,i);if(this.graphSettings.config.onlyTraceSelected){if(r&&r.sketch&&r.sketch.selected)return this.startTracingBranch(r,n),e.handle(),void e.handle("do-not-clear-poi-labels")}else if(r){if(this.controller.dispatch({type:"set-selected-id",id:r.id}),!1===this.graphSettings.config.trace)return;return this.startTracingBranch(r,n),e.handle(),void e.handle("do-not-clear-poi-labels")}r||this.getImgUnderMouse(n,i)||this.controller.dispatch({type:"set-none-selected"});var o=this;this.addGlobalMouseListener("dcg-tapmove",function(){o.removeAllGlobalMouseListeners()}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",function(e){o.removeAllGlobalMouseListeners();var t=o.getBranchInfoUnderPoint(n,i);if(!t||!t.sketch||t.sketch.selected){var r=o.getImgUnderMouse(n,i);return r?void this.controller.dispatch({type:"set-selected-id",id:r.id}):void 0}this.controller.dispatch({type:"set-selected-id",id:t.id})}.bind(this))}else e.handle("do-not-clear-poi-labels")}.bind(this))},v.prototype.addKeydownEventHandler=function(){this.$.on("keydown",function(e){if(s(document.activeElement).hasClass("dcg-movable-point")){var t=s(document.activeElement).data("movablePoint");if(t){var r=d.lookup(e),n=d.lookupChar(e);"Up"===r||"Down"===r||"Left"===r||"Right"===r?this.movePointFromKeyboard(t,e):"X"!==n&&"Y"!==n&&"L"!==n||this.speakPoint(t,n)}}}.bind(this))},v.prototype.getMouseRelativeToGrapher=function(e){var t=this.$[0].getBoundingClientRect(),r=e.touches?e.touches[0]:e;return{x:r.clientX-t.left,y:r.clientY-t.top}},v.prototype.getElementRelativeToGrapher=function(e){var t=this.pageOffset||this.$.offset(),r=e.getBoundingClientRect();return{x:r.left-t.left,y:r.top-t.top}},v.prototype._getClosestPoint=function(e,t,r){for(var n=r,i=null,o=this.manager.getProjection(),a=0;a<e.length;a++){var s=e[a],l=o.map_pt(s),c=E.hypot(l.x-t.x,l.y-t.y);c<n&&(n=c,i=s)}return i},v.prototype.getPOIUnderPoint=function(e,t){for(var r=[],n=[],i=[],o={},a=this.manager.__sketchOrder,s=a.length-1;0<=s;s--){var l=a[s];o[l]=s}var c=this.getIndexOfForegroundImageUnderMouse(e,t);return this.manager.poiDotsLayer.getDrawnPOI().forEach(function(e){e.isMovable()?r.push(e):e.isAttachedToPlottedPoint()?(e.sketch.showHighlight||o[e.sketch.id]>c)&&n.push(e):i.push(e)}),this._getClosestPoint(r,e,t)||this._getClosestPoint(i,e,t)||this._getClosestPoint(n,e,t)},v.prototype.clearOpenedPOI=function(){this.manager.poiLabelsLayer.clearOpenedPOI(),this.manager.redrawAllLayers()},v.prototype.togglePOIUnderPoint=function(e,t){if(!1!==this.graphSettings.config.trace){var r=this.getPOIUnderPoint(e,t);return!!r&&(this.manager.poiLabelsLayer.isOpenPOI(r)?(this.manager.poiLabelsLayer.closePOI(r),this.manager.poiLabelsLayer.setHoveredPOI(null)):(this.manager.poiLabelsLayer.openPOI(r),this.speakPoint(r)),this.manager.redrawAllLayers(),!0)}},v.prototype.getIndexOfForegroundImageUnderMouse=function(e,t){var r=this.getImgUnderMouse(e,t);return r&&r.img&&r.img.foreground?r.index:-1},v.prototype.getImgUnderMouse=function(e,t){for(var r=this.manager.getProjection().reverse_map_pt(e),n=null,i=function(e,t,r,n){return e<t+.5*Math.abs(r)+n&&e>t-.5*Math.abs(r)+n},o=this.manager.__sketchOrder,a=o.length-1;0<=a;a--){var s=o[a],l=this.manager.graphImages[s];if(l&&l.computed_x&&l.computed_y&&l.computed_width&&l.computed_height&&!l.hidden&&!this.controller.isItemSecret(l.id)&&(l.foreground||!n)){for(var c=!1,u=0;u<l.computed_x.length;u++){var p=l.computed_x[u],d=l.computed_y[u],h=l.computed_radian_angle[u],f=p+Math.cos(h)*(r.x-p)-Math.sin(h)*(r.y-d),g=d+Math.sin(h)*(r.x-p)+Math.cos(h)*(r.y-d);if(i(f,l.computed_x[u],l.computed_width[u],0)&&i(g,l.computed_y[u],l.computed_height[u],0)){c=!0;break}}if(c&&(n={id:s,img:l,index:a},l.foreground))return n}}return n},v.prototype.getBranchInfoUnderPoint=function(e,t){for(var r=null,n=t,i=this.manager.getProjection(),o=i.reverse_map_pt(e),a=this.getIndexOfForegroundImageUnderMouse(e,t),s=this.manager.__sketchOrder,l=s.length-1;0<=l;l--){var c=s[l],u=this.manager.graphSketches[c];if(u&&u.visible){var p=u.branches;if(p&&p.length&&(u.showHighlight||!(l<a)))for(var d=0;d<p.length;d++){var h=v.calculateDistanceFromBranch(p[d],o,i);h<n&&(n=h,r={id:c,branch:d,sketch:u})}}}return r},v.calculateDistanceFromBranch=function(e,t,r){var n=v.getBranchesDistanceInfo(e,t,r);return n?n.minDistance:1/0},v.getBranchesDistanceInfo=function(e,t,r){var n=r.screen.width/(r.viewport.xmax-r.viewport.xmin),i=r.screen.height/(r.viewport.ymax-r.viewport.ymin),o=t.x,a=t.y;switch(e.graphMode){case M.Y:break;case M.X:var s=o;o=a,a=s,s=n,n=i,i=s;break;default:return null}for(var l,c,u=1/0,p=1/0,d=0;d<e.segments.length;d++)for(var h=e.segments[d],f=0;f<h.length-3;f+=2){var g=h[f],m=h[f+1],y=h[f+2],v=h[f+3],b=E.closestPointOnSegment(0,0,(g-o)*n,(m-a)*i,(y-o)*n,(v-a)*i),x=E.hypot(b[0],b[1]);b[0]<0?x<u&&(u=x,l=b):x<p&&(p=x,c=b)}var w=u<p?l:c;if(!w)return null;var _=w[0]/n+o,S=w[1]/i+a;return{closestPoint:{x:e.graphMode===M.Y?_:S,y:e.graphMode===M.Y?S:_},minDistance:Math.min(u,p),secondDistance:Math.max(u,p)}},v.getBranchesTracePoint=function(e,t,r){if(e&&e.compiled&&e.compiled.fn){var n=e.compiled.fn,i=r.screen.width/(r.viewport.xmax-r.viewport.xmin),o=r.screen.height/(r.viewport.ymax-r.viewport.ymin),a=this.getBranchesDistanceInfo(e,t,r);if(!a)return null;var s=a.minDistance/a.secondDistance;s*=s;var l=e.graphMode===M.Y?"x":"y",c=a.closestPoint[l]*(1-s)+t[l]*s,u=1/(2*i),p=1/(2*o),d=n(c-u),h=n(c),f=n(c+u),g=u*Math.min(1,p/Math.abs(d-h)),m=u*Math.min(1,p/Math.abs(f-h));isFinite(g)||(g=u),isFinite(m)||(m=u),c=b.shortestDecimalBetween(c-g,c+m);var y=v.fillHole(n,c,i,o,t.x,t.y);return{x:e.graphMode===M.Y?c:y,y:e.graphMode===M.Y?y:c}}},v.prototype.startMovingPoint=function(i){var o=!1;this.manager.movablePointsLayer.pressedPointId=i.isMovable()?i.getMovablePoint().id:null,this.manager.redrawAllLayers();var r=null,a=function(){if(r){o=!0;var e=this.manager.getProjection(),t=this.getMouseRelativeToGrapher(r);r=null,this.controller.dispatch({type:"on-move-point",pointInfo:i.getMovablePoint(),screenPt:t,projection:e})}}.bind(this);this.manager.registerMovablePointListener(a),this.addGlobalMouseListener("dcg-tapmove",function(e){r=e}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",function(e){if(a(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.pressedPointId=null,this.manager.redrawAllLayers(),this.controller.dispatch({type:"stop-moving-point",pointInfo:i.getMovablePoint()}),!o){var t=this.manager.getProjection(),r=this.getToleranceByDevice(e.device),n=t.map_pt(i);this.togglePOIUnderPoint(n,r)}}.bind(this))},v.prototype.startTracingBranch=function(e,t){this.manager.markLabelsDirty(),this.last_screen_pt=t;var r=this.manager.getProjection(),n=r.reverse_map_pt(t),i=e.sketch.branches[e.branch],o=v.getBranchesTracePoint(i,n,r);o&&this.speakPoint(o),this.manager.traceLayer.traceInfo={pt:o,branchInfo:e},this.manager.redrawAllLayers(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))},v.prototype.stopTracingBranch=function(e){this.manager.markLabelsDirty();var t=this.manager.poiLabelsLayer.getHoveredPOI();t&&!this.manager.poiLabelsLayer.isOpenPOI(t)&&(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t),this.manager.redrawAllLayers()),this.last_screen_pt=null,this.manager.traceLayer.traceInfo=null,this.manager.redrawAllLayers(),this.removeAllGlobalMouseListeners()},v.prototype.handleTraceUpdate=function(e){if(this.manager.traceLayer.traceInfo){var t,r=this.manager.getProjection();if(e)t=this.getMouseRelativeToGrapher(e),this.last_screen_pt=t,this.manager.markLabelsDirty();else{if(!this.last_screen_pt)return;t=this.last_screen_pt}var n=r.reverse_map_pt(t),i=1/0,o=-1,a=this.manager.traceLayer.traceInfo,s=this.manager.graphSketches[a.branchInfo.sketch.id];if(s){a.branchInfo.sketch=s;for(var l=a.branchInfo.sketch.branches,c=0;c<l.length;c++){var u=v.calculateDistanceFromBranch(l[c],n,r);u<i&&(o=c,i=u)}var p=l[o],d=p?v.getBranchesTracePoint(p,n,r):null;d&&this.speakPoint(d),this.manager.traceLayer.traceInfo.branchInfo.branch=o,this.manager.traceLayer.traceInfo.pt=d,this.manager.redrawAllLayers()}}},v.prototype.speakPoint=function(e){var t=this.manager.getAudioTrace();t&&e&&t.queueCoordinates(e,void 0,!0)},v.fillHole=function(e,t,r,n,i,o){var a=e(t);if(isFinite(a))return a;var s=t-1e-11,l=t+1e-11,c=e(s),u=e(l);if(isNaN(c)&&isNaN(u))return NaN;if(isNaN(c))return u;if(isNaN(u))return c;var p=(i-s)*r,d=(i-l)*r,h=(o-c)*n,f=(o-u)*n;return E.hypot(p,h)<E.hypot(d,f)?c:u},v.prototype.movePointFromKeyboard=function(e,t){if(e&&t){var r,n=this.getElementRelativeToGrapher(t.target),i=0,o=0,a=t.shiftKey?10:2,s=t.shiftKey?"big":"",l=d.lookup(t);if("Up"===l?(r="y",o-=a,s+="up"):"Down"===l?(r="y",o+=a,s+="down"):"Left"===l?(r="x",i-=a,s+="down"):"Right"===l&&(r="x",i+=a,s+="up"),0!==i||0!==o){t.preventDefault(),t.stopPropagation();var c,u={x:n.x+i,y:n.y+o},p=this.manager.getProjection();"x"===r?c=[s,""]:"y"===r&&(c=["",s]),this.controller.dispatch({type:"on-move-point",pointInfo:e,screenPt:u,projection:p,keyboardDirection:c})}}},v.prototype.speakPoint=function(e,t){if(e){var r=this.manager.getProjection();if(r){var n=r.viewport;switch(t){case"X":i.alert("X: "+o.value(e.x,n.xmax-n.xmin).ariaString);break;case"Y":i.alert("Y: "+o.value(e.y,n.ymax-n.ymin).ariaString);break;case"L":i.alert(e.label||this.controller.t("Graph point"))}}}},v}),define("graphing/screen",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.width=e,this.height=t};t.Screen=r}),define("graphing/graphsketch",["require","exports","tslib","math/poi-type","./graphmode","./poi","math/poi-type"],function(e,t,n,l,c,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=this;this.color="#000000",this.style="normal",this.visible=!0,this.showPOI=!1,this.showHighlight=!1,this.selected=!1,this.labels=[],this.id=e,this.branches=void 0!==t?t:[],this.getPOI().forEach(function(e){e.type===l.LABEL&&r.labels.push(e)})}return e.prototype.getPOI=function(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(var e=0;e<this.branches.length;e++){var t=this.branches[e],r=t.poi;if(t.graphMode===c.X||t.graphMode===c.Y)this._pushPOI(r.zeros,e,l.ZERO),this._pushPOI(r.intercept,e,l.INTERCEPT),this._pushPOI(r.extrema,e,l.EXTREMUM),r.intersections&&this._pushPOI(r.intersections,e,l.INTERSECTION);else if(t.graphMode===c.XYPOINT||t.graphMode===c.XYPOINT_MOVABLE)if(t.graphMode,!0===t.showLabel){var n=t.nakedLabel;r.defined&&this._pushPOI(r.defined,e,l.LABEL,n)}else r.defined&&this._pushPOI(r.defined,e,l.DEFINITION)}return this.__cachedPOI},e.prototype.getBranchPOI=function(t){return this.getPOI().filter(function(e){return e.branch===t})},e.prototype.getMovablePoints=function(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];var e=this.branches[0];if(e&&1===e.segments.length&&e.graphMode===c.XYPOINT_MOVABLE)for(var t=e.segments[0],r=0;r<t.length;r++){var n=void 0;e.tableId&&(n={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[r].index,dragX:e.movablePointInfo[r].dragX,dragY:e.movablePointInfo[r].dragY});var i=e.scaleFactors?e.scaleFactors[0][r]:void 0,o=n?n.rowIndex:r;this.__cachedMovablePoints.push({id:"movable:["+this.id+","+o+"]",sketch:this,color:this.color,tableInfo:n,scaleFactor:i,x:t[r][0],y:t[r][1],isMovable:!0,label:1===e.segments.length&&e.labels&&e.labels[r]?e.labels[r]:void 0})}return this.__cachedMovablePoints},e.prototype.getInteractivePoints=function(){var t=this;if(this.__cachedInteractivePoints)return this.__cachedInteractivePoints;var r=this.branches[0];this.__cachedInteractivePoints=[],this.__cachedInteractivePoints.push.apply(this.__cachedInteractivePoints,this.getMovablePoints());var e=this.getPOI().filter(function(e){return e.type===i.DEFINITION||e.type===i.LABEL}).map(function(e){return n.__assign({},e,{isMovable:!1,color:t.color,label:r.graphMode===c.XYPOINT&&r.labels&&r.labels[0]?r.labels[0]:void 0})});return this.__cachedInteractivePoints.push.apply(this.__cachedInteractivePoints,e),this.__cachedInteractivePoints},e.prototype._pushPOI=function(e,t,r,n){void 0===n&&(n=!1);for(var i=0,o=e.x.length;i<o;i++){var a=new s.POI(e.x[i],e.y[i],r,this,t,i,n);e.intersects&&(a.intersects=e.intersects[i]),this.__cachedPOI.push(a),this.__cachedPOIIds[a.id]=a}},e.prototype.updateIntersections=function(e){for(var t=this,r=0,n=this.branches.length;r<n;r++)this.branches[r].poi.intersections=e[r];var i=this.__cachedPOI;this.__cachedPOI=[],i.forEach(function(e){e.type!==l.INTERSECTION?t.__cachedPOI.push(e):delete t.__cachedPOIIds[e.id]});for(r=0;r<this.branches.length;r++){var o=this.branches[r],a=o.graphMode,s=o.poi;a!==c.X&&a!==c.Y||s.intersections&&this._pushPOI(s.intersections,r,l.INTERSECTION)}},e.prototype.getPOIById=function(e){return this.__cachedPOIIds[e]},e.prototype.updateFrom=function(e){if(e){this.visible=!0,this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.selected=e.selected;var t=this.branches[0].graphMode;if(t===c.XYPOINT||t===c.XYPOINT_MOVABLE){for(var r=!0,n=0;n<this.__cachedPOI.length;n++){var i=e.__cachedPOI[n],o=this.__cachedPOI[n];if(!i||i.type!==o.type){r=!1;break}}if(r)for(n=0;n<this.__cachedPOI.length;n++){i=e.__cachedPOI[n],o=this.__cachedPOI[n];delete this.__cachedPOIIds[o.id],(this.__cachedPOIIds[i.id]=o).id=i.id}}}},e}();t.GraphSketch=r}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("base64",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).base64js=e()}}(function(){return function o(a,s,l){function c(r,e){if(!s[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(u)return u(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[r]={exports:{}};a[r][0].call(i.exports,function(e){var t=a[r][1][e];return c(t||e)},i,i.exports,o,a,s,l)}return s[r].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({"/":[function(e,t,r){"use strict";function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function l(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(u[(a=n)>>18&63]+u[a>>12&63]+u[a>>6&63]+u[63&a]);var a;return i.join("")}r.byteLength=function(e){return 3*e.length/4-c(e)},r.toByteArray=function(e){var t,r,n,i,o,a,s=e.length;o=c(e),a=new d(3*s/4-o),n=0<o?s-4:s;var l=0;for(r=t=0;t<n;t+=4,r+=3)i=p[e.charCodeAt(t)]<<18|p[e.charCodeAt(t+1)]<<12|p[e.charCodeAt(t+2)]<<6|p[e.charCodeAt(t+3)],a[l++]=i>>16&255,a[l++]=i>>8&255,a[l++]=255&i;return 2===o?(i=p[e.charCodeAt(t)]<<2|p[e.charCodeAt(t+1)]>>4,a[l++]=255&i):1===o&&(i=p[e.charCodeAt(t)]<<10|p[e.charCodeAt(t+1)]<<4|p[e.charCodeAt(t+2)]>>2,a[l++]=i>>8&255,a[l++]=255&i),a},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i="",o=[],a=0,s=r-n;a<s;a+=16383)o.push(l(e,a,s<a+16383?s:a+16383));return 1===n?(t=e[r-1],i+=u[t>>2],i+=u[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=u[t>>10],i+=u[t>>4&63],i+=u[t<<2&63],i+="="),o.push(i),o.join("")};for(var u=[],p=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=n.length;i<o;++i)u[i]=n[i],p[n.charCodeAt(i)]=i;p["-".charCodeAt(0)]=62,p["_".charCodeAt(0)]=63},{}]},{},[])("/")}),define("bin",["base64"],function(e){var s={};return{load:function(e,t,r,n){var i=t.toUrl("assets_src/"+e);if(n.isBuild){var o=require.nodeRequire("fs");s[e]=o.readFileSync(i).toString("base64"),r()}else{var a=new XMLHttpRequest;a.open("GET",i,!0),a.responseType="arraybuffer",a.onload=function(){r(a.response)},a.send()}},write:function(e,t,r,n){t in s?r("define('"+e+"!"+t+"', ['base64'], function (base64) {  return base64.toByteArray('"+s[t]+"').buffer;});"):console.log("ERROR - failed to find file "+t+" in buildMap")}}}),define("bin!audio/poi.mp3",["base64"],function(e){return e.toByteArray("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==").buffer}),define("graphing/tonegenerator",["require","exports","bin!audio/poi.mp3","tslib","browser","lib/animation-frame","bugsnag","graphing/graphmode"],function(e,t,r,C,n,f,i,k){"use strict";function P(e,t){var r=t.independentMin,n=t.independentMax,i=Math.abs((e-r)/(n-r));return isFinite(i)||(i=.5),i=Math.max(Math.min(i,1),0),{left:Math.cos(Math.PI/2*i),right:Math.sin(Math.PI/2*i)}}function D(e,t,r,n,i){var o,a=t.independent,s=t.dependent,l=e.phase,c=e.noiseVal,u=e.lowerOctaveGain,p=e.upperOctaveGain,d=r.dependentMin,h=r.dependentMax,f=0,g=0,m=0;!isNaN(s)&&d<=s&&s<=h?(l+=(o=(s-d)/(h-d),Math.min(Math.max(w*Math.pow(2,o),x),_))/n,m=i<4*b?g=0:(g=.5,a<0?.5:0),s<0&&(f+=.15*(c=v(c)))):f+=.15*(c=v(c));return p+=(m-p)/(n*b),{amplitude:f+=(u+=(g-u)/(n*b))*y(l)+p*y(2*l),phase:l,noiseVal:c,lowerOctaveGain:u,upperOctaveGain:p}}function y(e){return Math.abs(4*e+1-4*Math.floor((4*e+3)/4))-1}function v(e){return(e+.2*(2*Math.random()-1))/1.02}function A(e,t){return e[0]-t[0]}function L(e,t,r,n){for(var i=e.getChannelData(0),o=t.getChannelData(0),a=t.getChannelData(1),s=0;s<i.length&&s+r<o.length;s++)o[s+r]+=i[s]*n.left,a[s+r]+=i[s]*n.right}function a(e){switch(e.graphMode){case k.X:case k.Y:case k.XYPOINT:case k.XYPOINT_MOVABLE:return 0<e.segments.length;default:return!1}}function O(e,t,r){switch(e.graphMode){case k.Y:case k.X:if(t<0||t>=e.segments.length)return!1;var n=e.segments[t],i=2*r;return 0<=i&&i<n.length;case k.XYPOINT:case k.XYPOINT_MOVABLE:return 0<=r&&r<=1&&0<=t&&t<e.segments[0].length;default:return!1}}function q(e,t,r,n,i){if(!O(e,t,r))return{independent:NaN,dependent:NaN};switch(e.graphMode){case k.Y:case k.X:var o=2*r;return o+1>=(s=e.segments[t]).length?{independent:NaN,dependent:NaN}:{independent:s[o],dependent:s[o+1]};case k.XYPOINT:case k.XYPOINT_MOVABLE:var a=e.segments[0][t][1],s=e.segments[0],l=.5*(n.xmax-n.xmin)/i*p;if(0===r){var c=-1/0;return O(e,t-1,0)&&(c=.5*(s[t][0]+s[t-1][0])),{independent:Math.max(s[t][0]-l,c),dependent:a}}var u=1/0;return O(e,t+1,0)&&(u=.5*(s[t][0]+s[t+1][0])),{independent:Math.min(s[t][0]+l,u),dependent:a};default:return{independent:NaN,dependent:NaN}}}function F(e){switch(e.graphMode){case k.Y:case k.X:return e.segments.length;case k.XYPOINT:case k.XYPOINT_MOVABLE:return e.segments[0].length;default:return 0}}function N(e,t,r,n){if(!O(e,t,0))return NaN;switch(e.graphMode){case k.Y:case k.X:return(i=e.segments[t])[i.length-2];case k.XYPOINT:case k.XYPOINT_MOVABLE:var i=e.segments[0],o=1/0;O(e,t+1,0)&&(o=.5*(i[t][0]+i[t+1][0]));var a=.5*(r.xmax-r.xmin)/n*p;return Math.min(i[t][0]+a,o);default:return NaN}}function R(e,t){switch(t){case k.Y:case k.XYPOINT:case k.XYPOINT_MOVABLE:return{independentMin:e.xmin,independentMax:e.xmax,dependentMin:e.ymin,dependentMax:e.ymax};case k.X:return{independentMin:e.ymin,independentMax:e.ymax,dependentMin:e.xmin,dependentMax:e.xmax};default:throw B(t)}}function B(e){return"Unexpected graph mode. Received "+e}function o(e,t,r,n){var i,o,a=e.sampleRate,s=e.getChannelData(0),l=e.getChannelData(1),c=t.graphMode,u=R(r,c),p=u.independentMin,d=u.independentMax,h=d-p,f=0,g=0,m=s.length-1,y=m/a;t.graphMode!==k.XYPOINT&&t.graphMode!==k.XYPOINT_MOVABLE||(i=t,(o=(i=C.__assign({},i)).segments[0].slice()).sort(A),i.segments=[o],t=i);for(var v={amplitude:0,phase:0,noiseVal:0,lowerOctaveGain:0,upperOctaveGain:0},b=0;b<s.length;b++){for(var x=P(T=(m-b)/m*p+b/m*d,u);f<F(t)&&q(t,f,g,r,y).independent<T;)O(t,f,g+=1)||(f+=1,g=0);var w=(N(t,f,r,y)-T)*(y/h),_=q(t,f,g,r,y),S=q(t,f,g-1,r,y),E=_.independent-S.independent;v=D(v,{independent:T,dependent:(_.independent-T)/E*S.dependent+(T-S.independent)/E*_.dependent},u,a,w),s[b]+=v.amplitude*x.left,l[b]+=v.amplitude*x.right}if(n&&(c===k.X||c===k.Y)&&t.poi.intersections)for(var M=0,I=function(e,t){if(e===k.X)return t.y;if(e===k.Y)return t.x;throw B(e)}(c,t.poi.intersections);M<I.length;M++){var T=I[M];L(n,e,b=Math.round((T-p)/(d-p)*m),P(T,u))}}function s(e,t,r,n){for(var i=e.sampleRate,o=e.getChannelData(0),a=e.getChannelData(1),s=R(r,t.graphMode),l=o.length-1,c={amplitude:0,phase:0,noiseVal:0,lowerOctaveGain:0,upperOctaveGain:0},u=function(e){switch(e.graphMode){case k.Y:case k.XYPOINT:case k.XYPOINT_MOVABLE:return{independent:e.x,dependent:e.y};case k.X:return{independent:e.y,dependent:e.x};default:throw B(e.graphMode)}}(t),p=u.independent,d=u.dependent,h=P(p,s),f=0;f<o.length;f++){c=D(c,{independent:p,dependent:d},s,i,(l-f)/i),o[f]+=c.amplitude*h.left,a[f]+=c.amplitude*h.right}n&&void 0!==t.intersects&&L(n,e,0,h)}Object.defineProperty(t,"__esModule",{value:!0});var p=.075,b=.0015,x=125,w=500,_=2e3,l=function(){function e(e){var t=e.audioPointMove,r=e.audioPointReset;this.audioSpeed=50,this.audioPointMove=t,this.audioPointReset=r}return e.prototype.suspend=function(){this.playbackSupported&&this.audioCtx&&(this.stop(),this.audioCtx.suspend())},e.prototype.resume=function(){if(!this.audioCtx){var e=window.AudioContext||window.webkitAudioContext;if(n.IS_IE)this.playbackSupported=!1,this.audioCtx=void 0;else try{this.audioCtx=e?new e:void 0,this.playbackSupported=!0}catch(e){i.notify(e),this.playbackSupported=!1,this.audioCtx=void 0}}this.playbackSupported&&this.audioCtx&&("suspended"===this.audioCtx.state&&this.audioCtx.resume(),this.loadPOI())},e.prototype.stop=function(){this.playTimeout&&(f.cancelAnimationFrame(this.playTimeout),this.playTimeout=void 0),this.bufferSource&&(this.bufferSource.stop(),this.bufferSource.disconnect(),this.bufferSource=void 0),this.audioPointReset()},e.prototype.getAudioSpeed=function(){return this.audioSpeed},e.prototype.setAudioSpeed=function(e){this.audioSpeed=e},e.prototype.getPlaybackSupported=function(){return this.playbackSupported},e.prototype.playBranchByIndex=function(e,t,r){var n=this;if(!(t<0||t>=e.branches.length)&&a(e.branches[t])){this.playBranch(e.branches[t],t,r,function(){return n.stop()})}},e.prototype.playSketch=function(e,t){var r=this,n=e.branches;if(0!==n.length){var i=-1,o=function(){for(i+=1;i<n.length&&!a(n[i]);)i+=1;i<n.length?r.playBranch(n[i],i,t,o):r.stop()};o()}},e.prototype.playPoint=function(e,t){if(this.audioCtx&&function(e){switch(e.graphMode){case k.X:case k.Y:case k.XYPOINT:case k.XYPOINT_MOVABLE:return!0;default:return!1}}(e)){var r=this.audioCtx.sampleRate,n=r*p,i=this.audioCtx.createBuffer(2,n,r);s(i,e,t,this.poiBuffer),this.connectBuffer(i)}},e.prototype.connectBuffer=function(e){if(this.audioCtx){var t=this.audioCtx.createGain();t.connect(this.audioCtx.destination),t.gain.value=n.IS_APPLE?1:.5;var r=this.audioCtx.createBufferSource();(this.bufferSource=r).buffer=e,r.connect(t),r.start()}},e.prototype.playBranch=function(a,s,l,c){var u=this;if(this.audioCtx){var p=this.audioSpeed/10,e=this.audioCtx.sampleRate,t=e*p,r=this.audioCtx.createBuffer(2,t,e);o(r,a,l,this.poiBuffer),this.connectBuffer(r);var d=this.audioCtx.currentTime,h=function(){if(void 0!==u.playTimeout&&f.cancelAnimationFrame(u.playTimeout),u.audioCtx){var e=u.audioCtx.currentTime-d,t=a.graphMode,r=R(l,t),n=r.independentMin,i=r.independentMax,o=(p-e)/p*n+e/p*i;u.audioPointMove(s,o),e<p?u.playTimeout=f.requestAnimationFrame(h):c()}};h()}},e.prototype.loadPOI=function(){var t=this;this.playbackSupported&&!this.poiBuffer&&this.audioCtx&&this.audioCtx.decodeAudioData(r.slice(0),function(e){t.poiBuffer=e})},e}();t.default=l,t.canPlaySketch=function(e){for(var t=0,r=e.branches;t<r.length;t++)if(a(r[t]))return!0;return!1},t.canPlayBranch=a,t.getFirstPlayableBranchIndex=function(e){for(var t=0;t<e.branches.length;t++)if(a(e.branches[t]))return t;return 0},t.getReportedBranch=function(e,t){for(var r=0,n=0;n<=t;n++)a(e.branches[n])&&(r+=1);return r}}),define("graphing/audiographnavigator",["require","exports","main/propagate_selection","tslib","underscore","graphing/graphmode","graphing/label","math/poi","graphing/tonegenerator","lib/aria"],function(e,t,r,s,g,m,h,l,y,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this.grapher=r,this.controller=e,this.audiograph=t,this.reset()}return e.prototype.reset=function(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0,this.xstep=0,this.ystep=0},e.prototype.resetToFirstBranch=function(){var e=this.getCurrentSketch();this.branch=e?y.getFirstPlayableBranchIndex(e):0},e.prototype.getBranchPoints=function(e){var t=[];if(0<=e)for(var r=0,n=this.getSampledPoints();r<n.length;r++){var i=n[r];i.branch===e&&t.push(i)}return t},e.prototype.resetTracePoint=function(){this.drawTrace(this.getCurrentPoint())},e.prototype.drawTrace=function(e){var t=this.getCurrentSketch();if(e&&t){var r=t.branches[this.branch];if(r)if(r.graphMode!==m.XYPOINT){var n={x:e.x,y:e.y};this.grapher.traceLayer.traceInfo={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:n},this.grapher.redrawAllLayers()}}},e.prototype.moveToOrigin=function(){var e=this.getCurrentSketch();if(e&&y.canPlaySketch(e)){var t=e.branches[this.branch];if(y.canPlayBranch(t)){var r=t.graphMode;if(r===m.Y)this.setIndependent("x",0);else if(r===m.X)this.setIndependent("y",0);else if(r===m.XYPOINT){var n=this.getSortedPOI()[0];this.setIndependent("x",n?n.x:0)}}}},e.prototype.getCurrentSketch=function(){var e,t=this.getSelectedItem();if(t){var r=this.audiograph.getFocusedCell();e="table"===t.type&&r?this.getGraphSketchForTableCell(t,r):this.grapher.getGraphSketch(t.id)}return e},e.prototype.getFirstTraceableSketch=function(e){for(var t,r=this.controller.getItemCount(),n=this.controller.shouldAudioTraceReverseExpressions(),i=0;i<r;i++){var o=n?r-1-i:i,a=this.controller.getItemModelByIndex(o);if(a&&this.canTrace(a)){var s=n?this.prevTableColumn(a):this.nextTableColumn(a);if(t=s?(this.audiograph.setFocusedCell(s),this.getGraphSketchForTableCell(a,s)):this.grapher.getGraphSketch(a.id)){e&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:o});break}}}return t},e.prototype.canTrace=function(e){if("shouldGraph"in e){var t=this.grapher.getGraphSketch(e.id);return!!t&&y.canPlaySketch(t)}return!1},e.prototype.getTraceableExpressionCount=function(){for(var e=0,t=this.controller.getItemCount(),r=0;r<t;r++){var n=this.controller.getItemModelByIndex(r);n&&this.canTrace(n)&&e++}return e},e.prototype.computeStepSizes=function(){var e=this.grapher.getProjection().viewport;if(e){var t=(this.viewport=e).xmin,r=e.xmax;this.xstep=Math.abs(r-t)/100,this.xscale=r-t;var n=e.ymin,i=e.ymax;this.ystep=Math.abs(i-n)/100,this.yscale=i-n;var o=this.getCurrentSketch();if(o&&y.canPlaySketch(o)){var a=o.branches[this.branch];if(y.canPlayBranch(a)){var s=a.graphMode;if(s===m.Y)this.independent<t?this.independent=t:this.independent>r&&(this.independent=r);else if(s===m.X)this.independent<n?this.independent=n:this.independent>i&&(this.independent=i);else if(s===m.XYPOINT){var l=void 0,c=void 0;this.independent<t?(c=this.getSortedPOI()[0],this.independent=c&&void 0!==c.x?c.x:0):this.independent>r&&(c=(l=this.getSortedPOI())[l.length-1],this.independent=c&&void 0!==c.x?c.x:0)}}}}},e.prototype.getPoint=function(e,t){var r,n=this.getCurrentSketch();if(!n||!y.canPlaySketch(n))return r;var i,o,a,s=0,l=n.branches[e];if(l){var c=y.getReportedBranch(n,e);return"compiled"in l&&l.compiled&&(a=l.compiled.fn),(o=l.graphMode)===m.Y?((i=this.getInterveningPOIs(t,t+this.xstep,e,o)[0])&&i.x===t&&i.branch===e||(i=void 0,s=a?a(t):0),i?r={x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:c,graphMode:o,intersects:i.intersects}:a&&(r={x:t,y:s,branch:e,reportedBranch:c,graphMode:o})):o===m.X?((i=this.getInterveningPOIs(t,t+this.ystep,e,o)[0])&&i.y===t&&i.branch===e||(i=void 0,s=a?a(t):0),i?r={x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:c,graphMode:o,intersects:i.intersects}:a&&(r={y:t,x:s,branch:e,reportedBranch:c,graphMode:o})):o===m.XYPOINT&&(r=(i=this.getInterveningPOIs(t,t+this.xstep,e,o)[0])&&i.x===t&&i.branch===e?{x:i.x,y:i.y,type:i.type,typeChain:i.typeChain,branch:i.branch,reportedBranch:c,graphMode:o,intersects:i.intersects}:{x:t,y:NaN,branch:e,reportedBranch:c,graphMode:o}),r}},e.prototype.getSampledPoints=function(){return 0===this.sampledPoints.length&&this.updateSampledPoints(),this.sampledPoints},e.prototype.updateSampledPoints=function(){var e=this.getCurrentSketch();if(e&&y.canPlaySketch(e)){for(var t=[],r=0;r<e.branches.length;r++){var n=e.branches[r];if(y.canPlayBranch(n)){var i=n.graphMode,o=0,a=0,s=0,l=[];if(i===m.Y||i===m.XYPOINT?(o=this.viewport.xmin,a=this.viewport.xmax,s=this.xstep):i===m.X&&(o=this.viewport.ymin,a=this.viewport.ymax,s=this.ystep),0!==o||0!==a||0!==s){for(var c=0;h.value(o+c*s).value<=a;c++){var u=h.value(o+c*s).value,p=this.getInterveningPOIs(u,u+s,r,i);if(0<p.length)l.push.apply(l,p);else{var d=this.getPoint(r,u);d&&l.push(d)}}t.push.apply(t,this.removeDuplicates(l,i))}}}this.sampledPoints=t}},e.prototype.getCurrentPoint=function(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint},e.prototype.updateCurrentPoint=function(e){if(e){var t=(this.currentPoint=e).graphMode;t===m.Y||t===m.XYPOINT?this.independent=void 0!==e.x?e.x:0:t===m.X&&(this.independent=void 0!==e.y?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)},e.prototype.prevPoint=function(){this.moveToPoint(-1)},e.prototype.nextPoint=function(){this.moveToPoint(1)},e.prototype.firstPoint=function(){var e=this.getSampledPoints();0<e.length&&this.updateCurrentPoint(e[0])},e.prototype.lastPoint=function(){var e=this.getSampledPoints();0<e.length&&this.updateCurrentPoint(e[e.length-1])},e.prototype.moveToPoint=function(e){var t=this.getCurrentPoint();if(t){if(t.graphMode===m.XYPOINT)return void this.moveToPOI(e);var r=this.getSampledPoints(),n=this.getPointIndex(r,t);if(-1!==n){var i=n+e;i<=0?(i=0,c.queue(this.controller.t("First point"))):i>=r.length-1&&(i=r.length-1,c.queue(this.controller.t("Last point")));var o=r[i];this.updateCurrentPoint(o)}}},e.prototype.prevPOI=function(){this.moveToPOI(-1)},e.prototype.nextPOI=function(){this.moveToPOI(1)},e.prototype.getSortedPOI=function(){return this.pois&&0!==this.pois.length||this.updatePOI(),this.pois},e.prototype.updatePOI=function(){var e,t,r,n,i=[],o=[],a=this.getCurrentSketch();if(a&&y.canPlaySketch(a)){for(var s=0;s<a.branches.length;s++){var l=a.branches[s];if(l){var c=y.getReportedBranch(a,s),u=l.graphMode;if(o=[],0<(e=a.getBranchPOI(s)).length){u===m.Y||u===m.XYPOINT?o=g.sortBy(e,"x"):u===m.X&&(o=g.sortBy(e,"y"));for(var p=[],d=0,h=o;d<h.length;d++){var f=h[d];p.push((r=u,n=c,{x:(t=f).x,y:t.y,branch:t.branch,reportedBranch:n,type:t.type,graphMode:r,intersects:t.intersects}))}i.push.apply(i,this.removeDuplicates(p,u))}}}this.pois=i}},e.prototype.removeDuplicates=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var o=i[n];if((o=s.__assign({},o)).graphMode=t,0!==r.length){var a=r[r.length-1];h.value(a.x).value===h.value(o.x).value&&h.value(a.y).value===h.value(o.y).value&&a.branch===o.branch?(a.typeChain||(a.typeChain=void 0!==a.type?[a.type]:[]),void 0!==o.type&&-1===a.typeChain.indexOf(o.type)&&a.typeChain.push(o.type),o.type===l.default.INTERSECTION&&o.intersects&&void 0===a.intersects&&(a.intersects=o.intersects)):r.push(o)}else r.push(o)}return r},e.prototype.getInterveningPOIs=function(e,t,r,n){for(var i=[],o=NaN,a=0,s=this.getSortedPOI();a<s.length;a++){var l=s[a];l&&(n!==m.Y&&n!==m.XYPOINT||isNaN(l.x)?n!==m.X||isNaN(l.y)||(o=l.y):o=l.x,l.branch===r&&!isNaN(o)&&(e<=o&&o<t||t<=o&&o<e)&&i.push(l))}return t<e?i.reverse():i},e.prototype.setIndependent=function(e,t){for(var r=this.getSampledPoints(),n=0,i=r;n<i.length;n++){var o=i[n];if(o&&o.hasOwnProperty(e)&&o[e]===t){if("x"===e)return this.independent=void 0!==o.x?o.x:0,void this.updateCurrentPoint();if("y"===e)return this.independent=void 0!==o.y?o.y:0,void this.updateCurrentPoint()}}var a=!0;if(0<r.length){var s=r[Math.floor((r.length-1)/2)];s&&("x"===e?(this.independent=void 0!==s.x?s.x:0,a=!1):"y"===e&&(this.independent=void 0!==s.y?s.y:0,a=!1))}a&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()},e.prototype.moveToPOI=function(e){var t=this.getCurrentPoint();if(t){var r=this.getSampledPoints(),n=this.getPointIndex(r,t);if(-1!==n){for(var i=t.graphMode,o=-1,a=1===e?r.length-1:0,s=n;s!==a+e;s+=e){var l=r[s];if(((i===m.Y||i===m.XYPOINT)&&t.x!==l.x||i===m.X&&t.y!==l.y)&&void 0!==l.type){o=s;break}}-1===o?c.queue(this.controller.t("No more points of interest")):this.updateCurrentPoint(r[o])}}},e.prototype.getPointIndex=function(e,t){var r=-1;if(0<e.length&&t)for(var n=t.graphMode,i=0;i<e.length;i++){var o=e[i];if(((n===m.Y||n===m.XYPOINT)&&o.x===t.x||n===m.X&&o.y===t.y)&&o.branch===t.branch){r=i;break}}return r},e.prototype.prevCurve=function(){this.controller.shouldAudioTraceReverseExpressions()?this.curveDown():this.curveUp()},e.prototype.nextCurve=function(){this.controller.shouldAudioTraceReverseExpressions()?this.curveUp():this.curveDown()},e.prototype.curveUp=function(){var e=this.getSelectedItem();if(e){var t=this.prevTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{var r=e.index,n=this.findPrevTraceableIndex(r);if(-1!==n){var i=this.controller.getItemModelByIndex(n);i&&this.controller.dispatch({type:"set-selected-id",id:i.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}},e.prototype.curveDown=function(){var e=this.getSelectedItem();if(e){var t=this.nextTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{var r=e.index,n=this.findNextTraceableIndex(r);if(-1!==n){var i=this.controller.getItemModelByIndex(n);i&&this.controller.dispatch({type:"set-selected-id",id:i.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}},e.prototype.findPrevTraceableIndex=function(e){var t;do{e--;var r=(t=this.controller.getItemModelByIndex(e))&&this.prevTableColumn(t);if(r)return this.audiograph.setFocusedCell(r),e}while(t&&!this.canTrace(t));return t?e:-1},e.prototype.findNextTraceableIndex=function(e){var t;do{e++;var r=(t=this.controller.getItemModelByIndex(e))&&this.nextTableColumn(t);if(r)return this.audiograph.setFocusedCell(r),e}while(t&&!this.canTrace(t));return t?e:-1},e.prototype.prevTableColumn=function(e){return this.tableColumn(e,-1)},e.prototype.nextTableColumn=function(e){return this.tableColumn(e,1)},e.prototype.tableColumn=function(e,t){var r;if(e&&"table"===e.type){var n=this.audiograph.getFocusedCell(),i=void 0,o=void 0,a=void 0,s=((a=-1===t?(i=n?Math.max(n.location.column-1,0):NaN,o=n&&n.tableId===e.id&&!isNaN(i)?i:e.columnModels.length-1,0):(i=n?Math.min(n.location.column+1,e.columnModels.length-1):NaN,o=n&&n.tableId===e.id&&!isNaN(i)?i:0,e.columnModels.length-1))-o)/t;if(isFinite(s)&&0<=s)for(var l=o;l!==a;l+=t){var c=e.columnModels[l];if(c)if(this.grapher.getGraphSketch(c.id)){r={tableId:e.id,location:{column:l,row:0}};break}}}return r},e.prototype.getGraphSketchForTableCell=function(e,t){if(e&&"table"===e.type&&t){var r=e.columnModels[t.location.column];return r?this.grapher.getGraphSketch(r.id):void 0}},e.prototype.getXScale=function(){return this.xscale},e.prototype.getYScale=function(){return this.yscale},e.prototype.getSelectedItem=function(){var e=this.controller.getSelectedItem();return e&&"folder"===e.type?this.controller.getItemModel(r.getSelectedId(e)):e},e}();t.default=n}),define("graphing/audiograph",["require","exports","tslib","browser","keys","lib/aria","graphing/audiographnavigator","graphing/tonegenerator","graphing/graphmode","graphing/label","math/poi","graphing-calc/models/table"],function(e,t,r,l,d,h,n,f,a,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var r=this;this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new n.default(e,this,this.grapher),this.tonegen=new f.default({audioPointMove:function(e,t){r.agNavigator.drawTrace(r.agNavigator.getPoint(e,t))},audioPointReset:function(){r.agNavigator.resetTracePoint()}}),this.tonegen.suspend()}return e.prototype.remove=function(){},e.prototype.handleKeydown=function(e){var t=e.altKey||e.metaKey,r=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey,n=e.ctrlKey&&!e.metaKey&&!e.altKey,i=l.IS_APPLE?n:t,o=i&&(61===e.which||187===e.which),a=i&&!e.shiftKey&&(173===e.which||189===e.which),s=i&&!e.shiftKey&&"0"===d.lookupChar(e);r&&"S"===d.lookupChar(e)?this.agNavigator.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeGraph()):r&&"T"===d.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):o?(e.preventDefault(),e.stopPropagation(),this.zoom("in")):a?(e.preventDefault(),e.stopPropagation(),this.zoom("out")):s?(e.preventDefault(),e.stopPropagation(),this.zoom("default")):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):this.audioTraceKeydown(e))},e.prototype.sliderTraceKeydown=function(e){var t=e.altKey||e.metaKey,r=!t&&!e.ctrlKey&&!e.shiftKey;r&&d.lookup(e)===d.LEFT||"J"===d.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):r&&d.lookup(e)===d.RIGHT||"L"===d.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):r&&d.lookup(e)===d.PAGEDOWN?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):r&&d.lookup(e)===d.PAGEUP?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):t||d.lookup(e)!==d.DOWN&&(e.shiftKey||d.lookup(e)!==d.TAB)&&"K"!==d.lookupChar(e)?!t&&(d.lookup(e)===d.UP||e.shiftKey&&d.lookup(e)===d.TAB||"I"===d.lookupChar(e))?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):r&&d.lookup(e)===d.HOME||"U"===d.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):r&&d.lookup(e)===d.END||"N"===d.lookupChar(e)?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):(this.stopAnimations(),this.audioTraceKeydown(e)):(e.preventDefault(),e.stopPropagation(),this.nextSlider())},e.prototype.audioTraceKeydown=function(e){var t=this,r=e.altKey||e.metaKey,n=r&&!e.ctrlKey&&!e.shiftKey,i=!r&&!e.ctrlKey&&!e.shiftKey,o=d.lookupChar(e);if(d.lookup(e)===d.UP&&n)e.preventDefault(),e.stopPropagation(),this.agNavigator.prevCurve();else if(d.lookup(e)===d.DOWN&&n)e.preventDefault(),e.stopPropagation(),this.agNavigator.nextCurve();else if(i&&d.lookup(e)===d.LEFT||d.lookup(e)===d.UP||"J"===o)e.preventDefault(),e.stopPropagation(),this.agNavigator.prevPoint(),this.reportAudioTrace();else if(i&&d.lookup(e)===d.RIGHT||d.lookup(e)===d.DOWN||"L"===o)e.preventDefault(),e.stopPropagation(),this.agNavigator.nextPoint(),this.reportAudioTrace();else if(r||d.lookup(e)!==d.PAGEDOWN&&(e.shiftKey||d.lookup(e)!==d.TAB)&&"I"!==o)if(!r&&(d.lookup(e)===d.PAGEUP||e.shiftKey&&d.lookup(e)===d.TAB||"K"===o))e.preventDefault(),e.stopPropagation(),this.agNavigator.prevPOI(),this.reportAudioTrace();else if(i&&d.lookup(e)===d.HOME||"U"===o)e.preventDefault(),e.stopPropagation(),this.agNavigator.firstPoint(),this.reportAudioTrace();else if(i&&d.lookup(e)===d.END||"N"===o)e.preventDefault(),e.stopPropagation(),this.agNavigator.lastPoint(),this.reportAudioTrace();else if(i&&"X"===o)e.preventDefault(),e.stopPropagation(),this.reportAudioTrace("x");else if(i&&"P"===o)e.preventDefault(),e.stopPropagation(),this.queuePOICount(),h.alert();else if(i&&"Y"===o)e.preventDefault(),e.stopPropagation(),this.reportAudioTrace("y");else if(i&&"T"===o)e.preventDefault(),e.stopPropagation(),this.reportAudioTrace("type");else if(i&&"B"===o)e.preventDefault(),e.stopPropagation(),this.reportAudioTrace("branch");else if(i&&"O"===o)e.preventDefault(),e.stopPropagation(),this.agNavigator.moveToOrigin(),this.reportAudioTrace();else if(i&&"H"===o)if(e.preventDefault(),e.stopPropagation(),this.tonegen.getPlaybackSupported()){this.tonegen.stop();var a=this.agNavigator.getCurrentSketch();a&&f.canPlaySketch(a)?(h.alert(this.controller.t("Playing graph.")),clearTimeout(this.playTimeout),this.playTimeout=setTimeout(function(){return t.tonegen.playSketch(a,t.grapher.getCurrentViewport())},500)):h.alert(this.controller.t("Unable to audio trace this expression."))}else h.alert(this.controller.t("Unable to play audio."));else if(i&&"string"==typeof o&&"0"<=o&&o<="9"){e.preventDefault(),e.stopPropagation(),this.tonegen.stop();var s=this.agNavigator.getCurrentSketch();if(s){for(var l,c=l=48===e.which?9:e.which-49,u=-1,p=0;p<s.branches.length;p++)if(f.canPlayBranch(s.branches[p])&&(c-=1),c<0){u=p;break}0<=u?this.tonegen.getPlaybackSupported()?(h.alert(this.controller.t("Branch __branch__",{branch:l+1})),clearTimeout(this.playTimeout),this.playTimeout=setTimeout(function(){return t.tonegen.playBranchByIndex(s,u,t.grapher.getCurrentViewport())},500)):h.alert(this.controller.t("Unable to play audio.")):h.alert(this.controller.t("Branch __branch__ does not exist.",{branch:l+1}))}else h.alert(this.controller.t("No graph selected."))}else r&&"string"==typeof o&&"1"<=o&&o<="5"?(e.preventDefault(),e.stopPropagation(),this.adjustPlaybackSpeed(o)):i&&"A"===o?(e.preventDefault(),e.stopPropagation(),this.queueAnimatingPoints(!0),h.alert()):i&&"S"===o&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):i&&this.exitAudioTrace();else e.preventDefault(),e.stopPropagation(),this.agNavigator.nextPOI(),this.reportAudioTrace()},e.prototype.describeGraph=function(){var e=this.agNavigator.getCurrentSketch();if(e){var t=f.getReportedBranch(e,e.branches.length-1);1<t&&h.queue(this.controller.t("Branches: __branches__.",{branches:t}));var r=this.agNavigator.getSortedPOI();if(h.queue(this.controller.t("Points of interest: __poiCount__.",{poiCount:r.length})),0<r.length)for(var n=0;n<r.length;n++)this.queueCoordinates(r[n])}else h.queue(this.controller.t("No graph information available."));h.alert()},e.prototype.queueCoordinates=function(e,t,r){if(void 0===r&&(r=!1),e){var n=this.agNavigator.getCurrentSketch();(e.hasOwnProperty("branch")&&n&&1<n.branches.length&&this.lastSpokenBranch!==e.reportedBranch||"branch"===t)&&h.queue(this.controller.t("Branch __branch__.",{branch:e.reportedBranch})),this.lastSpokenBranch=e.reportedBranch?e.reportedBranch:e.branch+1,e.hasOwnProperty("type")&&!t?h.queue(this.controller.t("__type__ at",{type:this.describePOI(e)})):"type"===t&&h.queue(this.describePOI(e)),t&&"x"!==t||h.queue(this.controller.t("X: __x__.",{x:i.value(e.x,this.agNavigator.getXScale()).ariaString})),t&&"y"!==t||h.queue(this.controller.t("Y: __y__.",{y:i.value(e.y,this.agNavigator.getYScale()).ariaString})),r&&h.alert()}},e.prototype.describePOI=function(e){if(e.typeChain){for(var t=[],r=0;r<e.typeChain.length;r++)t.push(this.poiTypeToText(e,r));return t.join(", ")}return this.poiTypeToText(e)},e.prototype.poiTypeToText=function(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case o.default.INTERSECTION:var r=this.getIntersectingCurves(e);return""!==r?this.controller.t("Intersection with __curves__",{curves:r}):this.controller.t("Intersection");case o.default.ZERO:return this.controller.t("Zero");case o.default.INTERCEPT:return this.controller.t("Intercept");case o.default.EXTREMUM:return this.controller.t("Extremum");case o.default.EDGE:return this.controller.t("Edge");case o.default.DEFINITION:return this.controller.t("Point");case o.default.TRACE:return this.controller.t("Trace");case o.default.LABEL:return this.controller.t("Label");default:return this.controller.t("Not a P O I")}},e.prototype.getIntersectingCurves=function(e){return e&&e.intersects?this.getExpressionAriaLabel(e.intersects):""},e.prototype.getExpressionAriaLabel=function(e){var t=this.controller.getItemModel(e);return t?"expression"===t.type&&t.label?t.label:this.controller.isItemSecret(t.id)?this.controller.t("Secret expression __index__",{index:t.secretIndex}):"table"===t.type&&this.focusedCell?this.controller.t("Expression __index__ column __column__",{index:t.displayIndex,column:this.focusedCell.location.column+1}):this.controller.t("Expression __index__",{index:t.displayIndex}):""},e.prototype.exitAudioTrace=function(e){if(this.audioTraceActive){if(this.audioTraceActive=!1,e||(e=this.controller.t("Audio trace off.")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){var t=this.agNavigator.getSelectedItem();t&&this.controller.isItemSelectable(t.id)||(t=this.controller.getFirstFullyVisibleItem()),t&&this.controller.isItemSelectable(t.id)&&this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:"table"===t.type&&void 0!==this.focusedCell?r.__assign({location:"cell"},this.focusedCell.location):"end"})}this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.tonegen.stop(),this.tonegen.suspend(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.traceInfo=null,this.grapher.redrawAllLayers(),h.alert(e),this.resumeAnimations()}},e.prototype.isFocusInExpressionsView=function(){return!!this.controller.getFocusedItem()},e.prototype.enterAudioTrace=function(){var e,t=this,r=this.agNavigator.getSelectedItem(),n=!1;if(this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),n=!this.wasFocusInExpressionsView),n)e=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else{if(r&&"expression"===r.type&&r.formula&&r.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("No graph to trace.")}});if(r&&"table"===r.type){var i=s.getSelectedCell(r);this.focusedCell&&this.focusedCell.tableId===r.id&&(!i||i.column===this.focusedCell.location.column&&i.row===this.focusedCell.location.row)||(this.focusedCell=void 0!==i?{tableId:r.id,location:i}:void 0)}else this.focusedCell=void 0;e=this.agNavigator.getCurrentSketch()}if(!e)return this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("No graph to trace.")}});var o=e.branches[0].graphMode;return o===a.IMPLICIT?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("Sorry, but I can't trace implicit curves yet.")}})):o===a.PARAMETRIC?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("Sorry, but I can't trace parametric curves yet.")}})):o===a.POLAR?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("Sorry, but I can't trace polar curves yet.")}})):(this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.grapher.redrawAllLayers(),this.audioTraceActive||(this.controller.dispatch({type:"toast/show",toast:{message:this.controller.t("Audio trace on."),noAria:!0,onHide:function(){return t.exitAudioTrace()},hideAfter:0}}),h.queue(this.controller.t("Audio trace on.")),this.pauseAnimations(),this.queueAnimatingPoints(!1),h.queue(this.controller.t("Use Arrow keys to navigate.")),this.tonegen.resume(),this.tonegen.getPlaybackSupported()&&h.queue(this.controller.t("To hear the graph, press H.")),1<this.agNavigator.getTraceableExpressionCount()&&(l.IS_APPLE?h.queue(this.controller.t("To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.")):h.queue(this.controller.t("To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow."))),l.IS_APPLE?h.queue(this.controller.t("To disable audio trace, press OPTION+T.")):h.queue(this.controller.t("To disable audio trace, press ALT+T.")),this.wasFocusInExpressionsView&&this.controller.find$(".dcg-graph-outer").one("focusin",function(){setTimeout(function(){h.alert()},0)}).focus()),this.agNavigator.moveToOrigin(),r&&h.queue(this.getExpressionAriaLabel(r.id)),this.reportAudioTrace(),this.wasFocusInExpressionsView||h.alert(),void(this.audioTraceActive=!0))},e.prototype.checkIfSelectedItemChanged=function(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(h.queue(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),h.alert()):this.exitAudioTrace()))},e.prototype.pauseAnimations=function(){var t=this;this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(function(e){e.slider.isPlaying&&(t.controller.dispatch({type:"set-slider-isplaying",id:e.id,isPlaying:!1}),t.sliderArray.push(e))})},e.prototype.resumeAnimations=function(){if(0!==this.sliderArray.length){for(var e=0;e<this.sliderArray.length;e++){var t=this.sliderArray[e];!0!==t.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}},e.prototype.stopAnimations=function(){var t=this;this.controller.getAllModelsWithSliders().forEach(function(e){e.slider.isPlaying&&t.controller.dispatch({type:"set-slider-isplaying",id:e.id,isPlaying:!1})})},e.prototype.getAnimatingVars=function(){for(var e=[],t=0;t<this.sliderArray.length;t++)e.push('"'+this.sliderArray[t].dependent+'"');return e},e.prototype.hasActiveSliders=function(){for(var e=this.controller.getAllModelsWithSliders(),t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1},e.prototype.queueAnimatingPoints=function(e){1===this.sliderArray.length?h.queue(this.controller.t("One animating slider was paused.")):1<this.sliderArray.length?h.queue(this.controller.t("__sliders__ animating sliders were paused.",{sliders:this.sliderArray.length})):e&&h.queue(this.controller.t("No animating sliders were paused."))},e.prototype.queueSliderLatex=function(){this.hasActiveSliders()||this.tonegen.stop();var e=this.getSelectedSlider();e?h.queue(e.latex):h.queue(this.controller.t("Unable to determine slider value"))},e.prototype.getSelectedSlider=function(){var e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null},e.prototype.incrementSliderValue=function(){this.adjustSlider("up")},e.prototype.decrementSliderValue=function(){this.adjustSlider("down")},e.prototype.incrementBigSliderValue=function(){this.adjustSlider("bigup")},e.prototype.decrementBigSliderValue=function(){this.adjustSlider("bigdown")},e.prototype.nextSlider=function(){this.adjustSlider("next")},e.prototype.prevSlider=function(){this.adjustSlider("prev")},e.prototype.sliderMin=function(){this.adjustSlider("min")},e.prototype.sliderMax=function(){this.adjustSlider("max")},e.prototype.adjustSlider=function(e){var t=this.getSelectedSlider();if(t){var r=t.latex,n=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),h.alert();break;case"next":return this.sliderIndex++,this.sliderIndex>=n&&(h.queue(this.controller.t("Last slider.")),this.sliderIndex=n-1),this.queueSliderLatex(),void h.alert();case"prev":return this.sliderIndex--,this.sliderIndex<0&&(h.queue(this.controller.t("First slider.")),this.sliderIndex=0),this.queueSliderLatex(),void h.alert()}t.slider.isPlaying||r===t.latex||(this.queueSliderLatex(),h.alert())}else h.queue(this.controller.t("Unable to adjust slider"))},e.prototype.toggleAudioTrace=function(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()},e.prototype.toggleSliderTrace=function(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()},e.prototype.enterSliderTrace=function(){if(!this.sliderTraceActive){this.sliderIndex=0;var e=this.controller.getAllModelsWithSliders().length;this.sliderTraceActive=0!==e?(h.queue(this.controller.t("Slider trace on.")),this.queueSliderLatex(),!0):(h.queue(this.controller.t("No sliders to trace.")),!1),h.alert()}},e.prototype.exitSliderTrace=function(){this.sliderTraceActive&&(h.queue(this.controller.t("Slider trace off.")),this.sliderTraceActive=!1,this.sliderIndex=0,h.alert())},e.prototype.recomputePoints=function(){this.audioTraceActive&&(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes())},e.prototype.queuePOICount=function(){var e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;h.queue(this.controller.t("Points of interest, __x__.",{x:t}))},e.prototype.reportAudioTrace=function(e,t){var r=this.agNavigator.getCurrentPoint();r&&(e||(t||this.tonegen.stop(),this.tonegen.playPoint(r,this.grapher.getCurrentViewport())),!t)&&(this.queueCoordinates(r,e),setTimeout(function(){h.alert()},e?0:100))},e.prototype.adjustPlaybackSpeed=function(e){switch(e){case"1":return this.tonegen.setAudioSpeed(150),h.alert(this.controller.t("Graph playback very slow"));case"2":return this.tonegen.setAudioSpeed(100),h.alert(this.controller.t("Graph playback slow"));case"3":return this.tonegen.setAudioSpeed(50),h.alert(this.controller.t("Graph playback normal"));case"4":return this.tonegen.setAudioSpeed(30),h.alert(this.controller.t("Graph playback fast"));case"5":return this.tonegen.setAudioSpeed(16),h.alert(this.controller.t("Graph playback very fast"));default:return this.tonegen.setAudioSpeed(50),h.alert(this.controller.t("Graph playback normal"))}},e.prototype.zoom=function(e){this.grapher.viewportController.zoom(e)},e.prototype.getFocusedCell=function(){return this.focusedCell},e.prototype.setFocusedCell=function(e){this.focusedCell=e},e.prototype.getAudioTraceActive=function(){return this.audioTraceActive},e}();t.default=c}),define("graphing/grapher",["require","exports","main/graph_settings","./canvaslayer","./poidotslayer","./poilabelslayer","./gridlayer","./graphslayer","./imagelayer","./movablepointslayer","./viewportcontroller","./poicontroller","jquery","underscore","./viewport","./screen","./graphsketch","./projection","underscore_model","./audiograph","lib/deepCopy","lib/animation-frame","lib/default-spec","./graph-defaults","graphing/tonegenerator"],function(e,t,l,c,u,p,d,h,f,g,m,y,r,v,o,b,a,x,w,_,n,i,S,E,M){"use strict";function I(){return new o.Viewport(-10,10,-10,10)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function s(e,t,r,n){var i=this;this.thumbnail=s.prototype.screenshot,this.$=e,this.evaluator=n,this.controller=r,this.settings=t;var o=new b.Screen(1024,768),a=I().squareYAxis(o);this.setUserRequestedViewport(a),this.__projection=new x.Projection(o,a,t),this.markLabelsDirty=v.debounce(function(){i.evaluator.notifyWhenSynced(function(){i.__isRedrawingSlowly?i.notifyAfterRedraw(function(){i.poiLabelsLayer.markLabelsDirty(),i.redrawAllLayers()}):(i.poiLabelsLayer.markLabelsDirty(),i.redrawAllLayers())})},300),this.poiController=new y(this,t),this.viewportController=m(this,this.controller),this.showPOIDots=!0,this.$.css("overflow","hidden"),this.graphSketches={},this.graphImages={},this.canvasLayer=c(this),this.$.append(this.canvasLayer.$),this.imageLayer=f(),this.gridLayer=d(),this.poiDotsLayer=u(),this.graphsLayer=h(this.settings),this.movablePointsLayer=g(this.$,this.settings),this.movablePointsLayer.$.css("z-index","0"),this.$.append(this.movablePointsLayer.$),this.poiLabelsLayer=p(this.$,this.settings),this.traceLayer=this.poiLabelsLayer,this.traceLayer.$.css("z-index","0"),this.$.append(this.traceLayer.$),this.scaleAxis=void 0,this.__sketchOrder=[],this.selectedId=void 0,this.__redrawRequested=!1,this.__redrawSlowlyIndex=0,this.__isRedrawingSlowly=!1,this.events=new w.UnderscoreModel,this.audioGraph=new _.default(r,this)}return s.prototype.remove=function(){this.$.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()},s.prototype.tick=function(e){this.__isRedrawingSlowly?this._redrawSlowly():this.__redrawRequested&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()},s.prototype.registerMovablePointListener=function(e){this.__movablePointListener=e},s.prototype.deregisterMovablePointListener=function(){this.__movablePointListener=void 0},s.prototype.setSketchOrder=function(e){v.isEqual(this.__sketchOrder,e)||(this.__sketchOrder=e,this.redrawAllLayers())},s.prototype.clear=function(){this.graphSketches={},this.graphImages={}},s.prototype.getGraphSketch=function(e){return this.graphSketches[e]},s.prototype.addGraphSketch=function(e){this.graphSketches[e.id]=e},s.prototype.removeGraphSketch=function(e){delete this.graphSketches[e]},s.prototype.addGraphImage=function(e){var t=this;e.imageObj.width&&e.imageObj.height?(this.graphImages[e.id]=e,this.redrawAllLayers()):r(e.imageObj).on("load.calc_load",function(){return t.addGraphImage(e)})},s.prototype.removeGraphImage=function(e){var t=this.graphImages[e];t&&r(t.imageObj).off("load.calc_load"),delete this.graphImages[e],this.redrawAllLayers()},s.prototype.getProjection=function(){return this.__projection},s.prototype._setProjection=function(e){this.__projection=e,this.redrawAllLayers()},s.prototype.getAudioTrace=function(){return this.audioGraph},s.prototype.getDefaultViewport=function(){var e=this.getProjection();return I().squareYAxis(e.screen)},s.prototype._updateScreenSize=function(e,t){if(!(e<=0||t<=0)){var r=this.getProjection().screen;if(r.width!==e||r.height!==t){this.$.width(e);var n=new b.Screen(e,t);this.viewportController.setScreen(n)}}},s.prototype._setIsVisible=function(e){e!==this.isVisible&&((this.isVisible=e)?this.redrawAllLayers():this.canvasLayer.resize(0,0))},s.prototype.update=function(){var e=this.controller.computeMajorLayout().grapher;0<e.width&&0<e.height?(this._setIsVisible(!0),this._updateScreenSize(e.width,e.height),this.$.css({position:"absolute",left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"})):this._setIsVisible(!1)},s.prototype.hide=function(e){var t=this.getGraphSketch(e);t&&(t.visible=!1)},s.prototype.select=function(e){if(this.selectedId){var t=this.getGraphSketch(this.selectedId);t&&(t.selected=!1,t.showPOI=!1,t.showHighlight=!1)}var r=this.getGraphSketch(e);r&&(r.selected=!0,r.showPOI=!0,r.showHighlight=!0),this.selectedId=e},s.prototype.updateSketch=function(e,t){var r=this.getGraphSketch(e);if(!t.length)return this.hide(e);var n=new a.GraphSketch(e,t);n.color=t[0].color,n.style=t[0].style,r&&n.updateFrom(r);var i=String(e)===String(this.selectedId);n.selected=i,n.showPOI=i,n.showHighlight=i,this.addGraphSketch(n)},s.prototype.updateIntersections=function(e,t){var r=this.getGraphSketch(e);r&&r.updateIntersections(t)},s.prototype.redrawAllLayers=function(){this.cancelRedrawSlowly(),this.__redrawRequested=!0},s.prototype._clear=function(){var e=this.getProjection(),t=e.screen;this.canvasLayer.resize(e.screen.width,e.screen.height),this.canvasLayer.ctx.clearRect(0,0,t.width,t.height)},s.prototype._redrawAllLayers=function(){this.isVisible&&(this._clear(),this._redrawImageLayer(),this._redrawGridLayer(),this._redrawGraphsLayer(),this._redrawPointsAndLabels(),this._updateCanvasLayerAria(),this.audioGraph.recomputePoints(),this.__redrawRequested=!1,this.events.triggerEvent("redraw",void 0))},s.prototype.cancelRedrawSlowly=function(){this.__isRedrawingSlowly&&(this.__redrawSlowlyIndex=0,this.__isRedrawingSlowly=!1,this.redrawAllLayers())},s.prototype.redrawSlowly=function(){this.__isRedrawingSlowly||(this.__redrawSlowlyIndex=0,this.__isRedrawingSlowly=!0,this.audioGraph.recomputePoints())},s.prototype._redrawSlowly=function(){var e,t,r=this.__redrawSlowlyIndex;if(0===r&&(this._clear(),this._redrawGridLayer()),r>=this.__sketchOrder.length)this.cancelRedrawSlowly();else{var n=this.__sketchOrder[r],i=((e={})[n]=this.graphSketches[n],e),o=((t={})[n]=this.graphImages[n],t);(o[n]||i[n])&&this.graphsLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),i,o,[n]),this.__redrawSlowlyIndex+=1}},s.prototype._redrawGridLayer=function(){this.gridLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.scaleAxis)},s.prototype._redrawGraphsLayer=function(){this.graphsLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphSketches,this.graphImages,this.__sketchOrder)},s.prototype._updateCanvasLayerAria=function(){var e=0;for(var t in this.graphSketches)M.canPlaySketch(this.graphSketches[t])&&(e+=1);this.canvasLayer.updateAria(this.isVisible,e)},s.prototype._redrawPointsAndLabels=function(){this.movablePointsLayer.redraw(this.getProjection(),this.graphSketches),this.showPOIDots&&this.poiDotsLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphSketches);var r=[],n=this.poiLabelsLayer.$[0].getBoundingClientRect(),e=this.movablePointsLayer.renderedMovablePoints;for(var t in e){var i=e[t].$.find(".dcg-background")[0].getBoundingClientRect();r.push({left:i.left-n.left,top:i.top-n.top,right:i.right-n.left,bottom:i.bottom-n.top})}v.each([this.controller.find$(".dcg-overgraph-pillbox-elements")[0],this.controller.find$(".dcg-graphpaper-branding")[0]],function(e){if(e){var t=e.getBoundingClientRect();r.push({left:t.left-n.left,top:t.top-n.top,right:t.right-n.left,bottom:t.bottom-n.top})}}),this.poiLabelsLayer.redraw(this.getProjection(),this.graphSketches,this.canvasLayer.ctx,r)},s.prototype._redrawImageLayer=function(){this.imageLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphImages,this.__sketchOrder)},s.prototype._parseScreenshotOpts=function(e){var t,r,n,i,o,a,s=this.getProjection();return a=e?(t=e.width||e.height||s.screen.width,r=e.height||e.width||s.screen.height,n=e.targetPixelRatio||1,i=(t<256||r<256)&&!e.preserveAxisNumbers,o=l.fromObject(e.settings||this.settings),!!e.transparentBackground):(t=s.screen.width,r=s.screen.height,i=!(n=1),o=l.fromObject(this.settings),!1),i&&(o.setProperty("xAxisNumbers",!1),o.setProperty("yAxisNumbers",!1),o.setProperty("polarNumbers",!1)),{width:t,height:r,targetPixelRatio:n,settings:o,transparentBackground:a}},s.prototype.screenshot=function(e){var t=this._parseScreenshotOpts(e),r=document.createElement("canvas");return r.width=t.width*t.targetPixelRatio,r.height=t.height*t.targetPixelRatio,this.screenshotToCanvas(r,e),r.toDataURL("image/png")},s.prototype.screenshotToCanvas=function(e,t){var r=this._parseScreenshotOpts(t),n=r.width,i=r.height,o=r.targetPixelRatio,a=r.settings,s=r.transparentBackground;a.takingScreenshot=!0;var l=e.getContext("2d");l.scale(o,o);var c=new b.Screen(n,i),u=this.getProjection().viewport;this.getSetting("squareAxes")&&(u=u.squareCrop(c));var p=new x.Projection(c,u,a);s||(l.fillStyle="white",l.fillRect(0,0,c.width,c.height)),this.imageLayer.redrawToCtx(l,p,this.graphImages,this.__sketchOrder),this.gridLayer.redrawToCtx(l,p),this.graphsLayer.redrawToCtx(l,p,this.graphSketches,this.graphImages,this.__sketchOrder)},s.prototype.getImageData=function(e,t,r,n){return this.canvasLayer.ctx.getImageData(e,t,r,n)},s.prototype.getSetting=function(e,t){var r=this.settings.getProperty(e);return void 0!==r?r:t},s.prototype.getState=function(e){var t=this,r={};return this.settings.stateProperties.forEach(function(e){r[e]=t.getSetting(e)}),r.viewport=this.getCurrentViewport(),e.stripDefaults&&(r=S.stripDefaults(E.GraphDefaults,r)),r},s.prototype.getUndoRedoState=function(){var t=this,r={};return this.settings.stateProperties.forEach(function(e){r[e]=t.getSetting(e)}),r.viewport=this.getUserRequestedViewport(),r},s.prototype.notifyAfterRedraw=function(e){var t=this;if(this.__isRedrawingSlowly)i.requestAnimationFrame(this.notifyAfterRedraw.bind(this,e));else if(this.__redrawRequested){this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;var r="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(r,function(){t.events.unobserveEvent(r),e()})}else e()},s.prototype.getCurrentViewport=function(){return this.viewportController.getViewport().toObject()},s.prototype.getUserRequestedViewport=function(){return this._lastUserRequestedViewport},s.prototype.setUserRequestedViewport=function(e){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=n.default(e)},s.prototype.debounceUserRequestedViewportChange=function(){var n=this;if(!this.__debouncedViewportCommit){this.__debouncedViewportCommit=v.debounce(function(e,t){if(!n.isDragging&&n._lastUserRequestedViewportUpdateToken===t){if(n._lastUserRequestedViewport){var r=o.Viewport.fromObject(n._lastUserRequestedViewport);if(n.computeConcreteViewport(r).equals(e))return}n.controller.dispatch({type:"commit-user-requested-viewport",viewport:e})}},1e3)}var e=this.getCurrentViewport();this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)},s.prototype.setGrapherState=function(e,t){for(var r in e=S.populateDefaults(E.GraphDefaults,e),t&&t.doNotClear||this.clear(),E.GraphDefaults)E.GraphDefaults.hasOwnProperty(r)&&this.settings.setProperty(r,e[r]);if("viewport"in e){var n=o.Viewport.fromObject(e.viewport);this.setUserRequestedViewport(n);var i=this.computeConcreteViewport(n);this.viewportController.setViewport(i)}this.redrawAllLayers()},s.prototype.computeConcreteViewport=function(e){var t=this.getProjection().screen;return this.getSetting("squareAxes")&&!e.isSquare(t)?e.squareYAxis(t):e},s}();t.Grapher=s}),define("loadcss!tour",function(){}),define("loadcss!calculator_embed",function(){}),define("loadcss!buttons",function(){}),define("loadcss!dcg-normalize",function(){}),define("loadcss!projector_mode",function(){}),define("loadcss!desmos-icons",function(){}),define("loadcss!popovers",function(){}),define("main/calc_embed",["require","exports","main/graph_settings","tours/tour_manager","tslib","i18n","jquery","main/controller","dcgview","main/instancehotkeys","lib/console","underscore","lib/defocus-mobile","graphing-calc/views/main","underscore_model","graphing/viewport","main/evaluator","graphing/grapher","loadcss!tour","loadcss!calculator_embed","loadcss!buttons","loadcss!dcg-normalize","loadcss!projector_mode","loadcss!desmos-icons","loadcss!popovers"],function(e,t,h,f,i,g,m,y,v,b,o,x,r,w,_,n,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=0,a=function(){function e(e,t,r,n){var o=this;e||(e=document.createElement("div")),this.__id=M++;var a=new h;for(var i in this.graphSettings=a,r)a.config.setProperty(i,r[i]);var s=new y.default(a);this.controller=s,n&&s.dispatch({type:"ui/container-resized",size:n}),this.rootElt=e,this.view=v.mountToNode(w.default,this.rootElt,{controller:v.const(s)});var l=new S.Evaluator(t);this.controller.setEvaluator(l),this.controller.setRootElt(this.rootElt);var c=s.find$(".dcg-grapher"),u=new E.Grapher(c,a,this.controller,l);this.controller.setGrapher(u),a.registerCallbacks(u,l),this.controller.initStateStack(),a.config.redrawSlowly||(u.redrawSlowly=u.redrawAllLayers),l.triggerStatusChange=function(e){o.controller.dispatch({type:"on-evaluator-changes",changes:e})},l.triggerGraphData=function(e){s.dispatch({type:"process-graph-data",graphData:e})},l.triggerRender=function(){u.redrawAllLayers()},l.triggerRenderSlowly=function(){u.redrawSlowly()},this.unsubFunc=this.controller.subToChanges(function(){var e,t,r,n,i;o.controller.doesDOMHaveSize()&&(o.view.update(),u.update()),t=s.computeMajorLayout(),r={left:t.grapher.left,right:t.grapher.left+t.grapher.width,width:t.grapher.width,top:t.grapher.top,bottom:t.grapher.top+t.grapher.height,height:t.grapher.height},n=u.getCurrentViewport(),i={top:n.ymax,bottom:n.ymin,left:n.xmin,right:n.xmax,width:n.xmax-n.xmin,height:n.ymax-n.ymin},x.isEqual(i,p.mathCoordinates)||p.setProperty("mathCoordinates",i),0<r.height&&0<r.width&&!x.isEqual(r,p.pixelCoordinates)&&p.setProperty("pixelCoordinates",r),e=u.getProjection(),a.setProperty("zoomedDefault",u.viewportController.isZoomRestored()),a.setProperty("squareAxes",e.viewport.isSquare(e.screen))});var p=new _.UnderscoreModel;p.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=p,m(this.rootElt).on("keydown.calculator-"+this.__id,function(e){o.grapher&&o.grapher.audioGraph.handleKeydown(e),o.instanceHotkeys.handleKeydown(e)}),m(window).on("dcg-tapstart.calculator-"+this.__id,function(e){var t=m(e.target),r=!!t.closest(o.rootElt).length,n=e.wasHandled("create-expression-with-keyboard");if(r||t.hasClass("dcg-shell")||n||s.dispatch({type:"set-none-selected"}),e.wasHandled("do-not-clear-poi-labels")||u.poiController.clearOpenedPOI(),s.isInEditListMode()){var i=0===t.closest(".dcg-exppanel").length&&0===t.closest(".dcg-options-menu").length&&0===t.closest(".dcg-expression-top-bar").length&&0===t.closest(".dcg-keypad").length;r&&!i||s.dispatch({type:"set-edit-list-mode",isEditListMode:!1})}}),this.grapher=u,this.evaluator=l,this.tourManager=f({evaluator:l}),this.controller.dispatch({type:"set-blank"});var d={};["degreeMode"].forEach(function(e){void 0!==r[e]&&(d[e]=r[e])}),a.setGraphSettings(d),a.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),a.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),a.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:a.config.pointsOfInterest}),a.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:a.config.backgroundColor}),a.config.hasOwnProperty("textColor")&&this.setOptions({textColor:a.config.textColor}),a.config.observe("language",function(){var e,t,r=o.controller.getState();o.controller.dispatch({type:"set-state",state:r}),o.tourManager&&(o.tourManager.closingMsg=["<b>__endingMessage__</b><br>",(e="This message will self-destruct in __seconds__...",g.t(e,t,a.config.language))].join(""))}),this.instanceHotkeys=new b.default(s)}return e.prototype.getState=function(e){return this.controller.getState(e)},e.prototype.setState=function(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t})},e.prototype.setBlank=function(e){this.controller.dispatch({type:"set-blank",opts:e})},e.prototype.setOption=function(e,t){this.controller.getGraphSettings().config.setProperty(e,t)},e.prototype.setOptions=function(e){var t,r=this.controller.getGraphSettings().config,n=i.__assign({},e);for(t in e.hasOwnProperty("menus")&&(o.warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(n.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(n.expressionsTopbar=!!e.menus)),e.hasOwnProperty("solutions")&&(o.warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(n.pointsOfInterest=!!e.solutions)),e.hasOwnProperty("singleVariableSolutions")&&o.warn("Deprecated option: singleVariableSolutions has been removed."),!1===e.graphpaper&&(e.expressionsCollapsed&&(n.expressionsCollapsed=!1,o.warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),r.expressionsCollapsed&&(n.expressionsCollapsed=!1,o.warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(n.zoomButtons=!1,o.warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),r.zoomButtons&&(n.zoomButtons=!1,o.warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false."))),!1===r.graphpaper&&(e.expressionsCollapsed||e.zoomButtons)&&(n.graphpaper=!0,o.warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(n.zoomButtons=!1,o.warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),r.lockViewport&&e.zoomButtons&&(n.lockViewport=!1,o.warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),r.zoomButtons&&e.lockViewport&&(n.zoomButtons=!1,o.warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false.")),n)if(n.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!n.expressionsCollapsed),n.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list"}):this.controller.dispatch({type:"show-expressions-list"});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!n.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!n.degreeMode),this.controller.getGraphSettings().setGraphSettings({degreeMode:!!n.degreeMode});break;case"keypad":case"graphpaper":case"expressions":case"settingsMenu":case"zoomButtons":case"expressionsTopbar":case"pointsOfInterest":case"trace":case"border":case"lockViewport":case"administerSecretFolders":case"advancedStyling":case"images":case"imageUploadCallback":case"folders":case"notes":case"links":case"restrictedFunctions":case"pasteGraphLink":case"pasteTableData":case"clearIntoDegreeMode":case"autosize":case"plotSingleVariableImplicitEquations":case"colors":case"branding":case"disableScrollFix":case"invertedColors":case"fontSize":case"projectorMode":case"language":case"redrawSlowly":case"onlyTraceSelected":case"disableMouseInteractions":case"nativeOnscreenKeypad":case"functionDefinition":case"plaidMode":case"pasteGraphLinkCallback":case"editOnWeb":case"crossOriginSaveTest":case"solutions":case"menus":case"singleVariableSolutions":case"backgroundColor":case"textColor":case"enableTabindex":case"audioTraceReverseExpressions":case"showHamburger":case"decimalToFractionConversion":case"capExpressionSize":this.setOption(t,n[t]);break;default:return t}},e.prototype.setViewport=function(e){this.grapher.viewportController.setViewport(new n.Viewport(e[0],e[1],e[2],e[3]))},e.prototype.resize=function(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})},e.prototype.interceptTouch=function(){var e=this.grapher.$,t=m(this.rootElt);(e=e.add(t.find(".dcg-expression-top-bar"))).add(t.find(".dcg-keypad")),e.on("touchstart",function(e){e.preventDefault()}),e.on("touchend",function(e){0<m(e.target).closest(".dcg-do-not-blur").length||r.default()})},e.prototype.destroy=function(){m(window).off(".calculator-"+this.__id),m(this.rootElt).off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),v.unmountFromNode(this.rootElt)},e.prototype.tick=function(e){this.controller.dispatch({type:"tick",time:e})},e}();t.default=a}),define("main/calc_headless",["require","pjs","main/evaluator","main/graph_settings","underscore_model","main/controller"],function(e){var t=e("pjs"),a=e("main/evaluator").Evaluator,s=e("main/graph_settings"),l=e("underscore_model").UnderscoreModel,c=e("main/controller").default;return t(function(e){e.init=function(e,t){var r=new s;for(var n in t)r.config.setProperty(n,t[n]);this.controller=new c(r);var i=new a(e);this.controller.setEvaluator(i),i.triggerStatusChange=function(e){this.controller.dispatch({type:"on-evaluator-changes",changes:e})}.bind(this);var o=l();o.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=o,this.evaluator=i,this.getState=this.controller.getState.bind(this.controller),this.setState=function(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t})},this.setBlank=function(e){this.controller.dispatch({type:"set-blank",opts:e})},this.setViewport=function(e){},this.resize=function(){},this.setOptions=function(e){},this.setBlank()},e.tick=function(e){this.evaluator.tick(e)}})}),define("main/raf-loop",["require","lib/animation-frame"],function(e){var n=e("lib/animation-frame");return function(r){n.requestAnimationFrame(function e(t){n.requestAnimationFrame(e),r(t)})}}),define("main/shared-clock-bus",["require","exports","main/raf-loop","underscore_model"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new n.UnderscoreModel;r(function(e){i.triggerEvent("tick",e)});var o=0;t.subscribe=function(r){return o+=1,i.observeEvent("tick."+o,function(e,t){r(t)}),o},t.unsubscribe=function(e){i.unobserveEvent("tick."+e)}}),define("main/shared-worker-pool",["require","exports","worker/workerpool","lib/urlparser"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.getParameter("nworkers"),o=4;i&&(o=parseInt(i,10)),t.default=new r(o)}),define("main/font_sizes",{VERY_SMALL:9,SMALL:12,MEDIUM:16,LARGE:20,VERY_LARGE:24}),function(e){"use strict";var b=function(e,r,t){var n,i,o=document.createElement("img");if(o.onerror=r,o.onload=function(){!i||t&&t.noRevoke||b.revokeObjectURL(i),r&&r(b.scale(o,t))},b.isInstanceOf("Blob",e)||b.isInstanceOf("File",e))n=i=b.createObjectURL(e),o._type=e.type;else{if("string"!=typeof e)return!1;n=e,t&&t.crossOrigin&&(o.crossOrigin=t.crossOrigin)}return n?(o.src=n,o):b.readFile(e,function(e){var t=e.target;t&&t.result?o.src=t.result:r&&r(e)})},t=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(e){return e},b.renderImageToCanvas=function(e,t,r,n,i,o,a,s,l,c){return e.getContext("2d").drawImage(t,r,n,i,o,a,s,l,c),e},b.hasCanvasOption=function(e){return e.canvas||e.crop},b.scale=function(e,t){t=t||{};var r,n,i,o,a,s,l,c,u,p=document.createElement("canvas"),d=e.getContext||b.hasCanvasOption(t)&&p.getContext,h=e.naturalWidth||e.width,f=e.naturalHeight||e.height,g=h,m=f,y=function(){var e=Math.max((i||g)/g,(o||m)/m);1<e&&(g=Math.ceil(g*e),m=Math.ceil(m*e))},v=function(){var e=Math.min((r||g)/g,(n||m)/m);e<1&&(g=Math.ceil(g*e),m=Math.ceil(m*e))};return d&&(l=(t=b.getTransformedOptions(t)).left||0,c=t.top||0,t.sourceWidth?(a=t.sourceWidth,void 0!==t.right&&void 0===t.left&&(l=h-a-t.right)):a=h-l-(t.right||0),t.sourceHeight?(s=t.sourceHeight,void 0!==t.bottom&&void 0===t.top&&(c=f-s-t.bottom)):s=f-c-(t.bottom||0),g=a,m=s),r=t.maxWidth,n=t.maxHeight,i=t.minWidth,o=t.minHeight,d&&r&&n&&t.crop?(u=a/s-(g=r)/(m=n))<0?(s=n*a/r,void 0===t.top&&void 0===t.bottom&&(c=(f-s)/2)):0<u&&(a=r*s/n,void 0===t.left&&void 0===t.right&&(l=(h-a)/2)):((t.contain||t.cover)&&(i=r=r||i,o=n=n||o),t.cover?(v(),y()):(y(),v())),d?(p.width=g,p.height=m,b.transformCoordinates(p,t),b.renderImageToCanvas(p,e,l,c,a,s,0,0,g,m)):(e.width=g,e.height=m,e)},b.createObjectURL=function(e){return!!t&&t.createObjectURL(e)},b.revokeObjectURL=function(e){return!!t&&t.revokeObjectURL(e)},b.readFile=function(e,t,r){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,n[r=r||"readAsDataURL"])return n[r](e),n}return!1},"function"==typeof define&&define.amd?define("vendor/load-image/load-image",[],function(){return b}):e.loadImage=b}(this),function(e){"use strict";"function"==typeof define&&define.amd?define("vendor/load-image/load-image-orientation",["./load-image"],e):e(window.loadImage)}(function(e){"use strict";var t=e.hasCanvasOption;e.hasCanvasOption=function(e){return t(e)||e.orientation},e.transformCoordinates=function(e,t){var r=e.getContext("2d"),n=e.width,i=e.height,o=t.orientation;if(o)switch(4<o&&(e.width=i,e.height=n),o){case 2:r.translate(n,0),r.scale(-1,1);break;case 3:r.translate(n,i),r.rotate(Math.PI);break;case 4:r.translate(0,i),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-i);break;case 7:r.rotate(.5*Math.PI),r.translate(n,-i),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-n,0)}},e.getTransformedOptions=function(e){if(!e.orientation||1===e.orientation)return e;var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);switch(e.orientation){case 2:r.left=e.right,r.right=e.left;break;case 3:r.left=e.right,r.top=e.bottom,r.right=e.left,r.bottom=e.top;break;case 4:r.top=e.bottom,r.bottom=e.top;break;case 5:r.left=e.top,r.top=e.left,r.right=e.bottom,r.bottom=e.right;break;case 6:r.left=e.top,r.top=e.right,r.right=e.bottom,r.bottom=e.left;break;case 7:r.left=e.bottom,r.top=e.right,r.right=e.top,r.bottom=e.left;break;case 8:r.left=e.bottom,r.top=e.left,r.right=e.top,r.bottom=e.right}return 4<e.orientation&&(r.maxWidth=e.maxHeight,r.maxHeight=e.maxWidth,r.minWidth=e.minHeight,r.minHeight=e.minWidth,r.sourceWidth=e.sourceHeight,r.sourceHeight=e.sourceWidth),r}}),function(e){"use strict";"function"==typeof define&&define.amd?define("vendor/load-image/load-image-meta",["./load-image"],e):e(window.loadImage)}(function(f){"use strict";var e=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);f.blobSlice=e&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},f.metaDataParsers={jpeg:{65505:[]}},f.parseMetaData=function(e,u,p){var d=this,t=(p=p||{}).maxMetaDataSize||262144,h={};!!(window.DataView&&e&&12<=e.size&&"image/jpeg"===e.type&&f.blobSlice)&&f.readFile(f.blobSlice.call(e,0,t),function(e){var t,r,n,i,o=e.target.result,a=new DataView(o),s=2,l=a.byteLength-4,c=s;if(65496===a.getUint16(0)){for(;s<l&&(65504<=(t=a.getUint16(s))&&t<=65519||65534===t);){if(s+(r=a.getUint16(s+2)+2)>a.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(n=f.metaDataParsers.jpeg[t])for(i=0;i<n.length;i+=1)n[i].call(d,a,s,r,h,p);c=s+=r}!p.disableImageHead&&6<c&&(o.slice?h.imageHead=o.slice(0,c):h.imageHead=new Uint8Array(o).subarray(0,c))}else console.log("Invalid JPEG file: Missing JPEG marker.");u(h)},"readAsArrayBuffer")||u(h)}}),function(e){"use strict";"function"==typeof define&&define.amd?define("vendor/load-image/load-image-ios",["./load-image"],e):e(window.loadImage)}(function(v){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var b=v.renderImageToCanvas;v.detectSubsampling=function(e){var t,r;return 1048576<e.width*e.height&&((t=document.createElement("canvas")).width=t.height=1,(r=t.getContext("2d")).drawImage(e,1-e.width,0),0===r.getImageData(0,0,1,1).data[3])},v.detectVerticalSquash=function(e,t){var r,n,i,o,a=e.naturalHeight||e.height,s=document.createElement("canvas"),l=s.getContext("2d");for(t&&(a/=2),s.width=1,s.height=a,l.drawImage(e,0,0),r=l.getImageData(0,0,1,a).data,n=0,o=i=a;n<o;)0===r[4*(o-1)+3]?i=o:n=o,o=i+n>>1;return o/a||1},v.renderImageToCanvas=function(e,t,r,n,i,o,a,s,l,c){if("image/jpeg"===t._type){var u,p,d,h,f=e.getContext("2d"),g=document.createElement("canvas"),m=1024,y=g.getContext("2d");if(g.width=m,g.height=m,f.save(),(u=v.detectSubsampling(t))&&(r/=2,n/=2,i/=2,o/=2),p=v.detectVerticalSquash(t,u),u||1!==p){for(n*=p,l=Math.ceil(m*l/i),c=Math.ceil(m*c/o/p),h=s=0;h<o;){for(d=a=0;d<i;)y.clearRect(0,0,m,m),y.drawImage(t,r,n,i,o,-d,-h,i,o),f.drawImage(g,0,0,m,m,a,s,l,c),d+=m,a+=l;h+=m,s+=c}return f.restore(),e}}return b(e,t,r,n,i,o,a,s,l,c)}}}),function(e){"use strict";"function"==typeof define&&define.amd?define("vendor/load-image/load-image-exif",["./load-image","./load-image-meta"],e):e(window.loadImage)}(function(h){"use strict";h.ExifMap=function(){return this},h.ExifMap.prototype.map={Orientation:274},h.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},h.getExifThumbnail=function(e,t,r){var n,i,o;if(r&&!(t+r>e.byteLength)){for(n=[],i=0;i<r;i+=1)o=e.getUint8(t+i),n.push((o<16?"0":"")+o.toString(16));return"data:image/jpeg,%"+n.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},h.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,r){return e.getUint16(t,r)},size:2},4:{getValue:function(e,t,r){return e.getUint32(t,r)},size:4},5:{getValue:function(e,t,r){return e.getUint32(t,r)/e.getUint32(t+4,r)},size:8},9:{getValue:function(e,t,r){return e.getInt32(t,r)},size:4},10:{getValue:function(e,t,r){return e.getInt32(t,r)/e.getInt32(t+4,r)},size:8}},h.exifTagTypes[7]=h.exifTagTypes[1],h.getExifValue=function(e,t,r,n,i,o){var a,s,l,c,u,p,d=h.exifTagTypes[n];if(d){if(!((s=4<(a=d.size*i)?t+e.getUint32(r+8,o):r+8)+a>e.byteLength)){if(1===i)return d.getValue(e,s,o);for(l=[],c=0;c<i;c+=1)l[c]=d.getValue(e,s+c*d.size,o);if(d.ascii){for(u="",c=0;c<l.length&&"\0"!==(p=l[c]);c+=1)u+=p;return u}return l}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},h.parseExifTag=function(e,t,r,n,i){var o=e.getUint16(r,n);i.exif[o]=h.getExifValue(e,t,r,e.getUint16(r+2,n),e.getUint32(r+4,n),n)},h.parseExifTags=function(e,t,r,n,i){var o,a,s;if(r+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((a=r+2+12*(o=e.getUint16(r,n)))+4>e.byteLength)){for(s=0;s<o;s+=1)this.parseExifTag(e,t,r+2+12*s,n,i);return e.getUint32(a,n)}console.log("Invalid Exif data: Invalid directory size.")}},h.parseExifData=function(e,t,r,n,i){if(!i.disableExif){var o,a,s,l=t+10;if(1165519206===e.getUint32(t+4)){if(l+8>e.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==e.getUint16(t+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(e.getUint16(l)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==e.getUint16(l+2,o))return void console.log("Invalid Exif data: Missing TIFF marker.");a=e.getUint32(l+4,o),n.exif=new h.ExifMap,(a=h.parseExifTags(e,l,l+a,o,n))&&!i.disableExifThumbnail&&(s={exif:{}},a=h.parseExifTags(e,l,l+a,o,s),s.exif[513]&&(n.exif.Thumbnail=h.getExifThumbnail(e,l+s.exif[513],s.exif[514]))),n.exif[34665]&&!i.disableExifSub&&h.parseExifTags(e,l,l+n.exif[34665],o,n),n.exif[34853]&&!i.disableExifGps&&h.parseExifTags(e,l,l+n.exif[34853],o,n)}}},h.metaDataParsers.jpeg[65505].push(h.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define("vendor/load-image/load-image-exif-map",["./load-image","./load-image-exif"],e):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,r=e.tags,n=e.map;for(t in r)r.hasOwnProperty(t)&&(n[r[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,r={};for(e in this)this.hasOwnProperty(e)&&((t=this.tags[e])&&(r[t]=this.getText(t)));return r}}),define("loadImage",["require","vendor/load-image/load-image-orientation","vendor/load-image/load-image-meta","vendor/load-image/load-image-ios","vendor/load-image/load-image-exif","vendor/load-image/load-image-exif-map","vendor/load-image/load-image"],function(e){return e("vendor/load-image/load-image-orientation"),e("vendor/load-image/load-image-meta"),e("vendor/load-image/load-image-ios"),e("vendor/load-image/load-image-exif"),e("vendor/load-image/load-image-exif-map"),e("vendor/load-image/load-image")}),define("expressions/image_file_to_data_url",["require","loadImage"],function(e){function i(e,t){for(var r,n=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],i=0;i<n.length;i++)if((r=e.toDataURL("image/jpeg",n[i])).length<t)return r;return r}var t=e("loadImage");return function(r,n){t(r,function(e){var t;e.toDataURL?("image/jpeg"===r.type?t=i(e,2e5):2e5<(t=e.toDataURL()).length&&(t=t.length>.75*e.width*e.height&&!function(e){for(var t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,r=3;r<t.length;r+=4)if(255!==t[r])return!0;return!1}(e)?i(e,2e5):function(e,t){for(var r,n=e.toDataURL().length,i=e.width,o=e.height,a=document.createElement("canvas"),s=0;s<2;s++){var l=Math.sqrt(t/n);if(i=Math.round(l*i),o=Math.round(l*o),a.height=o,a.width=i,a.getContext("2d").drawImage(e,0,0,i,o),(n=(r=a.toDataURL()).length)<t)return r}return r}(e,2e5)),n(null,t)):n(!0)},{orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600})}}),define("lib/dom-change-detector",["require","exports","tslib","lib/animation-frame","jquery"],function(e,t,r,n,i){"use strict";function o(){c=!0,n.requestAnimationFrame(a)}function a(){for(var e in t.testFixture.rafSPY&&t.testFixture.rafSPY(),c=!1,l)l[e].detectAndEnqueueEvent(),c=!0;if(c)for(var e in o(),l)l[e].dispatchQueuedEvent()}Object.defineProperty(t,"__esModule",{value:!0});var s=1,l={},c=!1,u=!1;window&&window.location&&window.location.search&&(u=0<=window.location.search.indexOf("dcgKnewtonDisableAutoSize")),t.testFixture={},t.checkAllWatchingDetectors=a;var p=function(){function e(e,t){this.elt=e,this.cb=t,this.destroyed=!1,this.id=s.toString(),this.appliedScale={x:1,y:1},s++}return e.prototype.stopWatching=function(){delete l[this.id]},e.prototype.startWatching=function(){this.checkForChanges(),l[this.id]=this,c||o()},e.prototype.resetAppliedScalingAndGetBoundingClientRect=function(){var e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;var r=i(this.elt).children(".dcg-container:eq(0)")[0];return r&&(this.appliedScale=t,i(r).css({transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%"})),e},e.prototype.detectAndEnqueueEvent=function(){if(!this.destroyed)if(document.body&&document.body.contains(this.elt)){var e;e=u?{width:450,height:450}:this.resetAppliedScalingAndGetBoundingClientRect(),this.lastSize?e.width===this.lastSize.width&&e.height===this.lastSize.height||(this.lastSize.width=e.width,this.lastSize.height=e.height,this.queuedEvent={type:"resized",target:this.elt,size:r.__assign({},this.lastSize)}):(this.lastSize={width:e.width,height:e.height},this.queuedEvent={type:"added",target:this.elt,size:r.__assign({},this.lastSize)})}else this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt})},e.prototype.dispatchQueuedEvent=function(){var e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))},e.prototype.checkForChanges=function(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()},e.prototype.destroy=function(){for(var e in this.stopWatching(),this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0},e}();t.default=p}),define("graphing/compute-async-screenshot-bounds",["require","console"],function(e){var S=e("console");return function(e){var t=e.mode,r=e.width,n=e.height,i=e.currentBounds,o=e.graphpaperAspectRatio,a=e.mathAspectRatio,s=e.mathBounds,l=r/n,c=i.left+i.width/2,u=i.bottom+i.height/2;if(void 0===s.left!=(void 0===s.right)||void 0===s.bottom!=(void 0===s.top))return S.warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+s),i;var p,d,h,f,g,m,y,v,b,x=void 0!==s.left&&void 0!==s.right,w=void 0!==s.bottom&&void 0!==s.top,_=x&&w;switch(t){case"stretch":return _?s:x?{left:s.left,right:s.right,bottom:i.bottom,top:i.top}:w?{left:i.left,right:i.right,bottom:s.bottom,top:s.top}:i;case"contain":return _?(h=s.right-s.left,f=s.top-s.bottom,g={x:s.left+h/2,y:s.bottom+f/2},h/f<l?(p=(d=f/n)*a,{left:g.x-p*r/2,right:g.x+p*r/2,bottom:s.bottom,top:s.top}):(d=(p=h/r)/a,{left:s.left,right:s.right,bottom:g.y-d*n/2,top:g.y+d*n/2})):x?(m=s.right-s.left,y=s.left+m/2,m/i.height<l?{left:y-(p=(d=i.height/n)*a)*r/2,right:y+p*r/2,bottom:i.bottom,top:i.top}:(d=(p=m/r)/a,{left:s.left,right:s.right,bottom:u-d*n/2,top:u+d*n/2})):w?(v=s.top-s.bottom,b=s.bottom+v/2,i.width/v<l?{left:c-(p=(d=v/n)*a)*r/2,right:c+p*r/2,bottom:s.bottom,top:s.top}:(d=(p=i.width/r)/a,{left:i.left,right:i.right,bottom:b-d*n/2,top:b+d*n/2})):o<l?{left:c-(p=(d=i.height/n)*a)*r/2,right:c+p*r/2,bottom:i.bottom,top:i.top}:(d=(p=i.width/r)/a,{left:i.left,right:i.right,bottom:u-d*n/2,top:u+d*n/2});case"preserveX":return _?(h=s.right-s.left,f=s.top-s.bottom,g={x:s.left+h/2,y:s.bottom+f/2},d=(p=h/r)/a,{left:s.left,right:s.right,bottom:g.y-d*n/2,top:g.y+d*n/2}):w?(v=s.top-s.bottom,b=s.bottom+v/2,i.width,d=(p=i.width/r)/a,{left:i.left,right:i.right,bottom:b-d*n/2,top:b+d*n/2}):x?(d=(p=(m=s.right-s.left)/r)/a,{left:s.left,right:s.right,bottom:u-d*n/2,top:u+d*n/2}):(d=(p=(m=i.right-i.left)/r)/a,{left:i.left,right:i.right,bottom:u-d*n/2,top:u+d*n/2});case"preserveY":return _?(h=s.right-s.left,f=s.top-s.bottom,p=(d=f/n)*a,{left:(g={x:s.left+h/2,y:s.bottom+f/2}).x-p*r/2,right:g.x+p*r/2,bottom:s.bottom,top:s.top}):x?(m=s.right-s.left,y=s.left+m/2,i.height,{left:y-(p=(d=i.height/n)*a)*r/2,right:y+p*r/2,bottom:i.bottom,top:i.top}):w?{left:c-(p=(d=(v=s.top-s.bottom)/n)*a)*r/2,right:c+p*r/2,bottom:s.bottom,top:s.top}:{left:c-(p=(d=(v=i.top-i.bottom)/n)*a)*r/2,right:c+p*r/2,bottom:i.bottom,top:i.top};default:return i}}}),define("expressions/sanitize_expression",["require"],function(e){function i(e,t){var r={};return e.forEach(function(e){t.hasOwnProperty(e)&&(r[e]=t[e])}),r}function o(e){var t=i(r,e);return e.values&&"function"==typeof e.values.slice&&(t.values=e.values.slice()),t}var a=["type","latex","color","lineStyle","pointStyle","fillOpacity","points","lines","fill","hidden","secret","id","dragMode","label","showLabel","labelSize","labelOrientation","verticalLabel"],s=["type","id"],r=["id","latex","color","hidden","pointStyle","lineStyle","points","lines","dragMode"];return function(e){if("table"===e.type)return(r=i(s,t=e)).columns=t.columns.map(o),r;var t,r,n=i(a,e);return e.hasOwnProperty("parametricDomain")&&(n.parametricDomain={min:e.parametricDomain.min,max:e.parametricDomain.max}),e.hasOwnProperty("polarDomain")&&(n.polarDomain={min:e.polarDomain.min,max:e.polarDomain.max}),e.hasOwnProperty("domain")&&(n.domain={min:e.domain.min,max:e.domain.max}),e.slider&&(e.slider.hardMin&&(n.sliderBounds=n.sliderBounds||{},n.sliderBounds.min=e.slider.min),e.slider.hardMax&&(n.sliderBounds=n.sliderBounds||{},n.sliderBounds.max=e.slider.max),e.slider.step&&(n.sliderBounds=n.sliderBounds||{},n.sliderBounds.step=e.slider.step)),n}}),define("dcgview-helpers/mathquill-proxy",["require","exports","dcgview-helpers/mathquill-view"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.mq=e,this.id=e.id,this.data=e.data}return e.prototype.simulateUserChangedLatex=function(){r.default.simulateUserChangedLatex(this.mq)},e.prototype.simulateKeypress=function(e){r.default.simulateKeypress(this.mq,e)},e.prototype.latex=function(e){return void 0===e?this.mq.latex():(this.mq.latex(e),void this.simulateUserChangedLatex())},e.prototype.reflow=function(){this.mq.reflow()},e.prototype.el=function(){return this.mq.el()},e.prototype.getAriaLabel=function(){return this.mq.getAriaLabel()},e.prototype.setAriaLabel=function(e){return this.mq.setAriaLabel(e)},e.prototype.html=function(){return this.mq.html()},e.prototype.mathspeak=function(){return this.mq.mathspeak()},e.prototype.select=function(){this.mq.select()},e.prototype.moveToRightEnd=function(){this.mq.moveToRightEnd()},e.prototype.cmd=function(e){this.mq.cmd(e),this.simulateUserChangedLatex()},e.prototype.write=function(e){this.mq.write(e),this.simulateUserChangedLatex()},e.prototype.keystroke=function(e){this.simulateKeypress(e)},e.prototype.typedText=function(e){this.mq.typedText(e),this.simulateUserChangedLatex()},e.prototype.clearSelection=function(){this.mq.clearSelection()},e.prototype.getAriaPostLabel=function(){return this.mq.getAriaPostLabel()},e.prototype.setAriaPostLabel=function(e,t){this.mq.setAriaPostLabel(e,t)},e.prototype.blur=function(){this.mq.blur()},e.prototype.focus=function(){this.mq.focus()},e.prototype.revert=function(){this.mq.revert()},e.prototype.ignoreNextMousedown=function(e){this.mq.ignoreNextMousedown(e)},e.prototype.clickAt=function(e,t,r){this.mq.clickAt(e,t,r)},e}();t.MathQuillProxy=n}),define("api/abstract",["require","exports","touchtracking","lib/console","underscore_model","ipad.scrollfix","lib/dom-change-detector"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){if(this.rootElt=e,this.eventModel=new i.UnderscoreModel,!e)throw new Error("must pass an HTMLElement to the API")}return e.prototype.setupDomChangeDetector=function(e){var t=this;this.autoSize=e,r.monitor(this.rootElt),o.limitScrollOnElement(this.rootElt),this.domChangeDetector=new a.default(this.rootElt,function(e){switch(e.type){case"added":t.view=t.onCreateView(),t.onResizeView(e.size);break;case"removed":t.onDestroyView(),t.view=void 0;break;case"resized":t.onResizeView(e.size)}}),!1!==this.autoSize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()},e.prototype.detach=function(){n.warn(".detach() is deprecated. It should no longer be necessary")},e.prototype.destroy=function(){function e(e){n.warn("You've destroyed this API instance. You can no longer call ."+e+"()")}for(var t in this.view&&this.onDestroyView(),this.domChangeDetector.destroy(),this)"function"==typeof this[t]?this[t]=e.bind(this,t):this.hasOwnProperty(t)&&delete this[t];this.destroy=function(){}},e.prototype.resize=function(){this.domChangeDetector.checkForChanges()},e.prototype.updateView=function(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()},e.prototype.triggerEvent=function(e,t){this.eventModel.triggerEvent(e,t)},e.prototype.observeEvent=function(e,t){this.eventModel.observeEvent(e,t)},e.prototype.unobserveEvent=function(e){this.eventModel.unobserveEvent(e)},e}();t.default=s}),define("immutable-store",["require","underscore","lib/deepCopy"],function(e){function s(e){return r.clone(e)}function t(e){this.setState(e)}var r=e("underscore"),l=e("lib/deepCopy").default;return t.prototype.setState=function(e){this.state=e},t.prototype.getState=function(){return this.state},t.prototype.set=function(e,t){if(1!==arguments.length){if("string"==typeof e)return this.state=s(this.state),void(this.state[e]=t);var r,n=e.length-2,i=e[n+1];this.state=r=s(this.state);for(var o=0;o<=n;o++){var a=e[o];r=r[a]=s(r[a])}r[i]=t}else this.state=e},t.prototype.deepMutate=function(e,t){if(1===arguments.length)return t=e,this.state=l(this.state),void t(this.state);if("string"==typeof e)return this.state=s(this.state),this.state[e]=l(this.state[e]),void t(this.state[e]);for(var r=e.length-2,n=e[r+1],i=this.state=s(this.state),o=0;o<=r;o++){var a=e[o];i=i[a]=s(i[a])}t(i=i[n]=l(i[n]))},t.prototype.shallowMutate=function(e,t){if(1===arguments.length)return t=e,this.state=s(this.state),void t(this.state);if("string"==typeof e)return this.state=s(this.state),this.state[e]=s(this.state[e]),void t(this.state[e]);for(var r=e.length-1,n=this.state=s(this.state),i=0;i<=r;i++){var o=e[i];n=n[o]=s(n[o])}t(n)},t.areShallowEqual=function(e,t){},t.areDeepEqual=function(e,t){},{default:t}}),define("basic/model",["require","exports","tslib","immutable-store","main/shared-clock-bus","graphing/label","main/evaluator","graphing/label"],function(e,d,a,s,l,t,r,h){"use strict";Object.defineProperty(d,"__esModule",{value:!0}),d.DENOMINATOR_CUTOFF=1e6;var n=function(){function e(e){var t=e.evaluationMode,r=e.additionalFunctions,n=e.functionDefinition,i=e.workerPool,o=this;this._evaluations={},this._nextObjectId=0,this.store=new s.default({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1},ui:{focus:void 0}}),this.evaluationMode=t,this.additionalFunctions=r,this.functionDefinition=n,this.workerPool=i,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=l.subscribe(function(){o._evaluator.tick()})}return e.prototype.isSingleExpression=function(){return"singleExpressionScientific"===this.evaluationMode},e.prototype.destroy=function(){l.unsubscribe(this._sharedClockBusToken)},e.prototype.generateObjectId=function(){return(this._nextObjectId++).toString()},e.prototype.updateNextObjectId=function(){for(var e=this.store.getState().order,t=/^[0-9]+$/,r=this._nextObjectId=0,n=e;r<n.length;r++){var i=n[r];if(t.test(i)){var o=parseInt(i,10);o>=this._nextObjectId&&(this._nextObjectId=o+1)}}},e.prototype.clearShouldDebounceUndoRedo=function(){this._shouldDebounceUndoRedo=!1},e.prototype.markShouldDebounceUndoRedo=function(){this._shouldDebounceUndoRedo=!0},e.prototype.getShouldDebounceUndoRedo=function(){return this._shouldDebounceUndoRedo},e.prototype.clearCachedBrailleValues=function(){for(var e=0,t=this.getExpressionOrder();e<t.length;e++){var r=t[e];this.store.set(["expressions",r,"braille"],"")}},e.prototype.getState=function(){return this.store.getState()},e.prototype.getPersistedState=function(){var e=this.getState(),r=e.expressions,t=e.order,n=e.settings;return{expressions:{list:t.map(function(e){var t=r[e];return{id:t.id,latex:t.latex,displayAsFraction:t.displayAsFraction}})},settings:n}},e.prototype.setState=function(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()},e.prototype.setStateFromAPI=function(e){var t=[],r={};e.expressions.list.forEach(function(e){t.push(e.id),r[e.id]={id:e.id,latex:e.latex,braille:"",type:"latex",displayAsFraction:!!e.displayAsFraction}}),this.setState({expressions:r,order:t,settings:e.settings,ui:{focus:void 0}})},e.prototype.canClear=function(){if(1<this.getNumberOfExpressions())return!0;var e=this.getExpressionOrder()[0];return""!==this.getExpressionLatex(e)},e.prototype.clear=function(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})},e.prototype.getExpressionOrder=function(){return this.store.getState().order},e.prototype.getNumberOfExpressions=function(){return this.getExpressionOrder().length},e.prototype.getExpressionById=function(e){return this.getState().expressions[e]},e.prototype.getExpressionIndex=function(e){return this._indexes[e]},e.prototype._getExpressionByIndex=function(e){var t=this.getExpressionOrder()[e];return this.getExpressionById(t)},e.prototype._updateIndexes=function(){this._indexes={};for(var e=0,t=0,r=this.getExpressionOrder();t<r.length;t++){var n=r[t];this._indexes[n]=e,e+=1}this._evaluate()},e.prototype._usesAnsById=function(e){return-1!==this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")},e.prototype._getPreviousExpById=function(e){var t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)},e.prototype.createBlankAfterId=function(e){if(this.getExpressionById(e).latex){var t=this.getExpressionIndex(e),r=this.generateObjectId();this.store.shallowMutate("order",function(e){e.splice(t+1,0,r)}),this.store.shallowMutate("expressions",function(e){e[r]={id:r,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(r,!0)}},e.prototype.conditionallyCopyPrevious=function(e){var t=this._getPreviousExpById(e),r=this.getExpressionById(e);null!=t&&""===r.latex&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)},e.prototype.backspaceAtFrontOfId=function(t){if(""===this.getExpressionById(t).latex&&1!==this.getNumberOfExpressions()){var r=this.getExpressionIndex(t);this.store.shallowMutate("order",function(e){e.splice(r,1)}),this.store.shallowMutate("expressions",function(e){delete e[t]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(r-1,0),!0)}},e.prototype.setLatexById=function(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),""===t&&this.setFractionEvaluation(e,!1),this._evaluate()},e.prototype.setLatexAndBrailleById=function(e,t,r){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],r),""===t&&this.setFractionEvaluation(e,!1),this._evaluate()},e.prototype.setFractionEvaluation=function(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)},e.prototype.setLatexOfFocusedExpression=function(e){var t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)},e.prototype.isExpressionFocused=function(e){return this.getFocusedExpressionId()===e},e.prototype.getExpressionLatex=function(e){return this.getExpressionById(e).latex},e.prototype.getExpressionError=function(e){var t=this._evaluations[e];return t?t.error:""},e.prototype.getExpressionValue=function(e){var t=this._evaluations[e];if(t)return t.value},e.prototype.getExpressionAns=function(e){var t=this._evaluations[e];if(t)return t.ans},e.prototype.shouldShowEvaluationForExpression=function(e){var t=this._evaluations[e];return!!t&&t.showEvaluation},e.prototype.isRationalizableConstant=function(e){var t=this._evaluations[e];return!!t&&t.isRationalizableConstant},e.prototype.canDisplayEvaluationAsFraction=function(e){var t=this.getExpressionValue(e);return!!t&&h.canDisplayAsFraction(t,d.DENOMINATOR_CUTOFF)},e.prototype._setFocusedByIndex=function(e,t){var r,n=this._getExpressionByIndex(e),i=a.__assign({},this.store.getState()),o=!1;t?(r={type:"latex-expression",id:n.id},o=!0):this.getFocusedExpressionId()===n.id?o=!(r=void 0):i.expressions[n.id]=a.__assign({},n,{braille:""}),o&&(i.ui={focus:r}),this.store.set(i)},e.prototype.setFocusedById=function(e,t){var r=this.getExpressionIndex(e);this._setFocusedByIndex(r,t)},e.prototype.focusPrevById=function(e){var t=this.getExpressionIndex(e)-1;0<=t&&this._setFocusedByIndex(t,!0)},e.prototype.focusNextById=function(e){var t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()},e.prototype.getFocusedExpression=function(){var e=this.getFocusedExpressionId();return e?this.getExpressionById(e):void 0},e.prototype.getFocusedExpressionId=function(){var e=this.getState().ui.focus;return e&&e.id},e.prototype.clearFocusedExpression=function(){var e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")},e.prototype.shouldShowClear=function(){if(1===this.getNumberOfExpressions())return!1;var e=this.getFocusedExpression();return!!e&&!!e.latex},e.prototype.getLastExpression=function(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)},e.prototype.isLastExpressionEmpty=function(){return!!this.getLastExpression().latex},e.prototype.createAtEnd=function(){this.createBlankAfterId(this.getLastExpression().id)},e.prototype.focusLastExpression=function(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)},e.prototype.focusFirstExpression=function(){this._setFocusedByIndex(0,!0)},e.prototype.getDegreeMode=function(){return this.getState().settings.degreeMode},e.prototype.setDegreeMode=function(e){this.store.set(["settings","degreeMode"],!!e),this._evaluate()},e.prototype._cleanupLatex=function(e){return"="===(e=t.trimLatex(e)).substr(e.length-1)&&(e=e.substr(0,e.length-1)),e},e.prototype._evaluate=function(){var t=this;this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(function(e){return t._evaluator.addStatement({id:e,index:t.getExpressionIndex(e),latex:t._cleanupLatex(t.getExpressionLatex(e)),shouldGraph:!1,type:"statement"})}),this._evaluator.setDegreeMode(this.getDegreeMode())},e.prototype._setupEvaluator=function(){var p=this;this._evaluator=new r.Evaluator(this.workerPool),this._evaluator.setEvaluationMode(this.evaluationMode),this._evaluator.setAdditionalFunctions(this.additionalFunctions),this._evaluator.setFunctionDefinition(this.functionDefinition),this._evaluator.triggerStatusChange=function(e){for(var t in p._evaluations={},e){var r=e[t];if(p.getExpressionById(t)){var n=r.constant_value;void 0===n&&r.zero_values&&r.zero_values.length&&(n=r.zero_values[0].val);var i=r.hasOwnProperty("constant_value")&&h.canDisplayAsFraction(r.constant_value,d.DENOMINATOR_CUTOFF),o=!r.is_evaluable&&i,a=!!r.is_evaluable||o||Array.isArray(n);p._evaluations[t]={error:r.error,ans:void 0,value:n,showEvaluation:a,isRationalizableConstant:o}}}for(var s=void 0,l=0,c=p.getExpressionOrder();l<c.length;l++){t=c[l];var u=p._evaluations[t];s&&u&&(u.ans=s.value),s=u}"function"==typeof p.onEvaluationUpdate&&p.onEvaluationUpdate()}},e.prototype.reloadState=function(){this.setState(this.getState())},e.prototype.getFunctionDefinition=function(){return!!this.functionDefinition},e.prototype.enableFunctionDefinition=function(){this.functionDefinition=!0,this._evaluator.setFunctionDefinition(!0),this.reloadState()},e.prototype.disableFunctionDefinition=function(){this.functionDefinition=!1,this._evaluator.setFunctionDefinition(!1),this.reloadState()},e}();d.default=n}),define("basic/controller",["require","exports","tslib","flux","underscore","./model","lib/state-stack","keypad/mq-commands","i18n","dcgview-helpers/mathquill-view","lib/console","bugsnag","lib/color-helpers"],function(e,t,s,n,i,o,a,r,l,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e,t){var r=this;this.keyboardMode="main",this.fontSize=16,this.invertedColors=!1,this.backgroundColor="",this.textColor="",this.projectorMode=!1,this.capExpressionSize=!1,this.decimalToFractionConversion=!1,this.settingsMenu=!0,this.settingsMenuOpen=!1,this.language="en",this.brailleMode="none",this.sixKeyInput=!1,this.stateStack=new a.default,this.dispatcher=new n.Dispatcher,this.t=function(e,t){return l.t(e,t,r.language)},this.dispatch=function(e){p.leaveBreadcrumb("dispatch",{type:e.type}),r.dispatcher.dispatch(e);for(var t;t=r._queuedCallbacks.shift();)t()},this._queuedCallbacks=[],this.stateStack=new a.default,this.dispatcher=new n.Dispatcher,this.options=e,this.model=new o.default({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,functionDefinition:this.options.functionDefinition,workerPool:t.workerPool}),this.model=this.model,this.model.setDegreeMode(e.degreeMode),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFractionConversion(e.decimalToFractionConversion),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=function(){return r.dispatch({type:"render"})},this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}return e.prototype.runAfterDispatch=function(e){this._queuedCallbacks.push(e)},e.prototype.enqueueEvent=function(e){var t=this;this.runAfterDispatch(function(){t.onEventEmitted&&t.onEventEmitted(e)})},e.prototype.getFunctionDefinition=function(){return this.options.functionDefinition},e.prototype.getSettingsMenu=function(){return this.settingsMenu},e.prototype.getBrailleMode=function(){return this.brailleMode},e.prototype.renderAsBraille=function(){return"none"!==this.brailleMode},e.prototype.setBrailleMode=function(e){this.brailleMode=e},e.prototype.getSixKeyInput=function(){return this.sixKeyInput},e.prototype.setSixKeyInput=function(e){this.sixKeyInput=e},e.prototype.getRestrictedEditing=function(){return this.options.restrictedEditing},e.prototype.getKeyboardMode=function(){return this.keyboardMode},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.getInvertedColors=function(){return this.invertedColors},e.prototype.hasBackgroundColor=function(){return"#ffffff"!==this.getBackgroundColor()},e.prototype.getBackgroundColor=function(){var e=d.normalizeColor(this.backgroundColor||"#fff");return this.getInvertedColors()&&"#ffffff"!==e?d.invertColor(e):e},e.prototype.getTextColor=function(){var e=d.normalizeColor(this.textColor||"#000");return this.getInvertedColors()&&"#000000"!==e?d.invertColor(e):e},e.prototype.getAdditionalFunctions=function(){return this.options.additionalFunctions},e.prototype.getTypingSlashWritesDivisionSymbol=function(){return this.options.typingSlashWritesDivisionSymbol},e.prototype.getTypingAsteriskWritesTimesSymbol=function(){return this.options.typingAsteriskWritesTimesSymbol},e.prototype.setProjectorMode=function(e){this.projectorMode=e},e.prototype.isProjectorMode=function(){return this.projectorMode},e.prototype.setCapExpressionSize=function(e){this.capExpressionSize=e},e.prototype.getCapExpressionSize=function(){return this.capExpressionSize},e.prototype.setDecimalToFractionConversion=function(e){this.decimalToFractionConversion=e},e.prototype.getDecimalToFractionConversion=function(){return this.decimalToFractionConversion},e.prototype.isScientificCalc=function(){var e=this.options.evaluationMode;return"scientific"===e||"singleExpressionScientific"===e},e.prototype.isFourFunctionCalc=function(){return"fourFunction"===this.options.evaluationMode},e.prototype.getAllowLinks=function(){return this.options.links},e.prototype.canUndo=function(){return this.stateStack.canUndo()},e.prototype.canRedo=function(){return this.stateStack.canRedo()},e.prototype.undo=function(e){if(this.canUndo()){this.stateStack.undo();var t=this.stateStack.getState();if(!e.restoreFocus){t=s.__assign({},t,{ui:{focus:void 0}})}this.model.setState(t),this.enqueueEvent("change")}},e.prototype.redo=function(e){if(this.canRedo()){this.stateStack.redo();var t=this.stateStack.getState();if(!e.restoreFocus){t=s.__assign({},t,{ui:{focus:void 0}})}this.model.setState(t),this.enqueueEvent("change")}},e.prototype.clearHistory=function(){this.stateStack.clear()},e.prototype.canBackspace=function(){var e=this.model.getFocusedExpression();return e&&(0<e.latex.length||1<this.model.getNumberOfExpressions())},e.prototype.focusLastExpression=function(){this.model.focusLastExpression()},e.prototype.shouldRender=function(){return 0<this.containerSize.width&&0<this.containerSize.height},e.prototype.canClear=function(){return this.model.canClear()},e.prototype.shouldShowClear=function(){return this.model.shouldShowClear()},e.prototype.enableSettingsMenu=function(){this.settingsMenu=!0},e.prototype.disableSettingsMenu=function(){this.closeSettingsMenu(),this.settingsMenu=!1},e.prototype.closeSettingsMenu=function(){this.settingsMenuOpen=!1},e.prototype.toggleSettingsMenu=function(){this.settingsMenuOpen=!this.settingsMenuOpen},e.prototype.isSettingsMenuOpen=function(){return this.settingsMenuOpen},e.prototype.isLastExpressionEmpty=function(){return this.model.isLastExpressionEmpty()},e.prototype.createAtEnd=function(){this.model.createAtEnd()},e.prototype.clearFocusedExpression=function(){this.model.clearFocusedExpression()},e.prototype.setLatexById=function(e,t){this.model.setLatexById(e,t)},e.prototype.setLatexAndBrailleById=function(e,t,r){this.model.setLatexAndBrailleById(e,t,r)},e.prototype.setLatexOfFocusedExpression=function(e){this.model.setLatexOfFocusedExpression(e)},e.prototype.toggleFractionEvaluationById=function(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)},e.prototype.conditionallyCopyPrevious=function(e){this.model.conditionallyCopyPrevious(e)},e.prototype.createBlankAfterId=function(e){this.model.createBlankAfterId(e)},e.prototype.backspaceAtFrontOfId=function(e){this.model.backspaceAtFrontOfId(e)},e.prototype.areStatesDifferentEnoughForUndoRedo=function(e,t){var r={focus:void 0};return i.isEqual(s.__assign({},e,{ui:r}),s.__assign({},t,{ui:r}))},e.prototype.commitUndoRedoDebounced=function(){var e=this.model.getState(),t=this.stateStack.getState();if(!this.areStatesDifferentEnoughForUndoRedo(e,t)){var r=(new Date).getTime();r-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=r,this.enqueueEvent("change")}},e.prototype.commitUndoRedoSynchronously=function(){var e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))},e.prototype.updateKeyboardMode=function(e){this.keyboardMode=e},e.prototype.getFocusedMathquill=function(){if(this.model.getFocusedExpressionId())return c.default.getFocusedMathquill()},e.prototype.ensureMathquillIsFocusedAndReturnFocusedMathquill=function(){var e=this.getFocusedMathquill();return e||(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),this.getFocusedMathquill())},e.prototype.typeIntoFocusedMathquill=function(e){e=e.replace(/\r|\n/g,"");var t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&c.default.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())},e.prototype.pressKeyInFocusedMathquill=function(e,t){if("none"===this.getBrailleMode()){var r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();if(r)if("Up"===e||"Down"===e||"Left"===e||"Right"===e){c.default.applyArrowKeyAndReturnIfWasAtBounds(r,e,t)&&this.moveFocusInDirection(e)}else"Enter"===e?(t&&(t.preventDefault(),t.stopPropagation()),this.handleEnter()):"Backspace"===e&&this.attemptToMoveFocusWithBackspace()||(r.keystroke(e,t),this.setLatexOfFocusedExpression(r.latex()))}},e.prototype.moveFocusInDirection=function(e){var t=this.model.getFocusedExpressionId();t&&("Up"===e?this.model.focusPrevById(t):"Down"===e&&this.model.focusNextById(t))},e.prototype.handleEnter=function(){if(!this.model.isSingleExpression()){var e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}},e.prototype.attemptToMoveFocusWithBackspace=function(){var e=this.model.getFocusedExpression();if(!e)return!1;var t=e.latex,r=e.id;return""===t&&(this.backspaceAtFrontOfId(r),!0)},e.prototype.executeCommandInFocusedMathquill=function(e){var t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(r.execute(t,e),this.setLatexOfFocusedExpression(t.latex()))},e.prototype.syncPublicSettings=function(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFractionConversion",this.decimalToFractionConversion),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition())},e.prototype.hookUpDispatcher=function(){var a=this;this.dispatcher.register(function(e){a.enqueueEvent("render");var t=!1,r=a.getRestrictedEditing();switch(e.type){case"update-options":a.options=s.__assign({},a.options,e.options);break;case"keypad/shift":a.updateKeyboardMode("capitalQwerty"===a.keyboardMode?"qwerty":"capitalQwerty");break;case"undo":r||(a.undo({restoreFocus:"keyboard-shortcut"===e.source}),t=!0);break;case"redo":r||(a.redo({restoreFocus:"keyboard-shortcut"===e.source}),t=!0);break;case"clear-history":a.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||a.clearHistory(),a.model.setStateFromAPI(e.state);break;case"main":a.updateKeyboardMode("main");break;case"ABC":a.options.qwertyKeyboard?a.updateKeyboardMode("qwerty"):a.updateKeyboardMode("letters");break;case"functions":a.updateKeyboardMode("functions");break;case"degrees":a.model.setDegreeMode(!a.model.getDegreeMode());break;case"update-degree-mode":a.model.setDegreeMode(!!e.mode);break;case"update-font-size":var n=e.size;if("number"!=typeof n&&(n=parseInt(n,10)),isNaN(n))return;a.fontSize=n;break;case"update-inverted-colors":a.invertedColors=!!e.mode;break;case"update-background-color":a.backgroundColor=e.color;break;case"update-text-color":a.textColor=e.color;break;case"update-projector-mode":a.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":a.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":a.setDecimalToFractionConversion(!!e.mode);break;case"update-language":var i=e.language;"en"!==i&&-1===Desmos.supportedLanguages.indexOf(i)?u.warn("Translation for '"+i+"' isn't currently available. Using '"+a.language+"' instead."):a.language=i;break;case"set-blank":e.opts.allowUndo||a.clearHistory(),a.model.clear(),a.focusLastExpression();break;case"clear":a.model.clearFocusedExpression();break;case"set-braille-mode":var o=e.mode;"nemeth"!==o&&"ueb"!==o&&"none"!==o?u.warn("Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '"+o+"'."):(a.model.clearCachedBrailleValues(),a.setBrailleMode(e.mode));break;case"set-six-key-input":a.setSixKeyInput(!!e.mode);break;case"update-latex":a.model.markShouldDebounceUndoRedo(),a.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":a.model.markShouldDebounceUndoRedo(),a.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":a.model.setFocusedById(e.id,!0);break;case"focusout":a.model.setFocusedById(e.id,!1);break;case"focus-first-expression":a.model.focusFirstExpression();break;case"focus-prev-expression":a.moveFocusInDirection("Up");break;case"focus-next-expression":a.moveFocusInDirection("Down");break;case"focus-last-expression":a.model.focusLastExpression();break;case"insert-blank-expression":a.handleEnter();break;case"backspace-from-braille":a.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":a.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":a.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":a.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":break;case"enable-settings-menu":a.enableSettingsMenu();break;case"disable-settings-menu":a.disableSettingsMenu();break;case"toggle-settings-menu":a.toggleSettingsMenu();break;case"close-settings-menu":a.closeSettingsMenu();break;case"render":break;case"ui/container-resized":a.containerSize=e.size;break;case"toggle-fraction-evaluation":a.toggleFractionEvaluationById(e.id);break;default:return e}a.runAfterDispatch(function(){return a.syncPublicSettings()}),t||(a.model.getShouldDebounceUndoRedo()?(a.commitUndoRedoDebounced(),a.model.clearShouldDebounceUndoRedo()):a.commitUndoRedoSynchronously())})},e}();t.default=h}),define("basic/dcgview-basic",["require","exports","tslib","dcgview"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.init=function(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.t=this.controller.t},t}(n.Class);t.DCGViewBasic=i}),define("loadcss!keypad/control-bar",function(){}),define("keypad/control-bar",["require","exports","tslib","dcgview","./dcgview-keypad","loadcss!./control-bar"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:n.const("dcg-keypad-control-bar dcg-do-not-blur"),role:n.const("group"),"aria-label":function(){return e.controller.t("Control Bar")}},this.children)},t}(i.default);t.default=o}),define("loadcss!keypad/control-btn",function(){}),define("keypad/control-btn",["require","exports","tslib","dcgview","loadcss!./control-btn"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:function(){return{"dcg-keypad-control-btn":!0,"dcg-disabled":e.isDisabled(),"dcg-selected":!e.isDisabled()&&e.isSelected(),"dcg-selectable-btn":!e.isDisabled()&&e.isSelectable(),"dcg-narrow-control-btn":e.props.narrowButton&&e.props.narrowButton()}},didMount:this.bindFn(this.didMount),role:n.const("button"),"aria-disabled":function(){return e.isDisabled()||void 0},"aria-label":function(){return e.getAriaLabel()},"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":function(){return e.hasPopup()||e.isDisabled()||!e.isSelectable()?void 0:e.isSelected()},"aria-expanded":function(){return e.hasPopup()&&!e.isDisabled()?e.isSelected():void 0},tabindex:this.bindFn(this.getTabIndex)},this.children)},t.prototype.getTabIndex=function(){return this.isDisabled()?void 0:this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0},t.prototype.handleTap=function(e){this.isDisabled()||this.props.onTap(e)},t.prototype.getAriaLabel=function(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()},t.prototype.hasPopup=function(){return!!this.props.ariaPopup&&this.props.ariaPopup()},t.prototype.isDisabled=function(){return!!this.props.disabled&&this.props.disabled()},t.prototype.isSelected=function(){return!!this.props.selected&&this.props.selected()},t.prototype.isSelectable=function(){return!!this.props.selectable&&this.props.selectable()},t.prototype.didMount=function(e){this.props.didMount&&this.props.didMount(e)},t}(n.Class);t.default=i}),define("vendor/fake-xml-http-request",[],function(){function r(r,n){n.addEventListener(r,function(e){var t=n["on"+r];t&&"function"==typeof t&&t.call(e.target,e)})}function e(){this._eventListeners={};for(var e=["loadstart","progress","load","abort","loadend"],t=e.length-1;0<=t;t--)r(e[t],this)}function a(){e.call(this),this.readyState=a.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new e}function n(e){if(e.readyState!==a.OPENED)throw new Error("INVALID_STATE_ERR");if(e.sendFlag)throw new Error("INVALID_STATE_ERR")}var i=function(e,t,r,n){this.type=e,this.bubbles=t,this.cancelable=r,this.target=n};i.prototype={stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}};var o={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},s={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};e.prototype={addEventListener:function(e,t){this._eventListeners[e]=this._eventListeners[e]||[],this._eventListeners[e].push(t)},removeEventListener:function(e,t){for(var r=this._eventListeners[e]||[],n=0,i=r.length;n<i;++n)if(r[n]==t)return r.splice(n,1)},dispatchEvent:function(e){for(var t=e.type,r=this._eventListeners[t]||[],n=0;n<r.length;n++)"function"==typeof r[n]?r[n].call(this,e):r[n].handleEvent(e);return!!e.defaultPrevented},_progress:function(e,t,r){var n=new i("progress");n.target=this,n.lengthComputable=e,n.loaded=t,n.total=r,this.dispatchEvent(n)}},a.prototype=new e;var t={UNSENT:a.UNSENT=0,OPENED:a.OPENED=1,HEADERS_RECEIVED:a.HEADERS_RECEIVED=2,LOADING:a.LOADING=3,DONE:a.DONE=4,async:!0,withCredentials:!1,open:function(e,t,r,n,i){this.method=e,this.url=t,this.async="boolean"!=typeof r||r,this.username=n,this.password=i,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,this._readyStateChange(a.OPENED)},setRequestHeader:function(e,t){if(n(this),s[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+t:this.requestHeaders[e]=t},send:function(e){if(n(this),!/^(get|head)$/i.test(this.method)){var t=!1;Object.keys(this.requestHeaders).forEach(function(e){"content-type"===e.toLowerCase()&&(t=!0)}),t||(e||"").toString().match("FormData")||(this.requestHeaders["Content-Type"]="text/plain;charset=UTF-8"),this.requestBody=e}this.errorFlag=!1,this.sendFlag=this.async,this._readyStateChange(a.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new i("loadstart",!1,!1,this)),a.onSend&&a.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>a.UNSENT&&this.sendFlag&&(this._readyStateChange(a.DONE),this.sendFlag=!1),this.readyState=a.UNSENT,this.dispatchEvent(new i("abort",!1,!1,this)),"function"==typeof this.onerror&&this.onerror()},getResponseHeader:function(e){if(this.readyState<a.HEADERS_RECEIVED)return null;if(/^Set-Cookie2?$/i.test(e))return null;for(var t in e=e.toLowerCase(),this.responseHeaders)if(t.toLowerCase()==e)return this.responseHeaders[t];return null},getAllResponseHeaders:function(){if(this.readyState<a.HEADERS_RECEIVED)return"";var e="";for(var t in this.responseHeaders)this.responseHeaders.hasOwnProperty(t)&&!/^Set-Cookie2?$/i.test(t)&&(e+=t+": "+this.responseHeaders[t]+"\r\n");return e},overrideMimeType:function(e){"string"==typeof e&&(this.forceMimeType=e.toLowerCase())},_readyStateChange:function(e){this.readyState=e,"function"==typeof this.onreadystatechange&&this.onreadystatechange(new i("readystatechange")),this.dispatchEvent(new i("readystatechange")),this.readyState==a.DONE&&(this.dispatchEvent(new i("load",!1,!1,this)),this.dispatchEvent(new i("loadend",!1,!1,this)))},_setResponseHeaders:function(e){for(var t in this.responseHeaders={},e)e.hasOwnProperty(t)&&(this.responseHeaders[t]=e[t]);this.forceMimeType&&(this.responseHeaders["Content-Type"]=this.forceMimeType),this.async?this._readyStateChange(a.HEADERS_RECEIVED):this.readyState=a.HEADERS_RECEIVED},_setResponseBody:function(e){(function(e){if(e.readyState==a.DONE)throw new Error("Request done")})(this),function(e){if(e.async&&e.readyState!=a.HEADERS_RECEIVED)throw new Error("No headers received")}(this),function(e){if("string"!=typeof e){var t=new Error("Attempted to respond to fake XMLHttpRequest with "+e+", which is not a string.");throw t.name="InvalidBodyException",t}}(e);var t=this.chunkSize||10,r=0;for(this.responseText="";this.async&&this._readyStateChange(a.LOADING),this.responseText+=e.substring(r,r+t),(r+=t)<e.length;);var n,i,o=this.getResponseHeader("Content-Type");if(this.responseText&&(!o||/(text\/xml)|(application\/xml)|(\+xml)/.test(o)))try{this.responseXML=(n=this.responseText,"undefined"!=typeof DOMParser?i=(new DOMParser).parseFromString(n,"text/xml"):((i=new ActiveXObject("Microsoft.XMLDOM")).async="false",i.loadXML(n)),i)}catch(e){}this.async?this._readyStateChange(a.DONE):this.readyState=a.DONE},respond:function(e,t,r){this._setResponseHeaders(t||{}),this.status="number"==typeof e?e:200,this.statusText=o[this.status],this._setResponseBody(r||"")}};for(var l in t)a.prototype[l]=t[l];return a}),define("main/backend",["require","jquery"],function(require){var $=require("jquery"),Backend={baseURL:"",getGoogleLoginURL:function(e){void 0===e&&(e={});var t=e.changeToken?"?"+e.changeToken:"";return t+=e.changeToken?"&source":"?source="+(e.from?e.from:""),Backend.baseURL+"/drive_api/calculator/login"+t},exchangeGoogleAuthCode:function(e){var t=$.Deferred();return e?this.getJSON("/account/google_auth?code="+e).always(function(e){e&&e.success?t.resolve():t.reject()}):setTimeout(function(){t.reject("no auth code")},1),t.promise()},handleDeprecatedRoute:function(msg){if(msg&&msg.routeDeprecated){msg.js&&eval(msg.js);var deferred=$.Deferred();return deferred.reject(msg),deferred.promise()}return msg},post:function(e,t){return $.ajax({type:"POST",url:Backend.baseURL+e,data:t,xhrFields:{withCredentials:!0}}).then(Backend.handleDeprecatedRoute)},getJSON:function(e){return $.ajax({dataType:"json",url:Backend.baseURL+e,xhrFields:{withCredentials:!0}}).then(Backend.handleDeprecatedRoute)}};return Backend}),define("lib/app-bridge",["require","jquery","underscore_model","browser","lib/conditional_blur","vendor/fake-xml-http-request","pjs","console","main/backend"],function(e){function s(e){var t=n(e.target).closest("a[href]")[0];if(t&&"file:"===t.protocol){var r=t.getAttribute("href");"/"!==r[0]&&(r="/"+r),t.setAttribute("href",d.baseURL+r)}}var n=e("jquery"),t=e("underscore_model").UnderscoreModel,r=e("browser"),i=e("lib/conditional_blur").default,o=e("vendor/fake-xml-http-request"),l=null,a=null,c=e("pjs"),u=e("console"),p=!1,d=e("main/backend"),h={},f=0;if(r.IS_IOS){var g=[],m=[];l={loaded:!1,methods:{},queuedMethodCalls:[]},n(function(){var a=[];window.ObjC_callback=function(e){l.loaded=!0,e.split(" ").forEach(function(o){l.methods[o]=function(e,t){var r,n,i=t?(r=t,n=m.length?m.pop():g.length,g[n]=r,n):-1;a.push("desmos:"+o+"/"+i+"/"+encodeURIComponent(e)),1===a.length&&s.attr("src",a[0])}}),this.ObjC_callback=function(e,t){try{-1!==e&&(n=g[r=e],g[r]=null,m.push(r),n(t))}finally{a.shift(),0<a.length&&s.attr("src",a[0])}var r,n},l.methods.proxyXHR&&((window.XMLHttpRequest=o).onSend=function(e){var t=f+"";f+=1,h[t]=e,l.methods.proxyXHR(JSON.stringify({id:t,url:e.url,method:e.method,headers:e.requestHeaders,body:e.requestBody}))}),l.queuedMethodCalls.forEach(function(e){y[e.methodName].apply(y,e.args)})}})}else r.IS_ANDROID?a=window.Android:p=!0;var y=new(c(t,function(e,t){e.init=function(){t.init.call(this),this.heartbeatTimeout=null,this.observeEvent("started resumed",function(e){this.gaEvent(e+":"+this.versionNumber),this.incrementHeartbeat(0)}.bind(this))},e.isSingleAppModeEnabled=function(){return!!window.dcg_singleappmode_enabled},e.isSingleAppModeActive=function(){return!!window.dcg_singleappmode_active},e.openExitSingleAppModeModal=function(){this.show_end_singleappmode_modal=!0},e.closeEndSingleAppModeModal=function(){this.show_end_singleappmode_modal=!1},e.isEndSingleAppModeModalOpen=function(){return!!this.show_end_singleappmode_modal},e.openStartSingleAppModeModal=function(){this.show_start_singleappmode_modal=!0},e.closeStartSingleAppModeModal=function(){this.show_start_singleappmode_modal=!1},e.isStartSingleAppModeModalOpen=function(){return!!this.show_start_singleappmode_modal},e.heartbeat=function(e){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*e),this.incrementHeartbeat(e)},e.incrementHeartbeat=function(e){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(function(){this.heartbeat(e+1)}.bind(this),6e5)},e._started=function(e,t){this.appId=e,this.versionNumber=t,this.triggerEvent("started")},e._resumed=function(){this.triggerEvent("resumed")},e.ensureKeypadClosedAndReturnIfWasOpened=function(){var e=window.Calc&&window.Calc.controller;return e&&e.isKeypadOpen()?(i(),"true"):"false"},e.onGoogleAuthResult=function(e){this.triggerEvent("onGoogleAuthResult",e)},e.onObjCXHRProxyResult=function(e){var t=e.id,r=h[t];delete h[t],r.respond(e.status,e.headers,e.body)}}));return["hideLoadingScreen","gaEvent","openGoogleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain"].forEach(function(e){y[e]=function(){p||(a?a[e]?a[e].apply(a,arguments):u.log("call to missing Android method",e,arguments):l&&(l.loaded?l.methods[e]?l.methods[e].apply(l,arguments):u.log("call to missing ObjC method",e,arguments):l.queuedMethodCalls.push({methodName:e,args:arguments})))}}),p||(window.AppBridge=y,document.addEventListener("click",s,!0)),y}),define("loadcss!basic/settings-menu",function(){}),define("basic/settings-menu",["require","exports","lib/app-bridge","tslib","keys","dcgview","./dcgview-basic","jquery","loadcss!./settings-menu"],function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.Components.If,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.template=function(){var e=this;return i.createElement("div",{class:function(){return{"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":e.controller.hasBackgroundColor()}},role:i.const("complementary"),"aria-label":i.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},i.createElement("div",{class:i.const("dcg-popover-interior"),style:function(){return{background:e.controller.getBackgroundColor()}}},i.createElement("div",{class:function(){return{"dcg-settings-menu-option":!0,"dcg-modern-btn":!0,"dcg-action-projectormode":!0,"dcg-active":e.controller.isProjectorMode()}},role:i.const("button"),onTap:this.bindFn(this.onToggleProjectorMode),tabindex:i.const(0),"aria-label":function(){return e.controller.t("Projector Mode")},"aria-pressed":function(){return e.controller.isProjectorMode()}},function(){return e.controller.t("Projector Mode")}),i.createElement("div",{class:function(){return{"dcg-settings-menu-option":!0,"dcg-braille-container":!0}}},i.createElement("div",{class:i.const("dcg-group-title")},i.const("Braille Mode")),i.createElement("div",{role:i.const("group"),"aria-label":function(){return e.controller.t("Braille Mode")},class:i.const("dcg-braille-options-buttons")},i.createElement("span",{class:function(){return{"dcg-braille-option":!0,"dcg-selected":e.isLatex()}},role:i.const("button"),onTap:function(){return e.setBrailleMode("none")},tabindex:i.const(0),"aria-label":function(){return e.controller.t("Off")},"aria-pressed":function(){return e.isLatex()}},function(){return e.controller.t("Off")}),i.createElement("span",{class:function(){return{"dcg-braille-option":!0,"dcg-selected":e.isNemeth()}},role:i.const("button"),onTap:function(){return e.setBrailleMode("nemeth")},tabindex:i.const(0),"aria-label":function(){return e.controller.t("Nemeth")},"aria-pressed":function(){return e.isNemeth()}},function(){return e.controller.t("Nemeth")}),i.createElement("span",{class:function(){return{"dcg-braille-option":!0,"dcg-selected":e.isUEB()}},role:i.const("button"),onTap:function(){return e.setBrailleMode("ueb")},tabindex:i.const(0),"aria-label":function(){return e.controller.t("UEB")},"aria-pressed":function(){return e.isUEB()}},function(){return e.controller.t("UEB")})),i.createElement(l,{predicate:function(){return e.controller.renderAsBraille()}},function(){return i.createElement("div",null,i.createElement("div",{role:i.const("checkbox"),tabindex:i.const(0),onTap:function(){return e.onToggleSixKeyInput()},"aria-checked":function(){return e.controller.getSixKeyInput()},"aria-label":function(){return e.controller.t("Six Key Braille Input")},class:function(){return{"dcg-settings-menu-option":!0,"dcg-do-not-blur":!0,"dcg-six-key-checkbox":!0,"dcg-checked":e.controller.getSixKeyInput(),"dcg-checkbox-container":!0}},handleEvent:i.const(!0)},i.createElement("span",{class:i.const("dcg-checkbox-box")},i.createElement("i",{class:i.const("dcg-icon-check")})),i.createElement("span",{class:i.const("dcg-checkbox-label")},function(){return e.controller.t("Six Key Braille Input")})),i.createElement("a",{href:i.const("https://www.desmos.com/accessibility#braille"),class:i.const("dcg-six-key-info"),target:i.const("_blank")},i.createElement("i",{class:i.const("dcg-icon-question-sign")})))})),i.createElement("div",{role:i.const("checkbox"),tabindex:i.const(0),onTap:this.bindFn(this.onToggleInvertedColors),"aria-checked":function(){return e.controller.getInvertedColors()},"aria-label":function(){return e.controller.t("Reverse Contrast")},class:function(){return{"dcg-settings-menu-option":!0,"dcg-do-not-blur":!0,"dcg-checked":e.controller.getInvertedColors(),"dcg-checkbox-container":!0,"dcg-reverse-contrast":!0}},handleEvent:i.const(!0)},i.createElement("span",{class:i.const("dcg-checkbox-box")},i.createElement("i",{class:i.const("dcg-icon-check")})),i.createElement("span",{class:i.const("dcg-checkbox-label")},function(){return e.controller.t("Reverse Contrast")})),i.createElement(l,{predicate:function(){return r.versionNumber}},function(){return i.createElement("div",{class:i.const("dcg-version-number")},i.const("Version: "),function(){return r.versionNumber})})))},t.prototype.didUnmountSettingsDropdown=function(){s(document).off(".dcg-settings-view")},t.prototype.didMountSettingsDropdown=function(e){var i=this;this.settingsGroupNode=e,s(document).on("dcg-tapstart.dcg-settings-view",function(e){0===s(e.target).closest(".dcg-basic-settings-container").length&&i.controller.dispatch({type:"close-settings-menu"})}),s(document).on("keydown.dcg-settings-view",function(e){if("Esc"===o.lookup(e)&&(i.controller.dispatch({type:"close-settings-menu"}),i.controller.dispatch({type:"focus-last-expression"})),"Tab"===o.lookup(e)&&!e.altKey&&!e.metaKey&&!e.ctrlKey){var t=document.activeElement,r=s(i.props.settingsButtonNode()),n=s(i.settingsGroupNode).find(".dcg-settings-menu-option:last");e.shiftKey||t!==n[0]?e.shiftKey&&t===r[0]&&(n.focus(),e.preventDefault(),e.stopPropagation()):(r.focus(),e.preventDefault(),e.stopPropagation())}})},t.prototype.setBrailleMode=function(e){this.controller.dispatch({type:"set-braille-mode",mode:e})},t.prototype.isNemeth=function(){return"nemeth"===this.controller.getBrailleMode()},t.prototype.isUEB=function(){return"ueb"===this.controller.getBrailleMode()},t.prototype.isLatex=function(){return"none"===this.controller.getBrailleMode()},t.prototype.onToggleSixKeyInput=function(){var e=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",mode:e})},t.prototype.onToggleInvertedColors=function(){var e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})},t.prototype.onToggleProjectorMode=function(){this.controller.dispatch({type:"update-projector-mode",mode:!this.controller.isProjectorMode()})},t}(a.DCGViewBasic);t.SettingsMenu=c}),define("loadcss!basic/keypad/settings-control-button",function(){}),define("basic/keypad/settings-control-button",["require","exports","tslib","dcgview","keypad/control-btn","basic/dcgview-basic","basic/settings-menu","loadcss!./settings-control-button"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n.Components.If,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this,e=this.props.controller();return n.createElement("div",{class:n.const("dcg-basic-settings-container")},n.createElement(i.default,{didMount:function(e){return t.settingsButtonNode=e},command:this.const("settings"),ariaLabel:function(){return e.t("settings")},onTap:this.bindFn(this.onToggleSettingsMenu),selected:function(){return t.controller.isSettingsMenuOpen()},ariaPopup:this.const(!0)},n.createElement("i",{class:n.const("dcg-icon-wrench")})),n.createElement(s,{predicate:function(){return t.controller.isSettingsMenuOpen()}},function(){return n.createElement(a.SettingsMenu,{controller:t.props.controller,settingsButtonNode:function(){return t.settingsButtonNode}})}))},t.prototype.onToggleSettingsMenu=function(){this.controller.dispatch({type:"toggle-settings-menu"})},t}(o.DCGViewBasic);t.default=l}),define("basic/keypad/fourfunction-control-bar",["require","exports","tslib","dcgview","keypad/control-bar","keypad/control-btn","./settings-control-button","basic/dcgview-basic"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.Components.If,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this,t=this.props.controller();return n.createElement(i.default,{controller:this.props.controller},n.createElement(o.default,{command:this.const("undo"),disabled:function(){return!t.canUndo()},ariaLabel:function(){return t.t("undo")},onTap:function(e){return t.dispatch({type:"undo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-undo")})),n.createElement(o.default,{command:this.const("redo"),disabled:function(){return!t.canRedo()},ariaLabel:function(){return t.t("redo")},onTap:function(e){return t.dispatch({type:"redo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-redo")})),n.createElement(l,{predicate:function(){return t.shouldShowClear()}},function(){return n.createElement(o.default,{command:e.const("clear"),ariaLabel:function(){return t.t("clear")},onTap:function(){return t.dispatch({type:"clear"})}},function(){return t.t("clear")})}),n.createElement(l,{predicate:function(){return!t.shouldShowClear()}},function(){return n.createElement(o.default,{command:e.const("clearall"),disabled:function(){return!t.canClear()},ariaLabel:function(){return t.t("")},onTap:function(){return t.dispatch({type:"set-blank",opts:{allowUndo:!0}})}},function(){return t.t("")})}),n.createElement(l,{predicate:function(){return"none"===t.getBrailleMode()}},function(){return n.createElement(o.default,{command:e.const("backspace"),ariaLabel:function(){return t.t("backspace")},disabled:function(){return!t.canBackspace()},onTap:function(){return t.dispatch({type:"keypad/press-key",key:"Backspace"})}},n.createElement("i",{class:n.const("dcg-icon-delete")}))}),n.createElement(l,{predicate:function(){return e.props.controller().getSettingsMenu()}},function(){return n.createElement(a.default,{controller:e.props.controller})}))},t.prototype.onToggleSettingsMenu=function(){this.controller.dispatch({type:"toggle-settings-menu"})},t}(s.DCGViewBasic);t.default=c}),define("loadcss!keypad/control-toggle",function(){}),define("keypad/control-toggle",["require","exports","tslib","lib/aria","lib/color-helpers","dcgview","./dcgview-keypad","loadcss!./control-toggle"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return o.createElement("div",{class:function(){return{"dcg-keypad-control-toggle":!0,"dcg-toggled":e.props.toggled()}},role:o.const("button"),tabindex:o.const("0"),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.handleTap)},o.createElement("div",{class:o.const("dcg-ctrl-toggle-option")},this.props.defaultOption),o.createElement("div",{class:o.const("dcg-ctrl-toggle-option")},this.props.toggledOption),o.createElement("div",{class:o.const("dcg-ctrl-toggle-cover"),style:function(){return{background:i.shadeColor(e.controller.getBackgroundColor(),-.1)}}}))},t.prototype.getAriaLabel=function(){var e={toggled:this.props.toggledAriaLabel(),default:this.props.defaultAriaLabel()};return this.props.toggled()?this.controller.t("__toggled__ selected. Press Enter to switch to __default__.",e):this.controller.t("__default__ selected. Press Enter to switch to __toggled__.",e)},t.prototype.handleTap=function(){this.props.toggled()?n.alert(this.props.defaultAriaLabel()):n.alert(this.props.toggledAriaLabel()),this.props.onTap(this.props.command())},t}(a.default);t.default=s}),define("basic/keypad/scientific-control-bar",["require","exports","tslib","dcgview","keypad/control-bar","keypad/control-btn","basic/dcgview-basic","keypad/control-toggle","./settings-control-button"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.Components.If,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this,t=this.props.controller();return n.createElement(i.default,{controller:this.props.controller},n.createElement(o.default,{command:this.const("main"),selected:function(){return"main"===t.getKeyboardMode()},disabled:function(){return e.controller.renderAsBraille()},ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:function(){return t.dispatch({type:"main"})}},function(){return t.t("main")}),n.createElement(o.default,{command:this.const("ABC"),selected:function(){return-1!==["qwerty","capitalQwerty","letters"].indexOf(t.getKeyboardMode())},disabled:function(){return e.controller.renderAsBraille()},ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:function(){return t.t("A B C")},onTap:function(){return t.dispatch({type:"ABC"})}},function(){return t.t("abc")}),n.createElement(o.default,{command:this.const("functions"),selected:function(){return-1!==["functions","restrictedFunctions"].indexOf(t.getKeyboardMode())},ariaLabel:function(){return t.t("Functions")},disabled:function(){return e.controller.renderAsBraille()},ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:function(){return t.dispatch({type:"functions"})}},function(){return t.t("func")}),n.createElement(s.default,{command:this.const("degrees"),toggled:function(){return e.model.getDegreeMode()},defaultOption:function(){return t.t("rad")},toggledOption:function(){return t.t("deg")},defaultAriaLabel:function(){return t.t("Radians")},toggledAriaLabel:function(){return t.t("Degrees")},onTap:function(){return t.dispatch({type:"degrees"})},controller:this.props.controller}),n.createElement(c,{predicate:function(){return!e.controller.getRestrictedEditing()}},function(){return n.createElement(o.default,{command:e.const("undo"),disabled:function(){return!t.canUndo()},ariaLabel:function(){return t.t("Undo")},onTap:function(e){return t.dispatch({type:"undo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-undo")}))}),n.createElement(c,{predicate:function(){return!e.controller.getRestrictedEditing()}},function(){return n.createElement(o.default,{command:e.const("redo"),disabled:function(){return!t.canRedo()},ariaLabel:function(){return t.t("Redo")},onTap:function(e){return t.dispatch({type:"redo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-redo")}))}),n.createElement(c,{predicate:function(){return t.shouldShowClear()}},function(){return n.createElement(o.default,{command:e.const("clear"),ariaLabel:function(){return t.t("clear")},onTap:function(){return t.dispatch({type:"clear"})}},function(){return t.t("clear")})}),n.createElement(c,{predicate:function(){return!t.shouldShowClear()}},function(){return n.createElement(o.default,{command:e.const("clearall"),disabled:function(){return!t.canClear()},ariaLabel:function(){return t.t("")},onTap:function(){return t.dispatch({type:"set-blank",opts:{allowUndo:!0}})}},function(){return t.t("")})}),n.createElement(c,{predicate:function(){return e.props.controller().getSettingsMenu()}},function(){return n.createElement(l.default,{controller:e.props.controller})}))},t}(a.DCGViewBasic);t.default=u}),define("basic/keypad/single-expression-control-bar",["require","exports","tslib","dcgview","keypad/control-bar","keypad/control-btn","basic/dcgview-basic","keypad/control-toggle"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.Components.If,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this,t=this.props.controller();return n.createElement(i.default,{controller:this.props.controller},n.createElement(s.default,{command:this.const("degrees"),toggled:function(){return e.model.getDegreeMode()},defaultOption:function(){return t.t("rad")},toggledOption:function(){return t.t("deg")},defaultAriaLabel:function(){return t.t("Radians")},toggledAriaLabel:function(){return t.t("Degrees")},onTap:function(){return t.dispatch({type:"degrees"})},controller:this.props.controller}),n.createElement("div",{class:n.const("dcg-spacer")}),n.createElement(l,{predicate:function(){return!e.controller.getRestrictedEditing()}},function(){return n.createElement(o.default,{command:e.const("undo"),disabled:function(){return!t.canUndo()},ariaLabel:function(){return t.t("Undo")},onTap:function(e){return t.dispatch({type:"undo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-undo")}))}),n.createElement(l,{predicate:function(){return!e.controller.getRestrictedEditing()}},function(){return n.createElement(o.default,{command:e.const("redo"),disabled:function(){return!t.canRedo()},ariaLabel:function(){return t.t("Redo")},onTap:function(e){return t.dispatch({type:"redo",source:"keyboard"===e.device?"button-keyboard":"button-tap"})}},n.createElement("i",{class:n.const("dcg-icon-redo")}))}),n.createElement("div",{class:n.const("dcg-spacer")}),n.createElement(o.default,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:function(){return t.t("clear")},onTap:function(){return t.dispatch({type:"clear"})}},function(){return t.t("clear")}),n.createElement(o.default,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:function(){return t.t("backspace")},onTap:function(){return t.dispatch({type:"keypad/press-key",key:"Backspace"})}},n.createElement("i",{class:n.const("dcg-icon-delete")})))},t}(a.DCGViewBasic);t.default=c}),define("basic/keypad/fourfunction-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{role:n.const("group"),"aria-label":function(){return e.t("keypad")}},n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"(",{colspan:this.parenColspan()}),o.view(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),o.view(this,"/")),n.createElement(s.default,null,o.view(this,"7",{style:"highlight"}),o.view(this,"8",{style:"highlight"}),o.view(this,"9",{style:"highlight"}),o.view(this,"*")),n.createElement(s.default,null,o.view(this,"4",{style:"highlight"}),o.view(this,"5",{style:"highlight"}),o.view(this,"6",{style:"highlight"}),o.view(this,"-")),n.createElement(s.default,null,o.view(this,"1",{style:"highlight"}),o.view(this,"2",{style:"highlight"}),o.view(this,"3",{style:"highlight"}),o.view(this,"+")),n.createElement(s.default,null,o.view(this,"0",{style:"highlight"}),o.view(this,".",{style:"highlight"}),o.view(this,"ans"),o.view(this,"enter"))))},t.prototype.parenColspan=function(){return 1<this.controller.getAdditionalFunctions().length?.5:1},t.prototype.makeAdditionalFunctionKey=function(e){var t=this.controller.getAdditionalFunctions()[e];return"exponent"===t?o.view(this,"a^b"):"percent"===t?o.view(this,"%"):"sqrt"===t?o.view(this,"sqrt"):void 0},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/single-expression-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"("),o.view(this,")"),o.view(this,"x^2"),o.view(this,"sqrt"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"x^3"),o.view(this,"x^y"),o.view(this,"ythroot")),n.createElement(s.default,null,o.view(this,"7",{style:"highlight"}),o.view(this,"8",{style:"highlight"}),o.view(this,"9",{style:"highlight"}),o.view(this,"/"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"pi"),o.view(this,"e^x"),o.view(this,"!")),n.createElement(s.default,null,o.view(this,"4",{style:"highlight"}),o.view(this,"5",{style:"highlight"}),o.view(this,"6",{style:"highlight"}),o.view(this,"*"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"log"),o.view(this,"ln"),o.view(this,"|x|")),n.createElement(s.default,null,o.view(this,"1",{style:"highlight"}),o.view(this,"2",{style:"highlight"}),o.view(this,"3",{style:"highlight"}),o.view(this,"-"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"sin"),o.view(this,"cos"),o.view(this,"tan")),n.createElement(s.default,null,o.view(this,"0",{style:"highlight"}),o.view(this,".",{style:"highlight"}),o.view(this,"x/y"),o.view(this,"+"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"arcsin"),o.view(this,"arccos"),o.view(this,"arctan")))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/sci-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"7",{style:"highlight"}),o.view(this,"8",{style:"highlight"}),o.view(this,"9",{style:"highlight"}),o.view(this,"/"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"a^2"),o.view(this,"a^b"),o.view(this,"a/b"),o.view(this,"backspace",{style:"highlight"})),n.createElement(s.default,null,o.view(this,"4",{style:"highlight"}),o.view(this,"5",{style:"highlight"}),o.view(this,"6",{style:"highlight"}),o.view(this,"*"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"sqrt"),o.view(this,"nthroot"),o.view(this,"("),o.view(this,")")),n.createElement(s.default,null,o.view(this,"1",{style:"highlight"}),o.view(this,"2",{style:"highlight"}),o.view(this,"3",{style:"highlight"}),o.view(this,"-"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"sin"),o.view(this,"cos"),o.view(this,"tan"),o.view(this,"pi")),n.createElement(s.default,null,o.view(this,"0",{style:"highlight"}),o.view(this,".",{style:"highlight"}),o.view(this,"ans"),o.view(this,"+"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"|a|"),o.view(this,","),o.view(this,"%"),o.view(this,"enter",{style:"highlight"})))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/sci-qwerty-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"q"),o.view(this,"w"),o.view(this,"e"),o.view(this,"r"),o.view(this,"t"),o.view(this,"y"),o.view(this,"u"),o.view(this,"i"),o.view(this,"o"),o.view(this,"p")),n.createElement(s.default,null,n.createElement("div",{class:n.const("dcg-half-width-placeholder")}),o.view(this,"a"),o.view(this,"s"),o.view(this,"d"),o.view(this,"f"),o.view(this,"g"),o.view(this,"h"),o.view(this,"j"),o.view(this,"k"),o.view(this,"l"),n.createElement("div",{class:n.const("dcg-half-width-placeholder")})),n.createElement(s.default,null,o.view(this,"shift"),o.view(this,"z"),o.view(this,"x"),o.view(this,"c"),o.view(this,"v"),o.view(this,"b"),o.view(this,"n"),o.view(this,"m"),o.view(this,","),o.view(this,"backspace")),n.createElement(s.default,null,o.view(this,"="),o.view(this,"("),o.view(this,")"),o.view(this,"["),o.view(this,"]"),o.view(this,"!"),o.view(this,"'"),o.view(this,"pi"),o.view(this,"enter")))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/sci-letters-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"a"),o.view(this,"b"),o.view(this,"c"),o.view(this,"d"),o.view(this,"e"),o.view(this,"f"),o.view(this,"g"),o.view(this,"h"),o.view(this,"backspace",{style:"highlight"})),n.createElement(s.default,null,o.view(this,"i"),o.view(this,"j"),o.view(this,"k"),o.view(this,"l"),o.view(this,"m"),o.view(this,"n"),o.view(this,"o"),o.view(this,"p"),o.view(this,"q")),n.createElement(s.default,null,o.view(this,"r"),o.view(this,"s"),o.view(this,"t"),o.view(this,"u"),o.view(this,"v"),o.view(this,"w"),o.view(this,"x"),o.view(this,"y"),o.view(this,"z")),n.createElement(s.default,null,o.view(this,"=",{style:"highlight"}),o.view(this,"("),o.view(this,")"),o.view(this,"["),o.view(this,"]"),o.view(this,"!"),o.view(this,"'"),o.view(this,","),o.view(this,"enter",{style:"highlight"})))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/sci-capital-qwerty-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"Q"),o.view(this,"W"),o.view(this,"E"),o.view(this,"R"),o.view(this,"T"),o.view(this,"Y"),o.view(this,"U"),o.view(this,"I"),o.view(this,"O"),o.view(this,"P")),n.createElement(s.default,null,n.createElement("div",{class:n.const("dcg-half-width-placeholder")}),o.view(this,"A"),o.view(this,"S"),o.view(this,"D"),o.view(this,"F"),o.view(this,"G"),o.view(this,"H"),o.view(this,"J"),o.view(this,"K"),o.view(this,"L"),n.createElement("div",{class:n.const("dcg-half-width-placeholder")})),n.createElement(s.default,null,o.view(this,"shift",{style:"highlight"}),o.view(this,"Z"),o.view(this,"X"),o.view(this,"C"),o.view(this,"V"),o.view(this,"B"),o.view(this,"N"),o.view(this,"M"),o.view(this,","),o.view(this,"backspace",{style:"highlight"})),n.createElement(s.default,null,o.view(this,"=",{style:"highlight"}),o.view(this,"("),o.view(this,")"),o.view(this,"["),o.view(this,"]"),o.view(this,"!"),o.view(this,"'"),o.view(this,"pi"),o.view(this,"enter",{style:"highlight"})))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/sci-functions-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","keypad/keys","keypad/keypad","keypad/row"],function(e,t,r,n,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){return n.createElement(a.default,{controller:this.props.controller},n.createElement(s.default,null,o.view(this,"sin"),o.view(this,"cos"),o.view(this,"tan"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"ln"),o.view(this,"log"),o.view(this,"backspace",{style:"highlight"})),n.createElement(s.default,null,o.view(this,"arcsin"),o.view(this,"arccos"),o.view(this,"arctan"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"e^x"),o.view(this,"abs"),o.view(this,"round")),n.createElement(s.default,null,o.view(this,"mean"),o.view(this,"stdev"),o.view(this,"stdevp"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"a^b"),o.view(this,"sqrt"),o.view(this,"nthroot")),n.createElement(s.default,null,o.view(this,"nPr"),o.view(this,"nCr"),o.view(this,"!"),n.createElement("div",{class:n.const("dcg-partition-placeholder")}),o.view(this,"e"),o.view(this,"pi"),o.view(this,"enter",{style:"highlight"})))},t}(i.DCGViewBasic);t.default=l}),define("basic/keypad/scientific-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","./sci-keypad","./sci-qwerty-keypad","./sci-letters-keypad","./sci-capital-qwerty-keypad","./sci-functions-keypad"],function(e,t,r,n,i,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=n.Components.Switch,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var t=this;return n.createElement("div",{role:n.const("group"),"aria-label":function(){return t.t("keypad")}},n.createElement(u,{key:function(){return t.controller.getKeyboardMode()}},function(e){switch(e){case"qwerty":return n.createElement(a.default,{controller:t.props.controller});case"letters":return n.createElement(s.default,{controller:t.props.controller});case"capitalQwerty":return n.createElement(l.default,{controller:t.props.controller});case"functions":return n.createElement(c.default,{controller:t.props.controller});default:return n.createElement(o.default,{controller:t.props.controller})}}))},t}(i.DCGViewBasic);t.default=p}),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("abraham",[],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(r){function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i={};return n.m=r,n.c=i,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=26)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);t.map=function(e,t){var r=n.map(e,t);return e.warnings&&(r.warnings=e.warnings),r}},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(){f&&d&&(f=!1,d.length?h=d.concat(h):g=-1,h.length&&a())}function a(){if(!f){var e=i(o);f=!0;for(var t=h.length;t;){for(d=h,h=[];++g<t;)d&&d[g].run();g=-1,t=h.length}d=null,f=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var c,u,p=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(e){u=n}}();var d,h=[],f=!1,g=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new s(e,t)),1!==h.length||f||i(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,r){function i(e){var t=e.sort(function(e,t){return e.length-t.length||e.localeCompare(t)}).join("|");return new RegExp("("+t+")","g")}Object.defineProperty(t,"__esModule",{value:!0});var s,n=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","ceil","corr","cov","csch","distance","floor","gcf","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","nPr","polygon","quantile","quartile","round","sech","sign","signum","stddev","stddevp","stdDev","stdDevP","stdev","stdevp","total","var","variance","varp"],o=n,a=i(n);t.getAutoOperator=function(e){for(var t,r=0,n="",i=0,o=e;i<o.length;i++){var a=o[i];if("terminal"!==a.type||!/[A-Za-z]/.test(a.value))break;n+=a.value,r++}return t=n.replace(s,"\\operatorname{$1}"),{modified:0<r&&t!==n,terminalCount:r,value:t}},t.containsValue=function(e){return-1!==o.indexOf(e.toLowerCase())},t.setOperatorNames=function(e){if(!Array.isArray(e))throw new Error("Operator names must be an array, got "+typeof e);for(var t=0,r=e;t<r.length;t++){var n=r[t];if("string"!=typeof n)throw new Error("Operator names must be strings, found "+typeof n)}s=i(o=e)},t.resetOperatorNames=function(){o=n,s=a}},function(e,r,t){function n(e){if(!u.isSixDotCells(e))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}Object.defineProperty(r,"__esModule",{value:!0});var i=t(2),o=t(14),a=t(15),s=t(16),l=t(0),c=t(23),u=t(25);r.nemethToLatex=function(e,t){return n(e),s.default(r.UnicodeBraille.toBrailleAscii(e),t)},r.latexToNemeth=function(e,t){return t&&t.operatorNames?i.setOperatorNames(t.operatorNames):i.resetOperatorNames(),l.map(o.default(e),r.UnicodeBraille.coerceToSixDotCells)},r.uebToLatex=function(e,t){return n(e),c.default(r.UnicodeBraille.toBrailleAscii(e),t)},r.latexToUeb=function(e,t){return t&&t.operatorNames?i.setOperatorNames(t.operatorNames):i.resetOperatorNames(),l.map(a.default(e),r.UnicodeBraille.coerceToSixDotCells)},r.UnicodeBraille={coerceToSixDotCells:u.coerceToSixDotCells,toBrailleAscii:u.toBrailleAscii,toExpandedBrailleAscii:u.toExpandedBrailleAscii},r.version="1.0.3"},function(e,t){},function(e,c,t){(function(i){function o(e,t){for(var r=0,n=e.length-1;0<=n;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function a(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return t.exec(e).slice(1)};c.resolve=function(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){var n=0<=r?arguments[r]:i.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return(t?"/":"")+(e=o(a(e.split("/"),function(e){return!!e}),!t).join("/"))||"."},c.normalize=function(e){var t=c.isAbsolute(e),r="/"===n(e,-1);return(e=o(a(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},c.isAbsolute=function(e){return"/"===e.charAt(0)},c.join=function(){var e=Array.prototype.slice.call(arguments,0);return c.normalize(a(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},c.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=c.resolve(e).substr(1),t=c.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),o=Math.min(n.length,i.length),a=o,s=0;s<o;s++)if(n[s]!==i[s]){a=s;break}var l=[];for(s=a;s<n.length;s++)l.push("..");return(l=l.concat(i.slice(a))).join("/")},c.sep="/",c.delimiter=":",c.dirname=function(e){var t=s(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},c.basename=function(e,t){var r=s(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},c.extname=function(e){return s(e)[3]};var n="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(c,t(1))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e.hash)throw e;return{_diagnostic:{expected:e.hash.expected,message:e.message,text:e.hash.text,token:e.hash.token},location:e.hash.loc}}},function(e,t,r){function a(e){return{type:"command",value:e}}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Array.prototype.concat.apply([],e)}Object.defineProperty(t,"__esModule",{value:!0}),t.terminal=function(e){return{type:"terminal",value:e}},t.command=a,t.greek=function(e){return{type:"greek",value:e}},t.level=function(e){return{subscript:e._,superscript:e["^"],type:"level"}},t.processPrimes=function(e,t){var r=[],n=e.match(/'+/);if(null!==n)for(var i=n[0].length,o=0;o<i;o++)r.push(a("\\prime"));return s(r,t)},t.fraction=function(e,t){return{type:"fraction",numerator:e,denominator:t}},t.typeform=function(e,t){return{name:e,type:"typeform",value:t}},t.radical=function(e,t){return{type:"radical",index:t,radicand:e}},t.group=s},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,n,i){(function(r,e){var t=function(){function e(){this.yy={}}var t=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},r=[1,11],n=[1,12],i=[1,13],o=[1,69],a=[1,70],s=[1,68],l=[1,38],c=[1,39],u=[1,58],p=[1,59],d=[1,60],h=[1,61],f=[1,62],g=[1,63],m=[1,64],y=[1,65],v=[1,66],b=[1,67],x=[1,40],w=[1,34],_=[1,35],S=[1,36],E=[1,37],M=[1,41],I=[1,42],T=[1,43],C=[1,44],k=[1,45],P=[1,46],D=[1,47],A=[1,48],L=[1,49],O=[1,50],q=[1,51],F=[1,52],N=[1,17],R=[1,53],B=[1,54],j=[1,55],V=[1,56],U=[1,57],z=[5,11,12,13,17,23,24],G=[5,10,11,12,13,14,16,17,19,20,22,23,24,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,81],H=[5,10,11,12,13,14,16,17,19,20,22,23,24,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,81],W=[1,75],K=[5,10,11,12,13,14,16,17,19,20,22,23,24,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81],Y={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,OPEN_MODEXP:10,MODEXP_UNDER:11,MODEXP_OVER:12,CLOSE_MODEXP:13,RADICAL_INDEX:14,index_group:15,OPEN_RADICAL:16,CLOSE_RADICAL:17,level:18,LEVEL:19,BASELINE:20,frac:21,OPEN_FRAC:22,SLASH:23,CLOSE_FRAC:24,subscript_head:25,primes:26,number:27,atom:28,command:29,greek:30,letter:31,comma:32,period:33,space:34,operation:35,comparison:36,level_with_comparison:37,ellipsis:38,colon:39,infinity:40,integral:41,factorial:42,ampersand:43,question_mark:44,bracket:45,",":46,".":47,"[":48,"{":49,"(":50,"]":51,"}":52,")":53,LANGLE:54,RANGLE:55,PIPE:56,DOUBLE_PIPE:57,SPACE:58,COMMAND:59,GREEK:60,LETTER:61,CAPITAL_LETTER:62,"+":63,"-":64,CDOT:65,TIMES:66,"*":67,"/":68,DIV:69,PERCENT:70,COMPARISON:71,LEVEL_WITH_COMPARISON:72,ELLIPSIS:73,COLON:74,NUMBER:75,INFINITY:76,INTEGRAL:77,FACTORIAL:78,"&":79,PRIMES:80,"?":81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"OPEN_MODEXP",11:"MODEXP_UNDER",12:"MODEXP_OVER",13:"CLOSE_MODEXP",14:"RADICAL_INDEX",16:"OPEN_RADICAL",17:"CLOSE_RADICAL",19:"LEVEL",20:"BASELINE",22:"OPEN_FRAC",23:"SLASH",24:"CLOSE_FRAC",46:",",47:".",48:"[",49:"{",50:"(",51:"]",52:"}",53:")",54:"LANGLE",55:"RANGLE",56:"PIPE",57:"DOUBLE_PIPE",58:"SPACE",59:"COMMAND",60:"GREEK",61:"LETTER",62:"CAPITAL_LETTER",63:"+",64:"-",65:"CDOT",66:"TIMES",67:"*",68:"/",69:"DIV",70:"PERCENT",71:"COMPARISON",72:"LEVEL_WITH_COMPARISON",73:"ELLIPSIS",74:"COLON",75:"NUMBER",76:"INFINITY",77:"INTEGRAL",78:"FACTORIAL",79:"&",80:"PRIMES",81:"?"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[18,1],[18,1],[21,5],[21,4],[21,4],[21,3],[15,2],[15,1],[7,3],[7,2],[7,2],[7,2],[7,2],[7,1],[7,1],[7,1],[25,1],[25,1],[25,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[32,1],[33,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[34,1],[29,1],[30,1],[31,1],[31,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[36,1],[37,1],[38,1],[39,1],[27,1],[40,1],[41,1],[42,1],[43,1],[26,1],[44,1]],performAction:function(e,t,r,n,i,o,a){var s=o.length-1;switch(i){case 1:return o[s-1];case 2:return n.group();case 3:case 29:case 33:case 34:case 35:this.$=n.group(o[s-1],o[s]);break;case 4:case 30:this.$=n.group(o[s]);break;case 8:this.$=n.modified_expression(o[s-5],o[s-3],o[s-1]);break;case 9:this.$=n.modified_expression(o[s-4],o[s-2]);break;case 10:this.$=n.modified_expression(o[s-3],o[s-1]);break;case 11:this.$=n.modified_expression(o[s-4],n.group(),o[s-1]);break;case 12:this.$=n.modified_expression(o[s-3],n.group(),o[s-1]);break;case 13:this.$=n.modified_expression(o[s-3],n.group(),n.group());break;case 14:this.$=n.modified_expression(o[s-2],n.group());break;case 15:this.$=n.modified_expression(o[s-1]);break;case 16:this.$=n.modified_expression(n.group());break;case 17:this.$=n.radical(o[s-1],o[s-3]);break;case 18:this.$=n.radical(o[s-1],n.group());break;case 19:this.$=n.radical(n.group(),o[s-2]);break;case 20:this.$=n.radical(n.group(),n.group());break;case 21:this.$=n.radical(o[s-1]);break;case 22:this.$=n.radical(n.group());break;case 23:this.$=n.level(o[s]);break;case 24:this.$=n.baseline();break;case 25:this.$=n.fraction(o[s-3],o[s-1]);break;case 26:this.$=n.fraction(o[s-2],n.group());break;case 27:this.$=n.fraction(n.group(),o[s-1]);break;case 28:this.$=n.fraction(n.group(),n.group());break;case 31:this.$=n.group(n.simple_subscript(o[s-2],o[s]),o[s-1]);break;case 32:this.$=n.simple_subscript(o[s-1],o[s]);break;case 58:this.$=n.terminal(",");break;case 59:this.$=n.terminal(".");break;case 60:this.$=n.terminal("[");break;case 61:this.$=n.terminal("\\{");break;case 62:this.$=n.terminal("(");break;case 63:this.$=n.terminal("]");break;case 64:this.$=n.terminal("\\}");break;case 65:this.$=n.terminal(")");break;case 66:this.$=n.terminal("\\langle ");break;case 67:this.$=n.terminal("\\rangle ");break;case 68:this.$=n.terminal("|");break;case 69:this.$=n.terminal("\\|");break;case 70:this.$=n.terminal(" ");break;case 71:this.$=n.command(o[s].toLowerCase());break;case 72:this.$=n.terminal(n.greek(o[s]));break;case 73:this.$=n.terminal(o[s].toLowerCase());break;case 74:this.$=n.terminal(o[s].toUpperCase());break;case 75:this.$=n.terminal("+");break;case 76:this.$=n.terminal("-");break;case 77:this.$=n.terminal("\\cdot ");break;case 78:this.$=n.terminal("\\times ");break;case 79:this.$=n.terminal("*");break;case 80:this.$=n.terminal("/");break;case 81:this.$=n.terminal("\\div ");break;case 82:this.$=n.terminal("\\%");break;case 83:this.$=n.comparison(o[s].trim());break;case 84:this.$=n.level_with_comparison(o[s].trim());break;case 85:this.$=n.terminal("\\ldots ");break;case 86:this.$=n.terminal(":");break;case 87:this.$=n.terminal(o[s]);break;case 88:this.$=n.terminal("\\infty ");break;case 89:this.$=n.terminal("\\int ");break;case 90:this.$=n.terminal("!");break;case 91:this.$=n.terminal("\\&");break;case 92:this.$=n.primes(o[s]);break;case 93:this.$=n.terminal("?")}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:r,14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{1:[3]},{5:[1,71]},{1:[2,2]},t(z,[2,4],{6:4,7:5,8:6,9:7,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,21:32,18:33,4:72,10:r,14:n,16:i,19:o,20:a,22:s,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U}),t(G,[2,5]),t(G,[2,6]),t(G,[2,7]),t(H,[2,36],{26:73,27:74,75:N,80:W}),t(G,[2,37],{26:76,80:W}),t(G,[2,38],{26:77,80:W}),{4:78,6:4,7:5,8:6,9:7,10:r,13:[1,79],14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{7:82,15:80,16:[1,81],18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{4:83,6:4,7:5,8:6,9:7,10:r,14:n,16:i,17:[1,84],18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(K,[2,39]),t(K,[2,40]),t(K,[2,41]),t(K,[2,87]),t(K,[2,42]),t(K,[2,43]),t(K,[2,44]),t(K,[2,45]),t(K,[2,46]),t(K,[2,47]),t(K,[2,48]),t(K,[2,49]),t(K,[2,50]),t(K,[2,51]),t(K,[2,52]),t(K,[2,53]),t(K,[2,54]),t(K,[2,55]),t(K,[2,56]),t(K,[2,57]),t(K,[2,71]),t(K,[2,72]),t(K,[2,73]),t(K,[2,74]),t(K,[2,58]),t(K,[2,59]),t(K,[2,70]),t(K,[2,75]),t(K,[2,76]),t(K,[2,77]),t(K,[2,78]),t(K,[2,79]),t(K,[2,80]),t(K,[2,81]),t(K,[2,82]),t(K,[2,83]),t(K,[2,84]),t(K,[2,85]),t(K,[2,86]),t(K,[2,88]),t(K,[2,89]),t(K,[2,90]),t(K,[2,91]),t(K,[2,93]),t(K,[2,60]),t(K,[2,61]),t(K,[2,62]),t(K,[2,63]),t(K,[2,64]),t(K,[2,65]),t(K,[2,66]),t(K,[2,67]),t(K,[2,68]),t(K,[2,69]),{4:85,6:4,7:5,8:6,9:7,10:r,14:n,16:i,18:33,19:o,20:a,21:32,22:s,23:[1,86],25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(K,[2,23]),t(K,[2,24]),{1:[2,1]},t(z,[2,3]),t(H,[2,33],{27:87,75:N}),t(G,[2,32]),t(G,[2,92]),t(G,[2,34]),t(G,[2,35]),{11:[1,88],12:[1,89],13:[1,90]},t(G,[2,16]),{16:[1,91]},{4:92,6:4,7:5,8:6,9:7,10:r,14:n,16:i,17:[1,93],18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{7:82,15:94,16:[2,30],18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{17:[1,95]},t(G,[2,22]),{23:[1,96]},{4:97,6:4,7:5,8:6,9:7,10:r,14:n,16:i,18:33,19:o,20:a,21:32,22:s,24:[1,98],25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(G,[2,31]),{4:99,6:4,7:5,8:6,9:7,10:r,12:[1,100],13:[1,101],14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{4:102,6:4,7:5,8:6,9:7,10:r,14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(G,[2,15]),{4:103,6:4,7:5,8:6,9:7,10:r,14:n,16:i,17:[1,104],18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{17:[1,105]},t(G,[2,20]),{16:[2,29]},t(G,[2,21]),{4:106,6:4,7:5,8:6,9:7,10:r,14:n,16:i,18:33,19:o,20:a,21:32,22:s,24:[1,107],25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},{24:[1,108]},t(K,[2,28]),{12:[1,109],13:[1,110]},{4:111,6:4,7:5,8:6,9:7,10:r,13:[1,112],14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(G,[2,14]),{13:[1,113]},{17:[1,114]},t(G,[2,19]),t(G,[2,18]),{24:[1,115]},t(K,[2,26]),t(K,[2,27]),{4:116,6:4,7:5,8:6,9:7,10:r,13:[1,117],14:n,16:i,18:33,19:o,20:a,21:32,22:s,25:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:l,47:c,48:u,49:p,50:d,51:h,52:f,53:g,54:m,55:y,56:v,57:b,58:x,59:w,60:_,61:S,62:E,63:M,64:I,65:T,66:C,67:k,68:P,69:D,70:A,71:L,72:O,73:q,74:F,75:N,76:R,77:B,78:j,79:V,81:U},t(G,[2,10]),{13:[1,118]},t(G,[2,13]),t(G,[2,12]),t(G,[2,17]),t(K,[2,25]),{13:[1,119]},t(G,[2,9]),t(G,[2,11]),t(G,[2,8])],defaultActions:{3:[2,2],71:[2,1],94:[2,29]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],o=this.table,a="",s=0,l=0,c=0,u=i.slice.call(arguments,1),p=Object.create(this.lexer),d={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(d.yy[h]=this.yy[h]);p.setInput(e,d.yy),d.yy.lexer=p,d.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var f=p.yylloc;i.push(f);var g,m=p.options&&p.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,v,b,x,w,_,S,E,M,I={};;){if(b=r[r.length-1],void 0===(x=this.defaultActions[b]?this.defaultActions[b]:(null!=y||(g=void 0,"number"!=typeof(g=p.lex()||1)&&(g=t.symbols_[g]||g),y=g),o[b]&&o[b][y]))||!x.length||!x[0]){var T;for(_ in M=[],o[b])this.terminals_[_]&&2<_&&M.push("'"+this.terminals_[_]+"'");T=p.showPosition?"Parse error on line "+(s+1)+":\n"+p.showPosition()+"\nExpecting "+M.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(s+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(T,{text:p.match,token:this.terminals_[y]||y,line:p.yylineno,loc:f,expected:M})}if(x[0]instanceof Array&&1<x.length)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(x[0]){case 1:r.push(y),n.push(p.yytext),i.push(p.yylloc),r.push(x[1]),y=null,v?(y=v,v=null):(l=p.yyleng,a=p.yytext,s=p.yylineno,f=p.yylloc,0<c&&c--);break;case 2:if(S=this.productions_[x[1]][1],I.$=n[n.length-S],I._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},m&&(I._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),void 0!==(w=this.performAction.apply(I,[a,l,s,d.yy,x[1],n,i].concat(u))))return w;S&&(r=r.slice(0,-1*S*2),n=n.slice(0,-1*S),i=i.slice(0,-1*S)),r.push(this.productions_[x[1]][0]),n.push(I.$),i.push(I._$),E=o[r[r.length-2]][r[r.length-1]],r.push(E);break;case 3:return!0}}return!0}},X={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return 0<=(e=this.conditionStack.length-1-Math.abs(e||0))?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:return this.begin("modexp"),10;case 1:return 20;case 2:return this.begin("modexp"),10;case 3:return 11;case 4:return 12;case 5:return this.popState(),13;case 6:return 63;case 7:return 64;case 8:return 65;case 9:return 66;case 10:return 67;case 11:return 68;case 12:return 69;case 13:return 54;case 14:return 48;case 15:return 49;case 16:return 50;case 17:return 55;case 18:return 51;case 19:return 52;case 20:return 53;case 21:return 57;case 22:return 56;case 23:return 74;case 24:return 70;case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:return 72;case 33:return 71;case 34:case 35:return 72;case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:return 71;case 45:return 73;case 46:return 19;case 47:return 47;case 48:return 20;case 49:return 80;case 50:return 60;case 51:return 14;case 52:return this.begin("radical"),16;case 53:return this.popState(),17;case 54:return 17;case 55:return 77;case 56:return 79;case 57:return 78;case 58:case 59:return 59;case 60:return t.yytext=this.matches[1],75;case 61:return 22;case 62:return 23;case 63:return 24;case 64:return t.yytext=this.matches[1],62;case 65:return 61;case 66:return 76;case 67:return 81;case 68:return 46;case 69:return 47;case 70:return 58;case 71:return 5}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][\/])/,/^(?:[.][\/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[\/][.]K[ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[\/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[\/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][\/][.]K[ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[@][:])/,/^(?:[ ][\/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]?['][']['][ ]?)/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[\/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71],inclusive:!0}}};return Y.lexer=X,new((e.prototype=Y).Parser=e)}();n.parser=t,n.Parser=t.Parser,n.parse=function(){return t.parse.apply(t,arguments)},n.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),r.exit(1));var t=i(4).readFileSync(i(5).normalize(e[1]),"utf8");return n.parser.parse(t)},void 0!==e&&i.c[i.s]===e&&n.main(r.argv.slice(1))}).call(n,i(1),i(8)(e))},function(e,n,i){(function(r,e){var t=function(){function e(){this.yy={}}var t=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},r=[1,15],n=[1,16],i=[1,17],o=[1,36],a=[1,18],s=[1,37],l=[1,38],c=[1,14],u=[1,46],p=[1,47],d=[1,39],h=[1,40],f=[1,41],g=[1,56],m=[1,42],y=[1,43],v=[1,44],b=[1,45],x=[1,54],w=[1,55],_=[1,57],S=[1,58],E=[1,59],M=[1,60],I=[1,61],T=[1,62],C=[1,63],k=[1,64],P=[1,65],D=[1,66],A=[1,67],L=[1,68],O=[1,69],q=[1,70],F=[1,71],N=[1,72],R=[1,73],B=[1,74],j=[1,48],V=[1,49],U=[1,50],z=[1,51],G=[1,52],H=[1,75],W=[1,53],K=[5,14,18,19,29,52,53,54],Y=[5,10,13,14,15,18,19,29,52,53,54],X=[5,10,13,14,15,17,18,19,21,23,24,28,29,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86],$=[1,83],Q=[1,84],Z=[1,85],J=[10,13,15,17,21,23,24,28,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86],ee={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,atom:25,lbracket:26,rbracket:27,OPEN_GROUP:28,CLOSE_GROUP:29,command:30,greek:31,letter:32,comma:33,period:34,colon:35,infinity:36,integral:37,factorial:38,ampersand:39,question_mark:40,bracket:41,space:42,operation:43,comparison:44,ellipsis:45,primes:46,",":47,".":48,"[":49,"{":50,"(":51,"]":52,"}":53,")":54,SPACE:55,COMMAND:56,GREEK:57,CAPITAL_LETTER:58,LETTER:59,PIPE:60,DOUBLE_PIPE:61,"+":62,"-":63,CDOT:64,TIMES:65,"*":66,DIV:67,SLASH:68,PERCENT:69,"=":70,NEQ:71,"<":72,">":73,LEQ:74,GEQ:75,TILDE:76,PARALLEL:77,PERPENDICULAR:78,ELLIPSIS:79,COLON:80,INFINITY:81,INTEGRAL:82,FACTORIAL:83,"&":84,PRIMES:85,"?":86,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",28:"OPEN_GROUP",29:"CLOSE_GROUP",47:",",48:".",49:"[",50:"{",51:"(",52:"]",53:"}",54:")",55:"SPACE",56:"COMMAND",57:"GREEK",58:"CAPITAL_LETTER",59:"LETTER",60:"PIPE",61:"DOUBLE_PIPE",62:"+",63:"-",64:"CDOT",65:"TIMES",66:"*",67:"DIV",68:"SLASH",69:"PERCENT",70:"=",71:"NEQ",72:"<",73:">",74:"LEQ",75:"GEQ",76:"TILDE",77:"PARALLEL",78:"PERPENDICULAR",79:"ELLIPSIS",80:"COLON",81:"INFINITY",82:"INTEGRAL",83:"FACTORIAL",84:"&",85:"PRIMES",86:"?"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[33,1],[34,1],[26,1],[26,1],[26,1],[27,1],[27,1],[27,1],[42,1],[30,1],[31,1],[32,1],[32,1],[41,1],[41,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[45,1],[35,1],[36,1],[37,1],[38,1],[39,1],[46,1],[40,1]],performAction:function(e,t,r,n,i,o,a){var s=o.length-1;switch(i){case 1:return o[s-1];case 2:return n.group();case 3:case 35:this.$=n.group(o[s-2],o[s-1],o[s]);break;case 4:case 6:case 31:case 32:case 36:this.$=n.group(o[s-1],o[s]);break;case 5:case 7:case 33:case 34:this.$=n.group(o[s]);break;case 10:case 11:case 12:this.$=n.basic_level(o[s-1],n.group(o[s]));break;case 13:case 17:this.$=n.radical(o[s-1],n.group(o[s-2]));break;case 14:case 15:this.$=n.radical(n.group(),n.group(o[s-1]));break;case 16:this.$=n.radical(n.group(),n.group());break;case 18:this.$=n.radical(o[s-1]);break;case 19:this.$=n.radical(n.group());break;case 20:this.$=n.fraction(o[s-3],o[s-1]);break;case 21:this.$=n.fraction(o[s-2],n.group());break;case 22:this.$=n.fraction(n.group(),o[s-1]);break;case 23:case 24:this.$=n.fraction(n.group(),n.group());break;case 25:this.$=n.fraction(n.group(n.terminal(n.to_number(o[s-1]))),n.group(n.terminal(n.to_number(o[s]))));break;case 26:this.$=n.fraction(n.group(n.terminal(n.to_number(o[s]))),n.group());break;case 27:this.$=n.fraction(n.group(),n.group(n.terminal(n.to_number(o[$01]))));break;case 37:this.$=n.group(o[s-1]);break;case 38:this.$=n.group();break;case 39:this.$=n.terminal(n.to_number(o[s]));break;case 57:this.$=n.terminal(",");break;case 58:this.$=n.terminal(".");break;case 59:this.$=n.terminal("[");break;case 60:this.$=n.terminal("\\{");break;case 61:this.$=n.terminal("(");break;case 62:this.$=n.terminal("]");break;case 63:this.$=n.terminal("\\}");break;case 64:this.$=n.terminal(")");break;case 65:this.$=n.terminal(" ");break;case 66:this.$=n.command("\\"+o[s].trim().toLowerCase());break;case 67:this.$=n.terminal(n.greek(o[s]));break;case 68:this.$=n.terminal(o[s].toUpperCase());break;case 69:this.$=n.terminal(o[s].toLowerCase());break;case 70:this.$=n.terminal("|");break;case 71:this.$=n.terminal("\\|");break;case 72:this.$=n.terminal("+");break;case 73:this.$=n.terminal("-");break;case 74:this.$=n.terminal("\\cdot ");break;case 75:this.$=n.terminal("\\times ");break;case 76:this.$=n.terminal("*");break;case 77:this.$=n.terminal("\\div ");break;case 78:this.$=n.terminal("/");break;case 79:this.$=n.terminal("\\%");break;case 80:this.$=n.terminal("=");break;case 81:this.$=n.terminal("\\neq ");break;case 82:this.$=n.terminal("<");break;case 83:this.$=n.terminal(">");break;case 84:this.$=n.terminal("\\leq ");break;case 85:this.$=n.terminal("\\geq ");break;case 86:this.$=n.terminal("\\sim ");break;case 87:this.$=n.terminal("\\parallel ");break;case 88:this.$=n.terminal("\\perp ");break;case 89:this.$=n.terminal("\\ldots ");break;case 90:this.$=n.terminal(":");break;case 91:this.$=n.terminal("\\infty ");break;case 92:this.$=n.terminal("\\int ");break;case 93:this.$=n.terminal("!");break;case 94:this.$=n.terminal("\\&");break;case 95:this.$=n.primes(o[s]);break;case 96:this.$=n.terminal("?")}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{1:[3]},{5:[1,76]},{1:[2,2]},t(K,[2,5],{8:8,9:9,7:77,10:r,13:n,15:i}),t(K,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:78,10:r,13:n,15:i,17:o,21:a,23:s,24:l,28:c,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W}),t(Y,[2,33],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:79,17:o,21:a,23:s,24:l,28:c,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W}),t(Y,[2,34],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:80,17:o,21:a,23:s,24:l,28:c,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W}),t(X,[2,8]),t(X,[2,9]),t(X,[2,28]),t(X,[2,29]),t(X,[2,30]),{4:81,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,27:82,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,52:$,53:Q,54:Z,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{4:86,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,29:[1,87],30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{9:90,11:88,12:89,13:n,15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{11:91,12:92,14:[1,93],16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{4:94,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,14:[1,95],15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},t(X,[2,39],{22:[1,96]}),t(X,[2,40]),t(X,[2,41]),t(X,[2,42]),t(X,[2,43]),t(X,[2,44]),t(X,[2,45]),t(X,[2,46]),t(X,[2,47]),t(X,[2,48]),t(X,[2,49]),t(X,[2,50]),t(X,[2,51]),t(X,[2,52]),t(X,[2,53]),t(X,[2,54]),t(X,[2,55]),t(X,[2,56]),{4:97,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,18:[1,98],19:[1,99],20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},t(X,[2,26]),t(X,[2,27]),t(J,[2,59]),t(J,[2,60]),t(J,[2,61]),t(X,[2,66]),t(X,[2,67]),t(X,[2,68]),t(X,[2,69]),t(X,[2,57]),t(X,[2,58]),t(X,[2,90]),t(X,[2,91]),t(X,[2,92]),t(X,[2,93]),t(X,[2,94]),t(X,[2,96]),t(X,[2,70]),t(X,[2,71]),t(X,[2,65]),t(X,[2,72]),t(X,[2,73]),t(X,[2,74]),t(X,[2,75]),t(X,[2,76]),t(X,[2,77]),t(X,[2,78]),t(X,[2,79]),t(X,[2,80]),t(X,[2,81]),t(X,[2,82]),t(X,[2,83]),t(X,[2,84]),t(X,[2,85]),t(X,[2,86]),t(X,[2,87]),t(X,[2,88]),t(X,[2,89]),t(X,[2,95]),{1:[2,1]},t(K,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:100,10:r,13:n,15:i,17:o,21:a,23:s,24:l,28:c,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W}),t(K,[2,6]),t(Y,[2,31]),t(Y,[2,32]),{27:101,52:$,53:Q,54:Z},t(X,[2,36]),t(X,[2,62]),t(X,[2,63]),t(X,[2,64]),{29:[1,102]},t(X,[2,38]),t(X,[2,10]),t(X,[2,11]),t(X,[2,12]),{4:103,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,14:[1,104],15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{4:106,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,14:[1,105],15:i,16:11,17:o,20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},t(X,[2,16]),{14:[1,107]},t(X,[2,19]),t(X,[2,25]),{18:[1,108]},{4:109,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,19:[1,110],20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},t(X,[2,24]),t(K,[2,3]),t(X,[2,35]),t(X,[2,37]),{14:[1,111]},t(X,[2,15]),t(X,[2,14]),{14:[1,112]},t(X,[2,18]),{4:113,6:4,7:5,8:8,9:9,10:r,11:6,12:7,13:n,15:i,16:11,17:o,19:[1,114],20:12,21:a,23:s,24:l,25:10,26:13,28:c,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:u,48:p,49:d,50:h,51:f,55:g,56:m,57:y,58:v,59:b,60:x,61:w,62:_,63:S,64:E,65:M,66:I,67:T,68:C,69:k,70:P,71:D,72:A,73:L,74:O,75:q,76:F,77:N,78:R,79:B,80:j,81:V,82:U,83:z,84:G,85:H,86:W},{19:[1,115]},t(X,[2,23]),t(X,[2,13]),t(X,[2,17]),{19:[1,116]},t(X,[2,21]),t(X,[2,22]),t(X,[2,20])],defaultActions:{3:[2,2],76:[2,1]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],o=this.table,a="",s=0,l=0,c=0,u=i.slice.call(arguments,1),p=Object.create(this.lexer),d={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(d.yy[h]=this.yy[h]);p.setInput(e,d.yy),d.yy.lexer=p,d.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var f=p.yylloc;i.push(f);var g,m=p.options&&p.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,v,b,x,w,_,S,E,M,I={};;){if(b=r[r.length-1],void 0===(x=this.defaultActions[b]?this.defaultActions[b]:(null!=y||(g=void 0,"number"!=typeof(g=p.lex()||1)&&(g=t.symbols_[g]||g),y=g),o[b]&&o[b][y]))||!x.length||!x[0]){var T;for(_ in M=[],o[b])this.terminals_[_]&&2<_&&M.push("'"+this.terminals_[_]+"'");T=p.showPosition?"Parse error on line "+(s+1)+":\n"+p.showPosition()+"\nExpecting "+M.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(s+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(T,{text:p.match,token:this.terminals_[y]||y,line:p.yylineno,loc:f,expected:M})}if(x[0]instanceof Array&&1<x.length)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(x[0]){case 1:r.push(y),n.push(p.yytext),i.push(p.yylloc),r.push(x[1]),y=null,v?(y=v,v=null):(l=p.yyleng,a=p.yytext,s=p.yylineno,f=p.yylloc,0<c&&c--);break;case 2:if(S=this.productions_[x[1]][1],I.$=n[n.length-S],I._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},m&&(I._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),void 0!==(w=this.performAction.apply(I,[a,l,s,d.yy,x[1],n,i].concat(u))))return w;S&&(r=r.slice(0,-1*S*2),n=n.slice(0,-1*S),i=i.slice(0,-1*S)),r.push(this.productions_[x[1]][0]),n.push(I.$),i.push(I._$),E=o[r[r.length-2]][r[r.length-1]],r.push(E);break;case 3:return!0}}return!0}},te={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return 0<=(e=this.conditionStack.length-1-Math.abs(e||0))?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:return void this.begin("captext");case 1:return 58;case 2:return this.popState(),58;case 3:return 62;case 4:return 63;case 5:return 64;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 49;case 10:return 50;case 11:return 51;case 12:return 52;case 13:return 53;case 14:return 54;case 15:return 71;case 16:return 74;case 17:return 75;case 18:return 70;case 19:return 72;case 20:return 73;case 21:return 76;case 22:return 69;case 23:return 79;case 24:return 13;case 25:return 15;case 26:return 14;case 27:return 10;case 28:return 28;case 29:return 29;case 30:return 82;case 31:return 83;case 32:return 84;case 33:return 17;case 34:return 18;case 35:return 19;case 36:return 77;case 37:return 78;case 38:return 81;case 39:return t.yytext=this.matches[1],21;case 40:return t.yytext=this.matches[1],22;case 41:return t.yytext=this.matches[1],24;case 42:return 68;case 43:return 47;case 44:return 48;case 45:return 85;case 46:return 61;case 47:return 60;case 48:return 80;case 49:case 50:return 56;case 51:return 57;case 52:return t.yytext=this.matches[1],58;case 53:return 59;case 54:return;case 55:return 86;case 56:return;case 57:return 55;case 58:return 5}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][\/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9])/,/^(?:[.][0])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+)/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][\/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[\/]([A-J4]+))/,/^(?:[#][\/]([A-J4]+))/,/^(?:[_]?[\/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],inclusive:!0}}};return ee.lexer=te,new((e.prototype=ee).Parser=e)}();n.parser=t,n.Parser=t.Parser,n.parse=function(){return t.parse.apply(t,arguments)},n.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),r.exit(1));var t=i(4).readFileSync(i(5).normalize(e[1]),"utf8");return n.parser.parse(t)},void 0!==e&&i.c[i.s]===e&&n.main(r.argv.slice(1))}).call(n,i(1),i(8)(e))},function(e,t,r){function s(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];t.push(u.terminal(i))}return t}function l(e){for(var t=0,r=0;r<Math.min(3,e.length);r++){var n=e[r];"terminal"===n.type&&"."===n.value&&t++}return 3===t}Object.defineProperty(t,"__esModule",{value:!0});var c=r(2),u=r(7),p={"~":"\\ "},d={"\\,":"\\ ","\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},h={"\\space":!0};t.default=function e(t){for(var r=[],n=0;n<t.length;n++){var i=t[n];switch(i.type){case"command":var o=i.value.slice(1).trim();d.hasOwnProperty(i.value)?r.push(u.command(d[i.value])):c.containsValue(o)?r.push(u.typeform("operator_name",s(o))):h[i.value]||r.push(i);break;case"level":var a={subscript:i.subscript&&0<i.subscript.length?e(i.subscript):void 0,superscript:i.superscript&&0<i.superscript.length?e(i.superscript):void 0,type:i.type};(a.subscript||a.superscript)&&r.push(a);break;case"fraction":r.push({denominator:e(i.denominator),numerator:e(i.numerator),type:i.type});break;case"radical":r.push({index:i.index?e(i.index):void 0,radicand:e(i.radicand),type:i.type});break;case"terminal":l(t.slice(n))?(r.push({type:"command",value:"\\ldots"}),n+=2):r.push({type:i.type,value:p.hasOwnProperty(i.value)?p[i.value]:i.value});break;case"typeform":r.push(i);break;case"greek":r.push({type:i.type,value:p.hasOwnProperty(i.value)?p[i.value]:i.value});break;default:throw new Error("Unexpected item:\n"+JSON.stringify({group:t,item:i}))}}return r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(13),o=r(7);i.parser.yy=o,t.default=function(e){try{return{isError:!1,value:i.parser.parse(e)}}catch(e){return{isError:!0,error:n.default(e)}}}},function(e,n,i){(function(r,e){var t=function(){function e(){this.yy={}}var t=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},r=[1,13],n=[1,14],i=[1,15],o=[1,16],a=[1,17],s=[1,20],l=[1,18],c=[1,19],u=[1,21],p=[1,22],d=[1,27],h=[1,29],f=[1,30],g=[1,31],m=[1,32],y=[1,28],v=[5,21,26,37],b=[5,19,21,22,23,24,25,26,27,31,32,33,34,35,36,37],x=[5,10,12,13,14,19,21,22,23,24,25,26,27,31,32,33,34,35,36,37],w=[5,10,19,21,22,23,24,25,26,27,31,32,33,34,35,36,37],_={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,RADICAL_OPTARG:25,CLOSE_OPTARG:26,RADICAL:27,curly_group:28,greek:29,command:30,SYMBOL:31,DELIMITER:32,DELIMITER_COMMAND:33,GREEK:34,COMMAND:35,"{":36,"}":37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"RADICAL_OPTARG",26:"CLOSE_OPTARG",27:"RADICAL",31:"SYMBOL",32:"DELIMITER",33:"DELIMITER_COMMAND",34:"GREEK",35:"COMMAND",36:"{",37:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[29,1],[30,1],[28,3],[28,2]],performAction:function(e,t,r,n,i,o,a){var s=o.length-1;switch(i){case 1:return o[s-1];case 2:return n.group();case 3:this.$=n.group(o[s-2],o[s-1],o[s]);break;case 4:case 6:this.$=n.group(o[s-1],o[s]);break;case 5:case 7:this.$=n.group(o[s]);break;case 8:this.$=n.level({_:n.group(o[s-1]),"^":n.group(o[s])});break;case 9:this.$=n.level({_:n.group(o[s]),"^":n.group(o[s-1])});break;case 10:this.$=n.level({"^":n.group(o[s])});break;case 11:this.$=n.level({_:n.group(o[s])});break;case 12:case 13:this.$=o[s];break;case 14:this.$=n.processPrimes(o[s-1],o[s]);break;case 15:this.$=n.processPrimes(o[s],n.group());break;case 21:this.$=n.group(o[s-3],o[s-2],o[s]);break;case 22:this.$=n.group(o[s-2],o[s]);break;case 23:this.$=n.fraction(n.group(o[s-1]),n.group(o[s]));break;case 24:this.$=n.typeform("operator_name",n.group(o[s]));break;case 25:this.$=n.typeform("mathrm",n.group(o[s]));break;case 26:this.$=n.radical(o[s],n.group(o[s-2]));break;case 27:this.$=n.radical(n.group(o[s]),n.group());break;case 28:case 29:this.$=n.radical(n.group(o[s]));break;case 34:case 35:this.$=n.terminal(o[s]);break;case 36:case 38:this.$=n.command(o[s]);break;case 37:this.$=n.greek(o[s]);break;case 39:this.$=o[s-1];break;case 40:this.$=n.group()}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:r,11:12,12:n,13:i,14:o,15:8,16:9,17:10,18:11,19:a,20:24,22:s,23:l,24:c,25:u,27:p,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{1:[3]},{5:[1,33]},{1:[2,2]},t(v,[2,5],{15:8,16:9,17:10,18:11,11:12,28:23,20:24,29:25,30:26,7:34,19:a,22:s,23:l,24:c,25:u,27:p,31:d,32:h,33:f,34:g,35:m,36:y}),t(v,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,28:23,20:24,29:25,30:26,4:35,10:r,12:n,13:i,14:o,19:a,22:s,23:l,24:c,25:u,27:p,31:d,32:h,33:f,34:g,35:m,36:y}),t(b,[2,11],{9:36,12:n,13:i,14:o}),t(b,[2,10],{8:37,10:r}),t(x,[2,16]),t(x,[2,17]),t(x,[2,18]),t(x,[2,19]),t(x,[2,20]),{11:38,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{11:39,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{11:40,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},t(w,[2,15]),{20:41,32:h,33:f},{11:42,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{11:43,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{11:44,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{4:45,6:4,7:5,8:6,9:7,10:r,11:12,12:n,13:i,14:o,15:8,16:9,17:10,18:11,19:a,20:24,22:s,23:l,24:c,25:u,26:[1,46],27:p,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{11:47,17:48,20:24,22:s,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},t(x,[2,30]),t(x,[2,31]),t(x,[2,32]),t(x,[2,33]),t(x,[2,34]),{4:49,6:4,7:5,8:6,9:7,10:r,11:12,12:n,13:i,14:o,15:8,16:9,17:10,18:11,19:a,20:24,22:s,23:l,24:c,25:u,27:p,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y,37:[1,50]},t(x,[2,35]),t(x,[2,36]),t(x,[2,37]),t(x,[2,38]),{1:[2,1]},t(v,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,28:23,20:24,29:25,30:26,4:51,10:r,12:n,13:i,14:o,19:a,22:s,23:l,24:c,25:u,27:p,31:d,32:h,33:f,34:g,35:m,36:y}),t(v,[2,6]),t(b,[2,8]),t(b,[2,9]),t([5,12,13,14,19,21,22,23,24,25,26,27,31,32,33,34,35,36,37],[2,12]),t(w,[2,13]),t(w,[2,14]),{4:52,6:4,7:5,8:6,9:7,10:r,11:12,12:n,13:i,14:o,15:8,16:9,17:10,18:11,19:a,20:24,21:[1,53],22:s,23:l,24:c,25:u,27:p,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},t(x,[2,24]),t(x,[2,25]),{11:54,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},{26:[1,55]},{11:56,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},t(x,[2,28]),t(x,[2,29]),{37:[1,57]},t(x,[2,40]),t(v,[2,3]),{21:[1,58]},{20:59,32:h,33:f},t(x,[2,23]),{11:60,20:24,28:23,29:25,30:26,31:d,32:h,33:f,34:g,35:m,36:y},t(x,[2,27]),t(x,[2,39]),{20:61,32:h,33:f},t(x,[2,22]),t(x,[2,26]),t(x,[2,21])],defaultActions:{3:[2,2],33:[2,1]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],o=this.table,a="",s=0,l=0,c=0,u=i.slice.call(arguments,1),p=Object.create(this.lexer),d={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(d.yy[h]=this.yy[h]);p.setInput(e,d.yy),d.yy.lexer=p,d.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var f=p.yylloc;i.push(f);var g,m=p.options&&p.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,v,b,x,w,_,S,E,M,I={};;){if(b=r[r.length-1],void 0===(x=this.defaultActions[b]?this.defaultActions[b]:(null!=y||(g=void 0,"number"!=typeof(g=p.lex()||1)&&(g=t.symbols_[g]||g),y=g),o[b]&&o[b][y]))||!x.length||!x[0]){var T;for(_ in M=[],o[b])this.terminals_[_]&&2<_&&M.push("'"+this.terminals_[_]+"'");T=p.showPosition?"Parse error on line "+(s+1)+":\n"+p.showPosition()+"\nExpecting "+M.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(s+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(T,{text:p.match,token:this.terminals_[y]||y,line:p.yylineno,loc:f,expected:M})}if(x[0]instanceof Array&&1<x.length)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(x[0]){case 1:r.push(y),n.push(p.yytext),i.push(p.yylloc),r.push(x[1]),y=null,v?(y=v,v=null):(l=p.yyleng,a=p.yytext,s=p.yylineno,f=p.yylloc,0<c&&c--);break;case 2:if(S=this.productions_[x[1]][1],I.$=n[n.length-S],I._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},m&&(I._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),void 0!==(w=this.performAction.apply(I,[a,l,s,d.yy,x[1],n,i].concat(u))))return w;S&&(r=r.slice(0,-1*S*2),n=n.slice(0,-1*S),i=i.slice(0,-1*S)),r.push(this.productions_[x[1]][0]),n.push(I.$),i.push(I._$),E=o[r[r.length-2]][r[r.length-1]],r.push(E);break;case 3:return!0}}return!0}},S={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return 0<=(e=this.conditionStack.length-1-Math.abs(e||0))?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:break;case 1:return this.begin("optarg"),25;case 2:return this.popState(),26;case 3:return 23;case 4:return 24;case 5:return 27;case 6:return 22;case 7:return 13;case 8:return 14;case 9:return 12;case 10:return 10;case 11:return 19;case 12:return 21;case 13:return 33;case 14:return 32;case 15:return 36;case 16:return 37;case 17:case 18:case 19:return 31;case 20:case 21:return 34;case 22:return 35;case 23:return 31;case 24:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],inclusive:!0}}};return _.lexer=S,new((e.prototype=_).Parser=e)}();n.parser=t,n.Parser=t.Parser,n.parse=function(){return t.parse.apply(t,arguments)},n.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),r.exit(1));var t=i(4).readFileSync(i(5).normalize(e[1]),"utf8");return n.parser.parse(t)},void 0!==e&&i.c[i.s]===e&&n.main(r.argv.slice(1))}).call(n,i(1),i(8)(e))},function(e,t,r){function y(e){return/^[a-z]$/.test(e.value)?e.value.toUpperCase():/^[A-Z]$/.test(e.value)?","+e.value:/^[0-9.]$/.test(e.value)?e.value:/^[+\-()]$/.test(e.value)?e.value:s.hasOwnProperty(e.value)?s[e.value]:"[terminal: "+e.value+"]"}function v(e){return l.hasOwnProperty(e.value)?l[e.value]:e.value.slice(1).toUpperCase()+" "}function b(e,t){if(t>=e.length)return!1;var r=e[t];if("terminal"===r.type){if(/^[0-9]$/.test(r.value))return!0;if("."!==r.value)return!1;if(t+1>=e.length)return!1;if("terminal"===(r=e[t+1]).type)return/^[0-9]$/.test(r.value)}return!1}function x(e,t){for(var r="",n=e.levelIndicator,i=0,o=!1,a=0;a<t.length;a++){b(t,a)&&(""===n&&/[A-Z]$/.test(r)?r+=E(n):(m=r,((g=e).isStartOfLine&&/^-?$/.test(m)||/\s-?$/.test(m)||g.wasFraction)&&(r+="#")));var s=t[a],l=a<t.length-1?t[a+1]:null;switch("level"!==s.type&&n!==e.levelIndicator&&(n=I(s)?"":(e.wasModifiedExpression&&""===e.levelIndicator?e=M(e,{wasModifiedExpression:!1}):r+=E(e.levelIndicator),e.levelIndicator)),s.type){case"terminal":r+=!e.wasModifiedExpression&&""!==n&&I(s)?" "+E(n)+y(s).trim()+" ":y(s),"."===s.value&&l&&("terminal"===l.type&&/^[^_\d,]/.test(y(l))||"greek"===l.type)&&(r+='"'),e=M(e,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if("\\space"!==s.value){var c="\\sum"===(f=s).value||"\\prod"===f.value;c&&(r+='"'),r+=!c&&""!==n&&I(s)?" "+E(n)+v(s).trim()+" ":v(s),e=M(e,{wasFraction:!1,wasModifiedExpression:c,wasRomanCommand:!0})}break;case"greek":r+=(h=s,T.hasOwnProperty(h.value)?T[h.value]:h.value.slice(1).toUpperCase()+" "),e=M(e,{wasFraction:!1});break;case"fraction":var u=w(e,s);r+=u.value,i=Math.max(i,u.fractionLevel),e=M(e,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":var p=_(e,s);r+=p.value,i=Math.max(i,p.fractionLevel),e=M(e,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!e.wasModifiedExpression&&e.wasRomanCommand?(o=/\s$/.test(r))&&(r=r.replace(/\s$/,"")):o=!1;var d=S(e,0<r.length&&!0===/[A-Za-z]/.test(r[r.length-1]),o,s);r+=d.value,n=d.levelIndicator,e=M(e,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":r+=x(e,s.value).value,"operator_name"===s.name&&(r+=" "),e=M(e,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1})}}var h,f,g,m;return{fractionLevel:i,levelIndicator:n,value:r}}function w(e,t){for(var r=x(e=M(e,{isStartOfLine:!1}),t.numerator),n=x(e,t.denominator),i=Math.max(r.fractionLevel,n.fractionLevel),o="",a=0;a<i;a++)o+=",";var s=o+"?"+r.value;return r.levelIndicator!==e.levelIndicator&&(s+=E(e.levelIndicator)),/\.$/.test(r.value)&&(s+='"'),s+=o+"/"+n.value,n.levelIndicator!==e.levelIndicator&&(s+=E(e.levelIndicator)),/\.$/.test(n.value)&&(s+='"'),{fractionLevel:i+1,value:s+=o+"#"}}function _(e,t){for(var r=e.radicalLevel,n="",i="",o=0;o<r;o++)i+=".";if(t.index){n+=i+"<";var a=x(M(e,{isStartOfLine:!1}),t.index);n+=a.value,/\.$/.test(a.value)&&(n+='"'),a.levelIndicator!==e.levelIndicator&&(n+=E(e.levelIndicator)),n+=">"}else n+=i+">";var s=x(M(e,{isStartOfLine:!1,radicalLevel:r+1}),t.radicand);return n+=s.value,/\.$/.test(s.value)&&(n+='"'),s.levelIndicator!==e.levelIndicator&&(n+=E(e.levelIndicator)),n+=i+"]",{fractionLevel:s.fractionLevel,value:n}}function S(e,t,r,n){var i=e.levelIndicator,o="",a=function(e){var t="";if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];if("command"!==i.type||"\\prime"!==i.value)break;t+="'"}return t}(n.superscript);if(o+=a,n.subscript){e.wasModifiedExpression&&(o+="%");var s=x(M(e,{isStartOfLine:!1,levelIndicator:i=e.levelIndicator+";"}),n.subscript);t&&/^[0-9]*(\.|\,)?[0-9]+$/.test(s.value)&&i.length<=1?i=e.levelIndicator:!e.wasModifiedExpression&&n.subscript[0]&&"level"!==n.subscript[0].type&&(o+=E(i)),o+=s.value,/\.$/.test(s.value)&&(o+='"')}if(n.superscript){e.wasModifiedExpression&&(o+="<");var l=x(M(e,{isStartOfLine:!1,levelIndicator:i=e.levelIndicator+"^"}),n.superscript.slice(a.length));!e.wasModifiedExpression&&n.superscript[0]&&"level"!==n.superscript[0].type&&""!==l.value&&(o+=E(i)),o+=l.value,/\.$/.test(l.value)&&(o+='"')}return e.wasModifiedExpression?o+="]":e.wasRomanCommand&&r&&(o+=" ",i=i.slice(0,i.length-1)),{levelIndicator:i,value:o}}function E(e){return e||'"'}function M(e,t){return n({},e,t)}function I(e){return("terminal"===e.type||"command"===e.type)&&/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(e.value)}var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),o=r(12),a=r(0);t.default=function(e){return a.map(o.default(e),function(e){return x({isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1},i.default(e)).value})};var s={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"},l={"\\Vert":"\\\\","\\cdot":"*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\ne":" /.K ","\\neq":" /.K ","\\nparallel":" /$L ","\\parallel":" $L ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\vert":"\\"},T={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"}},function(e,t,r){function x(e,t,r){var n="",i=t.value,o=r&&"terminal"===r.type?r.value:"";return S(i,e)&&(n+=";"),/^[\D]/.test(i)&&(e=T(e,{wasNumber:!1})),/^[a-z]$/.test(i)?e.capsLock?(e=T(e,{capsLock:!1}),n+=",'"+i.toUpperCase()):n+=i.toUpperCase():/^[A-Z]$/.test(i)?e.capsLock?n+=i:/[A-Z]/.test(o)?(e=T(e,{capsLock:!0}),n+=",,"+i):n+=","+i:(e=T(e,{capsLock:!1}),n+=/^[0-9.]$/.test(i)?function(e){for(var t="",r="A".charCodeAt(0)-1,n=0,i=e;n<i.length;n++){var o=i[n];t+=","===o?"1":"."===o?"4":"0"===o?"J":String.fromCharCode(r+Number(o))}return t}(i):u.hasOwnProperty(i)?u[i]:"[terminal: "+i+"]"),{value:n,ctx:e}}function w(e,t){if(t<e.length){var r=e[t];if("terminal"===r.type){if(/^\d$/.test(r.value))return!0;if("."!==r.value)return!1;if(t+1>=e.length)return!1;if("terminal"===(r=e[t+1]).type)return/^\d$/.test(r.value)}}return!1}function _(e,t){for(var r,n,i="",o=!0,a=0;a<t.length;a++){w(t,a)?(e=T(e,{wasNumber:!0}),o&&(i+="#",o=!1)):o=!0;var s=t[a];switch(s.type){case"terminal":e=(r=x(e,s,a<t.length-1?t[a+1]:void 0)).ctx," "===(i+=r.value)[i.length-1]&&(o=!0);break;case"command":"\\space"===s.value||(y=s,v=e,b=void 0,S(b=C.hasOwnProperty(y.value)?C[y.value]:y.value.slice(1).toUpperCase()+" ",v)&&(b=";"+b),/^[\D]/.test(b)&&(v=T(v,{wasNumber:!1})),e=(n={value:b,ctx:v}).ctx," "===(i+=n.value)[i.length-1]&&(o=!0));break;case"greek":" "===(i+=(m=s,k.hasOwnProperty(m.value)?k[m.value]:m.value.slice(1).toUpperCase()+" "))[i.length-1]&&(o=!0);break;case"fraction":var l=(g=h=void 0,f=_(p=e,(d=s).numerator),g=_(p,d.denominator),h=E(f.value)&&E(g.value)?(p=T(p,{wasNumber:!0}),f.value+"/"+g.value.slice(1)):(p=T(p,{wasNumber:!1}),"("+f.value+"./"+g.value+")"),{ctx:p,value:h});i+=l.value,e=l.ctx,o=!1;break;case"radical":i+=M(e,s).value,o=!0;break;case"level":var c=I(e,s);i+=c.value,e=c.ctx,o=!0;break;case"typeform":var u=_(e,s.value).value;i+=u,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(u)&&(i+=" ")}}var p,d,h,f,g,m,y,v,b;return{ctx:e,value:i}}function S(e,t){return t.wasNumber&&/^[A-Ja-j]/.test(e)}function E(e){return/^\#[A-J41]+$/.test(e)}function M(e,t){var r="%";t.index&&(r+=_(e,i.group(i.level({"^":t.index}))).value);return{ctx:e,value:r+=_(e,t.radicand).value+"+"}}function I(e,t){var r,n="",i=function(e){var t="";if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];if("command"!==i.type||"\\prime"!==i.value)break;t+="7"}return t}(t.superscript);if(n+=i,t.subscript){var o=_(e,t.subscript);r=l(t.subscript,o.value,0)?"<"+s(o.value)+">":o.value,e=T(e,{wasNumber:o.ctx.wasNumber}),""!==r&&(n+="5"+r)}if(t.superscript){var a=_(e,t.superscript.slice(i.length));r=l(t.superscript,a.value,i.length)?"<"+s(a.value)+">":a.value,e=T(e,{wasNumber:a.ctx.wasNumber}),""!==i&&""===r||(n+="9"+r)}return{ctx:e,value:n}}function s(e){return/^;/.test(e)?e.slice(1):e}function l(e,t,r){var n=e[0],i=(t.match(/\</g)||[]).length,o=/^["|\.|_]?\</.test(t),a=(t.match(/\>/g)||[]).length,s=/["|\.|_]?\>$/.test(t);return!E(t)&&1<e.length-r&&0===i&&0===a||0<i&&0<a&&(!o||!s)||1<i||1<a||n&&"typeform"===n.type}function T(e,t){return n({},e,t)}var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=r(11),a=r(12),c=r(0);t.default=function(e){return c.map(a.default(e),function(e){return _({capsLock:!1,wasNumber:!1},o.default(e)).value})};var u={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"},C={"\\Vert":"_\\_\\","\\cdot":'"4',"\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\ne":'"7@:',"\\neq":'"7@:',"\\parallel":"#L","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\vert":"_\\"},k={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"}},function(e,t,r){function y(e,t){for(var r="",n=t,i="",o=!1,a="",s="",l=function(e){for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];if("terminal"===(c=i).type&&/^(\\langle |\[|\(|\\{)$/.test(c.value))t.push({direction:x,index:n}),r.push(_);else if("terminal"===(l=i).type&&/^(\\rangle |\]|\)|\\})$/.test(l.value)){for(;t.length&&t[t.length-1].direction===S;)t.pop();if(t.length){var o=t.pop();if(o){var a=o.index;r[a]=x,r.push(w)}}else r.push(_)}else if("terminal"===(s=i).type&&/^(\\\||\|)$/.test(s.value))if(t.length&&t[t.length-1].direction===S){var o=t.pop();if(o){var a=o.index;r[a]=x,r.push(w)}}else t.push({direction:S,index:n}),r.push(_);else r.push(_)}var s;var l;var c;return r}(e),c=0;c<e.length;c++){var u=e[c],p=c+1<e.length?e[c+1]:null;switch(u.type){case"terminal":var d=b.getAutoOperator(e.slice(c));""!==d.value?(r+=d.value,c+=d.terminalCount-1,o=o||d.modified):" "===u.value?(o?(r+=v(n,i=a),n=i):r+="\\ ",o=!1):(l[c]===x?r+="\\left":l[c]===w&&(r+="\\right"),r+=u.value);break;case"comparison":r+=v(n,i=""),n=i,o=!1,r+=u.value;break;case"level_with_comparison":r+=v(n,u.level),n=u.level,o=!1,r+=u.value;break;case"command":var h=u.value.slice(1).trim();o=p&&"terminal"===p.type&&/[a-z]/.test(p.value)?(r+=h,!1):(b.containsValue(h)?r+="\\operatorname{"+h+"}":r+=u.value,!0),a=n;break;case"expression":r+=u.value;break;case"fraction":r+=(f=u.numerator,g=u.denominator,"\\frac{"+y(f,m=n)+"}{"+y(g,m)+"}");break;case"modified_expression":r+=y(u.expression,n)+" ",u.under&&(r+="_{"+y(u.under,n)+"}"),u.over&&(r+="^{"+y(u.over,n)+"}");break;case"radical":r+="\\sqrt",u.index&&(r+="["+y(u.index,n)+"]"),r+="{"+y(u.value,n)+"}";break;case"simple_subscript":""===n?(r+=u.base.value+"_{"+u.subscript.value+"}","command"===u.base.type&&(o=!0,a=n)):r+=u.base.value+u.subscript.value;break;case"level":r+=v(n,u.value,s),n=u.value,"^"===u.value&&""!==s&&(s="");break;case"primes":s=p&&"level"===p.type&&";"===p.value?u.value:(r+=""!==n?Array(u.value.length+1).join("\\prime "):u.value,"")}}var f,g,m;return(r+=v(n,t)+s).replace(/([^\\])( )$/,"$1")}function v(e,t,r){var n,i,o,a="",s=Math.max(e.length,t.length);for(n=0;n<s&&e[n]===t[n];n++);for(i=e.length-1;n<=i;i--)a+="}";for(o=n;o<t.length;o++)"^"===t[o]&&(r&&(a+=r),a+="^{"),";"===t[o]&&(a+="_{");return a}function n(e){return y(e,"")}Object.defineProperty(t,"__esModule",{value:!0});var b=r(2),i=r(18),o=r(0),x=1,w=-1,_=0,S=2;t.default=function(e,t){return t&&t.operatorNames?b.setOperatorNames(t.operatorNames):b.resetOperatorNames(),o.map(i.default(e,t),n)}},function(e,t,r){function i(e){return{type:"level",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.terminal=function(e){return{type:"terminal",value:e}},t.command=function(e){return{type:"command",value:"\\"+e.trim()+" "}};var o={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim "};t.level_with_comparison=function(e){var t=/[\^;]+/.exec(e),r=t?t.toString():"",n=e.slice(i.length);return{type:"level_with_comparison",level:r,value:o[n]}},t.comparison=function(e){return{type:"comparison",value:o[e]}},t.level=i,t.baseline=function(){return i("")},t.primes=function(e){return{type:"primes",value:e}},t.fraction=function(e,t){return{type:"fraction",numerator:e,denominator:t}},t.modified_expression=function(e,t,r){return{type:"modified_expression",expression:e,under:t,over:r}},t.radical=function(e,t){return{type:"radical",value:e,index:t}},t.expression=function(e){return{type:"expression",value:e}},t.simple_subscript=function(e,t){return{type:"simple_subscript",base:e,subscript:t}};var n={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};t.greek=function(e){if(n.hasOwnProperty(e))return n[e]+" ";throw new Error("Unknown Greek letter")},t.group=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Array.prototype.concat.apply([],e)}},function(e,t,r){var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),o=r(9),a=r(17),s=r(20);t.default=function(e,t){t||(t={});var r=o.parser;t.strict?r.yy=a:(r.yy=n({warnings:[]},a),r.lexer=s.default);try{return{isError:!1,value:r.parse(e),warnings:r.yy.warnings||[]}}catch(e){return{error:i.default(e),isError:!0}}}},function(e,t,r){var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),o=r(21),a=r(10),s=r(24);t.default=function(e,t){t||(t={});var r=a.parser;t.strict?r.yy=s:(r.yy=n({warnings:[]},s),r.lexer=o.default);try{return{isError:!1,value:r.parse(e),warnings:r.yy.warnings||[]}}catch(e){return{error:i.default(e),isError:!0}}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=n.parser.lexer,i=Object.create(o);t.default=i;var a=n.parser.terminals_,s=n.parser.symbols_;i.setInput=function(e,t){this.delimiterStack=[],this.outputQueue=[],o.setInput.call(this,e,t)},i.lex=function(){var e=-1;if(!this)return e;if(this.outputQueue.length)return this.outputQueue.shift();var t,r,n=o.lex.call(this),i=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(a[n]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(n);break;case"RADICAL_INDEX":i===s.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(i)),this.delimiterStack.push(n);break;case"OPEN_RADICAL":i===s.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(n);break;case"SLASH":for(t=!1;this.delimiterStack.length;){if((r=this.delimiterStack.pop()||-1)===s.OPEN_FRAC){t=!0;break}this.pushCloseTokens(r)}t||this.pushOpenTokens(n),this.delimiterStack.push(n);break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;){if((r=this.delimiterStack.pop()||-1)===s.SLASH){t=!0;break}if(r===s.OPEN_FRAC){this.addMissingToken(s.SLASH),t=!0;break}this.pushCloseTokens(r)}if(!t)return this.warn(),this.lex();break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;){if((r=this.delimiterStack.pop()||-1)===s.OPEN_RADICAL){t=!0;break}if(r===s.RADICAL_INDEX){t=!0,this.addMissingToken(s.OPEN_RADICAL);break}this.pushCloseTokens(r)}t||this.pushOpenTokens(n);break;case"CLOSE_MODEXP":for(t=!1;this.delimiterStack.length;){if((r=this.delimiterStack.pop()||-1)===s.OPEN_MODEXP){t=!0;break}this.pushCloseTokens(r)}t||this.pushOpenTokens(n);break;case"EOF":for(;this.delimiterStack.length;)r=this.delimiterStack.pop()||-1,this.pushCloseTokens(r)}return this.outputQueue.push(n),this.outputQueue.shift()||-1},i.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},i.addMissingToken=function(e){this.outputQueue.push(e),this.warn()},i.pushCloseTokens=function(e){switch(a[e]){case"OPEN_FRAC":this.addMissingToken(s.SLASH),this.addMissingToken(s.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(s.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(s.OPEN_RADICAL),this.addMissingToken(s.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(s.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(s.CLOSE_MODEXP)}},i.pushOpenTokens=function(e){switch(a[e]){case"SLASH":this.addMissingToken(s.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(s.OPEN_FRAC),this.addMissingToken(s.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(s.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(s.OPEN_MODEXP)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=n.parser.lexer,o=Object.create(i);t.default=o;var a=n.parser.terminals_,s=n.parser.symbols_;o.setInput=function(e,t){this.delimiterStack=[],this.outputQueue=[],i.setInput.call(this,e,t)},o.lex=function(){if(this.outputQueue.length)return this.outputQueue.shift();var e,t,r=i.lex.call(this),n=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(a[r]){case"OPEN_FRAC":case"OPEN_GROUP":this.delimiterStack.push(r);break;case"RADICAL_WITH_INDEX":n===s.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(n)),this.delimiterStack.push(r);break;case"RADICAL":n===s.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(r);break;case"OVER":for(e=!1;this.delimiterStack.length;){if((t=this.delimiterStack.pop()||-1)===s.OPEN_FRAC){e=!0;break}this.pushCloseTokens(t)}e||this.pushOpenTokens(r),this.delimiterStack.push(r);break;case"CLOSE_FRAC":for(e=!1;this.delimiterStack.length;){if((t=this.delimiterStack.pop()||-1)===s.OVER){e=!0;break}if(t===s.OPEN_FRAC){this.outputQueue.push(s.OVER),e=!0;break}this.pushCloseTokens(t)}e||this.pushOpenTokens(r);break;case"CLOSE_GROUP":for(e=!1;this.delimiterStack.length;){if((t=this.delimiterStack.pop()||-1)===s.OPEN_GROUP){e=!0;break}this.pushCloseTokens(t)}e||this.pushOpenTokens(r);break;case"CLOSE_RADICAL":for(e=!1;this.delimiterStack.length;){if((t=this.delimiterStack.pop()||-1)===s.RADICAL||t===s.RADICAL_WITH_INDEX){e=!0;break}this.pushCloseTokens(t)}e||this.pushOpenTokens(r);break;case"EOF":for(;this.delimiterStack.length;)t=this.delimiterStack.pop()||-1,this.pushCloseTokens(t)}return this.outputQueue.push(r),this.outputQueue.shift()||-1},o.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},o.addMissingToken=function(e){this.outputQueue.push(e),this.warn()},o.pushCloseTokens=function(e){switch(a[e]){case"OPEN_FRAC":this.addMissingToken(s.OVER),this.addMissingToken(s.CLOSE_FRAC);break;case"OVER":this.addMissingToken(s.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(s.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(s.CLOSE_RADICAL)}},o.pushOpenTokens=function(e){switch(a[e]){case"OVER":this.addMissingToken(s.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(s.OPEN_FRAC),this.addMissingToken(s.OVER);break;case"CLOSE_GROUP":this.addMissingToken(s.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(s.RADICAL)}}},function(e,t,r){function n(e){return e.isError}Object.defineProperty(t,"__esModule",{value:!0}),t.isErr=n,t.isOk=function(e){return!e.isError},t.map=function(e,t){return n(e)?e:{isError:!1,value:t(e.value)}}},function(e,t,r){function M(e,t){for(var r="",n=!1,i="",o=function(e){for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];if("terminal"===(c=i).type&&/^(\\langle |\[|\(|\\{)$/.test(c.value))t.push({direction:T,index:n}),r.push(k);else if("terminal"===(l=i).type&&/^(\\rangle |\]|\)|\\})$/.test(l.value)){for(;t.length&&t[t.length-1].direction===P;)t.pop();if(t.length){var o=t.pop();if(o){var a=o.index;r[a]=T,r.push(C)}}else r.push(k)}else if("terminal"===(s=i).type&&/^(\\\||\|)$/.test(s.value))if(t.length&&t[t.length-1].direction===P){var o=t.pop();if(o){var a=o.index;r[a]=T,r.push(C)}}else t.push({direction:P,index:n}),r.push(k);else r.push(k)}var s;var l;var c;return r}(e),a=0;a<e.length;a++){var s=e[a],l=a+1<e.length?e[a+1]:null;switch(s.type){case"terminal":var c=I.getAutoOperator(e.slice(a));""!==c.value?(r+=c.value,a+=c.terminalCount-1):" "!==s.value||n?(o[a]===T?r+="\\left":o[a]===C&&(r+="\\right"),r+=s.value):r+="\\ ",n=!1;break;case"command":var u=s.value.slice(1).trim();n=l&&"terminal"===l.type&&/[a-z]/.test(l.value)?(r+=u,!1):(I.containsValue(u)?r+="\\operatorname{"+u+"}":r+=s.value,!0);break;case"expression":r+=s.value;break;case"fraction":r+=(S=s.numerator,E=s.denominator,"\\frac{"+M(S)+"}{"+M(E)+"}");break;case"radical":r+="\\sqrt",s.index&&(r+="["+M(s.index)+"]"),r+="{"+M(s.value)+"}";break;case"basic_level":r+=(v=s.level,b=s.value,x=i,w=void 0,w="",_="{"+M(b,v)+"}","9"===v?w+=x+"^"+_:"5"===v&&(w+="_"+_),w),"9"===s.level&&(i="");break;case"bracketed_level":r+=(p=s.level,d=s.lbrack,h=s.value,f=s.rbrack,g=i,m=void 0,m="",y="{"+d+M(h,p)+f+"}","9"===p?m+=g+"^"+y:"5"===p&&(m+="_"+y),m),"9"===s.level&&(i="");break;case"primes":i=!l||"basic_level"!==l.type&&"bracketed_level"!==l.type||"5"!==l.level?(r+=t&&""!==t?Array(s.value.length+1).join("\\prime "):s.value,""):s.value}}var p,d,h,f,g,m,y,v,b,x,w,_,S,E;return(r+=i).replace(/([^\\])( )$/,"$1")}Object.defineProperty(t,"__esModule",{value:!0});var I=r(2),n=r(19),i=r(0),T=1,C=-1,k=0,P=2,o=M;t.default=function(e,t){return t&&t.operatorNames?I.setOperatorNames(t.operatorNames):I.resetOperatorNames(),i.map(n.default(e,t),function(e){return o(e,"")})}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.terminal=function(e){return{type:"terminal",value:e}},t.command=function(e){return{type:"command",value:e}},t.basic_level=function(e,t){return{type:"basic_level",level:e,value:t}},t.bracketed_level=function(e,t,r,n){return{type:"bracketed_level",level:e,lbrack:t,value:r,rbrack:n}},t.primes=function(e){return{type:"primes",value:0<e.length?Array(e.length+1).join("'"):""}},t.fraction=function(e,t){return{type:"fraction",numerator:e,denominator:t}},t.radical=function(e,t){return{type:"radical",value:e,index:t}},t.expression=function(e){return{type:"expression",value:e}},t.group=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Array.prototype.concat.apply([],e)};var n={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};t.greek=function(e){if(n.hasOwnProperty(e))return n[e]+" ";throw new Error("Unknown Greek letter")},t.to_number=function(e){for(var t="",r="A".charCodeAt(0)-1,n=0,i=e;n<i.length;n++){var o=i[n];t+="4"===o?".":"J"===o?"0":o.charCodeAt(0)-r}return t}},function(e,t,r){function a(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=(a=i,o=s.indexOf(a),String.fromCharCode(l+o))}var o,a;return t}function n(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=(o=i.charCodeAt(0)-l,s[o])}var o;return t}Object.defineProperty(t,"__esModule",{value:!0});var s=" A1B'K2L@CIF/MSP\"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=",l=10240;t.toBrailleAscii=n,t.toExpandedBrailleAscii=function(e){return n(e).replace(/[@-^]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+32)})},t.coerceToSixDotCells=function(e){var t="";if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r],o=i.charCodeAt(0);96<=o&&o<=127&&(o-=32,i=String.fromCharCode(o)),32<=o&&o<=95&&(o=(i=a(i)).charCodeAt(0)),10305<=o&&o<=10495&&(o=10240+(o-1024)%64,i=String.fromCharCode(o)),t+=10240<=o&&o<=10304?i:String.fromCharCode(10240)}return t},t.isSixDotCells=function(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(r<10240||10304<r)return!1}return!0}},function(e,t,r){r(3),e.exports=r(3)}])}),define("loadcss!basic/keypad/braille-example-row",function(){}),define("basic/keypad/braille-example-row",["require","exports","tslib","dcgview","dcgview-helpers/static-mathquill-view","abraham","loadcss!./braille-example-row"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.Components.For,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("tr",null,n.createElement(a,{each:function(){return e.getBrailleAscii(e.props.latex())},key:function(e){return e.key}},n.createElement("td",null,function(e){return n.createElement("span",{class:n.const("dcg-key-press")},function(){return e.char})})),n.createElement("td",{class:n.const("dcg-braille-font")},function(){return e.getBrailleUnicode(e.props.latex())}),n.createElement("td",null,n.createElement(i.default,{latex:function(){return e.props.latex()}})))},t.prototype.getBrailleAscii=function(e){for(var t=o.UnicodeBraille.toExpandedBrailleAscii(this.getBrailleUnicode(e)),r=[],n=0;n<t.length;n++)r.push({char:t[n],key:n+")"+t[n]});return r},t.prototype.getBrailleUnicode=function(e){var t;return"nemeth"===this.props.brailleMode()?t=o.latexToNemeth(e):"ueb"===this.props.brailleMode()&&(t=o.latexToUeb(e)),t&&t.value?t.value:""},t}(n.Class);t.BrailleExampleRow=s}),define("loadcss!basic/keypad/braille-keypad",function(){}),define("basic/keypad/braille-keypad",["require","exports","tslib","dcgview","basic/dcgview-basic","./braille-example-row","loadcss!./braille-keypad"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return n.createElement("div",{class:function(){return{"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":e.controller.hasBackgroundColor()}}},n.createElement("div",{class:n.const("dcg-braille-io-keypad")},n.createElement("div",{class:n.const("dcg-braille-description")},n.createElement("div",{class:n.const("dcg-braille-title")},function(){return e.controller.t("__mode__ is on!",{mode:e.brailleType()})}),n.createElement("div",{class:n.const("dcg-braille-info-text")},function(){return e.controller.t("Use a Refreshable Braille display, or just type Braille with a keyboard.")}),n.createElement("div",{class:n.const("dcg-blue-btn"),role:n.const("button"),tabindex:n.const(0),onTap:function(){return e.controller.dispatch({type:"set-braille-mode",mode:"none"})}},function(){return e.controller.t("Turn __mode__ off",{mode:e.brailleType()})})),n.createElement("div",{class:n.const("dcg-braille-examples-table-container")},n.createElement("table",{class:n.const("dcg-braille-examples-table")},n.createElement("tr",null,n.createElement("th",null,function(){return e.controller.t("Type this")}),n.createElement("th",null,function(){return e.brailleType()}),n.createElement("th",null,function(){return e.controller.t("Typeset")})),n.createElement(o.BrailleExampleRow,{brailleMode:function(){return e.controller.getBrailleMode()},latex:this.const("2+2")}),n.createElement(o.BrailleExampleRow,{brailleMode:function(){return e.controller.getBrailleMode()},latex:this.const("\\frac{1}{2}")}),n.createElement(o.BrailleExampleRow,{brailleMode:function(){return e.controller.getBrailleMode()},latex:this.const("\\sqrt{4}")})),n.createElement("div",{class:n.const("dcg-more-examples-link")},n.createElement("a",{href:function(){return"https://www.desmos.com/braille-examples?"+e.controller.getBrailleMode()},target:n.const("_blank")},function(){return e.controller.t("View more examples")})))))},t.prototype.brailleType=function(){return"nemeth"===this.controller.getBrailleMode()?"Nemeth":"ueb"===this.controller.getBrailleMode()?"UEB":""},t}(i.DCGViewBasic);t.default=a}),define("expressions/braille-input",["require","exports","tslib","dcgview","jquery"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.Components.Input,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.init=function(){var e;for(this.ASCIICharacters=" A1B'K2L@CIF/MSP\"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=",this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0},e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))},t.prototype.template=function(){var e=this;return r.createElement(o,{class:this.const("dcg-braille-input"),onKeydown:this.bindFn(this.onKeydown),onKeyup:this.bindFn(this.onKeyup),onInput:this.bindFn(this.props.onInput),value:function(){return e.props.value()},"aria-label":function(){return e.props.ariaLabel()||""},didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount)})},t.prototype.didMount=function(e){var t=this;this.rootNode=e,i(this.rootNode).on("focus",function(){t.props.onFocusedChanged(!0)}).on("blur",function(){t.props.onFocusedChanged(!1)}),this.props.didMount(e)},t.prototype.didUpdate=function(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),this.props.shouldFocus()||document.activeElement!==this.rootNode||this.rootNode.blur())},t.prototype.onKeydown=function(e){var t=this.charCodes.indexOf(e.which);return!this.isSixKeyInput()||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||-1===t?this.props.onKeydown(e):(e.preventDefault(),this.sixKeyModel=n.__assign({},this.sixKeyModel,{keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)}),!1)},t.prototype.onKeyup=function(e){var t=this.charCodes.indexOf(e.which),r=!1;return!this.isSixKeyInput()||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||-1===t?r=!0:(this.sixKeyModel=n.__assign({},this.sixKeyModel,{keysDown:this.removeKey(this.sixKeyModel.keysDown,t)}),0===this.sixKeyModel.keysDown&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel=n.__assign({},this.sixKeyModel,{stickyKeysDown:0}))),r||e.preventDefault(),r},t.prototype.addKey=function(e,t){return e|1<<t},t.prototype.removeKey=function(e,t){return e&~(1<<t)},t.prototype.bitsToASCII=function(e){return String.fromCharCode(this.ASCIITable[e])},t.prototype.addCharacter=function(e){this.rootNode&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))},t.prototype.isSixKeyInput=function(){return"function"==typeof this.props.sixKeyInput&&this.props.sixKeyInput()},t}(r.Class);t.default=a}),define("loadcss!Abraham",function(){}),define("loadcss!basic/expression-view",function(){}),define("basic/expression-view",["require","exports","tslib","keys","graphing/label","dcgview","i18n","jquery","dcgview-helpers/static-mathquill-view","dcgview-helpers/mathquill-view","./dcgview-basic","abraham","expressions/braille-input","../lib/tooltip","./model","loadcss!Abraham","loadcss!./expression-view"],function(e,t,r,n,o,i,a,s,l,c,u,p,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=i.Components,m=g.If,y=g.Input,v=g.Textarea,b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getAriaLabel=function(){var e=this.getIndex()+1+"";return this.t("Expression __index__",{index:e})},t.prototype.didUpdate=function(){this.renderAnsValue()},t.prototype.didMountMQ=function(e){this.$mq=s(e)},t.prototype.getExp=function(){return this.model.getExpressionById(this.props.id())},t.prototype.getAns=function(){return this.model.getExpressionAns(this.props.id())},t.prototype.getLatex=function(){return this.getExp().latex},t.prototype.getValue=function(){return this.model.getExpressionValue(this.props.id())},t.prototype.getBraille=function(){var e=this.getExp().braille;if(""!==e)return e;var t=this.getBrailleValue(this.getLatex());return t.isError?"":p.UnicodeBraille.toExpandedBrailleAscii(t.value)},t.prototype.getBrailleValue=function(e){return"nemeth"===this.controller.getBrailleMode()?p.latexToNemeth(e):p.latexToUeb(e)},t.prototype.getLatexValue=function(e){return"nemeth"===this.controller.getBrailleMode()?p.nemethToLatex(e):p.uebToLatex(e)},t.prototype.getIndex=function(){return this.model.getExpressionIndex(this.props.id())},t.prototype.getShowEvaluation=function(){return this.model.shouldShowEvaluationForExpression(this.props.id())},t.prototype.isFractionEvaluation=function(){return this.getExp().displayAsFraction},t.prototype.canDisplayEvaluationAsFraction=function(){return this.controller.getDecimalToFractionConversion()&&this.model.canDisplayEvaluationAsFraction(this.props.id())},t.prototype.shouldDisplayEvaluationAsFraction=function(){return this.canDisplayEvaluationAsFraction()&&this.getExp().displayAsFraction},t.prototype.toggleFractionEvaluation=function(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})},t.prototype.getError=function(){var e=this.model.getExpressionError(this.props.id());return e&&0<this.getLatex().length?this.t(a.unpack(e)):""},t.prototype.showError=function(){return!!this.getError()},t.prototype.getFractionMessage=function(){return this.shouldDisplayEvaluationAsFraction()?this.t("Convert to decimal."):this.t("Convert to fraction.")},t.prototype.getIsFocused=function(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())},t.prototype.onFocusedChanged=function(e){this.getExp()&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))},t.prototype.onMQReflow=function(){this.renderedAnsData=void 0,this.renderAnsValue()},t.prototype.renderAnsValue=function(){if(this.$mq){var i=this.getAns();this.renderedAnsData&&this.renderedAnsData.value==i||(this.renderedAnsData={value:i},this.$mq.find(".dcg-mq-ans").each(function(e,t){var r=s(t);if(null!=i){var n=o.truncatedHTMLLabel(i,{digits:6,addEllipses:!0,bigCutoff:1e4});r.removeClass("dcg-invalid").html(n)}else r.addClass("dcg-invalid").html('<i class="dcg-icon-error"></i>')}))}},t.prototype.getEvaluationLatex=function(){var e=this.getValue();return void 0===e&&(e=NaN),this.model.isRationalizableConstant(this.props.id())&&!this.shouldDisplayEvaluationAsFraction()?"":Array.isArray(e)?"\\mathrm{"+e.length+"\\ element\\ list}":"="+o.truncatedLatexLabel(e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,denominatorCutoff:f.DENOMINATOR_CUTOFF,displayAsFraction:this.shouldDisplayEvaluationAsFraction()})},t.prototype.getEvaluationBraille=function(){var e=this.getEvaluationLatex(),t=this.getBrailleValue(e);return t.isError?"":p.UnicodeBraille.toExpandedBrailleAscii(t.value)},t.prototype.didMountBrailleInput=function(e){this.brailleInputNode=e},t.prototype.didUnmountBrailleInput=function(){this.brailleInputNode=void 0},t.prototype.handleBrailleFocus=function(e){var t=e.target;t&&setTimeout(function(){t.setSelectionRange(0,0)})},t.prototype.handleBrailleKeydown=function(e){if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){if(n.lookup(e)===n.UP)return this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),!1;if(n.lookup(e)===n.DOWN)return this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),!1;if(n.lookup(e)===n.ENTER)return this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),!1;if(n.lookup(e)===n.BACKSPACE&&document.activeElement===this.brailleInputNode&&""===this.getBraille())return this.dispatch({type:"backspace-from-braille"}),!1}return!0},t.prototype.forceModelFocus=function(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)},t.prototype.focusBrailleInput=function(){this.brailleInputNode&&document.activeElement!==this.brailleInputNode&&this.brailleInputNode.focus()},t.prototype.getPostLabel=function(){if(this.showError())return this.getError();if(this.getShowEvaluation()){var e=this.getValue();return void 0===e&&(e=NaN),Array.isArray(e)?e.length+" element list":"equals "+o.value(e).ariaString}return""},t.prototype.onBrailleInput=function(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});var t=this.getLatexValue(p.UnicodeBraille.coerceToSixDotCells(e));this.dispatch({type:"update-latex-from-braille",latex:t.isError?"":t.value,braille:e,id:this.props.id()})},t.prototype.getIndexSubscript=function(){return"_{"+(this.getIndex()+1)+"}"},t.prototype.getEvaluationDigits=function(){return this.controller.isScientificCalc()?10:7},t.prototype.onMountContainer=function(e){this.containerNode=e},t.prototype.onTapContainer=function(e){e.target!==this.containerNode||this.getShowEvaluation()||this.showError()||this.forceModelFocus()},t.prototype.template=function(){var r=this;return i.createElement("div",{class:function(){return{"dcg-basic-expression":!0,"dcg-focused":r.getIsFocused(),"dcg-braille-io":r.controller.renderAsBraille()}},onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},i.createElement(m,{predicate:function(){return r.controller.renderAsBraille()}},function(){return i.createElement("div",{class:i.const("dcg-braille-input")},i.createElement(d.default,{ariaLabel:function(){var e=r.getBrailleValue("eq"+r.getIndexSubscript());return e.isError?"":p.UnicodeBraille.toExpandedBrailleAscii(e.value)},didMount:r.bindFn(r.didMountBrailleInput),didUnmount:r.bindFn(r.didUnmountBrailleInput),onFocusedChanged:r.bindFn(r.onFocusedChanged),shouldFocus:r.bindFn(r.getIsFocused),onKeydown:r.bindFn(r.handleBrailleKeydown),onInput:r.bindFn(r.onBrailleInput),sixKeyInput:function(){return r.controller.getSixKeyInput()},value:function(){return r.getBraille()}}))}),i.createElement(m,{predicate:function(){return r.controller.renderAsBraille()}},function(){return i.createElement("div",{class:i.const("dcg-braille-evaluation-container")},i.createElement(m,{predicate:function(){return r.getShowEvaluation()}},function(){return i.createElement("div",{class:i.const("dcg-braille-evaluation")},i.createElement(y,{readonly:r.const("true"),class:r.const("dcg-braille-evaluation-inner"),value:function(){return r.getEvaluationBraille()},onFocus:r.bindFn(r.handleBrailleFocus),onKeydown:r.bindFn(r.handleBrailleKeydown),onInput:function(){}}))}),i.createElement(m,{predicate:function(){return r.showError()}},function(){return i.createElement("div",{class:i.const("dcg-braille-error")},i.createElement("div",{class:i.const("dcg-basic-expression-error")},i.createElement("i",{class:i.const("dcg-icon-error")})),i.createElement(v,{readonly:r.const("true"),class:r.const("dcg-braille-error-inner"),value:function(){return r.getError()},onFocus:r.bindFn(r.handleBrailleFocus),onKeydown:r.bindFn(r.handleBrailleKeydown),onInput:function(){}}))}))}),i.createElement(m,{predicate:function(){return r.controller.renderAsBraille()}},function(){return i.createElement("div",{class:i.const("dcg-exp-mathquill-container"),didMount:r.bindFn(r.didMountMQ),onTap:r.bindFn(r.forceModelFocus)},i.createElement(l.default,{latex:function(){return r.getLatex()},onReflow:r.bindFn(r.onMQReflow)}))}),i.createElement(m,{predicate:function(){return!r.controller.renderAsBraille()}},function(){return i.createElement("div",{class:i.const("dcg-exp-mathquill-container"),didMount:r.bindFn(r.didMountMQ)},i.createElement(c.default,{latex:function(){return r.getLatex()},onReflow:r.bindFn(r.onMQReflow),isFocused:r.bindFn(r.getIsFocused),capExpressionSize:function(){return r.controller.getCapExpressionSize()},config:r.const({typingAsteriskWritesTimesSymbol:r.controller.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:r.controller.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:r.controller.getRestrictedEditing()}),getAriaLabel:function(){return r.getAriaLabel()},getAriaPostLabel:function(){return r.getPostLabel()},hasError:function(){return!1},onUserPressedKey:function(e,t){r.controller.isSettingsMenuOpen()&&r.controller.dispatch({type:"close-settings-menu"}),r.dispatch({type:"keypad/press-key",key:e,evt:t})},onUserTypedText:function(e){return r.dispatch({type:"keypad/type-text",text:e})},onUserChangedLatex:function(e){r.dispatch({type:"update-latex",id:r.props.id(),latex:e})},onFocusedChanged:r.bindFn(r.onFocusedChanged),disableSpace:function(){return r.controller.getRestrictedEditing()}}))}),i.createElement("div",{class:i.const("dcg-exp-output-container")},i.createElement(m,{predicate:function(){return r.showError()&&!r.controller.renderAsBraille()}},function(){return i.createElement(h.Tooltip,{tooltip:r.bindFn(r.getError),gravity:r.const("w"),sticky:r.const(!0)},i.createElement("div",{class:i.const("dcg-basic-expression-error")},i.createElement("i",{class:i.const("dcg-icon-error")})))}),i.createElement(m,{predicate:function(){return r.getShowEvaluation()}},function(){return i.createElement("div",{class:function(){return{"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":Array.isArray(r.getValue())}}},i.createElement(l.default,{latex:function(){return r.getEvaluationLatex()}}),i.createElement(m,{predicate:r.bindFn(r.canDisplayEvaluationAsFraction)},function(){return i.createElement(h.Tooltip,{tooltip:r.bindFn(r.getFractionMessage),gravity:r.const("s"),sticky:r.const(!1)},i.createElement("span",{class:function(){return{"dcg-basic-fraction-toggle":!0,"dcg-selected":r.isFractionEvaluation()}},onTap:r.bindFn(r.toggleFractionEvaluation)},i.createElement("i",{class:i.const("dcg-icon-fraction")})))}))})))},t}(u.DCGViewBasic);t.default=b}),define("loadcss!basic/basic-list-view",function(){}),define("basic/basic-list-view",["require","exports","tslib","scroll_helpers","dcgview","./dcgview-basic","./expression-view","jquery","lib/conditional_blur","loadcss!./basic-list-view"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.Components,u=c.For,p=c.If,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.didShowAnswerHint=!1,e.didHideAnswerHint=!1,e}return r.__extends(e,t),e.prototype.template=function(){var t=this;return i.createElement("div",{class:i.const("dcg-basic-list-container"),role:i.const("complementary"),"aria-label":function(){return t.controller.t("Expression List")},didMount:this.bindFn(this.didMountContainer)},i.createElement("div",{class:i.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},i.createElement(p,{predicate:this.bindFn(this.showAnswerHint)},function(){return i.createElement("div",{class:i.const("dcg-answer-hint")},function(){return t.controller.t("Your answers show up on this side.")})})),i.createElement(u,{each:function(){return t.model.getExpressionOrder()}},i.createElement("div",{class:function(){return{"dcg-basic-list":!0,"dcg-projector-mode":t.controller.isProjectorMode()}}},function(e){return i.createElement(a.default,{controller:t.props.controller,id:t.const(e)})})))},e.prototype.didMountPlaceholder=function(e){s(e).on("dcg-tap",l.default)},e.prototype.showAnswerHint=function(){if(this.didHideAnswerHint)return!1;var e=this.model.getExpressionOrder()[0];return!(!this.model.shouldShowEvaluationForExpression(e)&&!this.didShowAnswerHint||(this.didShowAnswerHint=!0,(1<this.model.getNumberOfExpressions()||""===this.model.getExpressionLatex(e))&&(this.didHideAnswerHint=!0)))},e.prototype.didUpdate=function(){if(this.$container){var e=this.$container.find(".dcg-focused");0<e.length&&n.scrollVisible(e,this.$container,50)}},e.prototype.didMountContainer=function(e){this.$container=s(e)},e}(o.DCGViewBasic);t.default=d}),define("loadcss!basic/main",function(){}),define("basic/main",["require","exports","tslib","browser","keys","dcgview","./dcgview-basic","jquery","./keypad/fourfunction-control-bar","./keypad/scientific-control-bar","./keypad/single-expression-control-bar","./keypad/fourfunction-keypad","./keypad/single-expression-keypad","./keypad/scientific-keypad","./keypad/braille-keypad","./basic-list-view","lib/aria","loadcss!desmos-icons","loadcss!./main","loadcss!dcg-normalize"],function(e,t,r,n,i,o,a,s,l,c,u,p,d,h,f,g,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=o.Components.If,v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.template=function(){var e=this;return o.createElement(y,{predicate:function(){return e.controller.shouldRender()}},function(){return o.createElement("div",{class:function(){return{"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":e.controller.containerSize.width<570,"dcg-short":e.controller.containerSize.height<=500,"dcg-scientific-calculator":e.controller.isScientificCalc(),"dcg-four-function-calculator":e.controller.isFourFunctionCalc(),"dcg-container":!0}},onKeydown:e.bindFn(e.handleRootKeydown),"x-ms-format-detection":o.const("none")},o.createElement("div",{role:o.const("application"),"aria-label":function(){return e.controller.isScientificCalc()?e.controller.t(""):e.controller.isFourFunctionCalc()?e.controller.t("Desmos Four-Function Calculator"):""},class:function(){return{"dcg-calc-basic-main":!0,"dcg-inverted-colors":e.controller.getInvertedColors(),"dcg-projector-mode":e.controller.isProjectorMode(),"dcg-ipad":n.IS_IPAD,"dcg-has-background-color":e.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!e.controller.getAllowLinks()}},style:function(){return{"font-size":e.controller.getFontSize()+"px",background:e.controller.getBackgroundColor(),color:e.controller.getTextColor(),filter:e.controller.getInvertedColors()?"invert(100%)":"none"}}},o.createElement(g.default,{controller:e.props.controller}),o.createElement(y,{predicate:function(){return e.controller.isScientificCalc()&&e.model.isSingleExpression()}},function(){return o.createElement("div",null,o.createElement(u.default,{controller:e.props.controller}),o.createElement("div",{class:o.const("dcg-basic-keypad-container")},o.createElement(y,{predicate:function(){return!e.controller.renderAsBraille()}},function(){return o.createElement(d.default,{controller:e.props.controller})}),o.createElement(y,{predicate:function(){return e.controller.renderAsBraille()}},function(){return o.createElement(f.default,{controller:e.props.controller})})))}),o.createElement(y,{predicate:function(){return e.controller.isScientificCalc()&&!e.model.isSingleExpression()}},function(){return o.createElement("div",null,o.createElement(c.default,{controller:e.props.controller}),o.createElement("div",{class:o.const("dcg-basic-keypad-container")},o.createElement(y,{predicate:function(){return!e.controller.renderAsBraille()}},function(){return o.createElement(h.default,{controller:e.props.controller})}),o.createElement(y,{predicate:function(){return e.controller.renderAsBraille()}},function(){return o.createElement(f.default,{controller:e.props.controller})})))}),o.createElement(y,{predicate:function(){return e.controller.isFourFunctionCalc()}},function(){return o.createElement("div",null,o.createElement(l.default,{controller:e.props.controller}),o.createElement("div",{class:o.const("dcg-basic-keypad-container")},o.createElement(y,{predicate:function(){return!e.controller.renderAsBraille()}},function(){return o.createElement(p.default,{controller:e.props.controller})}),o.createElement(y,{predicate:function(){return e.controller.renderAsBraille()}},function(){return o.createElement(f.default,{controller:e.props.controller})})))})))})},t.prototype.handleRootKeydown=function(e){if(i.isUndo(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(i.isRedo(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(!e.metaKey&&!e.shiftKey)if(e.ctrlKey||e.altKey||i.lookup(e)!==i.BACKSPACE){if(e.ctrlKey===n.IS_APPLE&&e.altKey===!n.IS_APPLE){var t=i.lookupChar(e);if("N"===t)return this.dispatch({type:"set-braille-mode",mode:"nemeth"}),m.alert(this.controller.t("Braille mode Nemeth")),!1;if("U"===t)return this.dispatch({type:"set-braille-mode",mode:"ueb"}),m.alert(this.controller.t("Braille mode UEB")),!1;if("Q"===t||"X"===t)return this.dispatch({type:"set-braille-mode",mode:"none"}),m.alert(this.controller.t("Braille mode off")),!1;if("6"===t){var r=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",mode:r}),m.alert(r?this.controller.t("Six Key Braille Input on"):this.controller.t("Six Key Braille Input off")),!1}}}else if(!s(document.activeElement).is('input, textarea, [role="textbox"]'))return!1;return!0},t}(a.DCGViewBasic);t.default=v}),define("api/basic",["require","exports","tslib","dcgview","./abstract","main/shared-worker-pool","basic/controller","basic/main","lib/color-helpers","underscore_model","lib/deepCopy","lib/console"],function(e,t,i,r,n,o,a,s,f,l,c,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(e){return t.call(this,e)||this}return i.__extends(e,t),e.prototype.init=function(e){var t=this;(e=c.default(e)).backgroundColor&&!f.isValidHexColor(e.backgroundColor)&&(g.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete e.backgroundColor),e.textColor&&!f.isValidHexColor(e.textColor)&&(g.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete e.textColor);var r=i.__assign({qwertyKeyboard:!0,links:!0,degreeMode:!1,settingsMenu:!0,invertedColors:!1,backgroundColor:"#fff",textColor:"#000",brailleMode:"none",sixKeyInput:!1,projectorMode:!1,capExpressionSize:!1,functionDefinition:!0,autosize:!0,evaluationMode:"scientific",restrictedEditing:!1,additionalFunctions:["sqrt"],typingSlashWritesDivisionSymbol:!1,typingAsteriskWritesTimesSymbol:!1,decimalToFractionConversion:!1},e);this.settings=new l.UnderscoreModel;var n={workerPool:o.default,settingsProxy:this.settings};this.controller=new a.default(r,n),this.controller.onEventEmitted=function(e){"render"===e&&t.updateView(),t.triggerEvent(e,void 0)},this.setupDomChangeDetector(r.autosize)},e.prototype.onCreateView=function(){return r.mountToNode(s.default,this.rootElt,{controller:r.const(this.controller)})},e.prototype.setState=function(e,t){t||(t={}),this.controller.dispatch({type:"set-state-from-api",state:e,opts:{allowUndo:!!t.allowUndo}})},e.prototype.getState=function(){return c.default(this.controller.model.getPersistedState())},e.prototype.undo=function(){this.controller.dispatch({type:"undo",source:"api"})},e.prototype.redo=function(){this.controller.dispatch({type:"redo",source:"api"})},e.prototype.clearHistory=function(){this.controller.dispatch({type:"clear-history"})},e.prototype.setBlank=function(e){e||(e={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!e.allowUndo}})},e.prototype.updateSettings=function(e){if(null!=e)for(var t in e)switch(t){case"fontSize":var r=e[t];if(void 0===r)continue;this.controller.dispatch({type:"update-font-size",size:r});break;case"invertedColors":var n=e[t];if(void 0===n)continue;this.controller.dispatch({type:"update-inverted-colors",mode:n});break;case"backgroundColor":var i=e[t];if(void 0===i||!f.isValidHexColor(i)){g.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:i});break;case"textColor":var o=e[t];if(void 0===o||!f.isValidHexColor(o)){g.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:o});break;case"degreeMode":var a=e[t];if(void 0===a)continue;this.controller.dispatch({type:"update-degree-mode",mode:a});break;case"brailleMode":var s=e[t];this.controller.dispatch({type:"set-braille-mode",mode:s});break;case"sixKeyInput":var l=e[t];if(void 0===l)continue;this.controller.dispatch({type:"set-six-key-input",mode:l});break;case"projectorMode":var c=e[t];if(void 0===c)continue;this.controller.dispatch({type:"update-projector-mode",mode:c});break;case"capExpressionSize":var u=e[t];if(void 0===u)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:u});break;case"language":var p=e[t];if(void 0===p)continue;this.controller.dispatch({type:"update-language",language:p});break;case"settingsMenu":e.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!e.qwertyKeyboard}});var d=this.controller.getKeyboardMode();"qwerty"!==d&&"letters"!==d||this.controller.dispatch({type:"ABC"});break;case"functionDefinition":e.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!e.links}});break;case"decimalToFractionConversion":var h=e[t];if(void 0===h)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:h})}},e.prototype.focusFirstExpression=function(){this.controller.dispatch({type:"focus-first-expression"})},e.prototype.onResizeView=function(e){this.controller.dispatch({type:"ui/container-resized",size:e})},e.prototype.onDestroyView=function(){r.unmountFromNode(this.rootElt)},e.prototype.destroy=function(){this.controller.model.destroy(),t.prototype.destroy.call(this)},e}(n.default);t.BasicCalculator=u}),define("api/fourfunction",["require","exports","tslib","./basic","lib/deepCopy","lib/console"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function i(e,t){var r=n.call(this,e)||this;return r instanceof i?(r.init(function(e){if((e=o.default(e)).hasOwnProperty("typingSlashWritesDivisionSymbol")||(e.typingSlashWritesDivisionSymbol=!0),e.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(e.typingAsteriskWritesTimesSymbol=!0),e.exponentButtonForSquareRoot&&(a.warn("As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: \"exponent\"' instead."),e.additionalFunctions=["exponent"]),e.additionalFunctions){var t=e.additionalFunctions;"string"==typeof t&&(t=[t]),2<t.length&&(a.warn("additionalFunctions can only take up to 2 new functions. Using the first two."),t=t.slice(0,2));for(var r=0;r<t.length;r++)-1===["sqrt","exponent","percent"].indexOf(t[r])&&a.warn("Unrecognized value: '"+t[r]+"' for 'additionalFunction'. Valid values are 'sqrt', 'percent', or 'exponent'. Using default (\"sqrt\")");e.additionalFunctions=t}return e.additionalFunctions&&e.additionalFunctions.length||(e.additionalFunctions=["sqrt"]),e.evaluationMode="fourFunction",e}(t||{})),r):new i(e,t)}return r.__extends(i,n),i}(n.BasicCalculator);t.default=i}),define("api/scientific",["require","exports","tslib","./basic","lib/deepCopy"],function(e,t,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function o(e,t){var r,n=i.call(this,e)||this;return n instanceof o?(n.init((r=t||{},(r=a.default(r)).singleExpression?r.evaluationMode="singleExpressionScientific":r.evaluationMode="scientific",delete r.singleExpression,r)),n):new o(e,t)}return r.__extends(o,i),o}(n.BasicCalculator);t.default=i}),define("api/calculator",["require","console","pjs","underscore","i18n","main/calc_embed","main/calc_headless","underscore_model","mathquill","math/recttransformation","main/shared-clock-bus","main/shared-worker-pool","lib/number-to-latex","lib/color-helpers","expressions/colors","expressions/styles","expressions/opacity","graphing/columnmode","graphing/dragmode","graphing/axisarrowmode","main/font_sizes","main/label-sizes","main/label-orientations","expressions/image_file_to_data_url","lib/dom-change-detector","graphing/compute-async-screenshot-bounds","expressions/sanitize_expression","dcgview-helpers/mathquill-view","dcgview-helpers/mathquill-proxy","./fourfunction","./scientific"],function(e){function i(e){return e.hasOwnProperty("backgroundColor")&&!l(e.backgroundColor)&&(u.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete e.backgroundColor),e.hasOwnProperty("textColor")&&!l(e.textColor)&&(u.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete e.textColor),e}function c(r){var n={};r||(r={}),r=i(r);var e=function(e,t){r.hasOwnProperty(e)?n[e]=r[e]:n[e]=t};for(var t in e("keypad",!0),e("disableScrollFix",!1),e("graphpaper",!0),e("settingsMenu",!0),e("expressionsTopbar",!0),e("branding",!0),e("links",!0),e("autosize",!0),e("zoomButtons",n.graphpaper&&!n.lockViewport),e("pointsOfInterest",!0),e("plotSingleVariableImplicitEquations",!0),e("expressionsCollapsed",!1),e("capExpressionSize",!1),e("lockViewport",!1),e("administerSecretFolders",!1),e("advancedStyling",!1),e("redrawSlowly",!1),e("onlyTraceSelected",!1),e("disableMouseInteractions",!1),e("trace",!0),e("folders",!0),e("images",n.graphpaper),e("expressions",!0),e("border",!0),e("nativeOnscreenKeypad",!1),e("qwertyKeyboard",!0),e("restrictedFunctions",!1),e("notes",!0),e("degreeMode",!1),e("clearIntoDegreeMode",!1),e("functionDefinition",!0),e("distributions",!1),e("embosserSupport",!1),e("decimalToFractionConversion",!1),e("pasteGraphLink",!1),e("pasteTableData",!0),e("plaidMode",!1),e("imageUploadCallback",I),e("pasteGraphLinkCallback",!1),e("editOnWeb",!1),e("showHamburger",!1),e("invertedColors",!1),e("projectorMode",!1),e("fontSize",S.MEDIUM),e("colors",{RED:y.RED,BLUE:y.BLUE,GREEN:y.GREEN,ORANGE:y.ORANGE,PURPLE:y.PURPLE,BLACK:y.BLACK}),e("crossOriginSaveTest",!1),e("enableTabindex",!0),e("audioTraceReverseExpressions",!1),e("backgroundColor","#fff"),e("textColor","#000"),e("embosserSupport",!1),r.hasOwnProperty("menus")&&(u.warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),r.hasOwnProperty("settingsMenu")||(n.settingsMenu=!!r.menus),r.hasOwnProperty("expressionsTopbar")||(n.expressionsTopbar=!!r.menus)),r.hasOwnProperty("solutions")&&(u.warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),r.hasOwnProperty("pointsOfInterest")||(n.pointsOfInterest=!!r.solutions)),r.hasOwnProperty("singleVariableSolutions")&&u.warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),n.graphpaper||(n.expressionsCollapsed&&(n.expressionsCollapsed=!1,u.warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),n.zoomButtons&&(n.zoomButtons=!1,u.warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false."))),n.lockViewport&&n.zoomButtons&&(n.zoomButtons=!1,u.warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),r)r.hasOwnProperty(t)&&o.includes(O,t)&&(n[t]=r[t]);return n}function t(e,t){!Desmos.enabledFeatures||Desmos.enabledFeatures[e]?Desmos[e]=t:Desmos[e]=function(){throw new Error("The Desmos "+e+" is not enabled for this API key.")}}var u=e("console"),r=e("pjs"),o=e("underscore"),a=e("i18n"),p=e("main/calc_embed").default,n=e("main/calc_headless"),d=e("underscore_model").UnderscoreModel,s=e("mathquill"),h=e("math/recttransformation").RT,f=e("main/shared-clock-bus"),g=e("main/shared-worker-pool").default,m=e("lib/number-to-latex").default,l=e("lib/color-helpers").isValidHexColor,y=e("expressions/colors"),v=e("expressions/styles"),b=e("expressions/opacity"),x=e("graphing/columnmode"),w=e("graphing/dragmode"),_=e("graphing/axisarrowmode"),S=e("main/font_sizes"),E=e("main/label-sizes"),M=e("main/label-orientations"),I=e("expressions/image_file_to_data_url"),T=e("lib/dom-change-detector").default,C=e("graphing/compute-async-screenshot-bounds"),k=e("expressions/sanitize_expression"),P=e("dcgview-helpers/mathquill-view").default,D=e("dcgview-helpers/mathquill-proxy").MathQuillProxy,A=e("./fourfunction").default,L=e("./scientific").default,O=["showGrid","showXAxis","showYAxis","xAxisStep","yAxisStep","xAxisMinorSubdivisions","yAxisMinorSubdivisions","xAxisArrowMode","yAxisArrowMode","xAxisLabel","yAxisLabel","xAxisNumbers","yAxisNumbers","polarMode","polarNumbers","degreeMode","projectorMode","fontSize","invertedColors","language","restrictGridToFirstQuadrant"],q=["keypad","graphpaper","expressions","settingsMenu","zoomButtons","expressionsTopbar","capExpressionSize","pointsOfInterest","trace","border","lockViewport","expressionsCollapsed","capExpressionSize","administerSecretFolders","advancedStyling","images","imageUploadCallback","folders","notes","links","qwertyKeyboard","restrictedFunctions","pasteGraphLink","pasteTableData","degreeMode","clearIntoDegreeMode","autosize","plotSingleVariableImplicitEquations","colors","invertedColors","functionDefinition","projectorMode","decimalToFractionConversion","fontSize","language","backgroundColor","textColor","showHamburger","disableScrollFix","branding","redrawSlowly","onlyTraceSelected","disableMouseInteractions","nativeOnscreenKeypad","plaidMode","pasteGraphLinkCallback","editOnWeb","crossOriginSaveTest","enableTabindex","audioTraceReverseExpressions","distributions","embosserSupport","solutions","menus","singleVariableSolutions"],F=["disableScrollFix","branding","redrawSlowly","onlyTraceSelected","disableMouseInteractions","nativeOnscreenKeypad","plaidMode","pasteGraphLinkCallback","editOnWeb","crossOriginSaveTest","enableTabindex","audioTraceReverseExpressions","embosserSupport","solutions","menus","singleVariableSolutions"],N=function(e){var t={},r={};for(var n in e)o.includes(q,n)?t[n]=e[n]:o.includes(O,n)?r[n]=e[n]:u.warn("Unrecognized setting: "+n+". Ignoring.");return{configOptions:t,settingsOptions:r}},R=r(d,function(e,s,l){function t(e,t){var r={};return t.hasOwnProperty("x")&&(r.x=e.mapX(t.x)),t.hasOwnProperty("y")&&(r.y=e.mapY(t.y)),r}e.init=function(e,t,r){s.init.call(this);var n=c(t),i=N(n),o=i.configOptions,a=i.settingsOptions;this._calc=new p(e,g,o),this._calc.interceptTouch(),this.controller=this._calc.controller,this.controller.onEventsEmitted=function(e){this.setProperty("isAnyExpressionSelected",!!this.controller.getSelectedItem()),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());var t=P.getFocusedMathquill();for(var r in this.setProperty("focusedMathQuill",t?new D(t):void 0),e)e.hasOwnProperty(r)&&e[r]&&this.triggerEvent(r)}.bind(this),this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(a),this._sharedClockBusToken=f.subscribe(function(e){this._calc.tick(e)}.bind(this)),this.domChangeDetector=new T(e,function(e){switch(e.type){case"added":this._calc.resize(e.size);break;case"removed":this._calc.resize();break;case"resized":this._calc.resize(e.size)}}.bind(this)),n.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),"function"==typeof r&&r(this)},e.destroy=function(){function e(e){u.warn("You've destroyed this API instance. You can no longer call ."+e+"()")}for(var t in this._calc.destroy(),this.controller.onEventsEmitted=function(){},f.unsubscribe(this._sharedClockBusToken),this.domChangeDetector.destroy(),this)"function"==typeof this[t]?this[t]=e.bind(this,t):this.hasOwnProperty(t)&&delete this[t];this.destroy=function(){}},e._syncGraphpaperBounds=function(){this.controller.runAfterDispatch(function(){this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})}.bind(this))},e._initGraphSettings=function(){var t=d();this.settings=this.graphSettings=t,this.knownSettings=O;var r=this;O.forEach(function(e){r._calc.grapher.settings.observeAndSync(e,function(){r.controller.runAfterDispatch(function(){t.setProperty(e,r._calc.grapher.settings[e])})})}),q.forEach(function(e){o.includes(F,e)||r._calc.grapher.settings.config.observeAndSync(e,function(){r.controller.runAfterDispatch(function(){t.setProperty(e,r._calc.grapher.settings.config[e])})})})},e.updateSettings=function(e){e=i(e);var t=N(e),r=t.configOptions,n=t.settingsOptions;o.isEmpty(r)||this._calc.setOptions(r),o.isEmpty(n)||this._calc.grapher.settings.setGraphSettings(n),this.notifyControllerOfAPICall()},e.setGraphSettings=function(e){u.warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(e),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()},e.fetchLanguage=function(e){return a.fetchLanguage(e)},e.setDefaultState=function(e){this._calc.grapher.settings.setProperty("defaultState",e),this.notifyControllerOfAPICall()},e.mathToPixels=function(e){return t(h.fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates),e)},e.pixelsToMath=function(e){return t(h.fromRects(this.graphpaperBounds.pixelCoordinates,this.graphpaperBounds.mathCoordinates),e)};var n={expression:function(e,t,r){var n={type:"expression"};if(e.hasOwnProperty("id")?n.id=e.id.toString():n.id=t.generateId(),e.hasOwnProperty("latex")&&(n.latex=e.latex.toString()),e.hasOwnProperty("color")&&(n.color=e.color.toString()),e.hasOwnProperty("points")&&(n.points=!!e.points),e.hasOwnProperty("lines")&&(n.lines=!!e.lines),e.hasOwnProperty("style")&&(u.warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),o.contains([v.POINT,v.CROSS,v.OPEN],e.style)?n.pointStyle=e.style:o.contains([v.SOLID,v.DASHED,v.DOTTED],e.style)?n.lineStyle=e.style:u.warn("Invalid style: '"+e.style+"'.")),e.hasOwnProperty("pointStyle")&&(o.contains([v.POINT,v.CROSS,v.OPEN],e.pointStyle)?n.pointStyle=e.pointStyle:u.warn("Invalid pointStyle: '"+e.pointStyle+"'.")),e.hasOwnProperty("lineStyle")&&(o.contains([v.SOLID,v.DASHED,v.DOTTED],e.lineStyle)?n.lineStyle=e.lineStyle:u.warn("Invalid lineStyle: '"+e.lineStyle+"'.")),e.hasOwnProperty("hidden")&&(n.hidden=!!e.hidden),e.hasOwnProperty("secret")&&(n.secret=!!e.secret),e.hasOwnProperty("sliderBounds")&&(n.slider={min:m(e.sliderBounds.min),max:m(e.sliderBounds.max),step:m(e.sliderBounds.step)},n.slider.min&&(n.slider.hardMin=!0),n.slider.max&&(n.slider.hardMax=!0)),e.hasOwnProperty("parametricDomain")?(n.parametricDomain={min:m(e.parametricDomain.min),max:m(e.parametricDomain.max)},e.hasOwnProperty("domain")&&u.warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):e.hasOwnProperty("domain")&&(u.warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),n.parametricDomain={min:m(e.domain.min),max:m(e.domain.max)}),e.hasOwnProperty("polarDomain")&&(n.polarDomain={min:m(e.polarDomain.min),max:m(e.polarDomain.max)}),e.hasOwnProperty("dragMode")&&(o.contains(o.values(w),e.dragMode)?n.dragMode=e.dragMode:u.warn("Invalid dragMode: '"+e.dragMode+"'.")),e.hasOwnProperty("label")&&(n.label=e.label.toString()),e.hasOwnProperty("showLabel")&&(n.showLabel=!!e.showLabel),e.hasOwnProperty("labelSize")&&(o.contains(E.ALL,e.labelSize)?n.labelSize=e.labelSize:u.warn("Invalid labelSize: "+e.labelSize)),e.hasOwnProperty("labelOrientation")&&(o.contains(M.ALL,e.labelOrientation)?n.labelOrientation=e.labelOrientation:u.warn("Invalid labelOrientation: "+e.labelOrientation)),e.hasOwnProperty("fill")&&(n.fill=!!e.fill),e.hasOwnProperty("fillOpacity")){var i=parseFloat(e.fillOpacity);isNaN(i)||!isFinite(i)||i<0||1<i?(u.warn("Invalid fillOpacity: "+i+". Continuing with default."),n.fillOpacity=b.DEFAULT):n.fillOpacity=i}return n}};n.table=function(e,i,t){var r={type:"table"};return e.hasOwnProperty("id")?r.id=e.id.toString():r.id=i.generateId(),e.hasOwnProperty("columns")&&(r.columns=e.columns.map(function(e){return r=i,n={},(t=e).hasOwnProperty("id")?n.id=t.id.toString():n.id=r.generateId(),t.hasOwnProperty("latex")&&(n.latex=t.latex.toString()),t.hasOwnProperty("color")&&(n.color=t.color.toString()),t.hasOwnProperty("hidden")&&(n.hidden=!!t.hidden),t.hasOwnProperty("points")&&(n.points=!!t.points),t.hasOwnProperty("lines")&&(n.lines=!!t.lines),t.hasOwnProperty("values")&&(n.values=t.values.map(function(e){return e.toString()})),t.hasOwnProperty("columnMode")&&(u.warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),t.columnMode===x.POINTS_AND_LINES?(n.points=!0,n.lines=!0):t.columnMode===x.LINES?(n.points=!1,n.lines=!0):(n.points=!0,n.lines=!1),n.lines&&!n.points&&t.hasOwnProperty("dragMode")&&t.dragMode!==w.NONE&&(u.warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),n.points=!0),o.contains(o.values(x),t.columnMode)?n.columnMode=t.columnMode:u.warn("Invalid columnMode: '"+t.columnMode+"'.")),t.hasOwnProperty("dragMode")&&(o.contains(o.values(w),t.dragMode)?n.dragMode=t.dragMode===w.AUTO?w.NONE:t.dragMode:u.warn("Invalid dragMode: '"+t.dragMode+"'.")),n;var t,r,n})),r},n.folder=function(e,t,r){var n={type:"folder"};return e.hasOwnProperty("id")?n.id=e.id.toString():n.id=t.generateId(),e.hasOwnProperty("hidden")&&(n.hidden=!!e.hidden),n},n.image=function(e,t,r){var n={type:"image"};return e.hasOwnProperty("id")?n.id=e.id.toString():n.id=t.generateId(),e.hasOwnProperty("hidden")&&(n.hidden=!!e.hidden),n},e.notifyControllerOfAPICall=function(){this.controller.dispatch({type:"api-method-called"})},e.setExpression=function(e){var t,r=this.controller.getItemModel(e.id);if(r){if(e.type&&e.type!==r.type)return void u.warn("Cannot change type of expression from '"+r.type+"' to '"+e.type+"'.");if(!n.hasOwnProperty(r.type))return void u.warn("Cannot modify expressions of type: '"+e.type+"' through the API.");t=n[r.type](e,this.controller,!1),this.controller.dispatch({type:"set-expression-properties-from-api",id:t.id,properties:t})}else{if(e.type&&!n.hasOwnProperty(e.type))return void u.warn("Invalid expression type: '"+e.type+"'.");t=n[e.type||"expression"](e,this.controller,!0),this.controller.dispatch({type:"add-item-to-end-from-api",state:t})}},e.setExpressions=function(e){e.forEach(this.setExpression.bind(this)),this.notifyControllerOfAPICall()},e.removeExpression=function(e){var t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})},e.removeExpressions=function(e){e.forEach(this.removeExpression.bind(this)),this.notifyControllerOfAPICall()},e.removeSelected=function(){var e=this.controller.getSelectedItem();e&&this.controller.dispatch({type:"remove-item-by-id",id:e.id})},e.setMathBounds=function(e){e&&e.left<e.right&&e.bottom<e.top?this._calc.setViewport([e.left,e.right,e.bottom,e.top]):u.warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got "+JSON.stringify(e)),this.notifyControllerOfAPICall()},e.setViewport=function(e){4==e.length&&e[1]>e[0]&&e[3]>e[2]?this._calc.setViewport(e):u.warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+e),this.notifyControllerOfAPICall()},e.resize=function(){this.domChangeDetector.checkForChanges()},e.getState=function(){return this._calc.getState.apply(this._calc,arguments)},e.getExpressions=function(){return this.getState({stripDefaults:!1}).expressions.list.map(k)},e.setBlank=function(e){e||(e={}),this._calc.setBlank(e)},e.setState=function(e,t){t||(t={}),this._calc.setState(e,t)},e.undo=function(){this.controller.dispatch({type:"undo"})},e.redo=function(){this.controller.dispatch({type:"redo"})},e.clearHistory=function(){this.controller.dispatch({type:"clear-undoredo-history"})},e.screenshot=function(e){return this._calc.grapher.screenshot(e)},e._getMathAspectRatio=function(){var e=this.graphpaperBounds.mathCoordinates,t=this._calc.grapher.getProjection().pixelCoordinates,r=t.right-t.left,n=t.bottom-t.top;return e.width/r/(e.height/n)},e.isProjectionUniform=function(){return!!this._calc.grapher.getProjection().settings.squareAxes},e._parseAsyncScreenshotOpts=function(e){var t=e.mode||"contain",r=e.width||e.height||this.graphpaperBounds.pixelCoordinates.width,n=e.height||e.width||this.graphpaperBounds.pixelCoordinates.height,i=e.mathBounds||{},o=e.targetPixelRatio||1,a=e.preserveAxisNumbers,s=this._getMathAspectRatio(),l=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height;return{width:r,height:n,targetPixelRatio:o,preserveAxisNumbers:a,mathBounds:C({mode:t,width:r,height:n,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:l,mathAspectRatio:s,mathBounds:i})}},e.asyncScreenshot=function(t,r){if(arguments.length){if(1===arguments.length){if("function"!=typeof t)return void u.warn("asyncScreenshot expects a callback");r=t,t={}}t||(t={}),t=this._parseAsyncScreenshotOpts(t),l._sharedScreenshotCalc||(l._sharedScreenshotCalc=R());var n=l._sharedScreenshotCalc;n.setState(this.getState()),n.setMathBounds(t.mathBounds);var e=n._calc.evaluator,i=function(){var e=n.screenshot({width:t.width,height:t.height,targetPixelRatio:t.targetPixelRatio});r(e)},o=this.controller,a=f.subscribe(function(){o.areAnyImagesLoading()||(f.unsubscribe(a),e.notifyWhenSynced(i))})}else u.warn("asyncScreenshot expects a callback")},e.setOptions=function(){var e=this._calc.setOptions.apply(this._calc,arguments);return this.notifyControllerOfAPICall(),e},e.focusFirstExpression=function(){var e=this.controller.getItemModelByIndex(0);this.controller.dispatch({type:"move-focus-to-item",id:e.id,where:"end"})},e.HelperExpression=function(e){var t=e&&e.latex||"",r=d();return r.latex=t,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:r}}),r}}),B=r(R,function(e,t,r){e.init=function(){this._calc=n(g,c({})),this.controller=this._calc.controller,this._sharedClockBusToken=f.subscribe(function(e){this._calc.tick(e)}.bind(this))},e.resize=function(){}});return"undefined"==typeof Desmos&&(Desmos={}),Desmos.Colors={RED:y.RED,BLUE:y.BLUE,GREEN:y.GREEN,ORANGE:y.ORANGE,PURPLE:y.PURPLE,BLACK:y.BLACK},Desmos.imageFileToDataURL=I,Desmos.Styles=v,Desmos.supportedLanguages=Desmos.locales?Object.keys(Desmos.locales):[],Desmos.ColumnModes=x,Desmos.DragModes=w,Desmos.AxisArrowModes=_,Desmos.FontSizes=S,Desmos.LabelSizes=E,Desmos.LabelOrientations=M,Desmos.MathQuill=s,t("FourFunctionCalculator",A),t("ScientificCalculator",L),t("GraphingCalculator",R),Desmos.HeadlessGraphingCalculator=B,Desmos.Calculator=Desmos.GraphingCalculator,{Calculator:R,GraphingCalculator:R,FourFunctionCalculator:A,ScientificCalculator:L,HeadlessGraphingCalculator:B}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("vendor/bugsnag",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).bugsnag=e()}}(function(){function e(){return G((Math.random()*ee<<0).toString(J),Z)}function t(){return"c"+(new Date).getTime().toString(J)+G((Q=Q<ee?Q:0,++Q-1).toString(J),Z)+$()+(e()+e())}function n(){if(!Je(tt(),this[Qe])){var e={status:this.status,request:this[Ze]+" "+this[Qe]};400<=this.status?et.leaveBreadcrumb("XMLHttpRequest failed",e,$e):et.leaveBreadcrumb("XMLHttpRequest succeeded",e,$e)}}function i(){Je(tt(),this[Qe])||et.leaveBreadcrumb("XMLHttpRequest error",{request:this[Ze]+" "+this[Qe]},$e)}function h(e){return"[Throws: "+(e?e.message:"?")+"]"}function f(e,t){try{return e[t]}catch(e){return h(e)}}function o(e){var p=[],d=0;return function e(t,r){function n(){return Tt<r&&It<d}if(d++,void 0===r&&(r=0),Mt<r)return Ct;if(n())return Ct;if(null===t||"object"!=typeof t)return t;if(function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return!0;return!1}(p,t))return"[Circular]";if(p.push(t),"function"==typeof t.toJSON)try{d--;var i=e(t.toJSON(),r);return p.pop(),i}catch(t){return h(t)}if(l=t,"[object Array]"===Object.prototype.toString.call(l)){for(var o=[],a=0,s=t.length;a<s;a++){if(n()){o.push(Ct);break}o.push(e(t[a],r+1))}return p.pop(),o}var l,c={};try{for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){if(n()){c[u]=Ct;break}c[u]=e(f(t,u),r+1)}}catch(t){}return p.pop(),c}(e)}var r=function(e,t,r){for(var n=r,i=0,o=e.length;i<o;i++)n=t(n,e[i],i,e);return n},a=!{toString:null}.propertyIsEnumerable("toString"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(e){return e<10?"0"+e:e},c=function(e,i){return r(e,function(e,t,r,n){return e.concat(i(t,r,n))},[])},u=r,p=function(e,i){return r(e,function(e,t,r,n){return i(t,r,n)?e.concat(t):e},[])},d=function(e,i){return r(e,function(e,t,r,n){return!0===e||t===i},!1)},g=function(e){var t=[],r=void 0;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);if(!a)return t;for(var n=0,i=s.length;n<i;n++)Object.prototype.hasOwnProperty.call(e,s[n])&&t.push(s[n]);return t},m=function(e){return"[object Array]"===Object.prototype.toString.call(e)},y=function(){var e=new Date;return e.getUTCFullYear()+"-"+l(e.getUTCMonth()+1)+"-"+l(e.getUTCDate())+"T"+l(e.getUTCHours())+":"+l(e.getUTCMinutes())+":"+l(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},v=y,b=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"[anonymous]",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"manual",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:v();(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.type=r,this.name=e,this.metaData=t,this.timestamp=n}return i.prototype.toJSON=function(){return{type:this.type,name:this.name,timestamp:this.timestamp,metaData:this.metaData}},i}(),x={},w=d;x.positiveIntIfDefined=function(e){return w(["undefined","number"],typeof e)&&parseInt(""+e,10)===e&&0<e},x.stringWithLength=function(e){return"string"==typeof e&&!!e.length};var _={},S=p,E=u,M=g,I=m,T=d,C=x.positiveIntIfDefined,k=x.stringWithLength;_.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:k},appVersion:{defaultValue:function(){return null},message:"should be a string",validate:function(e){return null===e||k(e)}},autoNotify:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return!0===e||!1===e}},beforeSend:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:function(e){return"function"==typeof e||I(e)&&S(e,function(e){return"function"==typeof e}).length===e.length}},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }. sessions is optional if autoCaptureSessions=false",validate:function(e,t){return e&&"object"==typeof e&&k(e.notify)&&(!1===t.autoCaptureSessions||k(e.sessions))&&0===S(M(e),function(e){return!T(["notify","sessions"],e)}).length}},autoCaptureSessions:{defaultValue:function(e,t){return void 0===t.endpoints||!!t.endpoints&&!!t.endpoints.sessions},message:"should be true|false",validate:function(e){return!0===e||!1===e}},notifyReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(e){return null===e||I(e)&&S(e,function(e){return"string"==typeof e}).length===e.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(e){return"string"==typeof e&&e.length}},maxBreadcrumbs:{defaultValue:function(){return 20},message:"should be a number 40",validate:function(e){return 0===e||C(e)&&(void 0===e||e<=40)}},autoBreadcrumbs:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return"boolean"==typeof e}},user:{defaultValue:function(){return null},message:"(object) user should be an object",validate:function(e){return"object"==typeof e}},metaData:{defaultValue:function(){return null},message:"should be an object",validate:function(e){return"object"==typeof e}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(r){return!r||r&&E(["debug","info","warn","error"],function(e,t){return e&&"function"==typeof r[t]},!0)}}},_.mergeDefaults=function(r,n){if(!r||!n)throw new Error("opts and schema objects are required");return E(M(n),function(e,t){return e[t]=void 0!==r[t]?r[t]:n[t].defaultValue(r[t],r),e},{})},_.validate=function(r,n){if(!r||!n)throw new Error("opts and schema objects are required");var e=E(M(n),function(e,t){return n[t].validate(r[t],r)?e:e.concat({key:t,message:n[t].message,value:r[t]})},[]);return{valid:!e.length,errors:e}};var P=function(e){return e.app&&"string"==typeof e.app.releaseStage?e.app.releaseStage:e.config.releaseStage},D=function(e){return!(!e||!e.stack&&!e.stacktrace&&!e["opera#sourceloc"]||"string"!=typeof(e.stack||e.stacktrace||e["opera#sourceloc"])||e.stack===e.name+": "+e.message)},A={};!function(e,t){"use strict";"object"==typeof A?A=t():e.StackFrame=t()}(this,function(){"use strict";function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}function n(e){return e.charAt(0).toUpperCase()+e.substring(1)}function e(e){return function(){return this[e]}}function t(e){if(e instanceof Object)for(var t=0;t<s.length;t++)e.hasOwnProperty(s[t])&&void 0!==e[s[t]]&&this["set"+n(s[t])](e[s[t]])}var i=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],a=["fileName","functionName","source"],s=i.concat(o,a,["args"]);t.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof t)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new t(e)}},toString:function(){return(this.getFunctionName()||"{anonymous}")+("("+(this.getArgs()||[]).join(",")+")")+(this.getFileName()?"@"+this.getFileName():"")+(r(this.getLineNumber())?":"+this.getLineNumber():"")+(r(this.getColumnNumber())?":"+this.getColumnNumber():"")}};for(var l=0;l<i.length;l++)t.prototype["get"+n(i[l])]=e(i[l]),t.prototype["set"+n(i[l])]=function(t){return function(e){this[t]=Boolean(e)}}(i[l]);for(var c=0;c<o.length;c++)t.prototype["get"+n(o[c])]=e(o[c]),t.prototype["set"+n(o[c])]=function(t){return function(e){if(!r(e))throw new TypeError(t+" must be a Number");this[t]=Number(e)}}(o[c]);for(var u=0;u<a.length;u++)t.prototype["get"+n(a[u])]=e(a[u]),t.prototype["set"+n(a[u])]=function(t){return function(e){this[t]=String(e)}}(a[u]);return t});var L={};!function(e,t){"use strict";"object"==typeof L?L=t(A):e.ErrorStackParser=t(e.StackFrame)}(this,function(s){"use strict";var t=/(^|@)\S+\:\d+/,r=/^\s*at .*(\S+\:\d+|\(native\))/m,n=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(r))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(r)},this).map(function(e){-1<e.indexOf("(eval ")&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),r=this.extractLocation(t.pop()),n=t.join(" ")||void 0,i=-1<["eval","<anonymous>"].indexOf(r[0])?void 0:r[0];return new s({functionName:n,fileName:i,lineNumber:r[1],columnNumber:r[2],source:e})},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(n)},this).map(function(e){if(-1<e.indexOf(" > eval")&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new s({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(t),n=r&&r[1]?r[1]:void 0,i=this.extractLocation(e.replace(t,""));return new s({functionName:n,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:e})},this)},parseOpera:function(e){return!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[],i=2,o=r.length;i<o;i+=2){var a=t.exec(r[i]);a&&n.push(new s({fileName:a[2],lineNumber:a[1],source:r[i]}))}return n},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[],i=0,o=r.length;i<o;i+=2){var a=t.exec(r[i]);a&&n.push(new s({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:r[i]}))}return n},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(e){var t,r=e.split("@"),n=this.extractLocation(r.pop()),i=r.shift()||"",o=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;i.match(/\(([^\)]*)\)/)&&(t=i.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var a=void 0===t||"[arguments not available]"===t?void 0:t.split(",");return new s({functionName:o,args:a,fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:e})},this)}}});var O={};!function(e,t){"use strict";"object"==typeof O?O=t(A):e.StackGenerator=t(e.StackFrame)}(this,function(a){return{backtrace:function(e){var t=[],r=10;"object"==typeof e&&"number"==typeof e.maxStackSize&&(r=e.maxStackSize);for(var n=arguments.callee;n&&t.length<r&&n.arguments;){for(var i=new Array(n.arguments.length),o=0;o<i.length;++o)i[o]=n.arguments[o];/function(?:\s+([\w$]+))+\s*\(/.test(n.toString())?t.push(new a({functionName:RegExp.$1||void 0,args:i})):t.push(new a({args:i}));try{n=n.caller}catch(e){break}}return t}}});var q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F=u,N=p,R=function(){function i(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:V();(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.__isBugsnagReport=!0,this._ignored=!1,this._handledState=n,this.app=void 0,this.apiKey=void 0,this.breadcrumbs=[],this.context=void 0,this.device=void 0,this.errorClass=U(e,"[no error class]"),this.errorMessage=U(t,"[no error message]"),this.groupingHash=void 0,this.metaData={},this.request=void 0,this.severity=this._handledState.severity,this.stacktrace=F(r,function(e,t){var r=B(t);try{return"{}"===JSON.stringify(r)?e:e.concat(r)}catch(t){return e}},[]),this.user=void 0,this.session=void 0}return i.prototype.ignore=function(){this._ignored=!0},i.prototype.isIgnored=function(){return this._ignored},i.prototype.updateMetaData=function(e){var t;if(!e)return this;var r=void 0;return null===(arguments.length<=1?void 0:arguments[1])?this.removeMetaData(e):null===(arguments.length<=2?void 0:arguments[2])?this.removeMetaData(e,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):("object"==typeof(arguments.length<=1?void 0:arguments[1])&&(r=arguments.length<=1?void 0:arguments[1]),"string"==typeof(arguments.length<=1?void 0:arguments[1])&&((t={})[arguments.length<=1?void 0:arguments[1]]=arguments.length<=2?void 0:arguments[2],r=t),r&&(this.metaData[e]||(this.metaData[e]={}),this.metaData[e]=q({},this.metaData[e],r)),this)},i.prototype.removeMetaData=function(e,t){return"string"!=typeof e||(t?this.metaData[e]&&delete this.metaData[e][t]:delete this.metaData[e]),this},i.prototype.toJSON=function(){return{payloadVersion:"4",exceptions:[{errorClass:this.errorClass,message:this.errorMessage,stacktrace:this.stacktrace,type:"browserjs"}],severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,breadcrumbs:this.breadcrumbs,context:this.context,user:this.user,metaData:this.metaData,groupingHash:this.groupingHash,request:this.request,session:this.session}},i}(),B=function(e){var t={file:e.fileName,method:j(e.functionName),lineNumber:e.lineNumber,columnNumber:e.columnNumber,code:void 0,inProject:void 0};return-1<t.lineNumber&&!t.file&&!t.method&&(t.file="global code"),t},j=function(e){return/^global code$/i.test(e)?"global code":e},V=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},U=function(e,t){return"string"==typeof e&&e?e:t};R.getStacktrace=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return D(e)?L.parse(e).slice(t):N(O.backtrace(),function(e){return-1===(e.functionName||"").indexOf("StackGenerator$$")}).slice(1+r)},R.ensureReport=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(e.__isBugsnagReport)return e;try{var n=R.getStacktrace(e,t,1+r);return new R(e.name,e.message,n)}catch(t){return new R(e.name,e.message,[])}};var z=R,G=function(e,t){var r="000000000"+e;return r.substr(r.length-t)},H="object"==typeof window?window:self,W=0;for(var K in H)Object.hasOwnProperty.call(H,K)&&W++;var Y=navigator.mimeTypes?navigator.mimeTypes.length:0,X=G((Y+navigator.userAgent.length).toString(36)+W.toString(36),4),$=function(){return X},Q=0,Z=4,J=36,ee=Math.pow(J,Z);t.fingerprint=$;var te=t,re=y,ne=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.id=te(),this.startedAt=re(),this._handled=0,this._unhandled=0}return e.prototype.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},e.prototype.trackError=function(e){this[e._handledState.unhandled?"_unhandled":"_handled"]+=1},e}(),ie=function(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}},oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ae=c,se=u,le=d,ce=m,ue="Usage error.",pe="Bugsnag usage error.",de=function(){},he=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:_.schema,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),!(e&&e.name&&e.version&&e.url))throw new Error("`notifier` argument is required");this.notifier=e,this.configSchema=t,this._configured=!1,this._transport={sendSession:de,sendReport:de},this._logger={debug:de,info:de,warn:de,error:de},this.plugins=[],this.session=r,this.beforeSession=[],this.breadcrumbs=[],this.app={},this.context=void 0,this.device=void 0,this.metaData=void 0,this.request=void 0,this.user={},this.BugsnagReport=z,this.BugsnagBreadcrumb=b,this.BugsnagSession=ne}return n.prototype.configure=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config=_.mergeDefaults(oe({},this.config,e),this.configSchema);var t=_.validate(this.config,this.configSchema);if(1==!t.valid)throw new Error(me(t.errors));return"function"==typeof this.config.beforeSend&&(this.config.beforeSend=[this.config.beforeSend]),null!==this.config.appVersion&&(this.app.version=this.config.appVersion),this.config.metaData&&(this.metaData=this.config.metaData),this.config.user&&(this.user=this.config.user),this.config.logger&&this.logger(this.config.logger),this._configured=!0,this._logger.debug("Loaded!"),this},n.prototype.use=function(e){return this.plugins.push(e),e.init(this)},n.prototype.transport=function(e){return this._transport=e,this},n.prototype.logger=function(e,t){return this._logger=e,this},n.prototype.sessionDelegate=function(e){return this._sessionDelegate=e,this},n.prototype.startSession=function(){return this._sessionDelegate?this._sessionDelegate.startSession(this):(this._logger.warn("No session implementation is installed"),this)},n.prototype.leaveBreadcrumb=function(e,t,r,n){if(!this._configured)throw new Error("client not configured");if(r="string"==typeof r?r:void 0,n="string"==typeof n?n:void 0,t="object"==typeof t&&null!==t?t:void 0,"string"==typeof(e=e||void 0)||t){var i=new b(e,t,r,n);return this.breadcrumbs.push(i),this.breadcrumbs.length>this.config.maxBreadcrumbs&&(this.breadcrumbs=this.breadcrumbs.slice(this.breadcrumbs.length-this.config.maxBreadcrumbs)),this}},n.prototype.notify=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this._configured)throw new Error("client not configured");var r=P(this),n=fe(e,t,this._logger),i=n.err,o=n.errorFramesToSkip,a=n._opts;if(a&&(t=a),!i){var s=ye("nothing");this._logger.warn(ue+" "+s),i=new Error(pe+" "+s)}"object"==typeof t&&null!==t||(t={});var l=z.ensureReport(i,o,1);if(l.app=oe({releaseStage:r},l.app,this.app),l.context=l.context||t.context||this.context||void 0,l.device=oe({},l.device,this.device,t.device),l.request=oe({},l.request,this.request,t.request),l.user=oe({},l.user,this.user,t.user),l.metaData=oe({},l.metaData,this.metaData,t.metaData),l.breadcrumbs=this.breadcrumbs.slice(0),this.session&&(this.session.trackError(l),l.session=this.session),void 0!==t.severity&&(l.severity=t.severity,l._handledState.severityReason={type:"userSpecifiedSeverity"}),ce(this.config.notifyReleaseStages)&&!le(this.config.notifyReleaseStages,r))return this._logger.warn("Report not sent due to releaseStage/notifyReleaseStages configuration"),!1;var c=l.severity,u=[].concat(t.beforeSend).concat(this.config.beforeSend);return se(u,function(e,t){return!0===e||"function"==typeof t&&!1===t(l)||!!l.isIgnored()},!1)?(this._logger.debug("Report not sent due to beforeSend callback"),!1):(this.config.autoBreadcrumbs&&this.leaveBreadcrumb(l.errorClass,{errorClass:l.errorClass,errorMessage:l.errorMessage,severity:l.severity},"error"),c!==l.severity&&(l._handledState.severityReason={type:"userCallbackSetSeverity"}),this._transport.sendReport(this._logger,this.config,{apiKey:l.apiKey||this.config.apiKey,notifier:this.notifier,events:[l]}),!0)},n}(),fe=function(e,t,r){var n=void 0,i=0,o=void 0;switch(typeof e){case"string":if("string"==typeof t){var a=ye("string/string");r.warn(ue+" "+a),n=new Error(pe+" "+a),o={metaData:{notifier:{notifyArgs:[e,t]}}}}else n=new Error(String(e)),i+=2;break;case"number":case"boolean":n=new Error(String(e));break;case"function":var s=ye("function");r.warn(ue+" "+s),n=new Error(pe+" "+s);break;case"object":if(null!==e&&(ie(e)||e.__isBugsnagReport))n=e;else if(null!==e&&ge(e))(n=new Error(e.message||e.errorMessage)).name=e.name||e.errorClass,i+=2;else{var l=ye("unsupported object");r.warn(ue+" "+l),n=new Error(pe+" "+l)}}return{err:n,errorFramesToSkip:i,_opts:o}},ge=function(e){return!("string"!=typeof e.name&&"string"!=typeof e.errorClass||"string"!=typeof e.message&&"string"!=typeof e.errorMessage)},me=function(e){return"Bugsnag configuration error\n"+ae(e,function(e){return'"'+e.key+'" '+e.message+" \n    got "+ve(e.value)}).join("\n\n")},ye=function(e){return"notify() expected error/opts parameters, got "+e},ve=function(e){return"object"==typeof e?JSON.stringify(e):String(e)},be=he,xe=x.positiveIntIfDefined,we={init:function(t){var r=0;t.config.beforeSend.push(function(e){return r>=t.config.maxEvents?e.ignore():void r++}),t.refresh=function(){r=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer 100",validate:function(e){return xe(e)&&e<100}}}},_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Se=_.schema,Ee=c,Me={releaseStage:{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"},message:"should be set",validate:x.stringWithLength},collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return!0===e||!1===e}},logger:_e({},Se.logger,{defaultValue:function(){return"undefined"!=typeof console&&"function"==typeof console.debug?Ie():void 0}})},Ie=function(){var r={},n=console.log;return Ee(["debug","info","warn","error"],function(e){var t=console[e];r[e]="function"==typeof t?t.bind(console,"[bugsnag]"):n.bind(console,"[bugsnag]")}),r},Te={},Ce=c,ke=u,Pe=p;Te.init=function(o){Ce(De,function(n){var i=console[n];console[n]=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.leaveBreadcrumb("Console output",ke(t,function(e,t,r){var n=String(t);if("[object Object]"===n)try{n=JSON.stringify(t)}catch(e){}return e["["+r+"]"]=n,e},{severity:0===n.indexOf("group")?"log":n}),"log"),i.apply(console,t)},console[n]._restore=function(){console[n]=i}})},Te.configSchema={consoleBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}};var De=Pe(["log","debug","info","warn","error"],function(e){return"undefined"!=typeof console&&"function"==typeof console[e]}),Ae={init:function(e){e.config.beforeSend.unshift(function(e){e.context||(e.context=window.location.pathname)})}},Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oe=y,qe={init:function(e){e.config.beforeSend.unshift(function(e){e.device=Le({time:Oe(),locale:navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||navigator.language,userAgent:navigator.userAgent},e.device)}),e.beforeSession.push(function(e){e.device={userAgent:navigator.userAgent}})}},Fe={},Ne=u,Re=/^.*<script.*?>/,Be=/<\/script>.*$/,je=(Fe={init:function(e){var s="",l=!1,c=function(){return document.documentElement.outerHTML},u=window.location.href;s=c(),document.onreadystatechange=function(){"interactive"===document.readyState&&(s=c(),l=!0)},e.config.beforeSend.unshift(function(e){var n=e.stacktrace[0];if(!n||!n.file||!n.lineNumber)return n;if(n.file.replace(/#.*$/,"")!==u.replace(/#.*$/,""))return n;l&&s||(s=c());var t=["\x3c!-- DOC START --\x3e"].concat(s.split("\n")),r=je(t,n.lineNumber-1),i=r.script,o=r.start,a=Ne(i,function(e,t,r){return 10<Math.abs(o+r+1-n.lineNumber)||(e[""+(o+r+1)]=t),e},{});n.code=a,e.updateMetaData("script",{content:i.join("\n")})})}}).extractScriptContent=function(e,t){for(var r=t;r<e.length&&!Be.test(e[r]);)r++;for(var n=r;0<r&&!Re.test(e[r]);)r--;var i=r,o=e.slice(i,n+1);return o[0]=o[0].replace(Re,""),o[o.length-1]=o[o.length-1].replace(Be,""),{script:o,start:i}},Ve={init:function(n){"addEventListener"in window&&window.addEventListener("click",function(e){var t=void 0,r=void 0;try{t=Ue(e.target),r=function e(t){var r=[t.tagName];if(t.id&&r.push("#"+t.id),t.className&&t.className.length&&r.push("."+t.className.split(" ").join(".")),!document.querySelectorAll||!Array.prototype.indexOf)return r.join("");try{if(1===document.querySelectorAll(r.join("")).length)return r.join("")}catch(t){return r.join("")}if(1<t.parentNode.childNodes.length){var n=Array.prototype.indexOf.call(t.parentNode.childNodes,t)+1;r.push(":nth-child("+n+")")}return 1===document.querySelectorAll(r.join("")).length?r.join(""):t.parentNode?e(t.parentNode)+" > "+r.join(""):r.join("")}(e.target)}catch(e){r=t="[hidden]",n._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/y94fq5zm")}n.leaveBreadcrumb("UI click",{targetText:t,targetSelector:r},"user")},!0)},configSchema:{interactionBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}}},Ue=function(e){var t,r,n=e.textContent||e.innerText||"";return n||"submit"!==e.type&&"button"!==e.type||(n=e.value),n=n.replace(/^\s+|\s+$/g,""),r=140,(t=n)&&t.length<=r?t:t.slice(0,r-"(...)".length)+"(...)"},ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ge={init:function(e){e.config.collectUserIp||e.config.beforeSend.push(function(e){e.user=ze({id:"[NOT COLLECTED]"},e.user),e.request=ze({clientIp:"[NOT COLLECTED]"},e.request)})}},He={init:function(r){if("addEventListener"in window){var e=function(e){return function(){return r.leaveBreadcrumb(e,{},"navigation")}};window.addEventListener("pagehide",e("Page hidden"),!0),window.addEventListener("pageshow",e("Page shown"),!0),window.addEventListener("load",e("Page loaded"),!0),window.document.addEventListener("DOMContentLoaded",e("DOMContentLoaded"),!0),window.addEventListener("load",function(){return window.addEventListener("popstate",e("Navigated back"),!0)}),window.addEventListener("hashchange",function(e){var t=e.oldURL?{from:We(e.oldURL),to:We(e.newURL),state:Ye()}:{to:We(window.location.href)};r.leaveBreadcrumb("Hash changed",t,"navigation")},!0),window.history.replaceState&&Ke(r,window.history,"replaceState"),window.history.pushState&&Ke(r,window.history,"pushState"),r.leaveBreadcrumb("Bugsnag loaded",{},"navigation")}},configSchema:{navigationBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}}},We=function(e){var t=document.createElement("A");return t.href=e,""+t.pathname+t.search+t.hash},Ke=function(s,l,c){var u=l[c];l[c]=function(e,t,r){var n,i,o,a;s.leaveBreadcrumb("History "+c,(n=e,i=t,o=r,a=We(window.location.href),{title:i,state:n,prevState:Ye(),to:o||a,from:a}),"navigation"),"function"==typeof s.refresh&&s.refresh(),s.session&&s.startSession(),u.apply(l,[e,t].concat(void 0!==r?r:[]))},l[c]._restore=function(){l[c]=u}},Ye=function(){try{return window.history.state}catch(e){}},Xe={},$e="request",Qe="BS~~U",Ze="BS~~M",Je=d,et=void 0,tt=function(){return[et.config.endpoints.notify,et.config.endpoints.sessions]};Xe.init=function(e){et=e,rt(),nt()},Xe.configSchema={networkBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}};var rt=function(){if("addEventListener"in window.XMLHttpRequest.prototype){var r=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(e,t){this[Qe]=t,this[Ze]=e,this["BS~~S"]&&(this.removeEventListener("load",n),this.removeEventListener("error",i)),this.addEventListener("load",n),this.addEventListener("error",i),this["BS~~S"]=!0,r.apply(this,arguments)}}},nt=function(){if("fetch"in window){var a=window.fetch;window.fetch=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var i=n[0],r=n[1],o="GET";return r&&r.method&&(o=r.method),new Promise(function(t,r){a.apply(void 0,n).then(function(e){it(e,o,i),t(e)}).catch(function(e){ot(o,i),r(e)})})}}},it=function(e,t,r){var n={status:e.status,request:t+" "+r};400<=e.status?et.leaveBreadcrumb("fetch() failed",n,$e):et.leaveBreadcrumb("fetch() succeeded",n,$e)},ot=function(e,t){et.leaveBreadcrumb("fetch() error",{request:e+" "+t},$e)},at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},st={init:function(e){e.config.beforeSend.unshift(function(e){e.request&&e.request.url||(e.request=at({},e.request,{url:window.location.href}))})}},lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ct=c,ut=m,pt=d,dt={init:function(e){return e.sessionDelegate(ht)}},ht={startSession:function(e){var t=e;t.session=new e.BugsnagSession,ct(t.beforeSession,function(e){return e(t)});var r=P(t);return ut(t.config.notifyReleaseStages)&&!pt(t.config.notifyReleaseStages,r)?t._logger.warn("Session not sent due to releaseStage/notifyReleaseStages configuration"):t.config.endpoints.sessions?t._transport.sendSession(t._logger,t.config,{notifier:t.notifier,device:t.device,app:lt({releaseStage:r},t.app),sessions:[{id:t.session.id,startedAt:t.session.startedAt,user:t.user}]}):t._logger.warn("Session not sent due to missing endpoints.sessions configuration"),t}},ft={},gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mt=c,yt=(ft={init:function(e){e.config.beforeSend.push(function(e){e.stacktrace=mt(e.stacktrace,function(e){return gt({},e,{file:yt(e.file)})})})}})._strip=function(e){return"string"==typeof e?e.replace(/\?.*$/,"").replace(/#.*$/,""):e},vt={},bt=u;vt.init=function(o){var r=function(e){var t=e.reason,r=!1;e.detail&&e.detail.reason&&(t=e.detail.reason,r=!0);var n={severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},i=void 0;if(t&&D(t))i=new o.BugsnagReport(t.name,t.message,L.parse(t),n),r&&(i.stacktrace=bt(i.stacktrace,wt(t),[]));else{(i=new o.BugsnagReport(t&&t.name?t.name:"UnhandledRejection",t&&t.message?t.message:'Rejection reason was not an Error. See "Promise" tab for more detail.',[],n)).updateMetaData("promise","rejection reason",xt(t))}o.notify(i)};"addEventListener"in window?window.addEventListener("unhandledrejection",r):window.onunhandledrejection=function(e,t){r({detail:{reason:e,promise:t}})},r};var xt=function(e){return null==e?"undefined (or null)":ie(e)?((t={})[Object.prototype.toString.call(e)]={name:e.name,message:e.message,code:e.code,stack:e.stack},t):e;var t},wt=function(r){return function(e,t){return t.file===r.toString()?e:(t.method&&(t.method=t.method.replace(/^\s+/,"")),e.concat(t))}},_t={init:function(c){var u=window.onerror;window.onerror=function(e,t,r,n,i){if(0===r&&/Script error\.?/.test(e))c._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/y94fq5zm");else{var o={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},a=void 0;if(i)i.name&&i.message?a=new c.BugsnagReport(i.name,i.message,St(c.BugsnagReport.getStacktrace(i),t,r,n),o):(a=new c.BugsnagReport("window.onerror",String(i),St(c.BugsnagReport.getStacktrace(i,1),t,r,n),o)).updateMetaData("window onerror",{error:i});else if("object"!=typeof e||null===e||t||r||n||i)(a=new c.BugsnagReport("window.onerror",String(e),St(c.BugsnagReport.getStacktrace(i,1),t,r,n),o)).updateMetaData("window onerror",{event:e});else{var s=e.type?"Event: "+e.type:"window.onerror",l=e.message||e.detail||"";(a=new c.BugsnagReport(s,l,c.BugsnagReport.getStacktrace(new Error,1).slice(1),o)).updateMetaData("window onerror",{event:e})}c.notify(a),"function"==typeof u&&u(e,t,r,n,i)}}}},St=function(e,t,r,n){var i=e[0];return i&&(i.fileName||i.setFileName(t),i.lineNumber||i.setLineNumber(r),i.columnNumber||(void 0!==n?i.setColumnNumber(n):window.event&&window.event.errorCharacter&&i.setColumnNumber(window.event&&window.event.errorCharacter))),e},Et=function(e,t,r){return JSON.stringify(o(e),t,r)},Mt=20,It=25e3,Tt=8,Ct="...",kt=function(e){var t=Et(e);if(1e6<t.length&&(delete e.events[0].metaData,e.events[0].metaData={notifier:"WARNING!\nSerialized payload was "+t.length/1e6+"MB (limit = 1MB)\nmetaData was removed"},1e6<(t=Et(e)).length))throw new Error("payload exceeded 1MB limit");return t},Pt={},Dt=y;Pt={sendReport:function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},i=Lt(e,"notify","4.0"),o=new window.XDomainRequest;o.onload=function(){n(null,o.responseText)},o.open("POST",i),setTimeout(function(){try{o.send(kt(r))}catch(e){t.error(e)}},0)},sendSession:function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},i=Lt(e,"sessions","1.0"),o=new window.XDomainRequest;o.onload=function(){n(null,o.responseText)},o.open("POST",i),setTimeout(function(){try{o.send(Et(r))}catch(e){t.error(e)}},0)}};var At,Lt=function(e,t,r){return Ot(e.endpoints[t],window.location.protocol)+"?apiKey="+encodeURIComponent(e.apiKey)+"&payloadVersion="+r+"&sentAt="+encodeURIComponent(Dt())},Ot=Pt._matchPageProtocol=function(e,t){return"http:"===t?e.replace(/^https:/,"http:"):e},qt=y,Ft={sendReport:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};try{var i=t.endpoints.notify,o=new window.XMLHttpRequest;o.onreadystatechange=function(){o.readyState===window.XMLHttpRequest.DONE&&n(null,o.responseText)},o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Bugsnag-Api-Key",r.apiKey||t.apiKey),o.setRequestHeader("Bugsnag-Payload-Version","4.0"),o.setRequestHeader("Bugsnag-Sent-At",qt()),o.send(kt(r))}catch(t){e.error(t)}},sendSession:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};try{var i=t.endpoints.sessions,o=new window.XMLHttpRequest;o.onreadystatechange=function(){o.readyState===window.XMLHttpRequest.DONE&&n(null,o.responseText)},o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Bugsnag-Api-Key",t.apiKey),o.setRequestHeader("Bugsnag-Payload-Version","1.0"),o.setRequestHeader("Bugsnag-Sent-At",qt()),o.send(Et(r))}catch(t){e.error(t)}}},Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rt=c,Bt=u,jt=Nt({},_.schema,Me),Vt=[_t,vt,qe,Ae,st,we,Te,Xe,He,Ve,Fe,dt,Ge,ft];At=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e&&(e={apiKey:e});var r=[];e.sessionTrackingEnabled&&(r.push("deprecated option sessionTrackingEnabled is now called autoCaptureSessions"),e.autoCaptureSessions=e.sessionTrackingEnabled),!e.endpoint&&!e.sessionEndpoint||e.endpoints||(r.push("deprecated options endpoint/sessionEndpoint are now configured in the endpoints object"),e.endpoints={notify:e.endpoint,sessions:e.sessionEndpoint}),e.endpoints&&e.endpoints.notify&&!e.endpoints.sessions&&r.push("notify endpoint is set but sessions endpoint is not. No sessions will be sent.");var n=Bt([].concat(Vt).concat(t),function(e,t){return t.configSchema?Nt({},e,t.configSchema):e},jt),i=new be({name:"Bugsnag JavaScript",version:"4.7.3",url:"https://github.com/bugsnag/bugsnag-js"},n);return i.transport(window.XDomainRequest?Pt:Ft),i.configure(e),Rt(r,function(e){return i._logger.warn(e)}),i.use(qe),i.use(Ae),i.use(st),i.use(Fe),i.use(we),i.use(dt),i.use(Ge),i.use(ft),!1!==i.config.autoNotify&&(i.use(_t),i.use(vt)),Ut(i.config,"navigationBreadcrumbsEnabled")&&i.use(He),Ut(i.config,"interactionBreadcrumbsEnabled")&&i.use(Ve),Ut(i.config,"networkBreadcrumbsEnabled")&&i.use(Xe),Ut(i.config,"consoleBreadcrumbsEnabled",!1)&&i.use(Te),Rt(t,function(e){return i.use(e)}),i.config.autoCaptureSessions?i.startSession():i};var Ut=function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return"boolean"==typeof e[t]?e[t]:e.autoBreadcrumbs&&(r||!/^dev(elopment)?$/.test(e.releaseStage))};return At.Bugsnag={Client:be,Report:z,Session:ne,Breadcrumb:b},At.default=At}),define("main/calc_basic",["require","api/calculator","config","bugsnag","lib/app-bridge","jquery","vendor/bugsnag"],function(e){var r,t=e("api/calculator"),n=e("config"),i=(e("bugsnag"),e("lib/app-bridge")),o=e("jquery"),a=(e("vendor/bugsnag"),document.getElementById("main")),s=n.all();r=n.get("sciKeypad")?(o("#main").addClass("dcg-scientific-container"),o(".help-link").attr("href","https://www.sigoo.com/tools/calculator/help"),t.ScientificCalculator(a,s)):(o("#main").addClass("dcg-four-function-container"),o(".help-link").attr("href","http://learn.desmos.com/fourfunction"),t.FourFunctionCalculator(a,s)),o(document).on("keydown",function(e){if(0===o(e.target).closest(".dcg-calc-basic-main-wrapper").length)return r.view.handleRootKeydown(e)});var l=function(){var e=r.controller.getInvertedColors();o("body").toggleClass("dcg-inverted-colors",e);var t=r.controller.getBackgroundColor();o("body").css({background:t}),o("#main").css("border-color",t)};return r.settings.observeAndSync("invertedColors",l),r.settings.observeAndSync("backgroundColor",l),r.focusFirstExpression(),i.hideLoadingScreen(),o(".dcg-loading-div-container").hide(),o(".hidden-until-load").fadeIn("fast"),r}),define("main/noconflict",["require","jquery","underscore"],function(e){var t=e("jquery"),r=e("underscore");return"undefined"==typeof Desmos&&(Desmos={}),function(){Desmos.$=t,Desmos._=r,Desmos.$.noConflict(!0),Desmos._.noConflict()}}),define("toplevel/calculator_basic",["require","touchtracking","main/calc_basic","main/noconflict"],function(e){e("touchtracking").monitor(document.body);var t=e("main/calc_basic");return e("main/noconflict")(),t});